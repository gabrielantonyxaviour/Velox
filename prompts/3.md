# Prompt 3: Update Frontend Chart with Quadratic Curve

## Goal
Update the Dutch auction chart component to display the **same quadratic curve** as the contract. This ensures visual consistency with actual price behavior.

## Current Implementation (Linear)
```typescript
// dutch-auction-chart.tsx lines 63-72
const calculateCurrentPrice = useCallback((elapsedSeconds: number): bigint => {
  if (duration <= 0) return startPrice;
  if (elapsedSeconds >= duration) return endPrice;
  if (elapsedSeconds <= 0) return startPrice;

  const priceRange = Number(startPrice - endPrice);
  const priceDrop = (priceRange * elapsedSeconds) / duration;
  if (isNaN(priceDrop) || !isFinite(priceDrop)) return startPrice;
  return startPrice - BigInt(Math.floor(priceDrop));
}, [startPrice, endPrice, duration]);
```

## New Implementation (Quadratic)
The curve formula: `price = startPrice - priceRange * (elapsed/duration)^2`

### 1. Update `calculateCurrentPrice` function
```typescript
/**
 * Calculate Dutch auction price using quadratic decay
 * Formula: price = startPrice - priceRange * (elapsed/duration)^2
 * This creates a curve that starts slow and accelerates downward
 */
const calculateCurrentPrice = useCallback((elapsedSeconds: number): bigint => {
  if (duration <= 0) return startPrice;
  if (elapsedSeconds >= duration) return endPrice;
  if (elapsedSeconds <= 0) return startPrice;

  const priceRange = Number(startPrice - endPrice);
  // Quadratic decay: (elapsed/duration)^2
  const ratio = elapsedSeconds / duration;
  const ratioSquared = ratio * ratio;
  const priceDrop = priceRange * ratioSquared;

  if (isNaN(priceDrop) || !isFinite(priceDrop)) return startPrice;
  return startPrice - BigInt(Math.floor(priceDrop));
}, [startPrice, endPrice, duration]);
```

### 2. Update SOLD marker time calculation (lines 294-301)
The reverse calculation to find time from price needs quadratic inverse:
```typescript
// For quadratic: price = startPrice - priceRange * (t/duration)^2
// Solving for t: t = duration * sqrt((startPrice - price) / priceRange)
const priceRange = Number(startPrice - endPrice);
let soldTime = safeDuration;
if (priceRange > 0 && actualSoldPrice) {
  const priceDiff = Number(startPrice - actualSoldPrice);
  const ratio = priceDiff / priceRange;
  // Quadratic inverse: t = duration * sqrt(ratio)
  soldTime = Math.min(safeDuration, Math.max(0, safeDuration * Math.sqrt(ratio)));
}
```

## Visual Behavior
The quadratic curve will:
- Start at `startPrice` and stay high longer initially
- Curve downward, accelerating as time progresses
- Reach `endPrice` exactly at `duration`

This matches the reference image showing a curved depreciation line.

## Files to Modify
- `frontend/app/components/intent/dutch-auction-chart.tsx`

## Testing
After changes:
```bash
cd frontend && npm run dev
```
Navigate to an intent with Dutch auction and verify:
1. Chart shows curved (not straight) decline
2. Prices stay high longer at the start
3. SOLD marker appears at correct position on curve
