"use strict";var e=require("react/jsx-runtime"),r=require("react"),i=require("./get-is-unified-wallet-JejAvbr5.js"),t=require("./index-iQcFLOcm.js"),o=require("./to-ui-error-B_KfP469.js");require("viem"),require("./context-CcgGREUw.js"),require("@privy-io/js-sdk-core"),require("tinycolor2"),require("./internal-context-NWsAL807.js"),require("ofetch"),require("uuid"),require("jose"),require("eventemitter3"),require("./useActiveWallet-DTCrzsoG.js"),require("zustand"),require("styled-components"),require("react-device-detect"),require("./prepareFundingModalData-DkGmcQac.js"),require("./events-context-Di6--rDg.js"),require("viem/utils"),require("./getPublicClient-CGlodIp_.js"),require("./useWallets-ggeQUC3m.js"),require("@coinbase/wallet-sdk"),require("@privy-io/ethereum"),require("mipd"),require("@privy-io/popup"),require("./paths-DizMb-lU.js"),require("./usePrivy-CyUYnFHC.js"),require("@scure/base"),require("@headlessui/react"),require("@walletconnect/ethereum-provider"),require("@privy-io/urls"),require("js-cookie"),require("./frame-B14fp9oC.js"),require("@privy-io/routes"),require("x402/client"),require("@privy-io/api-base"),require("viem/accounts"),require("./use-sign-with-user-signer-BcAsQTGF.js"),require("./getEmbeddedConnectedWallet-6TsVZJkD.js"),require("@heroicons/react/24/outline/DevicePhoneMobileIcon"),require("@heroicons/react/24/outline/FingerPrintIcon"),require("@heroicons/react/24/outline/PhoneIcon"),require("@heroicons/react/24/outline/ShieldCheckIcon"),require("./ModalHeader-DRaJvD2v.js"),require("@heroicons/react/24/outline/ArrowLeftIcon"),require("@heroicons/react/24/outline/ArrowRightIcon"),require("@heroicons/react/24/outline/QuestionMarkCircleIcon"),require("@heroicons/react/24/outline/XMarkIcon"),require("./ScreenLayout-CfU_O3al.js"),require("./Button-BXkfCTro.js"),require("./Screen-BZ-J4FwQ.js"),require("./index-CRFXS9pP.js"),require("./PinInput-DSI6rjOn.js"),require("@heroicons/react/24/outline/CalendarIcon"),require("@heroicons/react/24/outline/ExclamationTriangleIcon"),require("./StackedContainer-ByB6Mdu0.js"),require("./useGetTokenPrice-DoyKddna.js"),require("./useGetSolPrice-C986iVoO.js"),require("./TransactionDetails-Bg0E9A_6.js"),require("./WalletLink-CzKk6PGd.js"),require("./ethers-CWRVqVsu.js"),require("./getFormattedUsdFromLamports-Mu2fqwL2.js"),require("./transaction-DjF5X-by.js"),require("./Layouts-dRL0OSpp.js"),require("@heroicons/react/24/outline/ChevronDownIcon");const u=({onClose:u})=>{let{user:s}=i.usePrivyContext(),[n,c]=r.useState(s?.mfaMethods[0]??null),{init:a,cancel:l,submit:q}=t.useMfa(),[d,h]=r.useState(!1),[j,f]=r.useState(null),[v,y]=r.useState();r.useEffect((()=>{c(s?.mfaMethods[0]??null)}),[s?.mfaMethods]);let m=r.useRef(!1);async function p(e){y(void 0);try{if(!e||!n)return;await q(n,e),h(!0),y(void 0),u()}catch(e){throw o.toUIError(e).error}}async function k(e){if("passkey"!==e)try{c(e),await a(e)}catch(e){console.error(e)}else try{c(e);let r=await a(e);if(!r)throw Error("something went wrong");f(r),await q(e,r),h(!0),y(void 0),u()}catch(e){y(o.toUIError(e))}}r.useEffect((()=>{!m.current&&n&&(m.current=!0,k(n).finally((()=>{m.current=!1})))}),[]);let S=()=>{c(null),y(void 0),l(),u()};return s?"passkey"===n?/*#__PURE__*/e.jsx(o.VerifyWithPasskey,{account:s.linkedAccounts.filter((e=>"passkey"===e.type&&e.enrolledInMfa)).sort(((e,r)=>r.firstVerifiedAt.valueOf()-e.firstVerifiedAt.valueOf()))[0],submitSuccess:d,hasBlockingError:v?.isBlocking??!1,error:v?.error,onClose:S,onBack:()=>{c(null),y(void 0)},handleSubmit:()=>p(j).catch(y)}):n?/*#__PURE__*/e.jsx(o.VerifyWithSmsOrTotpCode,{submitSuccess:d,hasBlockingError:v?.isBlocking??!1,handleSubmitCode:p,selectedMethod:n,onClose:S,onBack:s.mfaMethods.length>1?()=>c(null):void 0}):/*#__PURE__*/e.jsx(o.VerifyMethodSelectionScreen,{user:s,onSelect:k,handleClose:S}):null};exports.MfaVerifyFlowScreen=u,exports.default=u;
