(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,635138,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toBig=r.shrSL=r.shrSH=r.rotrSL=r.rotrSH=r.rotrBL=r.rotrBH=r.rotr32L=r.rotr32H=r.rotlSL=r.rotlSH=r.rotlBL=r.rotlBH=r.add5L=r.add5H=r.add4L=r.add4H=r.add3L=r.add3H=void 0,r.add=v,r.fromBig=s,r.split=a;let i=BigInt(0x100000000-1),n=BigInt(32);function s(e,t=!1){return t?{h:Number(e&i),l:Number(e>>n&i)}:{h:0|Number(e>>n&i),l:0|Number(e&i)}}function a(e,t=!1){let r=e.length,i=new Uint32Array(r),n=new Uint32Array(r);for(let a=0;a<r;a++){let{h:r,l:o}=s(e[a],t);[i[a],n[a]]=[r,o]}return[i,n]}let o=(e,t)=>BigInt(e>>>0)<<n|BigInt(t>>>0);r.toBig=o;let l=(e,t,r)=>e>>>r;r.shrSH=l;let c=(e,t,r)=>e<<32-r|t>>>r;r.shrSL=c;let d=(e,t,r)=>e>>>r|t<<32-r;r.rotrSH=d;let u=(e,t,r)=>e<<32-r|t>>>r;r.rotrSL=u;let h=(e,t,r)=>e<<64-r|t>>>r-32;r.rotrBH=h;let p=(e,t,r)=>e>>>r-32|t<<64-r;r.rotrBL=p;let f=(e,t)=>t;r.rotr32H=f;let y=(e,t)=>e;r.rotr32L=y;let g=(e,t,r)=>e<<r|t>>>32-r;r.rotlSH=g;let m=(e,t,r)=>t<<r|e>>>32-r;r.rotlSL=m;let w=(e,t,r)=>t<<r-32|e>>>64-r;r.rotlBH=w;let b=(e,t,r)=>e<<r-32|t>>>64-r;function v(e,t,r,i){let n=(t>>>0)+(i>>>0);return{h:e+r+(n/0x100000000|0)|0,l:0|n}}r.rotlBL=b;let _=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);r.add3L=_;let E=(e,t,r,i)=>t+r+i+(e/0x100000000|0)|0;r.add3H=E;let A=(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0);r.add4L=A;let S=(e,t,r,i,n)=>t+r+i+n+(e/0x100000000|0)|0;r.add4H=S;let I=(e,t,r,i,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(n>>>0);r.add5L=I;let k=(e,t,r,i,n,s)=>t+r+i+n+s+(e/0x100000000|0)|0;r.add5H=k,r.default={fromBig:s,split:a,toBig:o,shrSH:l,shrSL:c,rotrSH:d,rotrSL:u,rotrBH:h,rotrBL:p,rotr32H:f,rotr32L:y,rotlSH:g,rotlSL:m,rotlBH:w,rotlBL:b,add:v,add3L:_,add3H:E,add4L:A,add4H:S,add5H:k,add5L:I}},581918,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.crypto=void 0,r.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},857024,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.wrapXOFConstructorWithOpts=r.wrapConstructorWithOpts=r.wrapConstructor=r.Hash=r.nextTick=r.swap32IfBE=r.byteSwapIfBE=r.swap8IfBE=r.isLE=void 0,r.isBytes=n,r.anumber=s,r.abytes=a,r.ahash=function(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.createHasher");s(e.outputLen),s(e.blockLen)},r.aexists=function(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")},r.aoutput=function(e,t){a(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)},r.u8=function(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},r.u32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))},r.clean=function(...e){for(let t=0;t<e.length;t++)e[t].fill(0)},r.createView=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)},r.rotr=function(e,t){return e<<32-t|e>>>t},r.rotl=function(e,t){return e<<t|e>>>32-t>>>0},r.byteSwap=o,r.byteSwap32=l,r.bytesToHex=function(e){if(a(e),c)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=d[e[r]];return t},r.hexToBytes=function(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(c)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,n=0;t<r;t++,n+=2){let r=u(e.charCodeAt(n)),s=u(e.charCodeAt(n+1));if(void 0===r||void 0===s)throw Error('hex string expected, got non-hex character "'+(e[n]+e[n+1])+'" at index '+n);i[t]=16*r+s}return i},r.asyncLoop=h,r.utf8ToBytes=p,r.bytesToUtf8=function(e){return new TextDecoder().decode(e)},r.toBytes=f,r.kdfInputToBytes=function(e){return"string"==typeof e&&(e=p(e)),a(e),e},r.concatBytes=function(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];a(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r},r.checkOpts=function(e,t){if(void 0!==t&&"[object Object]"!==({}).toString.call(t))throw Error("options should be object or undefined");return Object.assign(e,t)},r.createHasher=y,r.createOptHasher=g,r.createXOFer=m,r.randomBytes=function(e=32){if(i.crypto&&"function"==typeof i.crypto.getRandomValues)return i.crypto.getRandomValues(new Uint8Array(e));if(i.crypto&&"function"==typeof i.crypto.randomBytes)return Uint8Array.from(i.crypto.randomBytes(e));throw Error("crypto.getRandomValues must be defined")};let i=e.r(581918);function n(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function s(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function a(e,...t){if(!n(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function o(e){return e<<24&0xff000000|e<<8&0xff0000|e>>>8&65280|e>>>24&255}function l(e){for(let t=0;t<e.length;t++)e[t]=o(e[t]);return e}r.isLE=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0],r.swap8IfBE=r.isLE?e=>e:e=>o(e),r.byteSwapIfBE=r.swap8IfBE,r.swap32IfBE=r.isLE?e=>e:l;let c="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,d=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function u(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}async function h(e,t,i){let n=Date.now();for(let s=0;s<e;s++){i(s);let e=Date.now()-n;e>=0&&e<t||(await (0,r.nextTick)(),n+=e)}}function p(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function f(e){return"string"==typeof e&&(e=p(e)),a(e),e}function y(e){let t=t=>e().update(f(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function g(e){let t=(t,r)=>e(r).update(f(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}function m(e){let t=(t,r)=>e(r).update(f(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}r.nextTick=async()=>{},r.Hash=class{},r.wrapConstructor=y,r.wrapConstructorWithOpts=g,r.wrapXOFConstructorWithOpts=m},13959,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shake256=r.shake128=r.keccak_512=r.keccak_384=r.keccak_256=r.keccak_224=r.sha3_512=r.sha3_384=r.sha3_256=r.sha3_224=r.Keccak=void 0,r.keccakP=b;let i=e.r(635138),n=e.r(857024),s=BigInt(0),a=BigInt(1),o=BigInt(2),l=BigInt(7),c=BigInt(256),d=BigInt(113),u=[],h=[],p=[];for(let e=0,t=a,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],u.push(2*(5*i+r)),h.push((e+1)*(e+2)/2%64);let n=s;for(let e=0;e<7;e++)(t=(t<<a^(t>>l)*d)%c)&o&&(n^=a<<(a<<BigInt(e))-a);p.push(n)}let f=(0,i.split)(p,!0),y=f[0],g=f[1],m=(e,t,r)=>r>32?(0,i.rotlBH)(e,t,r):(0,i.rotlSH)(e,t,r),w=(e,t,r)=>r>32?(0,i.rotlBL)(e,t,r):(0,i.rotlSL)(e,t,r);function b(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,n=(t+2)%10,s=r[n],a=r[n+1],o=m(s,a,1)^r[i],l=w(s,a,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=o,e[t+r+1]^=l}let t=e[2],n=e[3];for(let r=0;r<24;r++){let i=h[r],s=m(t,n,i),a=w(t,n,i),o=u[r];t=e[o],n=e[o+1],e[o]=s,e[o+1]=a}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=y[i],e[1]^=g[i]}(0,n.clean)(r)}class v extends n.Hash{constructor(e,t,r,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,(0,n.anumber)(r),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,n.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,n.swap32IfBE)(this.state32),b(this.state32,this.rounds),(0,n.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(e){(0,n.aexists)(this),e=(0,n.toBytes)(e),(0,n.abytes)(e);let{blockLen:t,state:r}=this,i=e.length;for(let n=0;n<i;){let s=Math.min(t-this.pos,i-n);for(let t=0;t<s;t++)r[this.pos++]^=e[n++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){(0,n.aexists)(this,!1),(0,n.abytes)(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,n=e.length;i<n;){this.posOut>=r&&this.keccak();let s=Math.min(r-this.posOut,n-i);e.set(t.subarray(this.posOut,this.posOut+s),i),this.posOut+=s,i+=s}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,n.anumber)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,n.aoutput)(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,n.clean)(this.state)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:n,enableXOF:s}=this;return e||(e=new v(t,r,i,s,n)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=n,e.suffix=r,e.outputLen=i,e.enableXOF=s,e.destroyed=this.destroyed,e}}r.Keccak=v;let _=(e,t,r)=>(0,n.createHasher)(()=>new v(t,e,r));r.sha3_224=_(6,144,28),r.sha3_256=_(6,136,32),r.sha3_384=_(6,104,48),r.sha3_512=_(6,72,64),r.keccak_224=_(1,144,28),r.keccak_256=_(1,136,32),r.keccak_384=_(1,104,48),r.keccak_512=_(1,72,64);let E=(e,t,r)=>(0,n.createXOFer)((i={})=>new v(t,e,void 0===i.dkLen?r:i.dkLen,!0));r.shake128=E(31,168,16),r.shake256=E(31,136,32)},321629,(e,t,r)=>{var i=e.i(467034);let{keccak_256:n}=e.r(13959);function s(e){return i.Buffer.allocUnsafe(e).fill(0)}function a(e,t){let r=e.toString(16);r.length%2!=0&&(r="0"+r);let n=r.match(/.{1,2}/g).map(e=>parseInt(e,16));for(;n.length<t;)n.unshift(0);return i.Buffer.from(n)}function o(e,t,r){let i=s(t);return(e=l(e),r)?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)}function l(e){if(!i.Buffer.isBuffer(e))if(Array.isArray(e))e=i.Buffer.from(e);else if("string"==typeof e){var t;e=c(e)?i.Buffer.from((t=d(e)).length%2?"0"+t:t,"hex"):i.Buffer.from(e)}else if("number"==typeof e)e=intToBuffer(e);else if(null==e)e=i.Buffer.allocUnsafe(0);else if("bigint"==typeof e)e=a(e);else if(e.toArray)e=i.Buffer.from(e.toArray());else throw Error("invalid type");return e}function c(e){return"string"==typeof e&&e.match(/^0x[0-9A-Fa-f]*$/)}function d(e){return"string"==typeof e&&e.startsWith("0x")?e.slice(2):e}t.exports={zeros:s,setLength:o,setLengthRight:function(e,t){return o(e,t,!0)},isHexString:c,stripHexPrefix:d,toBuffer:l,bufferToHex:function(e){return"0x"+(e=l(e)).toString("hex")},keccak:function(e,t){if(e=l(e),t||(t=256),256!==t)throw Error("unsupported");return i.Buffer.from(n(new Uint8Array(e)))},bitLengthFromBigInt:function(e){return e.toString(2).length},bufferBEFromBigInt:a,twosFromBigInt:function(e,t){return(e<0n?(~e&(1n<<BigInt(t))-1n)+1n:e)&(1n<<BigInt(t))-1n}}},132144,(e,t,r)=>{var i=e.i(467034);let n=e.r(321629);function s(e){if(e.startsWith("int["))return"int256"+e.slice(3);if("int"===e)return"int256";if(e.startsWith("uint["))return"uint256"+e.slice(4);if("uint"===e)return"uint256";if(e.startsWith("fixed["))return"fixed128x128"+e.slice(5);else if("fixed"===e)return"fixed128x128";else if(e.startsWith("ufixed["))return"ufixed128x128"+e.slice(6);else if("ufixed"===e)return"ufixed128x128";return e}function a(e){return Number.parseInt(/^\D+(\d+)$/.exec(e)[1],10)}function o(e){var t=/^\D+(\d+)x(\d+)$/.exec(e);return[Number.parseInt(t[1],10),Number.parseInt(t[2],10)]}function l(e){var t=e.match(/(.*)\[(.*?)\]$/);return t?""===t[2]?"dynamic":Number.parseInt(t[2],10):null}function c(e){var t=typeof e;if("string"===t||"number"===t)return BigInt(e);if("bigint"===t)return e;throw Error("Argument is not a number")}function d(e,t){if("address"===e)return d("uint160",c(t));if("bool"===e)return d("uint8",+!!t);if("string"===e)return d("bytes",new i.Buffer(t,"utf8"));if((p=e).lastIndexOf("]")===p.length-1){if(void 0===t.length)throw Error("Not an array?");if("dynamic"!==(r=l(e))&&0!==r&&t.length>r)throw Error("Elements exceed array size: "+r);for(h in u=[],e=e.slice(0,e.lastIndexOf("[")),"string"==typeof t&&(t=JSON.parse(t)),t)u.push(d(e,t[h]));if("dynamic"===r){var r,s,u,h,p,f=d("uint256",t.length);u.unshift(f)}return i.Buffer.concat(u)}else if("bytes"===e)return t=new i.Buffer(t),u=i.Buffer.concat([d("uint256",t.length),t]),t.length%32!=0&&(u=i.Buffer.concat([u,n.zeros(32-t.length%32)])),u;else if(e.startsWith("bytes")){if((r=a(e))<1||r>32)throw Error("Invalid bytes<N> width: "+r);return n.setLengthRight(t,32)}else if(e.startsWith("uint")){if((r=a(e))%8||r<8||r>256)throw Error("Invalid uint<N> width: "+r);s=c(t);let i=n.bitLengthFromBigInt(s);if(i>r)throw Error("Supplied uint exceeds width: "+r+" vs "+i);if(s<0)throw Error("Supplied uint is negative");return n.bufferBEFromBigInt(s,32)}else if(e.startsWith("int")){if((r=a(e))%8||r<8||r>256)throw Error("Invalid int<N> width: "+r);s=c(t);let i=n.bitLengthFromBigInt(s);if(i>r)throw Error("Supplied int exceeds width: "+r+" vs "+i);let o=n.twosFromBigInt(s,256);return n.bufferBEFromBigInt(o,32)}else if(e.startsWith("ufixed")){if(r=o(e),(s=c(t))<0)throw Error("Supplied ufixed is negative");return d("uint256",s*BigInt(2)**BigInt(r[1]))}else if(e.startsWith("fixed"))return r=o(e),d("int256",c(t)*BigInt(2)**BigInt(r[1]));throw Error("Unsupported or invalid type: "+e)}function u(e,t){if(e.length!==t.length)throw Error("Number of types are not matching the values");for(var r,o,l=[],d=0;d<e.length;d++){var u=s(e[d]),h=t[d];if("bytes"===u)l.push(h);else if("string"===u)l.push(new i.Buffer(h,"utf8"));else if("bool"===u)l.push(new i.Buffer(h?"01":"00","hex"));else if("address"===u)l.push(n.setLength(h,20));else if(u.startsWith("bytes")){if((r=a(u))<1||r>32)throw Error("Invalid bytes<N> width: "+r);l.push(n.setLengthRight(h,r))}else if(u.startsWith("uint")){if((r=a(u))%8||r<8||r>256)throw Error("Invalid uint<N> width: "+r);o=c(h);let e=n.bitLengthFromBigInt(o);if(e>r)throw Error("Supplied uint exceeds width: "+r+" vs "+e);l.push(n.bufferBEFromBigInt(o,r/8))}else if(u.startsWith("int")){if((r=a(u))%8||r<8||r>256)throw Error("Invalid int<N> width: "+r);o=c(h);let e=n.bitLengthFromBigInt(o);if(e>r)throw Error("Supplied int exceeds width: "+r+" vs "+e);let t=n.twosFromBigInt(o,r);l.push(n.bufferBEFromBigInt(t,r/8))}else throw Error("Unsupported or invalid type: "+u)}return i.Buffer.concat(l)}t.exports={rawEncode:function(e,t){var r=[],n=[],a=32*e.length;for(var o in e){var c=s(e[o]),u=d(c,t[o]);"string"===c||"bytes"===c||"dynamic"===l(c)?(r.push(d("uint256",a)),n.push(u),a+=u.length):r.push(u)}return i.Buffer.concat(r.concat(n))},solidityPack:u,soliditySHA3:function(e,t){return n.keccak(u(e,t))}}},980423,(e,t,r)=>{var i=e.i(467034);let n=e.r(321629),s=e.r(132144),a={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},o={encodeData(e,t,r,a=!0){let o=["bytes32"],l=[this.hashType(e,r)];if(a){let c=(e,t,o)=>{if(void 0!==r[t])return["bytes32",null==o?"0x0000000000000000000000000000000000000000000000000000000000000000":n.keccak(this.encodeData(t,o,r,a))];if(void 0===o)throw Error(`missing value for field ${e} of type ${t}`);if("bytes"===t)return["bytes32",n.keccak(o)];if("string"===t)return"string"==typeof o&&(o=i.Buffer.from(o,"utf8")),["bytes32",n.keccak(o)];if(t.lastIndexOf("]")===t.length-1){let r=t.slice(0,t.lastIndexOf("[")),i=o.map(t=>c(e,r,t));return["bytes32",n.keccak(s.rawEncode(i.map(([e])=>e),i.map(([,e])=>e)))]}return[t,o]};for(let i of r[e]){let[e,r]=c(i.name,i.type,t[i.name]);o.push(e),l.push(r)}}else for(let s of r[e]){let e=t[s.name];if(void 0!==e)if("bytes"===s.type)o.push("bytes32"),e=n.keccak(e),l.push(e);else if("string"===s.type)o.push("bytes32"),"string"==typeof e&&(e=i.Buffer.from(e,"utf8")),e=n.keccak(e),l.push(e);else if(void 0!==r[s.type])o.push("bytes32"),e=n.keccak(this.encodeData(s.type,e,r,a)),l.push(e);else if(s.type.lastIndexOf("]")===s.type.length-1)throw Error("Arrays currently unimplemented in encodeData");else o.push(s.type),l.push(e)}return s.rawEncode(o,l)},encodeType(e,t){let r="",i=this.findTypeDependencies(e,t).filter(t=>t!==e);for(let n of i=[e].concat(i.sort())){if(!t[n])throw Error("No type definition specified: "+n);r+=n+"("+t[n].map(({name:e,type:t})=>t+" "+e).join(",")+")"}return r},findTypeDependencies(e,t,r=[]){if(e=e.match(/^\w*/)[0],r.includes(e)||void 0===t[e])return r;for(let i of(r.push(e),t[e]))for(let e of this.findTypeDependencies(i.type,t,r))r.includes(e)||r.push(e);return r},hashStruct(e,t,r,i=!0){return n.keccak(this.encodeData(e,t,r,i))},hashType(e,t){return n.keccak(this.encodeType(e,t))},sanitizeData(e){let t={};for(let r in a.properties)e[r]&&(t[r]=e[r]);return t.types&&(t.types=Object.assign({EIP712Domain:[]},t.types)),t},hash(e,t=!0){let r=this.sanitizeData(e),s=[i.Buffer.from("1901","hex")];return s.push(this.hashStruct("EIP712Domain",r.domain,r.types,t)),"EIP712Domain"!==r.primaryType&&s.push(this.hashStruct(r.primaryType,r.message,r.types,t)),n.keccak(i.Buffer.concat(s))}};t.exports={TYPED_MESSAGE_SCHEMA:a,TypedDataUtils:o,hashForSignTypedDataLegacy:function(e){return function(e){let t=Error("Expect argument to be non-empty array");if("object"!=typeof e||!e.length)throw t;let r=e.map(function(e){return"bytes"===e.type?n.toBuffer(e.value):e.value}),i=e.map(function(e){return e.type}),a=e.map(function(e){if(!e.name)throw t;return e.type+" "+e.name});return s.soliditySHA3(["bytes32","bytes32"],[s.soliditySHA3(Array(e.length).fill("string"),a),s.soliditySHA3(i,r)])}(e.data)},hashForSignTypedData_v3:function(e){return o.hash(e.data,!1)},hashForSignTypedData_v4:function(e){return o.hash(e.data)}}},171126,(e,t,r)=>{"use strict";var i=e.r(271645),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=i.useSyncExternalStore,a=i.useRef,o=i.useEffect,l=i.useMemo,c=i.useDebugValue;r.useSyncExternalStoreWithSelector=function(e,t,r,i,d){var u=a(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;var p=s(e,(u=l(function(){function e(e){if(!o){if(o=!0,s=e,e=i(e),void 0!==d&&h.hasValue){var t=h.value;if(d(t,e))return a=t}return a=e}if(t=a,n(s,e))return t;var r=i(e);return void 0!==d&&d(t,r)?(s=e,t):(s=e,a=r)}var s,a,o=!1,l=void 0===r?null:r;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,r,i,d]))[0],u[1]);return o(function(){h.hasValue=!0,h.value=p},[p]),c(p),p}},313027,(e,t,r)=>{"use strict";t.exports=e.r(171126)},735071,(e,t,r)=>{"use strict";let i=e.r(71187);t.exports=d;let n=function(){function e(e){return void 0!==e&&e}try{if("undefined"!=typeof globalThis)return globalThis;return Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{};function s(e,t){return"silent"===e?1/0:t.levels.values[e]}let a=Symbol("pino.logFuncs"),o=Symbol("pino.hierarchy"),l={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function c(e,t){let r={logger:t,parent:e[o]};t[o]=r}function d(e){var t,r,i;let o,f,y;(e=e||{}).browser=e.browser||{};let g=e.browser.transmit;if(g&&"function"!=typeof g.send)throw Error("pino: transmit option must have a send function");let v=e.browser.write||n;e.browser.write&&(e.browser.asObject=!0);let _=e.serializers||{},E=(t=e.browser.serialize,Array.isArray(t)?t.filter(function(e){return"!stdSerializers.err"!==e}):!0===t&&Object.keys(_)),A=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(A=!1);let S=Object.keys(e.customLevels||{}),I=["error","fatal","warn","info","debug","trace"].concat(S);"function"==typeof v&&I.forEach(function(e){v[e]=v}),(!1===e.enabled||e.browser.disabled)&&(e.level="silent");let k=e.level||"info",T=Object.create(v);T.log||(T.log=m),o={},I.forEach(e=>{o[e]=v[e]?v[e]:n[e]||n[l[e]||"log"]||m}),T[a]=o,c({},T),Object.defineProperty(T,"levelVal",{get:function(){return s(this.level,this)}}),Object.defineProperty(T,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,u(this,x,T,"error"),u(this,x,T,"fatal"),u(this,x,T,"warn"),u(this,x,T,"info"),u(this,x,T,"debug"),u(this,x,T,"trace"),S.forEach(e=>{u(this,x,T,e)})}});let x={transmit:g,serialize:E,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:I,timestamp:"function"==typeof(r=e).timestamp?r.timestamp:!1===r.timestamp?w:b,messageKey:e.messageKey||"msg",onChild:e.onChild||m};function C(t,r,i){if(!r)throw Error("missing bindings for child Pino");i=i||{},E&&r.serializers&&(i.serializers=r.serializers);let n=i.serializers;if(E&&n){var s=Object.assign({},_,n),a=!0===e.browser.serialize?Object.keys(s):E;delete r.serializers,h([r],a,s,this._stdErrSerialize)}function o(e){this._childLevel=(0|e._childLevel)+1,this.bindings=r,s&&(this.serializers=s,this._serialize=a),g&&(this._logEvent=p([].concat(e._logEvent.bindings,r)))}o.prototype=this;let l=new o(this);return c(this,l),l.child=function(...e){return C.call(this,t,...e)},l.level=i.level||this.level,t.onChild(l),l}return f=e.customLevels||{},T.levels={values:Object.assign({},d.levels.values,f),labels:Object.assign({},d.levels.labels,(y={},Object.keys(i=f).forEach(function(e){y[i[e]]=e}),y))},T.level=k,T.isLevelEnabled=function(e){return!!this.levels.values[e]&&this.levels.values[e]>=this.levels.values[this.level]},T.setMaxListeners=T.getMaxListeners=T.emit=T.addListener=T.on=T.prependListener=T.once=T.prependOnceListener=T.removeListener=T.removeAllListeners=T.listeners=T.listenerCount=T.eventNames=T.write=T.flush=m,T.serializers=_,T._serialize=E,T._stdErrSerialize=A,T.child=function(...e){return C.call(this,x,...e)},g&&(T._logEvent=p()),T}function u(e,t,r,l){var c,d,u,f,y,g,w;if(Object.defineProperty(e,l,{value:s(e.level,r)>s(l,r)?m:r[a][l],writable:!0,enumerable:!0,configurable:!0}),e[l]===m){if(!t.transmit)return;let i=s(t.transmit.level||e.level,r);if(s(l,r)<i)return}e[l]=(c=e,d=t,u=r,f=l,y=c[a][f],function(){let e=d.timestamp(),t=Array(arguments.length),r=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var a=0;a<t.length;a++)t[a]=arguments[a];var o=!1;if(d.serialize&&(h(t,this._serialize,this.serializers,this._stdErrSerialize),o=!0),d.asObject||d.formatters?y.call(r,...function(e,t,r,n,s){let{level:a,log:o=e=>e}=s.formatters||{},l=r.slice(),c=l[0],d={},u=(0|e._childLevel)+1;if(u<1&&(u=1),n&&(d.time=n),a?Object.assign(d,a(t,e.levels.values[t])):d.level=e.levels.values[t],s.asObjectBindingsOnly){if(null!==c&&"object"==typeof c)for(;u--&&"object"==typeof l[0];)Object.assign(d,l.shift());return[o(d),...l]}if(null!==c&&"object"==typeof c){for(;u--&&"object"==typeof l[0];)Object.assign(d,l.shift());c=l.length?i(l.shift(),l):void 0}else"string"==typeof c&&(c=i(l.shift(),l));return void 0!==c&&(d[s.messageKey]=c),[o(d)]}(this,f,t,e,d)):y.apply(r,t),d.transmit){let r=d.transmit.level||c._level,i=s(r,u),n=s(f,u);if(n<i)return;!function(e,t,r,i=!1){let n=t.send,s=t.ts,a=t.methodLevel,o=t.methodValue,l=t.val,c=e._logEvent.bindings;i||h(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=s,e._logEvent.messages=r.filter(function(e){return -1===c.indexOf(e)}),e._logEvent.level.label=a,e._logEvent.level.value=o,n(a,e._logEvent,l),e._logEvent=p(c)}(this,{ts:e,methodLevel:f,methodValue:n,transmitLevel:r,transmitValue:u.levels.values[d.transmit.level||c._level],send:d.transmit.send,val:s(c._level,u)},t,o)}});let b=function(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[o];for(;r.parent;)(r=r.parent).logger.bindings&&t.push(r.logger.bindings);return t.reverse()}(e);0!==b.length&&(e[l]=(g=b,w=e[l],function(){return w.apply(this,[...g,...arguments])}))}function h(e,t,r,i){for(let n in e)if(i&&e[n]instanceof Error)e[n]=d.stdSerializers.err(e[n]);else if("object"==typeof e[n]&&!Array.isArray(e[n])&&t)for(let i in e[n])t.indexOf(i)>-1&&i in r&&(e[n][i]=r[i](e[n][i]))}function p(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function f(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)void 0===t[r]&&(t[r]=e[r]);return t}function y(){return{}}function g(e){return e}function m(){}function w(){return!1}function b(){return Date.now()}d.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},d.stdSerializers={mapHttpRequest:y,mapHttpResponse:y,wrapRequestSerializer:g,wrapResponseSerializer:g,wrapErrorSerializer:g,req:y,res:y,err:f,errWithCause:f},d.stdTimeFunctions=Object.assign({},{nullTime:w,epochTime:b,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),t.exports.default=d,t.exports.pino=d},852532,(e,t,r)=>{"use strict";let i=e.r(71187);t.exports=d;let n=function(){function e(e){return void 0!==e&&e}try{if("undefined"!=typeof globalThis)return globalThis;return Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{};function s(e,t){return"silent"===e?1/0:t.levels.values[e]}let a=Symbol("pino.logFuncs"),o=Symbol("pino.hierarchy"),l={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function c(e,t){let r={logger:t,parent:e[o]};t[o]=r}function d(e){var t,r,i;let o,f,y;(e=e||{}).browser=e.browser||{};let g=e.browser.transmit;if(g&&"function"!=typeof g.send)throw Error("pino: transmit option must have a send function");let v=e.browser.write||n;e.browser.write&&(e.browser.asObject=!0);let _=e.serializers||{},E=(t=e.browser.serialize,Array.isArray(t)?t.filter(function(e){return"!stdSerializers.err"!==e}):!0===t&&Object.keys(_)),A=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(A=!1);let S=Object.keys(e.customLevels||{}),I=["error","fatal","warn","info","debug","trace"].concat(S);"function"==typeof v&&I.forEach(function(e){v[e]=v}),(!1===e.enabled||e.browser.disabled)&&(e.level="silent");let k=e.level||"info",T=Object.create(v);T.log||(T.log=m),o={},I.forEach(e=>{o[e]=v[e]?v[e]:n[e]||n[l[e]||"log"]||m}),T[a]=o,c({},T),Object.defineProperty(T,"levelVal",{get:function(){return s(this.level,this)}}),Object.defineProperty(T,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,u(this,x,T,"error"),u(this,x,T,"fatal"),u(this,x,T,"warn"),u(this,x,T,"info"),u(this,x,T,"debug"),u(this,x,T,"trace"),S.forEach(e=>{u(this,x,T,e)})}});let x={transmit:g,serialize:E,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:I,timestamp:"function"==typeof(r=e).timestamp?r.timestamp:!1===r.timestamp?w:b,messageKey:e.messageKey||"msg",onChild:e.onChild||m};function C(t,r,i){if(!r)throw Error("missing bindings for child Pino");i=i||{},E&&r.serializers&&(i.serializers=r.serializers);let n=i.serializers;if(E&&n){var s=Object.assign({},_,n),a=!0===e.browser.serialize?Object.keys(s):E;delete r.serializers,h([r],a,s,this._stdErrSerialize)}function o(e){this._childLevel=(0|e._childLevel)+1,this.bindings=r,s&&(this.serializers=s,this._serialize=a),g&&(this._logEvent=p([].concat(e._logEvent.bindings,r)))}o.prototype=this;let l=new o(this);return c(this,l),l.child=function(...e){return C.call(this,t,...e)},l.level=i.level||this.level,t.onChild(l),l}return f=e.customLevels||{},T.levels={values:Object.assign({},d.levels.values,f),labels:Object.assign({},d.levels.labels,(y={},Object.keys(i=f).forEach(function(e){y[i[e]]=e}),y))},T.level=k,T.isLevelEnabled=function(e){return!!this.levels.values[e]&&this.levels.values[e]>=this.levels.values[this.level]},T.setMaxListeners=T.getMaxListeners=T.emit=T.addListener=T.on=T.prependListener=T.once=T.prependOnceListener=T.removeListener=T.removeAllListeners=T.listeners=T.listenerCount=T.eventNames=T.write=T.flush=m,T.serializers=_,T._serialize=E,T._stdErrSerialize=A,T.child=function(...e){return C.call(this,x,...e)},g&&(T._logEvent=p()),T}function u(e,t,r,l){var c,d,u,f,y,g,w;if(Object.defineProperty(e,l,{value:s(e.level,r)>s(l,r)?m:r[a][l],writable:!0,enumerable:!0,configurable:!0}),e[l]===m){if(!t.transmit)return;let i=s(t.transmit.level||e.level,r);if(s(l,r)<i)return}e[l]=(c=e,d=t,u=r,f=l,y=c[a][f],function(){let e=d.timestamp(),t=Array(arguments.length),r=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var a=0;a<t.length;a++)t[a]=arguments[a];var o=!1;if(d.serialize&&(h(t,this._serialize,this.serializers,this._stdErrSerialize),o=!0),d.asObject||d.formatters?y.call(r,...function(e,t,r,n,s){let{level:a,log:o=e=>e}=s.formatters||{},l=r.slice(),c=l[0],d={},u=(0|e._childLevel)+1;if(u<1&&(u=1),n&&(d.time=n),a?Object.assign(d,a(t,e.levels.values[t])):d.level=e.levels.values[t],s.asObjectBindingsOnly){if(null!==c&&"object"==typeof c)for(;u--&&"object"==typeof l[0];)Object.assign(d,l.shift());return[o(d),...l]}if(null!==c&&"object"==typeof c){for(;u--&&"object"==typeof l[0];)Object.assign(d,l.shift());c=l.length?i(l.shift(),l):void 0}else"string"==typeof c&&(c=i(l.shift(),l));return void 0!==c&&(d[s.messageKey]=c),[o(d)]}(this,f,t,e,d)):y.apply(r,t),d.transmit){let r=d.transmit.level||c._level,i=s(r,u),n=s(f,u);if(n<i)return;!function(e,t,r,i=!1){let n=t.send,s=t.ts,a=t.methodLevel,o=t.methodValue,l=t.val,c=e._logEvent.bindings;i||h(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=s,e._logEvent.messages=r.filter(function(e){return -1===c.indexOf(e)}),e._logEvent.level.label=a,e._logEvent.level.value=o,n(a,e._logEvent,l),e._logEvent=p(c)}(this,{ts:e,methodLevel:f,methodValue:n,transmitLevel:r,transmitValue:u.levels.values[d.transmit.level||c._level],send:d.transmit.send,val:s(c._level,u)},t,o)}});let b=function(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[o];for(;r.parent;)(r=r.parent).logger.bindings&&t.push(r.logger.bindings);return t.reverse()}(e);0!==b.length&&(e[l]=(g=b,w=e[l],function(){return w.apply(this,[...g,...arguments])}))}function h(e,t,r,i){for(let n in e)if(i&&e[n]instanceof Error)e[n]=d.stdSerializers.err(e[n]);else if("object"==typeof e[n]&&!Array.isArray(e[n])&&t)for(let i in e[n])t.indexOf(i)>-1&&i in r&&(e[n][i]=r[i](e[n][i]))}function p(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function f(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)void 0===t[r]&&(t[r]=e[r]);return t}function y(){return{}}function g(e){return e}function m(){}function w(){return!1}function b(){return Date.now()}d.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},d.stdSerializers={mapHttpRequest:y,mapHttpResponse:y,wrapRequestSerializer:g,wrapResponseSerializer:g,wrapErrorSerializer:g,req:y,res:y,err:f,errWithCause:f},d.stdTimeFunctions=Object.assign({},{nullTime:w,epochTime:b,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),t.exports.default=d,t.exports.pino=d},313323,902737,544508,746725,835696,914189,294316,83733,233137,397701,700020,998348,825720,341650,140407,402155,684653,813581,877891,652265,22357,952744,605083,101852,255743,601893,35889,526599,635307,610760,e=>{"use strict";let t,r,i,n,s,a,o,l,c,d,u,h,p,f,y,g,m,w,b,v,_,E,A,S,I,k,T,x,C,P,O,R,N,M,U,D,j,L,B;var W=e.i(843476),F=e.i(271645),H=e.i(902910),q=e.i(877225),z=e.i(771567),$=(e.i(63398),e.i(944406));e.i(31557);e.i(733821);let K="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),V=new Uint8Array(16),J=[];for(let e=0;e<256;++e)J.push((e+256).toString(16).slice(1));let Z=function(e,r,i){if(K&&!r&&!e)return K();let n=(e=e||{}).random||(e.rng||function(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(V)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,r){i=i||0;for(let e=0;e<16;++e)r[i+e]=n[e];return r}return function(e,t=0){return J[e[t+0]]+J[e[t+1]]+J[e[t+2]]+J[e[t+3]]+"-"+J[e[t+4]]+J[e[t+5]]+"-"+J[e[t+6]]+J[e[t+7]]+"-"+J[e[t+8]]+J[e[t+9]]+"-"+J[e[t+10]]+J[e[t+11]]+J[e[t+12]]+J[e[t+13]]+J[e[t+14]]+J[e[t+15]]}(n)};var G=e.i(33867),Y=e.i(840796);e.s([],964092),e.i(964092);var Q=e.i(194820),X=e.i(932763),ee=e.i(654544);let et=ee.default.getRandomValues.bind(ee.default);function er(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new G.JOSENotSupported(`Unsupported JWE Algorithm: ${e}`)}}let ei=e=>et(new Uint8Array(er(e)>>3)),en=(e,t)=>{if(t.length<<3!==er(e))throw new G.JWEInvalid("Invalid Initialization Vector length")},es=(e,t)=>{let r=e.byteLength<<3;if(r!==t)throw new G.JWEInvalid(`Invalid Content Encryption Key length. Expected ${t} bits, got ${r} bits`)};function ea(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function eo(e,t){return e.name===t}function el(e){return parseInt(e.name.slice(4),10)}function ec(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw TypeError(e)}}function ed(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!eo(e.algorithm,"AES-GCM"))throw ea("AES-GCM");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw ea(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!eo(e.algorithm,"AES-KW"))throw ea("AES-KW");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw ea(r,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw ea("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!eo(e.algorithm,"PBKDF2"))throw ea("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!eo(e.algorithm,"RSA-OAEP"))throw ea("RSA-OAEP");let r=parseInt(t.slice(9),10)||1;if(el(e.algorithm.hash)!==r)throw ea(`SHA-${r}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}ec(e,r)}function eu(e,t,...r){if(r.length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}let eh=(e,...t)=>eu("Key must be ",e,...t);function ep(e,t,...r){return eu(`Key for the ${e} algorithm must be `,t,...r)}let ef=e=>(0,ee.isCryptoKey)(e),ey=["CryptoKey"];async function eg(e,t,r,i,n,s){let a,o;if(!(t instanceof Uint8Array))throw TypeError(eh(t,"Uint8Array"));let l=parseInt(e.slice(1,4),10),c=await ee.default.subtle.importKey("raw",t.subarray(l>>3),"AES-CBC",!1,["decrypt"]),d=await ee.default.subtle.importKey("raw",t.subarray(0,l>>3),{hash:`SHA-${l<<1}`,name:"HMAC"},!1,["sign"]),u=(0,X.concat)(s,i,r,(0,X.uint64be)(s.length<<3)),h=new Uint8Array((await ee.default.subtle.sign("HMAC",d,u)).slice(0,l>>3));try{a=((e,t)=>{if(!(e instanceof Uint8Array))throw TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw TypeError("Second argument must be a buffer");if(e.length!==t.length)throw TypeError("Input buffers must have the same length");let r=e.length,i=0,n=-1;for(;++n<r;)i|=e[n]^t[n];return 0===i})(n,h)}catch(e){}if(!a)throw new G.JWEDecryptionFailed;try{o=new Uint8Array(await ee.default.subtle.decrypt({iv:i,name:"AES-CBC"},c,r))}catch(e){}if(!o)throw new G.JWEDecryptionFailed;return o}async function em(e,t,r,i,n,s){let a;t instanceof Uint8Array?a=await ee.default.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):(ed(t,e,"decrypt"),a=t);try{return new Uint8Array(await ee.default.subtle.decrypt({additionalData:s,iv:i,name:"AES-GCM",tagLength:128},a,(0,X.concat)(r,n)))}catch(e){throw new G.JWEDecryptionFailed}}let ew=async(e,t,r,i,n,s)=>{if(!(0,ee.isCryptoKey)(t)&&!(t instanceof Uint8Array))throw TypeError(eh(t,...ey,"Uint8Array"));switch(en(e,i),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&es(t,parseInt(e.slice(-3),10)),eg(e,t,r,i,n,s);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&es(t,parseInt(e.slice(1,4),10)),em(e,t,r,i,n,s);default:throw new G.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}},eb=async()=>{throw new G.JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `inflateRaw` decrypt option to provide Inflate Raw implementation.')},ev=async()=>{throw new G.JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `deflateRaw` encrypt option to provide Deflate Raw implementation.')},e_=(...e)=>{let t,r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0};var eE=e.i(763162);let eA=[{hash:"SHA-256",name:"HMAC"},!0,["sign"]];function eS(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function eI(e,t,r){if((0,ee.isCryptoKey)(e))return ed(e,t,r),e;if(e instanceof Uint8Array)return ee.default.subtle.importKey("raw",e,"AES-KW",!0,[r]);throw TypeError(eh(e,...ey,"Uint8Array"))}let ek=async(e,t,r)=>{let i=await eI(t,e,"wrapKey");eS(i,e);let n=await ee.default.subtle.importKey("raw",r,...eA);return new Uint8Array(await ee.default.subtle.wrapKey("raw",n,i,"AES-KW"))},eT=async(e,t,r)=>{let i=await eI(t,e,"unwrapKey");eS(i,e);let n=await ee.default.subtle.unwrapKey("raw",r,i,"AES-KW",...eA);return new Uint8Array(await ee.default.subtle.exportKey("raw",n))};async function ex(e,t,r,i,n=new Uint8Array(0),s=new Uint8Array(0)){let a;if(!(0,ee.isCryptoKey)(e))throw TypeError(eh(e,...ey));if(ed(e,"ECDH"),!(0,ee.isCryptoKey)(t))throw TypeError(eh(t,...ey));ed(t,"ECDH","deriveBits");let o=(0,X.concat)((0,X.lengthAndInput)(X.encoder.encode(r)),(0,X.lengthAndInput)(n),(0,X.lengthAndInput)(s),(0,X.uint32be)(i));a="X25519"===e.algorithm.name?256:"X448"===e.algorithm.name?448:Math.ceil(parseInt(e.algorithm.namedCurve.substr(-3),10)/8)<<3;let l=new Uint8Array(await ee.default.subtle.deriveBits({name:e.algorithm.name,public:e},t,a));return(0,X.concatKdf)(l,i,o)}async function eC(e){if(!(0,ee.isCryptoKey)(e))throw TypeError(eh(e,...ey));return ee.default.subtle.generateKey(e.algorithm,!0,["deriveBits"])}function eP(e){if(!(0,ee.isCryptoKey)(e))throw TypeError(eh(e,...ey));return["P-256","P-384","P-521"].includes(e.algorithm.namedCurve)||"X25519"===e.algorithm.name||"X448"===e.algorithm.name}async function eO(e,t,r,i){if(!(e instanceof Uint8Array)||e.length<8)throw new G.JWEInvalid("PBES2 Salt Input must be 8 or more octets");let n=(0,X.p2s)(t,e),s=parseInt(t.slice(13,16),10),a={hash:`SHA-${t.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:n},o=await function(e,t){if(e instanceof Uint8Array)return ee.default.subtle.importKey("raw",e,"PBKDF2",!1,["deriveBits"]);if((0,ee.isCryptoKey)(e))return ed(e,t,"deriveBits","deriveKey"),e;throw TypeError(eh(e,...ey,"Uint8Array"))}(i,t);if(o.usages.includes("deriveBits"))return new Uint8Array(await ee.default.subtle.deriveBits(a,o,s));if(o.usages.includes("deriveKey"))return ee.default.subtle.deriveKey(a,o,{length:s,name:"AES-KW"},!1,["wrapKey","unwrapKey"]);throw TypeError('PBKDF2 key "usages" must include "deriveBits" or "deriveKey"')}let eR=async(e,t,r,i=2048,n=et(new Uint8Array(16)))=>{let s=await eO(n,e,i,t);return{encryptedKey:await ek(e.slice(-6),s,r),p2c:i,p2s:(0,Q.encode)(n)}},eN=async(e,t,r,i,n)=>{let s=await eO(n,e,i,t);return eT(e.slice(-6),s,r)};function eM(e){switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new G.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}let eU=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){let{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}},eD=async(e,t,r)=>{if(!(0,ee.isCryptoKey)(t))throw TypeError(eh(t,...ey));if(ed(t,e,"encrypt","wrapKey"),eU(e,t),t.usages.includes("encrypt"))return new Uint8Array(await ee.default.subtle.encrypt(eM(e),t,r));if(t.usages.includes("wrapKey")){let i=await ee.default.subtle.importKey("raw",r,...eA);return new Uint8Array(await ee.default.subtle.wrapKey("raw",i,t,eM(e)))}throw TypeError('RSA-OAEP key "usages" must include "encrypt" or "wrapKey" for this operation')},ej=async(e,t,r)=>{if(!(0,ee.isCryptoKey)(t))throw TypeError(eh(t,...ey));if(ed(t,e,"decrypt","unwrapKey"),eU(e,t),t.usages.includes("decrypt"))return new Uint8Array(await ee.default.subtle.decrypt(eM(e),t,r));if(t.usages.includes("unwrapKey")){let i=await ee.default.subtle.unwrapKey("raw",r,t,eM(e),...eA);return new Uint8Array(await ee.default.subtle.exportKey("raw",i))}throw TypeError('RSA-OAEP key "usages" must include "decrypt" or "unwrapKey" for this operation')};function eL(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new G.JOSENotSupported(`Unsupported JWE Algorithm: ${e}`)}}let eB=e=>et(new Uint8Array(eL(e)>>3)),eW=(e,t)=>{let r=(e.match(/.{1,64}/g)||[]).join("\n");return`-----BEGIN ${t}-----
${r}
-----END ${t}-----`},eF=async(e,t,r)=>{if(!(0,ee.isCryptoKey)(r))throw TypeError(eh(r,...ey));if(!r.extractable)throw TypeError("CryptoKey is not extractable");if(r.type!==e)throw TypeError(`key is not a ${e} key`);return eW((0,Q.encodeBase64)(new Uint8Array(await ee.default.subtle.exportKey(t,r))),`${e.toUpperCase()} KEY`)},eH=(e,t,r=0)=>{0===r&&(t.unshift(t.length),t.unshift(6));let i=e.indexOf(t[0],r);if(-1===i)return!1;let n=e.subarray(i,i+t.length);return n.length===t.length&&(n.every((e,r)=>e===t[r])||eH(e,t,i+1))},eq=e=>{switch(!0){case eH(e,[42,134,72,206,61,3,1,7]):return"P-256";case eH(e,[43,129,4,0,34]):return"P-384";case eH(e,[43,129,4,0,35]):return"P-521";case eH(e,[43,101,110]):return"X25519";case eH(e,[43,101,111]):return"X448";case eH(e,[43,101,112]):return"Ed25519";case eH(e,[43,101,113]):return"Ed448";default:throw new G.JOSENotSupported("Invalid or unsupported EC Key Curve or OKP Key Sub Type")}},ez=async(e,t,r,i,n)=>{var s;let a,o,l=new Uint8Array(atob(r.replace(e,"")).split("").map(e=>e.charCodeAt(0))),c="spki"===t;switch(i){case"PS256":case"PS384":case"PS512":a={name:"RSA-PSS",hash:`SHA-${i.slice(-3)}`},o=c?["verify"]:["sign"];break;case"RS256":case"RS384":case"RS512":a={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${i.slice(-3)}`},o=c?["verify"]:["sign"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":a={name:"RSA-OAEP",hash:`SHA-${parseInt(i.slice(-3),10)||1}`},o=c?["encrypt","wrapKey"]:["decrypt","unwrapKey"];break;case"ES256":a={name:"ECDSA",namedCurve:"P-256"},o=c?["verify"]:["sign"];break;case"ES384":a={name:"ECDSA",namedCurve:"P-384"},o=c?["verify"]:["sign"];break;case"ES512":a={name:"ECDSA",namedCurve:"P-521"},o=c?["verify"]:["sign"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let e=eq(l);a=e.startsWith("P-")?{name:"ECDH",namedCurve:e}:{name:e},o=c?[]:["deriveBits"];break}case"EdDSA":a={name:eq(l)},o=c?["verify"]:["sign"];break;default:throw new G.JOSENotSupported('Invalid or unsupported "alg" (Algorithm) value')}return ee.default.subtle.importKey(t,l,a,null!=(s=null==n?void 0:n.extractable)&&s,o)};function e$(e){let t=[],r=0;for(;r<e.length;){let i=eK(e.subarray(r));t.push(i),r+=i.byteLength}return t}function eK(e){let t=0,r=31&e[0];if(t++,31===r){for(r=0;e[t]>=128;)r=128*r+e[t]-128,t++;r=128*r+e[t]-128,t++}let i=0;if(e[t]<128)i=e[t],t++;else if(128===i){for(i=0;0!==e[t+i]||0!==e[t+i+1];){if(i>e.byteLength)throw TypeError("invalid indefinite form length");i++}let r=t+i+2;return{byteLength:r,contents:e.subarray(t,t+i),raw:e.subarray(0,r)}}else{let r=127&e[t];t++,i=0;for(let n=0;n<r;n++)i=256*i+e[t],t++}let n=t+i;return{byteLength:n,contents:e.subarray(t,n),raw:e.subarray(0,n)}}let eV=async e=>{var t,r;if(!e.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:i,keyUsages:n}=function(e){let t,r;switch(e.kty){case"oct":switch(e.alg){case"HS256":case"HS384":case"HS512":t={name:"HMAC",hash:`SHA-${e.alg.slice(-3)}`},r=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":throw new G.JOSENotSupported(`${e.alg} keys cannot be imported as CryptoKey instances`);case"A128GCM":case"A192GCM":case"A256GCM":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":t={name:"AES-GCM"},r=["encrypt","decrypt"];break;case"A128KW":case"A192KW":case"A256KW":t={name:"AES-KW"},r=["wrapKey","unwrapKey"];break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":t={name:"PBKDF2"},r=["deriveBits"];break;default:throw new G.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new G.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new G.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(e.alg){case"EdDSA":t={name:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new G.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new G.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}(e),s=[i,null!=(t=e.ext)&&t,null!=(r=e.key_ops)?r:n];if("PBKDF2"===i.name)return ee.default.subtle.importKey("raw",(0,Q.decode)(e.k),...s);let a={...e};return delete a.alg,delete a.use,ee.default.subtle.importKey("jwk",a,...s)};async function eJ(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return ez(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,"spki",e,t,r)}async function eZ(e,t,r){let i;if("string"!=typeof e||0!==e.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');try{let t,r;r=e.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,""),i=eW((t=e$(e$(eK((0,Q.decodeBase64)(r)).contents)[0].contents),(0,Q.encodeBase64)(t[160===t[0].raw[0]?6:5].raw)),"PUBLIC KEY")}catch(e){throw TypeError("Failed to parse the X.509 certificate",{cause:e})}return ez(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,"spki",i,t,r)}async function eG(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return ez(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,"pkcs8",e,t,r)}async function eY(e,t,r){var i;if(!(0,eE.default)(e))throw TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=r||(r=!0!==e.ext),r)return eV({...e,alg:t,ext:null!=(i=e.ext)&&i});return(0,Q.decode)(e.k);case"RSA":if(void 0!==e.oth)throw new G.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return eV({...e,alg:t});default:throw new G.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}let eQ=(e,t,r)=>{if(e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)){if(!(t instanceof Uint8Array)){if(!ef(t))throw TypeError(ep(e,t,...ey,"Uint8Array"));if("secret"!==t.type)throw TypeError(`${ey.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}}else{if(!ef(t))throw TypeError(ep(e,t,...ey));if("secret"===t.type)throw TypeError(`${ey.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${ey.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${ey.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${ey.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${ey.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)}};async function eX(e,t,r,i,n){if(!(r instanceof Uint8Array))throw TypeError(eh(r,"Uint8Array"));let s=parseInt(e.slice(1,4),10),a=await ee.default.subtle.importKey("raw",r.subarray(s>>3),"AES-CBC",!1,["encrypt"]),o=await ee.default.subtle.importKey("raw",r.subarray(0,s>>3),{hash:`SHA-${s<<1}`,name:"HMAC"},!1,["sign"]),l=new Uint8Array(await ee.default.subtle.encrypt({iv:i,name:"AES-CBC"},a,t)),c=(0,X.concat)(n,i,l,(0,X.uint64be)(n.length<<3));return{ciphertext:l,tag:new Uint8Array((await ee.default.subtle.sign("HMAC",o,c)).slice(0,s>>3))}}async function e0(e,t,r,i,n){let s;r instanceof Uint8Array?s=await ee.default.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):(ed(r,e,"encrypt"),s=r);let a=new Uint8Array(await ee.default.subtle.encrypt({additionalData:n,iv:i,name:"AES-GCM",tagLength:128},s,t)),o=a.slice(-16);return{ciphertext:a.slice(0,-16),tag:o}}let e1=async(e,t,r,i,n)=>{if(!(0,ee.isCryptoKey)(r)&&!(r instanceof Uint8Array))throw TypeError(eh(r,...ey,"Uint8Array"));switch(en(e,i),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&es(r,parseInt(e.slice(-3),10)),eX(e,t,r,i,n);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&es(r,parseInt(e.slice(1,4),10)),e0(e,t,r,i,n);default:throw new G.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}};async function e2(e,t,r,i){let n=e.slice(0,7);i||(i=ei(n));let{ciphertext:s,tag:a}=await e1(n,r,t,i,new Uint8Array(0));return{encryptedKey:s,iv:(0,Q.encode)(i),tag:(0,Q.encode)(a)}}async function e3(e,t,r,i,n){return ew(e.slice(0,7),t,r,i,n,new Uint8Array(0))}async function e5(e,t,r,i,n){switch(eQ(e,t,"decrypt"),e){case"dir":if(void 0!==r)throw new G.JWEInvalid("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new G.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let n,s;if(!(0,eE.default)(i.epk))throw new G.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!eP(t))throw new G.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let a=await eY(i.epk,e);if(void 0!==i.apu){if("string"!=typeof i.apu)throw new G.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{n=(0,Q.decode)(i.apu)}catch(e){throw new G.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==i.apv){if("string"!=typeof i.apv)throw new G.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{s=(0,Q.decode)(i.apv)}catch(e){throw new G.JWEInvalid("Failed to base64url decode the apv")}}let o=await ex(a,t,"ECDH-ES"===e?i.enc:e,"ECDH-ES"===e?eL(i.enc):parseInt(e.slice(-5,-2),10),n,s);if("ECDH-ES"===e)return o;if(void 0===r)throw new G.JWEInvalid("JWE Encrypted Key missing");return eT(e.slice(-6),o,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new G.JWEInvalid("JWE Encrypted Key missing");return ej(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let s;if(void 0===r)throw new G.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof i.p2c)throw new G.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let a=(null==n?void 0:n.maxPBES2Count)||1e4;if(i.p2c>a)throw new G.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof i.p2s)throw new G.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{s=(0,Q.decode)(i.p2s)}catch(e){throw new G.JWEInvalid("Failed to base64url decode the p2s")}return eN(e,t,r,i.p2c,s)}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new G.JWEInvalid("JWE Encrypted Key missing");return eT(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let n,s;if(void 0===r)throw new G.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof i.iv)throw new G.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof i.tag)throw new G.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{n=(0,Q.decode)(i.iv)}catch(e){throw new G.JWEInvalid("Failed to base64url decode the iv")}try{s=(0,Q.decode)(i.tag)}catch(e){throw new G.JWEInvalid("Failed to base64url decode the tag")}return e3(e,t,r,n,s)}default:throw new G.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}let e8=function(e,t,r,i,n){let s;if(void 0!==n.crit&&void 0===i.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!i||void 0===i.crit)return new Set;if(!Array.isArray(i.crit)||0===i.crit.length||i.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let a of(s=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,i.crit)){if(!s.has(a))throw new G.JOSENotSupported(`Extension Header Parameter "${a}" is not recognized`);if(void 0===n[a])throw new e(`Extension Header Parameter "${a}" is missing`);if(s.get(a)&&void 0===i[a])throw new e(`Extension Header Parameter "${a}" MUST be integrity protected`)}return new Set(i.crit)},e6=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function e4(e,t,r){var i;let n,s,a,o,l,c,d;if(!(0,eE.default)(e))throw new G.JWEInvalid("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new G.JWEInvalid("JOSE Header missing");if("string"!=typeof e.iv)throw new G.JWEInvalid("JWE Initialization Vector missing or incorrect type");if("string"!=typeof e.ciphertext)throw new G.JWEInvalid("JWE Ciphertext missing or incorrect type");if("string"!=typeof e.tag)throw new G.JWEInvalid("JWE Authentication Tag missing or incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new G.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new G.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new G.JWEInvalid("JWE AAD incorrect type");if(void 0!==e.header&&!(0,eE.default)(e.header))throw new G.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!(0,eE.default)(e.unprotected))throw new G.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=(0,Q.decode)(e.protected);n=JSON.parse(X.decoder.decode(t))}catch(e){throw new G.JWEInvalid("JWE Protected Header is invalid")}if(!e_(n,e.header,e.unprotected))throw new G.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let u={...n,...e.header,...e.unprotected};if(e8(G.JWEInvalid,new Map,null==r?void 0:r.crit,n,u),void 0!==u.zip){if(!n||!n.zip)throw new G.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==u.zip)throw new G.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:h,enc:p}=u;if("string"!=typeof h||!h)throw new G.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof p||!p)throw new G.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let f=r&&e6("keyManagementAlgorithms",r.keyManagementAlgorithms),y=r&&e6("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(f&&!f.has(h))throw new G.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(y&&!y.has(p))throw new G.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==e.encrypted_key)try{s=(0,Q.decode)(e.encrypted_key)}catch(e){throw new G.JWEInvalid("Failed to base64url decode the encrypted_key")}let g=!1;"function"==typeof t&&(t=await t(n,e),g=!0);try{a=await e5(h,t,s,u,r)}catch(e){if(e instanceof TypeError||e instanceof G.JWEInvalid||e instanceof G.JOSENotSupported)throw e;a=eB(p)}try{o=(0,Q.decode)(e.iv)}catch(e){throw new G.JWEInvalid("Failed to base64url decode the iv")}try{l=(0,Q.decode)(e.tag)}catch(e){throw new G.JWEInvalid("Failed to base64url decode the tag")}let m=X.encoder.encode(null!=(i=e.protected)?i:"");c=void 0!==e.aad?(0,X.concat)(m,X.encoder.encode("."),X.encoder.encode(e.aad)):m;try{d=(0,Q.decode)(e.ciphertext)}catch(e){throw new G.JWEInvalid("Failed to base64url decode the ciphertext")}let w=await ew(p,a,d,o,l,c);"DEF"===u.zip&&(w=await ((null==r?void 0:r.inflateRaw)||eb)(w));let b={plaintext:w};if(void 0!==e.protected&&(b.protectedHeader=n),void 0!==e.aad)try{b.additionalAuthenticatedData=(0,Q.decode)(e.aad)}catch(e){throw new G.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==e.unprotected&&(b.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(b.unprotectedHeader=e.header),g)?{...b,key:t}:b}async function e7(e,t,r){if(e instanceof Uint8Array&&(e=X.decoder.decode(e)),"string"!=typeof e)throw new G.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:i,1:n,2:s,3:a,4:o,length:l}=e.split(".");if(5!==l)throw new G.JWEInvalid("Invalid Compact JWE");let c=await e4({ciphertext:a,iv:s||void 0,protected:i||void 0,tag:o||void 0,encrypted_key:n||void 0},t,r),d={plaintext:c.plaintext,protectedHeader:c.protectedHeader};return"function"==typeof t?{...d,key:c.key}:d}async function e9(e,t,r){if(!(0,eE.default)(e))throw new G.JWEInvalid("General JWE must be an object");if(!Array.isArray(e.recipients)||!e.recipients.every(eE.default))throw new G.JWEInvalid("JWE Recipients missing or incorrect type");if(!e.recipients.length)throw new G.JWEInvalid("JWE Recipients has no members");for(let i of e.recipients)try{return await e4({aad:e.aad,ciphertext:e.ciphertext,encrypted_key:i.encrypted_key,header:i.header,iv:e.iv,protected:e.protected,tag:e.tag,unprotected:e.unprotected},t,r)}catch(e){}throw new G.JWEDecryptionFailed}let te=async e=>{if(e instanceof Uint8Array)return{kty:"oct",k:(0,Q.encode)(e)};if(!(0,ee.isCryptoKey)(e))throw TypeError(eh(e,...ey,"Uint8Array"));if(!e.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:t,key_ops:r,alg:i,use:n,...s}=await ee.default.subtle.exportKey("jwk",e);return s};async function tt(e){return eF("public","spki",e)}async function tr(e){return eF("private","pkcs8",e)}async function ti(e){return te(e)}async function tn(e,t,r,i,n={}){let s,a,o;switch(eQ(e,r,"encrypt"),e){case"dir":o=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!eP(r))throw new G.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:l,apv:c}=n,{epk:d}=n;d||(d=(await eC(r)).privateKey);let{x:u,y:h,crv:p,kty:f}=await ti(d),y=await ex(r,d,"ECDH-ES"===e?t:e,"ECDH-ES"===e?eL(t):parseInt(e.slice(-5,-2),10),l,c);if(a={epk:{x:u,crv:p,kty:f}},"EC"===f&&(a.epk.y=h),l&&(a.apu=(0,Q.encode)(l)),c&&(a.apv=(0,Q.encode)(c)),"ECDH-ES"===e){o=y;break}o=i||eB(t);let g=e.slice(-6);s=await ek(g,y,o);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":o=i||eB(t),s=await eD(e,r,o);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{o=i||eB(t);let{p2c:l,p2s:c}=n;({encryptedKey:s,...a}=await eR(e,r,o,l,c));break}case"A128KW":case"A192KW":case"A256KW":o=i||eB(t),s=await ek(e,r,o);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{o=i||eB(t);let{iv:l}=n;({encryptedKey:s,...a}=await e2(e,r,o,l));break}default:throw new G.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:o,encryptedKey:s,parameters:a}}let ts=Symbol();class ta{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=e}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}async encrypt(e,t){let r,i,n,s,a,o,l;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new G.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!e_(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new G.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let c={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if(e8(G.JWEInvalid,new Map,null==t?void 0:t.crit,this._protectedHeader,c),void 0!==c.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new G.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==c.zip)throw new G.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:d,enc:u}=c;if("string"!=typeof d||!d)throw new G.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof u||!u)throw new G.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===d){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===d&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let n;({cek:i,encryptedKey:r,parameters:n}=await tn(d,u,e,this._cek,this._keyManagementParameters)),n&&(t&&ts in t?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...n}:this.setUnprotectedHeader(n):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...n}:this.setProtectedHeader(n))}if(this._iv||(this._iv=ei(u)),s=this._protectedHeader?X.encoder.encode((0,Q.encode)(JSON.stringify(this._protectedHeader))):X.encoder.encode(""),this._aad?(a=(0,Q.encode)(this._aad),n=(0,X.concat)(s,X.encoder.encode("."),X.encoder.encode(a))):n=s,"DEF"===c.zip){let e=await ((null==t?void 0:t.deflateRaw)||ev)(this._plaintext);({ciphertext:o,tag:l}=await e1(u,e,i,this._iv,n))}else({ciphertext:o,tag:l}=await e1(u,this._plaintext,i,this._iv,n));let h={ciphertext:(0,Q.encode)(o),iv:(0,Q.encode)(this._iv),tag:(0,Q.encode)(l)};return r&&(h.encrypted_key=(0,Q.encode)(r)),a&&(h.aad=a),this._protectedHeader&&(h.protected=X.decoder.decode(s)),this._sharedUnprotectedHeader&&(h.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(h.header=this._unprotectedHeader),h}}class to{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addRecipient(...e){return this.parent.addRecipient(...e)}encrypt(...e){return this.parent.encrypt(...e)}done(){return this.parent}}class tl{constructor(e){this._recipients=[],this._plaintext=e}addRecipient(e,t){let r=new to(this,e,{crit:null==t?void 0:t.crit});return this._recipients.push(r),r}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}async encrypt(e){var t,r,i;let n;if(!this._recipients.length)throw new G.JWEInvalid("at least one recipient must be added");if(e={deflateRaw:null==e?void 0:e.deflateRaw},1===this._recipients.length){let[t]=this._recipients,r=await new ta(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(t.unprotectedHeader).encrypt(t.key,{...t.options,...e}),i={ciphertext:r.ciphertext,iv:r.iv,recipients:[{}],tag:r.tag};return r.aad&&(i.aad=r.aad),r.protected&&(i.protected=r.protected),r.unprotected&&(i.unprotected=r.unprotected),r.encrypted_key&&(i.recipients[0].encrypted_key=r.encrypted_key),r.header&&(i.recipients[0].header=r.header),i}for(let e=0;e<this._recipients.length;e++){let t=this._recipients[e];if(!e_(this._protectedHeader,this._unprotectedHeader,t.unprotectedHeader))throw new G.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let r={...this._protectedHeader,...this._unprotectedHeader,...t.unprotectedHeader},{alg:i}=r;if("string"!=typeof i||!i)throw new G.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===i||"ECDH-ES"===i)throw new G.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof r.enc||!r.enc)throw new G.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(n){if(n!==r.enc)throw new G.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else n=r.enc;if(e8(G.JWEInvalid,new Map,t.options.crit,this._protectedHeader,r),void 0!==r.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new G.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let s=eB(n),a={ciphertext:"",iv:"",recipients:[],tag:""};for(let o=0;o<this._recipients.length;o++){let l=this._recipients[o],c={};a.recipients.push(c);let d=({...this._protectedHeader,...this._unprotectedHeader,...l.unprotectedHeader}).alg.startsWith("PBES2")?2048+o:void 0;if(0===o){let t=await new ta(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(s).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(l.unprotectedHeader).setKeyManagementParameters({p2c:d}).encrypt(l.key,{...l.options,...e,[ts]:!0});a.ciphertext=t.ciphertext,a.iv=t.iv,a.tag=t.tag,t.aad&&(a.aad=t.aad),t.protected&&(a.protected=t.protected),t.unprotected&&(a.unprotected=t.unprotected),c.encrypted_key=t.encrypted_key,t.header&&(c.header=t.header);continue}let{encryptedKey:u,parameters:h}=await tn((null==(t=l.unprotectedHeader)?void 0:t.alg)||(null==(r=this._protectedHeader)?void 0:r.alg)||(null==(i=this._unprotectedHeader)?void 0:i.alg),n,l.key,s,{p2c:d});c.encrypted_key=(0,Q.encode)(u),(l.unprotectedHeader||h)&&(c.header={...l.unprotectedHeader,...h})}return a}}function tc(e,t){let r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"EdDSA":return{name:t.name};default:throw new G.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}function td(e,t,r){if((0,ee.isCryptoKey)(t))return!function(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!eo(e.algorithm,"HMAC"))throw ea("HMAC");let r=parseInt(t.slice(2),10);if(el(e.algorithm.hash)!==r)throw ea(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!eo(e.algorithm,"RSASSA-PKCS1-v1_5"))throw ea("RSASSA-PKCS1-v1_5");let r=parseInt(t.slice(2),10);if(el(e.algorithm.hash)!==r)throw ea(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!eo(e.algorithm,"RSA-PSS"))throw ea("RSA-PSS");let r=parseInt(t.slice(2),10);if(el(e.algorithm.hash)!==r)throw ea(`SHA-${r}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw ea("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!eo(e.algorithm,"ECDSA"))throw ea("ECDSA");let r=function(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(t);if(e.algorithm.namedCurve!==r)throw ea(r,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}ec(e,r)}(t,e,r),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw TypeError(eh(t,...ey));return ee.default.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}throw TypeError(eh(t,...ey,"Uint8Array"))}let tu=async(e,t,r,i)=>{let n=await td(e,t,"verify");eU(e,n);let s=tc(e,n.algorithm);try{return await ee.default.subtle.verify(s,n,r,i)}catch(e){return!1}};async function th(e,t,r){var i;let n,s;if(!(0,eE.default)(e))throw new G.JWSInvalid("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new G.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new G.JWSInvalid("JWS Protected Header incorrect type");if(void 0===e.payload)throw new G.JWSInvalid("JWS Payload missing");if("string"!=typeof e.signature)throw new G.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==e.header&&!(0,eE.default)(e.header))throw new G.JWSInvalid("JWS Unprotected Header incorrect type");let a={};if(e.protected)try{let t=(0,Q.decode)(e.protected);a=JSON.parse(X.decoder.decode(t))}catch(e){throw new G.JWSInvalid("JWS Protected Header is invalid")}if(!e_(a,e.header))throw new G.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let o={...a,...e.header},l=e8(G.JWSInvalid,new Map([["b64",!0]]),null==r?void 0:r.crit,a,o),c=!0;if(l.has("b64")&&"boolean"!=typeof(c=a.b64))throw new G.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:d}=o;if("string"!=typeof d||!d)throw new G.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let u=r&&e6("algorithms",r.algorithms);if(u&&!u.has(d))throw new G.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(c){if("string"!=typeof e.payload)throw new G.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new G.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let h=!1;"function"==typeof t&&(t=await t(a,e),h=!0),eQ(d,t,"verify");let p=(0,X.concat)(X.encoder.encode(null!=(i=e.protected)?i:""),X.encoder.encode("."),"string"==typeof e.payload?X.encoder.encode(e.payload):e.payload);try{n=(0,Q.decode)(e.signature)}catch(e){throw new G.JWSInvalid("Failed to base64url decode the signature")}if(!await tu(d,t,n,p))throw new G.JWSSignatureVerificationFailed;if(c)try{s=(0,Q.decode)(e.payload)}catch(e){throw new G.JWSInvalid("Failed to base64url decode the payload")}else s="string"==typeof e.payload?X.encoder.encode(e.payload):e.payload;let f={payload:s};return(void 0!==e.protected&&(f.protectedHeader=a),void 0!==e.header&&(f.unprotectedHeader=e.header),h)?{...f,key:t}:f}async function tp(e,t,r){if(e instanceof Uint8Array&&(e=X.decoder.decode(e)),"string"!=typeof e)throw new G.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:i,1:n,2:s,length:a}=e.split(".");if(3!==a)throw new G.JWSInvalid("Invalid Compact JWS");let o=await th({payload:n,protected:i,signature:s},t,r),l={payload:o.payload,protectedHeader:o.protectedHeader};return"function"==typeof t?{...l,key:o.key}:l}async function tf(e,t,r){if(!(0,eE.default)(e))throw new G.JWSInvalid("General JWS must be an object");if(!Array.isArray(e.signatures)||!e.signatures.every(eE.default))throw new G.JWSInvalid("JWS Signatures missing or incorrect type");for(let i of e.signatures)try{return await th({header:i.header,payload:e.payload,protected:i.protected,signature:i.signature},t,r)}catch(e){}throw new G.JWSSignatureVerificationFailed}let ty=e=>Math.floor(e.getTime()/1e3),tg=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,tm=e=>{let t=tg.exec(e);if(!t)throw TypeError("Invalid time period format");let r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*r);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*r);case"day":case"days":case"d":return Math.round(86400*r);case"week":case"weeks":case"w":return Math.round(604800*r);default:return Math.round(0x1e187e0*r)}},tw=e=>e.toLowerCase().replace(/^application\//,""),tb=(e,t,r={})=>{var i,n;let s,a,{typ:o}=r;if(o&&("string"!=typeof e.typ||tw(e.typ)!==tw(o)))throw new G.JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");try{s=JSON.parse(X.decoder.decode(t))}catch(e){}if(!(0,eE.default)(s))throw new G.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims:l=[],issuer:c,subject:d,audience:u,maxTokenAge:h}=r;for(let e of(void 0!==h&&l.push("iat"),void 0!==u&&l.push("aud"),void 0!==d&&l.push("sub"),void 0!==c&&l.push("iss"),new Set(l.reverse())))if(!(e in s))throw new G.JWTClaimValidationFailed(`missing required "${e}" claim`,e,"missing");if(c&&!(Array.isArray(c)?c:[c]).includes(s.iss))throw new G.JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(d&&s.sub!==d)throw new G.JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(u&&(i=s.aud,n="string"==typeof u?[u]:u,"string"==typeof i?!n.includes(i):!(Array.isArray(i)&&n.some(Set.prototype.has.bind(new Set(i))))))throw new G.JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");switch(typeof r.clockTolerance){case"string":a=tm(r.clockTolerance);break;case"number":a=r.clockTolerance;break;case"undefined":a=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:p}=r,f=ty(p||new Date);if((void 0!==s.iat||h)&&"number"!=typeof s.iat)throw new G.JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(void 0!==s.nbf){if("number"!=typeof s.nbf)throw new G.JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(s.nbf>f+a)throw new G.JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==s.exp){if("number"!=typeof s.exp)throw new G.JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(s.exp<=f-a)throw new G.JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(h){let e=f-s.iat;if(e-a>("number"==typeof h?h:tm(h)))throw new G.JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(e<0-a)throw new G.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return s};async function tv(e,t,r){var i;let n=await tp(e,t,r);if((null==(i=n.protectedHeader.crit)?void 0:i.includes("b64"))&&!1===n.protectedHeader.b64)throw new G.JWTInvalid("JWTs MUST NOT use unencoded payload");let s={payload:tb(n.protectedHeader,n.payload,r),protectedHeader:n.protectedHeader};return"function"==typeof t?{...s,key:n.key}:s}async function t_(e,t,r){let i=await e7(e,t,r),n=tb(i.protectedHeader,i.plaintext,r),{protectedHeader:s}=i;if(void 0!==s.iss&&s.iss!==n.iss)throw new G.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==s.sub&&s.sub!==n.sub)throw new G.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==s.aud&&JSON.stringify(s.aud)!==JSON.stringify(n.aud))throw new G.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',"aud","mismatch");let a={payload:n,protectedHeader:s};return"function"==typeof t?{...a,key:i.key}:a}class tE{constructor(e){this._flattened=new ta(e)}setContentEncryptionKey(e){return this._flattened.setContentEncryptionKey(e),this}setInitializationVector(e){return this._flattened.setInitializationVector(e),this}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}setKeyManagementParameters(e){return this._flattened.setKeyManagementParameters(e),this}async encrypt(e,t){let r=await this._flattened.encrypt(e,t);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}}let tA=async(e,t,r)=>{let i=await td(e,t,"sign");return eU(e,i),new Uint8Array(await ee.default.subtle.sign(tc(e,i.algorithm),i,r))};class tS{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){let r;if(!this._protectedHeader&&!this._unprotectedHeader)throw new G.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!e_(this._protectedHeader,this._unprotectedHeader))throw new G.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let i={...this._protectedHeader,...this._unprotectedHeader},n=e8(G.JWSInvalid,new Map([["b64",!0]]),null==t?void 0:t.crit,this._protectedHeader,i),s=!0;if(n.has("b64")&&"boolean"!=typeof(s=this._protectedHeader.b64))throw new G.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:a}=i;if("string"!=typeof a||!a)throw new G.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');eQ(a,e,"sign");let o=this._payload;s&&(o=X.encoder.encode((0,Q.encode)(o))),r=this._protectedHeader?X.encoder.encode((0,Q.encode)(JSON.stringify(this._protectedHeader))):X.encoder.encode("");let l=(0,X.concat)(r,X.encoder.encode("."),o),c=await tA(a,e,l),d={signature:(0,Q.encode)(c),payload:""};return s&&(d.payload=X.decoder.decode(o)),this._unprotectedHeader&&(d.header=this._unprotectedHeader),this._protectedHeader&&(d.protected=X.decoder.decode(r)),d}}class tI{constructor(e){this._flattened=new tS(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){let r=await this._flattened.sign(e,t);if(void 0===r.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}class tk{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setProtectedHeader(e){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=e,this}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addSignature(...e){return this.parent.addSignature(...e)}sign(...e){return this.parent.sign(...e)}done(){return this.parent}}class tT{constructor(e){this._signatures=[],this._payload=e}addSignature(e,t){let r=new tk(this,e,t);return this._signatures.push(r),r}async sign(){if(!this._signatures.length)throw new G.JWSInvalid("at least one signature must be added");let e={signatures:[],payload:""};for(let t=0;t<this._signatures.length;t++){let r=this._signatures[t],i=new tS(this._payload);i.setProtectedHeader(r.protectedHeader),i.setUnprotectedHeader(r.unprotectedHeader);let{payload:n,...s}=await i.sign(r.key,r.options);if(0===t)e.payload=n;else if(e.payload!==n)throw new G.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");e.signatures.push(s)}return e}}class tx{constructor(e){if(!(0,eE.default)(e))throw TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:e}:this._payload={...this._payload,nbf:ty(new Date)+tm(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:e}:this._payload={...this._payload,exp:ty(new Date)+tm(e)},this}setIssuedAt(e){return void 0===e?this._payload={...this._payload,iat:ty(new Date)}:this._payload={...this._payload,iat:e},this}}class tC extends tx{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){var r;let i=new tI(X.encoder.encode(JSON.stringify(this._payload)));if(i.setProtectedHeader(this._protectedHeader),Array.isArray(null==(r=this._protectedHeader)?void 0:r.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new G.JWTInvalid("JWTs MUST NOT use unencoded payload");return i.sign(e,t)}}class tP extends tx{setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(e,t){let r=new tE(X.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),r.setProtectedHeader(this._protectedHeader),this._iv&&r.setInitializationVector(this._iv),this._cek&&r.setContentEncryptionKey(this._cek),this._keyManagementParameters&&r.setKeyManagementParameters(this._keyManagementParameters),r.encrypt(e,t)}}var tO=e.i(797481);let tR=(e,t)=>{if("string"!=typeof e||!e)throw new G.JWKInvalid(`${t} missing or invalid`)};async function tN(e,t){let r;if(!(0,eE.default)(e))throw TypeError("JWK must be an object");if(null!=t||(t="sha256"),"sha256"!==t&&"sha384"!==t&&"sha512"!==t)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(e.kty){case"EC":tR(e.crv,'"crv" (Curve) Parameter'),tR(e.x,'"x" (X Coordinate) Parameter'),tR(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":tR(e.crv,'"crv" (Subtype of Key Pair) Parameter'),tR(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":tR(e.e,'"e" (Exponent) Parameter'),tR(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":tR(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new G.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let i=X.encoder.encode(JSON.stringify(r));return(0,Q.encode)(await (0,tO.default)(t,i))}async function tM(e,t){null!=t||(t="sha256");let r=await tN(e,t);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${t.slice(-3)}:${r}`}async function tU(e,t){let r={...e,...null==t?void 0:t.header};if(!(0,eE.default)(r.jwk))throw new G.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let i=await eY({...r.jwk,ext:!0},r.alg,!0);if(i instanceof Uint8Array||"public"!==i.type)throw new G.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return i}function tD(e){return e&&"object"==typeof e&&Array.isArray(e.keys)&&e.keys.every(tj)}function tj(e){return(0,eE.default)(e)}class tL{constructor(e){if(this._cached=new WeakMap,!tD(e))throw new G.JWKSInvalid("JSON Web Key Set malformed");this._jwks=function(e){return"function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}(e)}async getKey(e,t){let{alg:r,kid:i}={...e,...null==t?void 0:t.header},n=function(e){switch("string"==typeof e&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new G.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}(r),s=this._jwks.keys.filter(e=>{let t=n===e.kty;if(t&&"string"==typeof i&&(t=i===e.kid),t&&"string"==typeof e.alg&&(t=r===e.alg),t&&"string"==typeof e.use&&(t="sig"===e.use),t&&Array.isArray(e.key_ops)&&(t=e.key_ops.includes("verify")),t&&"EdDSA"===r&&(t="Ed25519"===e.crv||"Ed448"===e.crv),t)switch(r){case"ES256":t="P-256"===e.crv;break;case"ES256K":t="secp256k1"===e.crv;break;case"ES384":t="P-384"===e.crv;break;case"ES512":t="P-521"===e.crv}return t}),{0:a,length:o}=s;if(0===o)throw new G.JWKSNoMatchingKey;if(1!==o){let e=new G.JWKSMultipleMatchingKeys,{_cached:t}=this;throw e[Symbol.asyncIterator]=async function*(){for(let e of s)try{yield await tB(t,e,r)}catch(e){continue}},e}return tB(this._cached,a,r)}}async function tB(e,t,r){let i=e.get(t)||e.set(t,{}).get(t);if(void 0===i[r]){let e=await eY({...t,ext:!0},r);if(e instanceof Uint8Array||"public"!==e.type)throw new G.JWKSInvalid("JSON Web Key Set members must be public keys");i[r]=e}return i[r]}function tW(e){let t=new tL(e);return async function(e,r){return t.getKey(e,r)}}let tF=async(e,t,r)=>{let i,n,s=!1;"function"==typeof AbortController&&(i=new AbortController,n=setTimeout(()=>{s=!0,i.abort()},t));let a=await fetch(e.href,{signal:i?i.signal:void 0,redirect:"manual",headers:r.headers}).catch(e=>{if(s)throw new G.JWKSTimeout;throw e});if(void 0!==n&&clearTimeout(n),200!==a.status)throw new G.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await a.json()}catch(e){throw new G.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}};class tH extends tL{constructor(e,t){if(super({keys:[]}),this._jwks=void 0,!(e instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(e.href),this._options={agent:null==t?void 0:t.agent,headers:null==t?void 0:t.headers},this._timeoutDuration="number"==typeof(null==t?void 0:t.timeoutDuration)?null==t?void 0:t.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==t?void 0:t.cooldownDuration)?null==t?void 0:t.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==t?void 0:t.cacheMaxAge)?null==t?void 0:t.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(e,t){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(e,t)}catch(r){if(r instanceof G.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),super.getKey(e,t);throw r}}async reload(){this._pendingFetch&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=tF(this._url,this._timeoutDuration,this._options).then(e=>{if(!tD(e))throw new G.JWKSInvalid("JSON Web Key Set malformed");this._jwks={keys:e.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(e=>{throw this._pendingFetch=void 0,e})),await this._pendingFetch}}function tq(e,t){let r=new tH(e,t);return async function(e,t){return r.getKey(e,t)}}class tz extends tx{encode(){let e=Q.encode(JSON.stringify({alg:"none"})),t=Q.encode(JSON.stringify(this._payload));return`${e}.${t}.`}static decode(e,t){let r;if("string"!=typeof e)throw new G.JWTInvalid("Unsecured JWT must be a string");let{0:i,1:n,2:s,length:a}=e.split(".");if(3!==a||""!==s)throw new G.JWTInvalid("Invalid Unsecured JWT");try{if(r=JSON.parse(X.decoder.decode(Q.decode(i))),"none"!==r.alg)throw Error()}catch(e){throw new G.JWTInvalid("Invalid Unsecured JWT")}return{payload:tb(r,Q.decode(n),t),header:r}}}function t$(e){let t;if("string"==typeof e){let r=e.split(".");(3===r.length||5===r.length)&&([t]=r)}else if("object"==typeof e&&e)if("protected"in e)t=e.protected;else throw TypeError("Token does not contain a Protected Header");try{if("string"!=typeof t||!t)throw Error();let e=JSON.parse(X.decoder.decode((0,Y.decode)(t)));if(!(0,eE.default)(e))throw Error();return e}catch(e){throw TypeError("Invalid Token or Protected Header formatting")}}var tK=e.i(576951);async function tV(e,t){var r;let i,n,s;switch(e){case"HS256":case"HS384":case"HS512":i=parseInt(e.slice(-3),10),n={name:"HMAC",hash:`SHA-${i}`,length:i},s=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return et(new Uint8Array((i=parseInt(e.slice(-3),10))>>3));case"A128KW":case"A192KW":case"A256KW":n={name:"AES-KW",length:i=parseInt(e.slice(1,4),10)},s=["wrapKey","unwrapKey"];break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":n={name:"AES-GCM",length:i=parseInt(e.slice(1,4),10)},s=["encrypt","decrypt"];break;default:throw new G.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return ee.default.subtle.generateKey(n,null!=(r=null==t?void 0:t.extractable)&&r,s)}function tJ(e){var t;let r=null!=(t=null==e?void 0:e.modulusLength)?t:2048;if("number"!=typeof r||r<2048)throw new G.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return r}async function tZ(e,t){var r,i,n;let s,a;switch(e){case"PS256":case"PS384":case"PS512":s={name:"RSA-PSS",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:tJ(t)},a=["sign","verify"];break;case"RS256":case"RS384":case"RS512":s={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:tJ(t)},a=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":s={name:"RSA-OAEP",hash:`SHA-${parseInt(e.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:tJ(t)},a=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":s={name:"ECDSA",namedCurve:"P-256"},a=["sign","verify"];break;case"ES384":s={name:"ECDSA",namedCurve:"P-384"},a=["sign","verify"];break;case"ES512":s={name:"ECDSA",namedCurve:"P-521"},a=["sign","verify"];break;case"EdDSA":a=["sign","verify"];let o=null!=(r=null==t?void 0:t.crv)?r:"Ed25519";switch(o){case"Ed25519":case"Ed448":s={name:o};break;default:throw new G.JOSENotSupported("Invalid or unsupported crv option provided")}break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{a=["deriveKey","deriveBits"];let e=null!=(i=null==t?void 0:t.crv)?i:"P-256";switch(e){case"P-256":case"P-384":case"P-521":s={name:"ECDH",namedCurve:e};break;case"X25519":case"X448":s={name:e};break;default:throw new G.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}break}default:throw new G.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return ee.default.subtle.generateKey(s,null!=(n=null==t?void 0:t.extractable)&&n,a)}async function tG(e,t){return tZ(e,t)}async function tY(e,t){return tV(e,t)}e.s(["CompactEncrypt",()=>tE,"CompactSign",()=>tI,"EmbeddedJWK",()=>tU,"EncryptJWT",()=>tP,"FlattenedEncrypt",()=>ta,"FlattenedSign",()=>tS,"GeneralEncrypt",()=>tl,"GeneralSign",()=>tT,"SignJWT",()=>tC,"UnsecuredJWT",()=>tz,"base64url",0,Y,"calculateJwkThumbprint",()=>tN,"calculateJwkThumbprintUri",()=>tM,"compactDecrypt",()=>e7,"compactVerify",()=>tp,"createLocalJWKSet",()=>tW,"createRemoteJWKSet",()=>tq,"cryptoRuntime",0,"WebCryptoAPI","decodeJwt",()=>tK.decodeJwt,"decodeProtectedHeader",()=>t$,"errors",0,G,"exportJWK",()=>ti,"exportPKCS8",()=>tr,"exportSPKI",()=>tt,"flattenedDecrypt",()=>e4,"flattenedVerify",()=>th,"generalDecrypt",()=>e9,"generalVerify",()=>tf,"generateKeyPair",()=>tG,"generateSecret",()=>tY,"importJWK",()=>eY,"importPKCS8",()=>eG,"importSPKI",()=>eJ,"importX509",()=>eZ,"jwtDecrypt",()=>t_,"jwtVerify",()=>tv],563703),e.i(563703);var tQ=e.i(199220),tX=e.i(814925),t0=e.i(595932),t1=e.i(48673),t2=e.i(193197),t3=e.i(515502),t5=e.i(547511);class t8{constructor(e,t){this.scope=e,this.module=t}storeObject(e,t){this.setItem(e,JSON.stringify(t))}loadObject(e){let t=this.getItem(e);return t?JSON.parse(t):void 0}setItem(e,t){localStorage.setItem(this.scopedKey(e),t)}getItem(e){return localStorage.getItem(this.scopedKey(e))}removeItem(e){localStorage.removeItem(this.scopedKey(e))}clear(){let e=this.scopedKey(""),t=[];for(let r=0;r<localStorage.length;r++){let i=localStorage.key(r);"string"==typeof i&&i.startsWith(e)&&t.push(i)}t.forEach(e=>localStorage.removeItem(e))}scopedKey(e){return`-${this.scope}${this.module?`:${this.module}`:""}:${e}`}static clearAll(){new t8("CBWSDK").clear(),new t8("walletlink").clear()}}var t6=e.i(467034);let t4=-32602,t7=-32603,t9=4001,re=4100,rt=4200,rr=4900,ri={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."},4902:{standard:"EIP-3085",message:"Unrecognized chain ID."}},rn="Unspecified error message.";function rs(e,t=rn){if(e&&Number.isInteger(e)){var r;let t=e.toString();if(ro(ri,t))return ri[t].message;if((r=e)>=-32099&&r<=-32e3)return"Unspecified server error."}return t}function ra(e){return e&&"object"==typeof e&&!Array.isArray(e)?Object.assign({},e):e}function ro(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function rl(e,t){return"object"==typeof e&&null!==e&&t in e&&"string"==typeof e[t]}let rc=e=>rg(t4,e),rd=e=>rg(t7,e),ru=e=>rm(t9,e),rh=e=>rm(re,e),rp=e=>rm(rt,e),rf=e=>rm(rr,e),ry=e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw Error("Ethereum Provider custom errors must provide single object argument.");let{code:t,message:r,data:i}=e;if(!r||"string"!=typeof r)throw Error('"message" must be a nonempty string');return new rv(t,r,i)};function rg(e,t){let[r,i]=rw(t);return new rb(e,r||rs(e),i)}function rm(e,t){let[r,i]=rw(t);return new rv(e,r||rs(e),i)}function rw(e){if(e){if("string"==typeof e)return[e];else if("object"==typeof e&&!Array.isArray(e)){let{message:t,data:r}=e;if(t&&"string"!=typeof t)throw Error("Must specify string message.");return[t||void 0,r]}}return[]}class rb extends Error{constructor(e,t,r){if(!Number.isInteger(e))throw Error('"code" must be an integer.');if(!t||"string"!=typeof t)throw Error('"message" must be a nonempty string.');super(t),this.code=e,void 0!==r&&(this.data=r)}}class rv extends rb{constructor(e,t,r){if(!function(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}(e))throw Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,r)}}function r_(e){return Math.floor(e)}let rE=/^[0-9]*$/,rA=/^[a-f0-9]*$/;function rS(e){return rI(crypto.getRandomValues(new Uint8Array(e)))}function rI(e){return[...e].map(e=>e.toString(16).padStart(2,"0")).join("")}function rk(e){return new Uint8Array(e.match(/.{1,2}/g).map(e=>Number.parseInt(e,16)))}function rT(e,t=!1){let r=e.toString("hex");return t?`0x${r}`:r}function rx(e){return rT(rj(e),!0)}function rC(e){return e.toString(10)}function rP(e){return`0x${BigInt(e).toString(16)}`}function rO(e){return e.startsWith("0x")||e.startsWith("0X")}function rR(e){return rO(e)?e.slice(2):e}function rN(e){return rO(e)?`0x${e.slice(2)}`:`0x${e}`}function rM(e){if("string"!=typeof e)return!1;let t=rR(e).toLowerCase();return rA.test(t)}function rU(e,t=!1){let r=function(e,t=!1){if("string"==typeof e){let r=rR(e).toLowerCase();if(rA.test(r))return t?`0x${r}`:r}throw rc(`"${String(e)}" is not a hexadecimal string`)}(e,!1);return r.length%2==1&&(r=`0${r}`),t?`0x${r}`:r}function rD(e){if("string"==typeof e){let t=rR(e).toLowerCase();if(rM(t)&&40===t.length)return rN(t)}throw rc(`Invalid Ethereum address: ${String(e)}`)}function rj(e){if(t6.Buffer.isBuffer(e))return e;if("string"==typeof e){if(rM(e)){let t=rU(e,!1);return t6.Buffer.from(t,"hex")}return t6.Buffer.from(e,"utf8")}throw rc(`Not binary data: ${String(e)}`)}function rL(e){if("number"==typeof e&&Number.isInteger(e))return r_(e);if("string"==typeof e){if(rE.test(e))return r_(Number(e));if(rM(e))return r_(Number(BigInt(rU(e,!0))))}throw rc(`Not an integer: ${String(e)}`)}function rB(e){if(null!==e&&("bigint"==typeof e||function(e){if(null==e||"function"!=typeof e.constructor)return!1;let{constructor:t}=e;return"function"==typeof t.config&&"number"==typeof t.EUCLID}(e)))return BigInt(e.toString(10));if("number"==typeof e)return BigInt(rL(e));if("string"==typeof e){if(rE.test(e))return BigInt(e);if(rM(e))return BigInt(rU(e,!0))}throw rc(`Not an integer: ${String(e)}`)}async function rW(){return crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"])}async function rF(e,t){return crypto.subtle.deriveKey({name:"ECDH",public:t},e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function rH(e,t){let r=crypto.getRandomValues(new Uint8Array(12)),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},e,new TextEncoder().encode(t));return{iv:r,cipherText:i}}async function rq(e,{iv:t,cipherText:r}){let i=await crypto.subtle.decrypt({name:"AES-GCM",iv:t},e,r);return new TextDecoder().decode(i)}function rz(e){switch(e){case"public":return"spki";case"private":return"pkcs8"}}async function r$(e,t){let r=rz(e);return rI(new Uint8Array(await crypto.subtle.exportKey(r,t)))}async function rK(e,t){let r=rz(e),i=rk(t).buffer;return await crypto.subtle.importKey(r,new Uint8Array(i),{name:"ECDH",namedCurve:"P-256"},!0,"private"===e?["deriveKey"]:[])}async function rV(e,t){return rH(t,JSON.stringify(e,(e,t)=>t instanceof Error?Object.assign(Object.assign({},t.code?{code:t.code}:{}),{message:t.message}):t))}async function rJ(e,t){return JSON.parse(await rq(t,e))}let rZ={storageKey:"ownPrivateKey",keyType:"private"},rG={storageKey:"ownPublicKey",keyType:"public"},rY={storageKey:"peerPublicKey",keyType:"public"};class rQ{constructor(){this.storage=new t8("CBWSDK","SCWKeyManager"),this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null}async getOwnPublicKey(){return await this.loadKeysIfNeeded(),this.ownPublicKey}async getSharedSecret(){return await this.loadKeysIfNeeded(),this.sharedSecret}async setPeerPublicKey(e){this.sharedSecret=null,this.peerPublicKey=e,await this.storeKey(rY,e),await this.loadKeysIfNeeded()}async clear(){this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null,this.storage.removeItem(rG.storageKey),this.storage.removeItem(rZ.storageKey),this.storage.removeItem(rY.storageKey)}async generateKeyPair(){let e=await rW();this.ownPrivateKey=e.privateKey,this.ownPublicKey=e.publicKey,await this.storeKey(rZ,e.privateKey),await this.storeKey(rG,e.publicKey)}async loadKeysIfNeeded(){null===this.ownPrivateKey&&(this.ownPrivateKey=await this.loadKey(rZ)),null===this.ownPublicKey&&(this.ownPublicKey=await this.loadKey(rG)),(null===this.ownPrivateKey||null===this.ownPublicKey)&&await this.generateKeyPair(),null===this.peerPublicKey&&(this.peerPublicKey=await this.loadKey(rY)),null===this.sharedSecret&&null!==this.ownPrivateKey&&null!==this.peerPublicKey&&(this.sharedSecret=await rF(this.ownPrivateKey,this.peerPublicKey))}async loadKey(e){let t=this.storage.getItem(e.storageKey);return t?rK(e.keyType,t):null}async storeKey(e,t){let r=await r$(e.keyType,t);this.storage.setItem(e.storageKey,r)}}let rX="4.3.2",r0="@coinbase/wallet-sdk";async function r1(e,t){let r=Object.assign(Object.assign({},e),{jsonrpc:"2.0",id:crypto.randomUUID()}),i=await window.fetch(t,{method:"POST",body:JSON.stringify(r),mode:"cors",headers:{"Content-Type":"application/json","X-Cbw-Sdk-Version":rX,"X-Cbw-Sdk-Platform":r0}}),{result:n,error:s}=await i.json();if(s)throw s;return n}let r2="accounts",r3="activeChain",r5="availableChains",r8="walletCapabilities";class r6{constructor(e){var t,r,i;this.metadata=e.metadata,this.communicator=e.communicator,this.callback=e.callback,this.keyManager=new rQ,this.storage=new t8("CBWSDK","SCWStateManager"),this.accounts=null!=(t=this.storage.loadObject(r2))?t:[],this.chain=this.storage.loadObject(r3)||{id:null!=(i=null==(r=e.metadata.appChainIds)?void 0:r[0])?i:1},this.handshake=this.handshake.bind(this),this.request=this.request.bind(this),this.createRequestMessage=this.createRequestMessage.bind(this),this.decryptResponseMessage=this.decryptResponseMessage.bind(this)}async handshake(e){var t,r,i,n;await (null==(r=(t=this.communicator).waitForPopupLoaded)?void 0:r.call(t));let s=await this.createRequestMessage({handshake:{method:e.method,params:Object.assign({},this.metadata,null!=(i=e.params)?i:{})}}),a=await this.communicator.postRequestAndWaitForResponse(s);if("failure"in a.content)throw a.content.failure;let o=await rK("public",a.sender);await this.keyManager.setPeerPublicKey(o);let l=(await this.decryptResponseMessage(a)).result;if("error"in l)throw l.error;if("eth_requestAccounts"===e.method){let e=l.value;this.accounts=e,this.storage.storeObject(r2,e),null==(n=this.callback)||n.call(this,"accountsChanged",e)}}async request(e){var t;if(0===this.accounts.length)if("wallet_sendCalls"===e.method)return this.sendRequestToPopup(e);else throw rh();switch(e.method){case"eth_requestAccounts":return null==(t=this.callback)||t.call(this,"connect",{chainId:rP(this.chain.id)}),this.accounts;case"eth_accounts":return this.accounts;case"eth_coinbase":return this.accounts[0];case"net_version":return this.chain.id;case"eth_chainId":return rP(this.chain.id);case"wallet_getCapabilities":return this.storage.loadObject(r8);case"wallet_switchEthereumChain":return this.handleSwitchChainRequest(e);case"eth_ecRecover":case"personal_sign":case"wallet_sign":case"personal_ecRecover":case"eth_signTransaction":case"eth_sendTransaction":case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":case"wallet_addEthereumChain":case"wallet_watchAsset":case"wallet_sendCalls":case"wallet_showCallsStatus":case"wallet_grantPermissions":return this.sendRequestToPopup(e);default:if(!this.chain.rpcUrl)throw rd("No RPC URL set for chain");return r1(e,this.chain.rpcUrl)}}async sendRequestToPopup(e){var t,r;await (null==(r=(t=this.communicator).waitForPopupLoaded)?void 0:r.call(t));let i=await this.sendEncryptedRequest(e),n=(await this.decryptResponseMessage(i)).result;if("error"in n)throw n.error;return n.value}async cleanup(){var e,t;this.storage.clear(),await this.keyManager.clear(),this.accounts=[],this.chain={id:null!=(t=null==(e=this.metadata.appChainIds)?void 0:e[0])?t:1}}async handleSwitchChainRequest(e){var t;let r=e.params;if(!r||!(null==(t=r[0])?void 0:t.chainId))throw rc();let i=rL(r[0].chainId);if(this.updateChain(i))return null;let n=await this.sendRequestToPopup(e);return null===n&&this.updateChain(i),n}async sendEncryptedRequest(e){let t=await this.keyManager.getSharedSecret();if(!t)throw rh("No valid session found, try requestAccounts before other methods");let r=await rV({action:e,chainId:this.chain.id},t),i=await this.createRequestMessage({encrypted:r});return this.communicator.postRequestAndWaitForResponse(i)}async createRequestMessage(e){let t=await r$("public",await this.keyManager.getOwnPublicKey());return{id:crypto.randomUUID(),sender:t,content:e,timestamp:new Date}}async decryptResponseMessage(e){var t,r;let i=e.content;if("failure"in i)throw i.failure;let n=await this.keyManager.getSharedSecret();if(!n)throw rh("Invalid session");let s=await rJ(i.encrypted,n),a=null==(t=s.data)?void 0:t.chains;if(a){let e=Object.entries(a).map(([e,t])=>({id:Number(e),rpcUrl:t}));this.storage.storeObject(r5,e),this.updateChain(this.chain.id,e)}let o=null==(r=s.data)?void 0:r.capabilities;return o&&this.storage.storeObject(r8,o),s}updateChain(e,t){var r;let i=null!=t?t:this.storage.loadObject(r5),n=null==i?void 0:i.find(t=>t.id===e);return!!n&&(n!==this.chain&&(this.chain=n,this.storage.storeObject(r3,n),null==(r=this.callback)||r.call(this,"chainChanged",rP(n.id))),!0)}}var r4=e.i(980423);let r7="Addresses";function r9(e){return void 0!==e.errorMessage}class ie{constructor(e){this.secret=e}async encrypt(e){let t=this.secret;if(64!==t.length)throw Error("secret must be 256 bits");let r=crypto.getRandomValues(new Uint8Array(12)),i=await crypto.subtle.importKey("raw",rk(t),{name:"aes-gcm"},!1,["encrypt","decrypt"]),n=new TextEncoder,s=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:r},i,n.encode(e)),a=s.slice(s.byteLength-16),o=s.slice(0,s.byteLength-16),l=new Uint8Array(a),c=new Uint8Array(o);return rI(new Uint8Array([...r,...l,...c]))}async decrypt(e){let t=this.secret;if(64!==t.length)throw Error("secret must be 256 bits");return new Promise((r,i)=>{!async function(){let n=await crypto.subtle.importKey("raw",rk(t),{name:"aes-gcm"},!1,["encrypt","decrypt"]),s=rk(e),a=s.slice(0,12),o=s.slice(12,28),l=new Uint8Array([...s.slice(28),...o]),c={name:"AES-GCM",iv:new Uint8Array(a)};try{let e=await window.crypto.subtle.decrypt(c,n,l),t=new TextDecoder;r(t.decode(e))}catch(e){i(e)}}()})}}class it{constructor(e,t,r){this.linkAPIUrl=e,this.sessionId=t;const i=`${t}:${r}`;this.auth=`Basic ${btoa(i)}`}async markUnseenEventsAsSeen(e){return Promise.all(e.map(e=>fetch(`${this.linkAPIUrl}/events/${e.eventId}/seen`,{method:"POST",headers:{Authorization:this.auth}}))).catch(e=>console.error("Unabled to mark event as failed:",e))}async fetchUnseenEvents(){var e;let t=await fetch(`${this.linkAPIUrl}/events?unseen=true`,{headers:{Authorization:this.auth}});if(t.ok){let{events:r,error:i}=await t.json();if(i)throw Error(`Check unseen events failed: ${i}`);let n=null!=(e=null==r?void 0:r.filter(e=>"Web3Response"===e.event).map(e=>({type:"Event",sessionId:this.sessionId,eventId:e.id,event:e.event,data:e.data})))?e:[];return this.markUnseenEventsAsSeen(n),n}throw Error(`Check unseen events failed: ${t.status}`)}}(ig=im||(im={}))[ig.DISCONNECTED=0]="DISCONNECTED",ig[ig.CONNECTING=1]="CONNECTING",ig[ig.CONNECTED=2]="CONNECTED";class ir{setConnectionStateListener(e){this.connectionStateListener=e}setIncomingDataListener(e){this.incomingDataListener=e}constructor(e,t=WebSocket){this.WebSocketClass=t,this.webSocket=null,this.pendingData=[],this.url=e.replace(/^http/,"ws")}async connect(){if(this.webSocket)throw Error("webSocket object is not null");return new Promise((e,t)=>{var r;let i;try{this.webSocket=i=new this.WebSocketClass(this.url)}catch(e){t(e);return}null==(r=this.connectionStateListener)||r.call(this,im.CONNECTING),i.onclose=e=>{var r;this.clearWebSocket(),t(Error(`websocket error ${e.code}: ${e.reason}`)),null==(r=this.connectionStateListener)||r.call(this,im.DISCONNECTED)},i.onopen=t=>{var r;e(),null==(r=this.connectionStateListener)||r.call(this,im.CONNECTED),this.pendingData.length>0&&([...this.pendingData].forEach(e=>this.sendData(e)),this.pendingData=[])},i.onmessage=e=>{var t,r;if("h"===e.data)null==(t=this.incomingDataListener)||t.call(this,{type:"Heartbeat"});else try{let t=JSON.parse(e.data);null==(r=this.incomingDataListener)||r.call(this,t)}catch(e){}}})}disconnect(){var e;let{webSocket:t}=this;if(t){this.clearWebSocket(),null==(e=this.connectionStateListener)||e.call(this,im.DISCONNECTED),this.connectionStateListener=void 0,this.incomingDataListener=void 0;try{t.close()}catch(e){}}}sendData(e){let{webSocket:t}=this;if(!t){this.pendingData.push(e),this.connect();return}t.send(e)}clearWebSocket(){let{webSocket:e}=this;e&&(this.webSocket=null,e.onclose=null,e.onerror=null,e.onmessage=null,e.onopen=null)}}class ii{constructor({session:e,linkAPIUrl:t,listener:r}){this.destroyed=!1,this.lastHeartbeatResponse=0,this.nextReqId=r_(1),this._connected=!1,this._linked=!1,this.shouldFetchUnseenEventsOnConnect=!1,this.requestResolutions=new Map,this.handleSessionMetadataUpdated=e=>{e&&new Map([["__destroyed",this.handleDestroyed],["EthereumAddress",this.handleAccountUpdated],["WalletUsername",this.handleWalletUsernameUpdated],["AppVersion",this.handleAppVersionUpdated],["ChainId",t=>e.JsonRpcUrl&&this.handleChainUpdated(t,e.JsonRpcUrl)]]).forEach((t,r)=>{let i=e[r];void 0!==i&&t(i)})},this.handleDestroyed=e=>{var t;"1"===e&&(null==(t=this.listener)||t.resetAndReload())},this.handleAccountUpdated=async e=>{var t;let r=await this.cipher.decrypt(e);null==(t=this.listener)||t.accountUpdated(r)},this.handleMetadataUpdated=async(e,t)=>{var r;let i=await this.cipher.decrypt(t);null==(r=this.listener)||r.metadataUpdated(e,i)},this.handleWalletUsernameUpdated=async e=>{this.handleMetadataUpdated("walletUsername",e)},this.handleAppVersionUpdated=async e=>{this.handleMetadataUpdated("AppVersion",e)},this.handleChainUpdated=async(e,t)=>{var r;let i=await this.cipher.decrypt(e),n=await this.cipher.decrypt(t);null==(r=this.listener)||r.chainUpdated(i,n)},this.session=e,this.cipher=new ie(e.secret),this.listener=r;const i=new ir(`${t}/rpc`,WebSocket);i.setConnectionStateListener(async e=>{let t=!1;switch(e){case im.DISCONNECTED:if(!this.destroyed){let e=async()=>{await new Promise(e=>setTimeout(e,5e3)),this.destroyed||i.connect().catch(()=>{e()})};e()}break;case im.CONNECTED:t=await this.handleConnected(),this.updateLastHeartbeat(),setInterval(()=>{this.heartbeat()},1e4),this.shouldFetchUnseenEventsOnConnect&&this.fetchUnseenEventsAPI();case im.CONNECTING:}this.connected!==t&&(this.connected=t)}),i.setIncomingDataListener(e=>{var t;switch(e.type){case"Heartbeat":this.updateLastHeartbeat();return;case"IsLinkedOK":case"Linked":{let t="IsLinkedOK"===e.type?e.linked:void 0;this.linked=t||e.onlineGuests>0;break}case"GetSessionConfigOK":case"SessionConfigUpdated":this.handleSessionMetadataUpdated(e.metadata);break;case"Event":this.handleIncomingEvent(e)}void 0!==e.id&&(null==(t=this.requestResolutions.get(e.id))||t(e))}),this.ws=i,this.http=new it(t,e.id,e.key)}connect(){if(this.destroyed)throw Error("instance is destroyed");this.ws.connect()}async destroy(){this.destroyed||(await this.makeRequest({type:"SetSessionConfig",id:r_(this.nextReqId++),sessionId:this.session.id,metadata:{__destroyed:"1"}},{timeout:1e3}),this.destroyed=!0,this.ws.disconnect(),this.listener=void 0)}get connected(){return this._connected}set connected(e){this._connected=e}get linked(){return this._linked}set linked(e){var t,r;this._linked=e,e&&(null==(t=this.onceLinked)||t.call(this)),null==(r=this.listener)||r.linkedUpdated(e)}setOnceLinked(e){return new Promise(t=>{this.linked?e().then(t):this.onceLinked=()=>{e().then(t),this.onceLinked=void 0}})}async handleIncomingEvent(e){var t;if("Event"!==e.type||"Web3Response"!==e.event)return;let r=JSON.parse(await this.cipher.decrypt(e.data));if("WEB3_RESPONSE"!==r.type)return;let{id:i,response:n}=r;null==(t=this.listener)||t.handleWeb3ResponseMessage(i,n)}async checkUnseenEvents(){if(!this.connected){this.shouldFetchUnseenEventsOnConnect=!0;return}await new Promise(e=>setTimeout(e,250));try{await this.fetchUnseenEventsAPI()}catch(e){console.error("Unable to check for unseen events",e)}}async fetchUnseenEventsAPI(){this.shouldFetchUnseenEventsOnConnect=!1,(await this.http.fetchUnseenEvents()).forEach(e=>this.handleIncomingEvent(e))}async publishEvent(e,t,r=!1){let i=await this.cipher.encrypt(JSON.stringify(Object.assign(Object.assign({},t),{origin:location.origin,location:location.href,relaySource:"coinbaseWalletExtension"in window&&window.coinbaseWalletExtension?"injected_sdk":"sdk"}))),n={type:"PublishEvent",id:r_(this.nextReqId++),sessionId:this.session.id,event:e,data:i,callWebhook:r};return this.setOnceLinked(async()=>{let e=await this.makeRequest(n);if("Fail"===e.type)throw Error(e.error||"failed to publish event");return e.eventId})}sendData(e){this.ws.sendData(JSON.stringify(e))}updateLastHeartbeat(){this.lastHeartbeatResponse=Date.now()}heartbeat(){if(Date.now()-this.lastHeartbeatResponse>2e4)return void this.ws.disconnect();try{this.ws.sendData("h")}catch(e){}}async makeRequest(e,t={timeout:6e4}){let r,i=e.id;return this.sendData(e),Promise.race([new Promise((e,n)=>{r=window.setTimeout(()=>{n(Error(`request ${i} timed out`))},t.timeout)}),new Promise(e=>{this.requestResolutions.set(i,t=>{clearTimeout(r),e(t),this.requestResolutions.delete(i)})})])}async handleConnected(){return"Fail"!==(await this.makeRequest({type:"HostSession",id:r_(this.nextReqId++),sessionId:this.session.id,sessionKey:this.session.key})).type&&(this.sendData({type:"IsLinked",id:r_(this.nextReqId++),sessionId:this.session.id}),this.sendData({type:"GetSessionConfig",id:r_(this.nextReqId++),sessionId:this.session.id}),!0)}}class is{constructor(){this._nextRequestId=0,this.callbacks=new Map}makeRequestId(){this._nextRequestId=(this._nextRequestId+1)%0x7fffffff;let e=this._nextRequestId,t=rN(e.toString(16));return this.callbacks.get(t)&&this.callbacks.delete(t),e}}var ia=e.i(280355),io=e.i(470525);let il="session:id",ic="session:secret",id="session:linked";class iu{constructor(e,t,r,i=!1){this.storage=e,this.id=t,this.secret=r,this.key=(0,io.bytesToHex)((0,ia.sha256)(`${t}, ${r} WalletLink`)),this._linked=!!i}static create(e){return new iu(e,rS(16),rS(32)).save()}static load(e){let t=e.getItem(il),r=e.getItem(id),i=e.getItem(ic);return t&&i?new iu(e,t,i,"1"===r):null}get linked(){return this._linked}set linked(e){this._linked=e,this.persistLinked()}save(){return this.storage.setItem(il,this.id),this.storage.setItem(ic,this.secret),this.persistLinked(),this}persistLinked(){this.storage.setItem(id,this._linked?"1":"0")}}function ih(){var e,t;return null!=(t=null==(e=null==window?void 0:window.matchMedia)?void 0:e.call(window,"(prefers-color-scheme: dark)").matches)&&t}function ip(){let e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode('@namespace svg "http://www.w3.org/2000/svg";.-cbwsdk-css-reset,.-cbwsdk-css-reset *{animation:none;animation-delay:0;animation-direction:normal;animation-duration:0;animation-fill-mode:none;animation-iteration-count:1;animation-name:none;animation-play-state:running;animation-timing-function:ease;backface-visibility:visible;background:0;background-attachment:scroll;background-clip:border-box;background-color:rgba(0,0,0,0);background-image:none;background-origin:padding-box;background-position:0 0;background-position-x:0;background-position-y:0;background-repeat:repeat;background-size:auto auto;border:0;border-style:none;border-width:medium;border-color:inherit;border-bottom:0;border-bottom-color:inherit;border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-style:none;border-bottom-width:medium;border-collapse:separate;border-image:none;border-left:0;border-left-color:inherit;border-left-style:none;border-left-width:medium;border-radius:0;border-right:0;border-right-color:inherit;border-right-style:none;border-right-width:medium;border-spacing:0;border-top:0;border-top-color:inherit;border-top-left-radius:0;border-top-right-radius:0;border-top-style:none;border-top-width:medium;box-shadow:none;box-sizing:border-box;caption-side:top;clear:none;clip:auto;color:inherit;columns:auto;column-count:auto;column-fill:balance;column-gap:normal;column-rule:medium none currentColor;column-rule-color:currentColor;column-rule-style:none;column-rule-width:none;column-span:1;column-width:auto;counter-increment:none;counter-reset:none;direction:ltr;empty-cells:show;float:none;font:normal;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:normal;height:auto;hyphens:none;letter-spacing:normal;line-height:normal;list-style:none;list-style-image:none;list-style-position:outside;list-style-type:disc;margin:0;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;opacity:1;orphans:0;outline:0;outline-color:invert;outline-style:none;outline-width:medium;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;perspective:none;perspective-origin:50% 50%;pointer-events:auto;position:static;quotes:"\\201C" "\\201D" "\\2018" "\\2019";tab-size:8;table-layout:auto;text-align:inherit;text-align-last:auto;text-decoration:none;text-decoration-color:inherit;text-decoration-line:none;text-decoration-style:solid;text-indent:0;text-shadow:none;text-transform:none;transform:none;transform-style:flat;transition:none;transition-delay:0s;transition-duration:0s;transition-property:none;transition-timing-function:ease;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:0;word-spacing:normal;z-index:auto}.-cbwsdk-css-reset strong{font-weight:bold}.-cbwsdk-css-reset *{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;line-height:1}.-cbwsdk-css-reset [class*=container]{margin:0;padding:0}.-cbwsdk-css-reset style{display:none}')),document.documentElement.appendChild(e)}function iy(){for(var e,t,r=0,i="";r<arguments.length;)(e=arguments[r++])&&(t=function e(t){var r,i,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t)if(Array.isArray(t))for(r=0;r<t.length;r++)t[r]&&(i=e(t[r]))&&(n&&(n+=" "),n+=i);else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}(e))&&(i&&(i+=" "),i+=t);return i}var ig,im,iw,ib,iv,i_,iE,iA,iS,iI,ik,iT,ix,iC={},iP=[],iO=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,iR=Array.isArray;function iN(e,t){for(var r in t)e[r]=t[r];return e}function iM(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function iU(e,t,r){var i,n,s,a={};for(s in t)"key"==s?i=t[s]:"ref"==s?n=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?iw.call(arguments,2):r),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===a[s]&&(a[s]=e.defaultProps[s]);return iD(e,a,i,n,null)}function iD(e,t,r,i,n){var s={type:e,props:t,key:r,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==n?++iv:n,__i:-1,__u:0};return null==n&&null!=ib.vnode&&ib.vnode(s),s}function ij(e){return e.children}function iL(e,t){this.props=e,this.context=t}function iB(e,t){if(null==t)return e.__?iB(e.__,e.__i+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?iB(e):null}function iW(e){(!e.__d&&(e.__d=!0)&&i_.push(e)&&!iF.__r++||iE!=ib.debounceRendering)&&((iE=ib.debounceRendering)||iA)(iF)}function iF(){for(var e,t,r,i,n,s,a=1;i_.length;)i_.length>a&&i_.sort(iS),e=i_.shift(),a=i_.length,e.__d&&(t=void 0,r=void 0,i=(r=e.__v).__e,n=[],s=[],e.__P&&((t=iN({},r)).__v=r.__v+1,ib.vnode&&ib.vnode(t),iK(e.__P,t,r,e.__n,e.__P.namespaceURI,32&r.__u?[i]:null,n,null==i?iB(r):i,!!(32&r.__u),s),t.__v=r.__v,t.__.__k[t.__i]=t,iJ(n,t,s),r.__e=r.__=null,t.__e!=i&&function e(t){var r,i;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,r=0;r<t.__k.length;r++)if(null!=(i=t.__k[r])&&null!=i.__e){t.__e=t.__c.base=i.__e;break}return e(t)}}(t)));iF.__r=0}function iH(e,t,r,i,n,s,a,o,l,c,d){var u,h,p,f,y,g,m,w=i&&i.__k||iP,b=t.length;for(l=function(e,t,r,i,n){var s,a,o,l,c,d=r.length,u=d,h=0;for(e.__k=Array(n),s=0;s<n;s++)null!=(a=t[s])&&"boolean"!=typeof a&&"function"!=typeof a?("string"==typeof a||"number"==typeof a||"bigint"==typeof a||a.constructor==String?a=e.__k[s]=iD(null,a,null,null,null):iR(a)?a=e.__k[s]=iD(ij,{children:a},null,null,null):null==a.constructor&&a.__b>0?a=e.__k[s]=iD(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):e.__k[s]=a,l=s+h,a.__=e,a.__b=e.__b+1,o=null,-1!=(c=a.__i=function(e,t,r,i){var n,s,a,o=e.key,l=e.type,c=t[r],d=null!=c&&0==(2&c.__u);if(null===c&&null==o||d&&o==c.key&&l==c.type)return r;if(i>+!!d){for(n=r-1,s=r+1;n>=0||s<t.length;)if(null!=(c=t[a=n>=0?n--:s++])&&0==(2&c.__u)&&o==c.key&&l==c.type)return a}return -1}(a,r,l,u))&&(u--,(o=r[c])&&(o.__u|=2)),null==o||null==o.__v?(-1==c&&(n>d?h--:n<d&&h++),"function"!=typeof a.type&&(a.__u|=4)):c!=l&&(c==l-1?h--:c==l+1?h++:(c>l?h--:h++,a.__u|=4))):e.__k[s]=null;if(u)for(s=0;s<d;s++)null!=(o=r[s])&&0==(2&o.__u)&&(o.__e==i&&(i=iB(o)),function e(t,r,i){var n,s;if(ib.unmount&&ib.unmount(t),(n=t.ref)&&(n.current&&n.current!=t.__e||iZ(n,null,r)),null!=(n=t.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(e){ib.__e(e,r)}n.base=n.__P=null}if(n=t.__k)for(s=0;s<n.length;s++)n[s]&&e(n[s],r,i||"function"!=typeof t.type);i||iM(t.__e),t.__c=t.__=t.__e=void 0}(o,o));return i}(r,t,w,l,b),u=0;u<b;u++)null!=(p=r.__k[u])&&(h=-1==p.__i?iC:w[p.__i]||iC,p.__i=u,g=iK(e,p,h,n,s,a,o,l,c,d),f=p.__e,p.ref&&h.ref!=p.ref&&(h.ref&&iZ(h.ref,null,p),d.push(p.ref,p.__c||f,p)),null==y&&null!=f&&(y=f),(m=!!(4&p.__u))||h.__k===p.__k?l=function e(t,r,i,n){var s,a;if("function"==typeof t.type){for(s=t.__k,a=0;s&&a<s.length;a++)s[a]&&(s[a].__=t,r=e(s[a],r,i,n));return r}t.__e!=r&&(n&&(r&&t.type&&!r.parentNode&&(r=iB(t)),i.insertBefore(t.__e,r||null)),r=t.__e);do r=r&&r.nextSibling;while(null!=r&&8==r.nodeType)return r}(p,l,e,m):"function"==typeof p.type&&void 0!==g?l=g:f&&(l=f.nextSibling),p.__u&=-7);return r.__e=y,l}function iq(e,t,r){"-"==t[0]?e.setProperty(t,null==r?"":r):e[t]=null==r?"":"number"!=typeof r||iO.test(t)?r:r+"px"}function iz(e,t,r,i,n){var s,a;e:if("style"==t)if("string"==typeof r)e.style.cssText=r;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)r&&t in r||iq(e.style,t,"");if(r)for(t in r)i&&r[t]==i[t]||iq(e.style,t,r[t])}else if("o"==t[0]&&"n"==t[1])s=t!=(t=t.replace(iI,"$1")),t=(a=t.toLowerCase())in e||"onFocusOut"==t||"onFocusIn"==t?a.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=r,r?i?r.u=i.u:(r.u=ik,e.addEventListener(t,s?ix:iT,s)):e.removeEventListener(t,s?ix:iT,s);else{if("http://www.w3.org/2000/svg"==n)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==r?"":r;break e}catch(e){}"function"==typeof r||(null==r||!1===r&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==r?"":r))}}function i$(e){return function(t){if(this.l){var r=this.l[t.type+e];if(null==t.t)t.t=ik++;else if(t.t<r.u)return;return r(ib.event?ib.event(t):t)}}}function iK(e,t,r,i,n,s,a,o,l,c){var d,u,h,p,f,y,g,m,w,b,v,_,E,A,S,I,k,T=t.type;if(null!=t.constructor)return null;128&r.__u&&(l=!!(32&r.__u),s=[o=t.__e=r.__e]),(d=ib.__b)&&d(t);e:if("function"==typeof T)try{if(m=t.props,w="prototype"in T&&T.prototype.render,b=(d=T.contextType)&&i[d.__c],v=d?b?b.props.value:d.__:i,r.__c?g=(u=t.__c=r.__c).__=u.__E:(w?t.__c=u=new T(m,v):(t.__c=u=new iL(m,v),u.constructor=T,u.render=iG),b&&b.sub(u),u.state||(u.state={}),u.__n=i,h=u.__d=!0,u.__h=[],u._sb=[]),w&&null==u.__s&&(u.__s=u.state),w&&null!=T.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=iN({},u.__s)),iN(u.__s,T.getDerivedStateFromProps(m,u.__s))),p=u.props,f=u.state,u.__v=t,h)w&&null==T.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),w&&null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(w&&null==T.getDerivedStateFromProps&&m!==p&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(m,v),t.__v==r.__v||!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(m,u.__s,v)){for(t.__v!=r.__v&&(u.props=m,u.state=u.__s,u.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.some(function(e){e&&(e.__=t)}),_=0;_<u._sb.length;_++)u.__h.push(u._sb[_]);u._sb=[],u.__h.length&&a.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(m,u.__s,v),w&&null!=u.componentDidUpdate&&u.__h.push(function(){u.componentDidUpdate(p,f,y)})}if(u.context=v,u.props=m,u.__P=e,u.__e=!1,E=ib.__r,A=0,w){for(u.state=u.__s,u.__d=!1,E&&E(t),d=u.render(u.props,u.state,u.context),S=0;S<u._sb.length;S++)u.__h.push(u._sb[S]);u._sb=[]}else do u.__d=!1,E&&E(t),d=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++A<25)u.state=u.__s,null!=u.getChildContext&&(i=iN(iN({},i),u.getChildContext())),w&&!h&&null!=u.getSnapshotBeforeUpdate&&(y=u.getSnapshotBeforeUpdate(p,f)),I=d,null!=d&&d.type===ij&&null==d.key&&(I=function e(t){return"object"!=typeof t||null==t||t.__b&&t.__b>0?t:iR(t)?t.map(e):iN({},t)}(d.props.children)),o=iH(e,iR(I)?I:[I],t,r,i,n,s,a,o,l,c),u.base=t.__e,t.__u&=-161,u.__h.length&&a.push(u),g&&(u.__E=u.__=null)}catch(e){if(t.__v=null,l||null!=s)if(e.then){for(t.__u|=l?160:128;o&&8==o.nodeType&&o.nextSibling;)o=o.nextSibling;s[s.indexOf(o)]=null,t.__e=o}else{for(k=s.length;k--;)iM(s[k]);iV(t)}else t.__e=r.__e,t.__k=r.__k,e.then||iV(t);ib.__e(e,t,r)}else null==s&&t.__v==r.__v?(t.__k=r.__k,t.__e=r.__e):o=t.__e=function(e,t,r,i,n,s,a,o,l){var c,d,u,h,p,f,y,g=r.props||iC,m=t.props,w=t.type;if("svg"==w?n="http://www.w3.org/2000/svg":"math"==w?n="http://www.w3.org/1998/Math/MathML":n||(n="http://www.w3.org/1999/xhtml"),null!=s){for(c=0;c<s.length;c++)if((p=s[c])&&"setAttribute"in p==!!w&&(w?p.localName==w:3==p.nodeType)){e=p,s[c]=null;break}}if(null==e){if(null==w)return document.createTextNode(m);e=document.createElementNS(n,w,m.is&&m),o&&(ib.__m&&ib.__m(t,s),o=!1),s=null}if(null==w)g===m||o&&e.data==m||(e.data=m);else{if(s=s&&iw.call(e.childNodes),!o&&null!=s)for(g={},c=0;c<e.attributes.length;c++)g[(p=e.attributes[c]).name]=p.value;for(c in g)if(p=g[c],"children"==c);else if("dangerouslySetInnerHTML"==c)u=p;else if(!(c in m)){if("value"==c&&"defaultValue"in m||"checked"==c&&"defaultChecked"in m)continue;iz(e,c,null,p,n)}for(c in m)p=m[c],"children"==c?h=p:"dangerouslySetInnerHTML"==c?d=p:"value"==c?f=p:"checked"==c?y=p:o&&"function"!=typeof p||g[c]===p||iz(e,c,p,g[c],n);if(d)o||u&&(d.__html==u.__html||d.__html==e.innerHTML)||(e.innerHTML=d.__html),t.__k=[];else if(u&&(e.innerHTML=""),iH("template"==t.type?e.content:e,iR(h)?h:[h],t,r,i,"foreignObject"==w?"http://www.w3.org/1999/xhtml":n,s,a,s?s[0]:r.__k&&iB(r,0),o,l),null!=s)for(c=s.length;c--;)iM(s[c]);o||(c="value","progress"==w&&null==f?e.removeAttribute("value"):null==f||f===e[c]&&("progress"!=w||f)&&("option"!=w||f==g[c])||iz(e,c,f,g[c],n),c="checked",null!=y&&y!=e[c]&&iz(e,c,y,g[c],n))}return e}(r.__e,t,r,i,n,s,a,l,c);return(d=ib.diffed)&&d(t),128&t.__u?void 0:o}function iV(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(iV)}function iJ(e,t,r){for(var i=0;i<r.length;i++)iZ(r[i],r[++i],r[++i]);ib.__c&&ib.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){ib.__e(e,t.__v)}})}function iZ(e,t,r){try{if("function"==typeof e){var i="function"==typeof e.__u;i&&e.__u(),i&&null==t||(e.__u=e(t))}else e.current=t}catch(e){ib.__e(e,r)}}function iG(e,t,r){return this.constructor(e,r)}function iY(e,t,r){var i,n,s,a;t==document&&(t=document.documentElement),ib.__&&ib.__(e,t),n=(i="function"==typeof r)?null:r&&r.__k||t.__k,s=[],a=[],iK(t,e=(!i&&r||t).__k=iU(ij,null,[e]),n||iC,iC,t.namespaceURI,!i&&r?[r]:n?null:t.firstChild?iw.call(t.childNodes):null,s,!i&&r?r:n?n.__e:t.firstChild,i,a),iJ(s,e,a)}iw=iP.slice,ib={__e:function(e,t,r,i){for(var n,s,a;t=t.__;)if((n=t.__c)&&!n.__)try{if((s=n.constructor)&&null!=s.getDerivedStateFromError&&(n.setState(s.getDerivedStateFromError(e)),a=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e,i||{}),a=n.__d),a)return n.__E=n}catch(t){e=t}throw e}},iv=0,iL.prototype.setState=function(e,t){var r;r=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=iN({},this.state),"function"==typeof e&&(e=e(iN({},r),this.props)),e&&iN(r,e),null!=e&&this.__v&&(t&&this._sb.push(t),iW(this))},iL.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),iW(this))},iL.prototype.render=ij,i_=[],iA="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,iS=function(e,t){return e.__v.__b-t.__v.__b},iF.__r=0,iI=/(PointerCapture)$|Capture$/i,ik=0,iT=i$(!1),ix=i$(!0);var iQ,iX,i0,i1,i2=0,i3=[],i5=ib,i8=i5.__b,i6=i5.__r,i4=i5.diffed,i7=i5.__c,i9=i5.unmount,ne=i5.__;function nt(e,t){i5.__h&&i5.__h(iX,e,i2||t),i2=0;var r=iX.__H||(iX.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function nr(e,t,r){var i=nt(iQ++,2);if(i.t=e,!i.__c&&(i.__=[r?r(t):no(void 0,t),function(e){var t=i.__N?i.__N[0]:i.__[0],r=i.t(t,e);t!==r&&(i.__N=[r,i.__[1]],i.__c.setState({}))}],i.__c=iX,!iX.__f)){var n=function(e,t,r){if(!i.__c.__H)return!0;var n=i.__c.__H.__.filter(function(e){return!!e.__c});if(n.every(function(e){return!e.__N}))return!s||s.call(this,e,t,r);var a=i.__c.props!==e;return n.forEach(function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(a=!0)}}),s&&s.call(this,e,t,r)||a};iX.__f=!0;var s=iX.shouldComponentUpdate,a=iX.componentWillUpdate;iX.componentWillUpdate=function(e,t,r){if(this.__e){var i=s;s=void 0,n(e,t,r),s=i}a&&a.call(this,e,t,r)},iX.shouldComponentUpdate=n}return i.__N||i.__}function ni(){for(var e;e=i3.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(ns),e.__H.__h.forEach(na),e.__H.__h=[]}catch(t){e.__H.__h=[],i5.__e(t,e.__v)}}i5.__b=function(e){iX=null,i8&&i8(e)},i5.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),ne&&ne(e,t)},i5.__r=function(e){i6&&i6(e),iQ=0;var t=(iX=e.__c).__H;t&&(i0===iX?(t.__h=[],iX.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(ns),t.__h.forEach(na),t.__h=[],iQ=0)),i0=iX},i5.diffed=function(e){i4&&i4(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==i3.push(t)&&i1===i5.requestAnimationFrame||((i1=i5.requestAnimationFrame)||function(e){var t,r=function(){clearTimeout(i),nn&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(r,35);nn&&(t=requestAnimationFrame(r))})(ni)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),i0=iX=null},i5.__c=function(e,t){t.some(function(e){try{e.__h.forEach(ns),e.__h=e.__h.filter(function(e){return!e.__||na(e)})}catch(r){t.some(function(e){e.__h&&(e.__h=[])}),t=[],i5.__e(r,e.__v)}}),i7&&i7(e,t)},i5.unmount=function(e){i9&&i9(e);var t,r=e.__c;r&&r.__H&&(r.__H.__.forEach(function(e){try{ns(e)}catch(e){t=e}}),r.__H=void 0,t&&i5.__e(t,r.__v))};var nn="function"==typeof requestAnimationFrame;function ns(e){var t=iX,r=e.__c;"function"==typeof r&&(e.__c=void 0,r()),iX=t}function na(e){var t=iX;e.__c=e.__(),iX=t}function no(e,t){return"function"==typeof t?t(e):t}class nl{constructor(){this.items=new Map,this.nextItemKey=0,this.root=null,this.darkMode=ih()}attach(e){this.root=document.createElement("div"),this.root.className="-cbwsdk-snackbar-root",e.appendChild(this.root),this.render()}presentItem(e){let t=this.nextItemKey++;return this.items.set(t,e),this.render(),()=>{this.items.delete(t),this.render()}}clear(){this.items.clear(),this.render()}render(){this.root&&iY(iU("div",null,iU(nc,{darkMode:this.darkMode},Array.from(this.items.entries()).map(([e,t])=>iU(nd,Object.assign({},t,{key:e}))))),this.root)}}let nc=e=>iU("div",{class:iy("-cbwsdk-snackbar-container")},iU("style",null,".-cbwsdk-css-reset .-gear-container{margin-left:16px !important;margin-right:9px !important;display:flex;align-items:center;justify-content:center;width:24px;height:24px;transition:opacity .25s}.-cbwsdk-css-reset .-gear-container *{user-select:none}.-cbwsdk-css-reset .-gear-container svg{opacity:0;position:absolute}.-cbwsdk-css-reset .-gear-icon{height:12px;width:12px;z-index:10000}.-cbwsdk-css-reset .-cbwsdk-snackbar{align-items:flex-end;display:flex;flex-direction:column;position:fixed;right:0;top:0;z-index:2147483647}.-cbwsdk-css-reset .-cbwsdk-snackbar *{user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance{display:flex;flex-direction:column;margin:8px 16px 0 16px;overflow:visible;text-align:left;transform:translateX(0);transition:opacity .25s,transform .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header:hover .-gear-container svg{opacity:1}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header{display:flex;align-items:center;background:#fff;overflow:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-cblogo{margin:8px 8px 8px 8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-message{color:#000;font-size:13px;line-height:1.5;user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu{background:#fff;transition:opacity .25s ease-in-out,transform .25s linear,visibility 0s;visibility:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;opacity:0;flex-direction:column;padding-left:8px;padding-right:8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:last-child{margin-bottom:8px !important}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover{background:#f5f7f8;border-radius:6px;transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover span{color:#050f19;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover svg path{fill:#000;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item{visibility:inherit;height:35px;margin-top:8px;margin-bottom:0;display:flex;flex-direction:row;align-items:center;padding:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item *{visibility:inherit;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover{background:rgba(223,95,103,.2);transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover svg path{fill:#df5f67;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover span{color:#df5f67;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-info{color:#aaa;font-size:13px;margin:0 8px 0 32px;position:absolute}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-hidden{opacity:0;text-align:left;transform:translateX(25%);transition:opacity .5s linear}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-expanded .-cbwsdk-snackbar-instance-menu{opacity:1;display:flex;transform:translateY(8px);visibility:visible}"),iU("div",{class:"-cbwsdk-snackbar"},e.children)),nd=({autoExpand:e,message:t,menuItems:r})=>{var i,n,s,a;let[o,l]=(i2=1,nr(no,!0)),[c,d]=(i2=1,nr(no,null!=e&&e));return i=()=>{let e=[window.setTimeout(()=>{l(!1)},1),window.setTimeout(()=>{d(!0)},1e4)];return()=>{e.forEach(window.clearTimeout)}},n=nt(iQ++,3),!i5.__s&&(s=n.__H,a=void 0,!s||s.length!==a.length||a.some(function(e,t){return e!==s[t]}))&&(n.__=i,n.u=void 0,iX.__H.__h.push(n)),iU("div",{class:iy("-cbwsdk-snackbar-instance",o&&"-cbwsdk-snackbar-instance-hidden",c&&"-cbwsdk-snackbar-instance-expanded")},iU("div",{class:"-cbwsdk-snackbar-instance-header",onClick:()=>{d(!c)}},iU("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEuNDkyIDEwLjQxOWE4LjkzIDguOTMgMCAwMTguOTMtOC45M2gxMS4xNjNhOC45MyA4LjkzIDAgMDE4LjkzIDguOTN2MTEuMTYzYTguOTMgOC45MyAwIDAxLTguOTMgOC45M0gxMC40MjJhOC45MyA4LjkzIDAgMDEtOC45My04LjkzVjEwLjQxOXoiIGZpbGw9IiMxNjUyRjAiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEwLjQxOSAwSDIxLjU4QzI3LjMzNSAwIDMyIDQuNjY1IDMyIDEwLjQxOVYyMS41OEMzMiAyNy4zMzUgMjcuMzM1IDMyIDIxLjU4MSAzMkgxMC40MkM0LjY2NSAzMiAwIDI3LjMzNSAwIDIxLjU4MVYxMC40MkMwIDQuNjY1IDQuNjY1IDAgMTAuNDE5IDB6bTAgMS40ODhhOC45MyA4LjkzIDAgMDAtOC45MyA4LjkzdjExLjE2M2E4LjkzIDguOTMgMCAwMDguOTMgOC45M0gyMS41OGE4LjkzIDguOTMgMCAwMDguOTMtOC45M1YxMC40MmE4LjkzIDguOTMgMCAwMC04LjkzLTguOTNIMTAuNDJ6IiBmaWxsPSIjZmZmIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNS45OTggMjYuMDQ5Yy01LjU0OSAwLTEwLjA0Ny00LjQ5OC0xMC4wNDctMTAuMDQ3IDAtNS41NDggNC40OTgtMTAuMDQ2IDEwLjA0Ny0xMC4wNDYgNS41NDggMCAxMC4wNDYgNC40OTggMTAuMDQ2IDEwLjA0NiAwIDUuNTQ5LTQuNDk4IDEwLjA0Ny0xMC4wNDYgMTAuMDQ3eiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik0xMi43NjIgMTQuMjU0YzAtLjgyMi42NjctMS40ODkgMS40ODktMS40ODloMy40OTdjLjgyMiAwIDEuNDg4LjY2NiAxLjQ4OCAxLjQ4OXYzLjQ5N2MwIC44MjItLjY2NiAxLjQ4OC0xLjQ4OCAxLjQ4OGgtMy40OTdhMS40ODggMS40ODggMCAwMS0xLjQ4OS0xLjQ4OHYtMy40OTh6IiBmaWxsPSIjMTY1MkYwIi8+PC9zdmc+",class:"-cbwsdk-snackbar-instance-header-cblogo"})," ",iU("div",{class:"-cbwsdk-snackbar-instance-header-message"},t),iU("div",{class:"-gear-container"},!c&&iU("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},iU("circle",{cx:"12",cy:"12",r:"12",fill:"#F5F7F8"})),iU("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDYuNzV2LTEuNWwtMS43Mi0uNTdjLS4wOC0uMjctLjE5LS41Mi0uMzItLjc3bC44MS0xLjYyLTEuMDYtMS4wNi0xLjYyLjgxYy0uMjQtLjEzLS41LS4yNC0uNzctLjMyTDYuNzUgMGgtMS41bC0uNTcgMS43MmMtLjI3LjA4LS41My4xOS0uNzcuMzJsLTEuNjItLjgxLTEuMDYgMS4wNi44MSAxLjYyYy0uMTMuMjQtLjI0LjUtLjMyLjc3TDAgNS4yNXYxLjVsMS43Mi41N2MuMDguMjcuMTkuNTMuMzIuNzdsLS44MSAxLjYyIDEuMDYgMS4wNiAxLjYyLS44MWMuMjQuMTMuNS4yMy43Ny4zMkw1LjI1IDEyaDEuNWwuNTctMS43MmMuMjctLjA4LjUyLS4xOS43Ny0uMzJsMS42Mi44MSAxLjA2LTEuMDYtLjgxLTEuNjJjLjEzLS4yNC4yMy0uNS4zMi0uNzdMMTIgNi43NXpNNiA4LjVhMi41IDIuNSAwIDAxMC01IDIuNSAyLjUgMCAwMTAgNXoiIGZpbGw9IiMwNTBGMTkiLz48L3N2Zz4=",class:"-gear-icon",title:"Expand"}))),r&&r.length>0&&iU("div",{class:"-cbwsdk-snackbar-instance-menu"},r.map((e,t)=>iU("div",{class:iy("-cbwsdk-snackbar-instance-menu-item",e.isRed&&"-cbwsdk-snackbar-instance-menu-item-is-red"),onClick:e.onClick,key:t},iU("svg",{width:e.svgWidth,height:e.svgHeight,viewBox:"0 0 10 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},iU("path",{"fill-rule":e.defaultFillRule,"clip-rule":e.defaultClipRule,d:e.path,fill:"#AAAAAA"})),iU("span",{class:iy("-cbwsdk-snackbar-instance-menu-item-info",e.isRed&&"-cbwsdk-snackbar-instance-menu-item-info-is-red")},e.info)))))},nu="M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z";class nh{constructor(){this.attached=!1,this.snackbar=new nl}attach(){if(this.attached)throw Error("Coinbase Wallet SDK UI is already attached");let e=document.documentElement,t=document.createElement("div");t.className="-cbwsdk-css-reset",e.appendChild(t),this.snackbar.attach(t),this.attached=!0,ip()}showConnecting(e){let t;return t=e.isUnlinkedErrorState?{autoExpand:!0,message:"Connection lost",menuItems:[{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:"M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:e.onResetConnection}]}:{message:"Confirm on phone",menuItems:[{isRed:!0,info:"Cancel transaction",svgWidth:"11",svgHeight:"11",path:"M10.3711 1.52346L9.21775 0.370117L5.37109 4.21022L1.52444 0.370117L0.371094 1.52346L4.2112 5.37012L0.371094 9.21677L1.52444 10.3701L5.37109 6.53001L9.21775 10.3701L10.3711 9.21677L6.53099 5.37012L10.3711 1.52346Z",defaultFillRule:"inherit",defaultClipRule:"inherit",onClick:e.onCancel},{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:nu,defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:e.onResetConnection}]},this.snackbar.presentItem(t)}}class np{constructor(){this.root=null,this.darkMode=ih()}attach(){let e=document.documentElement;this.root=document.createElement("div"),this.root.className="-cbwsdk-css-reset",e.appendChild(this.root),ip()}present(e){this.render(e)}clear(){this.render(null)}render(e){!this.root||(iY(null,this.root),e&&iY(iU(nf,Object.assign({},e,{onDismiss:()=>{this.clear()},darkMode:this.darkMode})),this.root))}}let nf=({title:e,buttonText:t,darkMode:r,onButtonClick:i,onDismiss:n})=>iU(nc,{darkMode:r},iU("div",{class:"-cbwsdk-redirect-dialog"},iU("style",null,".-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop{position:fixed;top:0;left:0;right:0;bottom:0;transition:opacity .25s;background-color:rgba(10,11,13,.5)}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop-hidden{opacity:0}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box{display:block;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);padding:20px;border-radius:8px;background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box p{display:block;font-weight:400;font-size:14px;line-height:20px;padding-bottom:12px;color:#5b636e}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box button{appearance:none;border:none;background:none;color:#0052ff;padding:0;text-decoration:none;display:block;font-weight:600;font-size:16px;line-height:24px}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark{background-color:#0a0b0d;color:#fff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark button{color:#0052ff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light{background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light button{color:#0052ff}"),iU("div",{class:"-cbwsdk-redirect-dialog-backdrop",onClick:n}),iU("div",{class:iy("-cbwsdk-redirect-dialog-box",r?"dark":"light")},iU("p",null,e),iU("button",{onClick:i},t)))),ny="https://www.walletlink.org";class ng{constructor(){this.attached=!1,this.redirectDialog=new np}attach(){if(this.attached)throw Error("Coinbase Wallet SDK UI is already attached");this.redirectDialog.attach(),this.attached=!0}redirectToCoinbaseWallet(e){let t=new URL("https://go.cb-w.com/walletlink");t.searchParams.append("redirect_url",function(){try{if(function(){try{return null!==window.frameElement}catch(e){return!1}}()&&window.top)return window.top.location;return window.location}catch(e){return window.location}}().href),e&&t.searchParams.append("wl_url",e);let r=document.createElement("a");r.target="cbw-opener",r.href=t.href,r.rel="noreferrer noopener",r.click()}openCoinbaseWalletDeeplink(e){this.redirectDialog.present({title:"Redirecting to Coinbase Wallet...",buttonText:"Open",onButtonClick:()=>{this.redirectToCoinbaseWallet(e)}}),setTimeout(()=>{this.redirectToCoinbaseWallet(e)},99)}showConnecting(e){return()=>{this.redirectDialog.clear()}}}class nm{constructor(e){this.chainCallbackParams={chainId:"",jsonRpcUrl:""},this.isMobileWeb=function(){var e;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(null==(e=null==window?void 0:window.navigator)?void 0:e.userAgent)}(),this.linkedUpdated=e=>{this.isLinked=e;let t=this.storage.getItem(r7);if(e&&(this._session.linked=e),this.isUnlinkedErrorState=!1,t){let r=t.split(" "),i="true"===this.storage.getItem("IsStandaloneSigning");""===r[0]||e||!this._session.linked||i||(this.isUnlinkedErrorState=!0)}},this.metadataUpdated=(e,t)=>{this.storage.setItem(e,t)},this.chainUpdated=(e,t)=>{(this.chainCallbackParams.chainId!==e||this.chainCallbackParams.jsonRpcUrl!==t)&&(this.chainCallbackParams={chainId:e,jsonRpcUrl:t},this.chainCallback&&this.chainCallback(t,Number.parseInt(e,10)))},this.accountUpdated=e=>{this.accountsCallback&&this.accountsCallback([e]),nm.accountRequestCallbackIds.size>0&&(Array.from(nm.accountRequestCallbackIds.values()).forEach(t=>{this.invokeCallback(t,{method:"requestEthereumAccounts",result:[e]})}),nm.accountRequestCallbackIds.clear())},this.resetAndReload=this.resetAndReload.bind(this),this.linkAPIUrl=e.linkAPIUrl,this.storage=e.storage,this.metadata=e.metadata,this.accountsCallback=e.accountsCallback,this.chainCallback=e.chainCallback;const{session:t,ui:r,connection:i}=this.subscribe();this._session=t,this.connection=i,this.relayEventManager=new is,this.ui=r,this.ui.attach()}subscribe(){let e=iu.load(this.storage)||iu.create(this.storage),{linkAPIUrl:t}=this,r=new ii({session:e,linkAPIUrl:t,listener:this}),i=this.isMobileWeb?new ng:new nh;return r.connect(),{session:e,ui:i,connection:r}}resetAndReload(){this.connection.destroy().then(()=>{let e=iu.load(this.storage);(null==e?void 0:e.id)===this._session.id&&t8.clearAll(),document.location.reload()}).catch(e=>{})}signEthereumTransaction(e){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:e.fromAddress,toAddress:e.toAddress,weiValue:rC(e.weiValue),data:rT(e.data,!0),nonce:e.nonce,gasPriceInWei:e.gasPriceInWei?rC(e.gasPriceInWei):null,maxFeePerGas:e.gasPriceInWei?rC(e.gasPriceInWei):null,maxPriorityFeePerGas:e.gasPriceInWei?rC(e.gasPriceInWei):null,gasLimit:e.gasLimit?rC(e.gasLimit):null,chainId:e.chainId,shouldSubmit:!1}})}signAndSubmitEthereumTransaction(e){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:e.fromAddress,toAddress:e.toAddress,weiValue:rC(e.weiValue),data:rT(e.data,!0),nonce:e.nonce,gasPriceInWei:e.gasPriceInWei?rC(e.gasPriceInWei):null,maxFeePerGas:e.maxFeePerGas?rC(e.maxFeePerGas):null,maxPriorityFeePerGas:e.maxPriorityFeePerGas?rC(e.maxPriorityFeePerGas):null,gasLimit:e.gasLimit?rC(e.gasLimit):null,chainId:e.chainId,shouldSubmit:!0}})}submitEthereumTransaction(e,t){return this.sendRequest({method:"submitEthereumTransaction",params:{signedTransaction:rT(e,!0),chainId:t}})}getWalletLinkSession(){return this._session}sendRequest(e){let t=null,r=rS(8),i=i=>{this.publishWeb3RequestCanceledEvent(r),this.handleErrorResponse(r,e.method,i),null==t||t()};return new Promise((n,s)=>{t=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:i,onResetConnection:this.resetAndReload}),this.relayEventManager.callbacks.set(r,e=>{if(null==t||t(),r9(e))return s(Error(e.errorMessage));n(e)}),this.publishWeb3RequestEvent(r,e)})}publishWeb3RequestEvent(e,t){let r={type:"WEB3_REQUEST",id:e,request:t};this.publishEvent("Web3Request",r,!0).then(e=>{}).catch(e=>{this.handleWeb3ResponseMessage(r.id,{method:t.method,errorMessage:e.message})}),this.isMobileWeb&&this.openCoinbaseWalletDeeplink(t.method)}openCoinbaseWalletDeeplink(e){if(this.ui instanceof ng)switch(e){case"requestEthereumAccounts":case"switchEthereumChain":return;default:window.addEventListener("blur",()=>{window.addEventListener("focus",()=>{this.connection.checkUnseenEvents()},{once:!0})},{once:!0}),this.ui.openCoinbaseWalletDeeplink()}}publishWeb3RequestCanceledEvent(e){this.publishEvent("Web3RequestCanceled",{type:"WEB3_REQUEST_CANCELED",id:e},!1).then()}publishEvent(e,t,r){return this.connection.publishEvent(e,t,r)}handleWeb3ResponseMessage(e,t){if("requestEthereumAccounts"===t.method){nm.accountRequestCallbackIds.forEach(e=>this.invokeCallback(e,t)),nm.accountRequestCallbackIds.clear();return}this.invokeCallback(e,t)}handleErrorResponse(e,t,r){var i;let n=null!=(i=null==r?void 0:r.message)?i:"Unspecified error message.";this.handleWeb3ResponseMessage(e,{method:t,errorMessage:n})}invokeCallback(e,t){let r=this.relayEventManager.callbacks.get(e);r&&(r(t),this.relayEventManager.callbacks.delete(e))}requestEthereumAccounts(){let{appName:e,appLogoUrl:t}=this.metadata,r={method:"requestEthereumAccounts",params:{appName:e,appLogoUrl:t}},i=rS(8);return new Promise((e,t)=>{this.relayEventManager.callbacks.set(i,r=>{if(r9(r))return t(Error(r.errorMessage));e(r)}),nm.accountRequestCallbackIds.add(i),this.publishWeb3RequestEvent(i,r)})}watchAsset(e,t,r,i,n,s){let a={method:"watchAsset",params:{type:e,options:{address:t,symbol:r,decimals:i,image:n},chainId:s}},o=null,l=rS(8),c=e=>{this.publishWeb3RequestCanceledEvent(l),this.handleErrorResponse(l,a.method,e),null==o||o()};return o=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:c,onResetConnection:this.resetAndReload}),new Promise((e,t)=>{this.relayEventManager.callbacks.set(l,r=>{if(null==o||o(),r9(r))return t(Error(r.errorMessage));e(r)}),this.publishWeb3RequestEvent(l,a)})}addEthereumChain(e,t,r,i,n,s){let a={method:"addEthereumChain",params:{chainId:e,rpcUrls:t,blockExplorerUrls:i,chainName:n,iconUrls:r,nativeCurrency:s}},o=null,l=rS(8),c=e=>{this.publishWeb3RequestCanceledEvent(l),this.handleErrorResponse(l,a.method,e),null==o||o()};return o=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:c,onResetConnection:this.resetAndReload}),new Promise((e,t)=>{this.relayEventManager.callbacks.set(l,r=>{if(null==o||o(),r9(r))return t(Error(r.errorMessage));e(r)}),this.publishWeb3RequestEvent(l,a)})}switchEthereumChain(e,t){let r={method:"switchEthereumChain",params:Object.assign({chainId:e},{address:t})},i=null,n=rS(8),s=e=>{this.publishWeb3RequestCanceledEvent(n),this.handleErrorResponse(n,r.method,e),null==i||i()};return i=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:s,onResetConnection:this.resetAndReload}),new Promise((e,t)=>{this.relayEventManager.callbacks.set(n,r=>(null==i||i(),r9(r)&&r.errorCode)?t(ry({code:r.errorCode,message:"Unrecognized chain ID. Try adding the chain using addEthereumChain first."})):r9(r)?t(Error(r.errorMessage)):void e(r)),this.publishWeb3RequestEvent(n,r)})}}nm.accountRequestCallbackIds=new Set;let nw="DefaultChainId",nb="DefaultJsonRpcUrl";class nv{constructor(e){this._relay=null,this._addresses=[],this.metadata=e.metadata,this._storage=new t8("walletlink",ny),this.callback=e.callback||null;const t=this._storage.getItem(r7);if(t){const e=t.split(" ");""!==e[0]&&(this._addresses=e.map(e=>rD(e)))}this.initializeRelay()}getSession(){let{id:e,secret:t}=this.initializeRelay().getWalletLinkSession();return{id:e,secret:t}}async handshake(){await this._eth_requestAccounts()}get selectedAddress(){return this._addresses[0]||void 0}get jsonRpcUrl(){var e;return null!=(e=this._storage.getItem(nb))?e:void 0}set jsonRpcUrl(e){this._storage.setItem(nb,e)}updateProviderInfo(e,t){var r;this.jsonRpcUrl=e;let i=this.getChainId();this._storage.setItem(nw,t.toString(10)),rL(t)!==i&&(null==(r=this.callback)||r.call(this,"chainChanged",rP(t)))}async watchAsset(e){let t=Array.isArray(e)?e[0]:e;if(!t.type)throw rc("Type is required");if((null==t?void 0:t.type)!=="ERC20")throw rc(`Asset of type '${t.type}' is not supported`);if(!(null==t?void 0:t.options))throw rc("Options are required");if(!(null==t?void 0:t.options.address))throw rc("Address is required");let r=this.getChainId(),{address:i,symbol:n,image:s,decimals:a}=t.options,o=this.initializeRelay(),l=await o.watchAsset(t.type,i,n,a,s,null==r?void 0:r.toString());return!r9(l)&&!!l.result}async addEthereumChain(e){var t,r;let i=e[0];if((null==(t=i.rpcUrls)?void 0:t.length)===0)throw rc("please pass in at least 1 rpcUrl");if(!i.chainName||""===i.chainName.trim())throw rc("chainName is a required field");if(!i.nativeCurrency)throw rc("nativeCurrency is a required field");let n=Number.parseInt(i.chainId,16);if(n===this.getChainId())return!1;let s=this.initializeRelay(),{rpcUrls:a=[],blockExplorerUrls:o=[],chainName:l,iconUrls:c=[],nativeCurrency:d}=i,u=await s.addEthereumChain(n.toString(),a,c,o,l,d);if(r9(u))return!1;if((null==(r=u.result)?void 0:r.isApproved)===!0)return this.updateProviderInfo(a[0],n),null;throw rd("unable to add ethereum chain")}async switchEthereumChain(e){let t=Number.parseInt(e[0].chainId,16),r=this.initializeRelay(),i=await r.switchEthereumChain(t.toString(10),this.selectedAddress||void 0);if(r9(i))throw i;let n=i.result;return n.isApproved&&n.rpcUrl.length>0&&this.updateProviderInfo(n.rpcUrl,t),null}async cleanup(){this.callback=null,this._relay&&this._relay.resetAndReload(),this._storage.clear()}_setAddresses(e,t){var r;if(!Array.isArray(e))throw Error("addresses is not an array");let i=e.map(e=>rD(e));JSON.stringify(i)!==JSON.stringify(this._addresses)&&(this._addresses=i,null==(r=this.callback)||r.call(this,"accountsChanged",i),this._storage.setItem(r7,i.join(" ")))}async request(e){let t=e.params||[];switch(e.method){case"eth_accounts":return[...this._addresses];case"eth_coinbase":return this.selectedAddress||null;case"net_version":return this.getChainId().toString(10);case"eth_chainId":return rP(this.getChainId());case"eth_requestAccounts":return this._eth_requestAccounts();case"eth_ecRecover":case"personal_ecRecover":return this.ecRecover(e);case"personal_sign":return this.personalSign(e);case"eth_signTransaction":return this._eth_signTransaction(t);case"eth_sendRawTransaction":return this._eth_sendRawTransaction(t);case"eth_sendTransaction":return this._eth_sendTransaction(t);case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":return this.signTypedData(e);case"wallet_addEthereumChain":return this.addEthereumChain(t);case"wallet_switchEthereumChain":return this.switchEthereumChain(t);case"wallet_watchAsset":return this.watchAsset(t);default:if(!this.jsonRpcUrl)throw rd("No RPC URL set for chain");return r1(e,this.jsonRpcUrl)}}_ensureKnownAddress(e){let t=rD(e);if(!this._addresses.map(e=>rD(e)).includes(t))throw Error("Unknown Ethereum address")}_prepareTransactionParams(e){let t=e.from?rD(e.from):this.selectedAddress;if(!t)throw Error("Ethereum address is unavailable");this._ensureKnownAddress(t);let r=e.to?rD(e.to):null,i=null!=e.value?rB(e.value):BigInt(0),n=e.data?rj(e.data):t6.Buffer.alloc(0),s=null!=e.nonce?rL(e.nonce):null,a=null!=e.gasPrice?rB(e.gasPrice):null,o=null!=e.maxFeePerGas?rB(e.maxFeePerGas):null,l=null!=e.maxPriorityFeePerGas?rB(e.maxPriorityFeePerGas):null;return{fromAddress:t,toAddress:r,weiValue:i,data:n,nonce:s,gasPriceInWei:a,maxFeePerGas:o,maxPriorityFeePerGas:l,gasLimit:null!=e.gas?rB(e.gas):null,chainId:e.chainId?rL(e.chainId):this.getChainId()}}async ecRecover(e){let{method:t,params:r}=e;if(!Array.isArray(r))throw rc();let i=this.initializeRelay(),n=await i.sendRequest({method:"ethereumAddressFromSignedMessage",params:{message:rx(r[0]),signature:rx(r[1]),addPrefix:"personal_ecRecover"===t}});if(r9(n))throw n;return n.result}getChainId(){var e;return Number.parseInt(null!=(e=this._storage.getItem(nw))?e:"1",10)}async _eth_requestAccounts(){var e,t;if(this._addresses.length>0)return null==(e=this.callback)||e.call(this,"connect",{chainId:rP(this.getChainId())}),this._addresses;let r=this.initializeRelay(),i=await r.requestEthereumAccounts();if(r9(i))throw i;if(!i.result)throw Error("accounts received is empty");return this._setAddresses(i.result),null==(t=this.callback)||t.call(this,"connect",{chainId:rP(this.getChainId())}),this._addresses}async personalSign({params:e}){if(!Array.isArray(e))throw rc();let t=e[1],r=e[0];this._ensureKnownAddress(t);let i=this.initializeRelay(),n=await i.sendRequest({method:"signEthereumMessage",params:{address:rD(t),message:rx(r),addPrefix:!0,typedDataJson:null}});if(r9(n))throw n;return n.result}async _eth_signTransaction(e){let t=this._prepareTransactionParams(e[0]||{}),r=this.initializeRelay(),i=await r.signEthereumTransaction(t);if(r9(i))throw i;return i.result}async _eth_sendRawTransaction(e){let t=rj(e[0]),r=this.initializeRelay(),i=await r.submitEthereumTransaction(t,this.getChainId());if(r9(i))throw i;return i.result}async _eth_sendTransaction(e){let t=this._prepareTransactionParams(e[0]||{}),r=this.initializeRelay(),i=await r.signAndSubmitEthereumTransaction(t);if(r9(i))throw i;return i.result}async signTypedData(e){let{method:t,params:r}=e;if(!Array.isArray(r))throw rc();let i=r[+("eth_signTypedData_v1"===t)],n=r[+("eth_signTypedData_v1"!==t)];this._ensureKnownAddress(i);let s=this.initializeRelay(),a=await s.sendRequest({method:"signEthereumMessage",params:{address:rD(i),message:rT(({eth_signTypedData_v1:r4.default.hashForSignTypedDataLegacy,eth_signTypedData_v3:r4.default.hashForSignTypedData_v3,eth_signTypedData_v4:r4.default.hashForSignTypedData_v4,eth_signTypedData:r4.default.hashForSignTypedData_v4})[t]({data:function(e){if("string"==typeof e)return JSON.parse(e);if("object"==typeof e)return e;throw rc(`Not a JSON string or an object: ${String(e)}`)}(n)}),!0),typedDataJson:JSON.stringify(n,null,2),addPrefix:!1}});if(r9(a))throw a;return a.result}initializeRelay(){return this._relay||(this._relay=new nm({linkAPIUrl:ny,storage:this._storage,metadata:this.metadata,accountsCallback:this._setAddresses.bind(this),chainCallback:this.updateProviderInfo.bind(this)})),this._relay}}let n_="SignerType",nE=new t8("CBWSDK","SignerConfigurator");async function nA(e){let{communicator:t,metadata:r,handshakeRequest:i,callback:n}=e;nS(t,r,n).catch(()=>{});let s={id:crypto.randomUUID(),event:"selectSignerType",data:Object.assign(Object.assign({},e.preference),{handshakeRequest:i})},{data:a}=await t.postRequestAndWaitForResponse(s);return a}async function nS(e,t,r){await e.onMessage(({event:e})=>"WalletLinkSessionRequest"===e);let i=new nv({metadata:t,callback:r});e.postMessage({event:"WalletLinkUpdate",data:{session:i.getSession()}}),await i.handshake(),e.postMessage({event:"WalletLinkUpdate",data:{connected:!0}})}let nI=`Coinbase Wallet SDK requires the Cross-Origin-Opener-Policy header to not be set to 'same-origin'. This is to ensure that the SDK can communicate with the Coinbase Smart Wallet app.

Please see https://www.smartwallet.dev/guides/tips/popup-tips#cross-origin-opener-policy for more information.`,{checkCrossOriginOpenerPolicy:nk,getCrossOriginOpenerPolicy:nT}={getCrossOriginOpenerPolicy:()=>void 0===p?"undefined":p,checkCrossOriginOpenerPolicy:async()=>{if("undefined"==typeof window){p="non-browser-env";return}try{let e=`${window.location.origin}${window.location.pathname}`,t=await fetch(e,{method:"HEAD"});if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);let r=t.headers.get("Cross-Origin-Opener-Policy");p=null!=r?r:"null","same-origin"===p&&console.error(nI)}catch(e){console.error("Error checking Cross-Origin-Opener-Policy:",e.message),p="error"}}},nx={isRed:!1,info:"Retry",svgWidth:"10",svgHeight:"11",path:nu,defaultFillRule:"evenodd",defaultClipRule:"evenodd"},nC=null;class nP{constructor({url:e="https://keys.coinbase.com/connect",metadata:t,preference:r}){this.popup=null,this.listeners=new Map,this.postMessage=async e=>{(await this.waitForPopupLoaded()).postMessage(e,this.url.origin)},this.postRequestAndWaitForResponse=async e=>{let t=this.onMessage(({requestId:t})=>t===e.id);return this.postMessage(e),await t},this.onMessage=async e=>new Promise((t,r)=>{let i=r=>{if(r.origin!==this.url.origin)return;let n=r.data;e(n)&&(t(n),window.removeEventListener("message",i),this.listeners.delete(i))};window.addEventListener("message",i),this.listeners.set(i,{reject:r})}),this.disconnect=()=>{var e;(e=this.popup)&&!e.closed&&e.close(),this.popup=null,this.listeners.forEach(({reject:e},t)=>{e(ru("Request rejected")),window.removeEventListener("message",t)}),this.listeners.clear()},this.waitForPopupLoaded=async()=>this.popup&&!this.popup.closed?(this.popup.focus(),this.popup):(this.popup=await function(e){let t=(window.innerWidth-420)/2+window.screenX,r=(window.innerHeight-540)/2+window.screenY;function i(){let i=`wallet_${crypto.randomUUID()}`,n=window.open(e,i,`width=420, height=540, left=${t}, top=${r}`);return(null==n||n.focus(),n)?n:null}var n=e;for(let[e,t]of Object.entries({sdkName:r0,sdkVersion:rX,origin:window.location.origin,coop:nT()}))n.searchParams.append(e,t.toString());let s=i();if(!s){let e=function(){if(!nC){let e=document.createElement("div");e.className="-cbwsdk-css-reset",document.body.appendChild(e),(nC=new nl).attach(e)}return nC}();return new Promise((t,r)=>{e.presentItem({autoExpand:!0,message:"Popup was blocked. Try again.",menuItems:[Object.assign(Object.assign({},nx),{onClick:()=>{(s=i())?t(s):r(rd("Popup window was blocked")),e.clear()}})]})})}return Promise.resolve(s)}(this.url),this.onMessage(({event:e})=>"PopupUnload"===e).then(this.disconnect).catch(()=>{}),this.onMessage(({event:e})=>"PopupLoaded"===e).then(e=>{this.postMessage({requestId:e.id,data:{version:rX,metadata:this.metadata,preference:this.preference,location:window.location.toString()}})}).then(()=>{if(!this.popup)throw rd();return this.popup})),this.url=new URL(e),this.metadata=t,this.preference=r}}var nO=e.i(87246);class nR extends nO.EventEmitter{}var nN=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};class nM extends nR{constructor(e){var{metadata:t}=e,r=e.preference,{keysUrl:i}=r,n=nN(r,["keysUrl"]);super(),this.signer=null,this.isCoinbaseWallet=!0,this.metadata=t,this.preference=n,this.communicator=new nP({url:i,metadata:t,preference:n});const s=nE.getItem(n_);s&&(this.signer=this.initSigner(s))}async request(e){try{if(!function(e){if(!e||"object"!=typeof e||Array.isArray(e))throw rc({message:"Expected a single, non-array, object argument.",data:e});let{method:t,params:r}=e;if("string"!=typeof t||0===t.length)throw rc({message:"'args.method' must be a non-empty string.",data:e});if(void 0!==r&&!Array.isArray(r)&&("object"!=typeof r||null===r))throw rc({message:"'args.params' must be an object or array if provided.",data:e});switch(t){case"eth_sign":case"eth_signTypedData_v2":case"eth_subscribe":case"eth_unsubscribe":throw rp()}}(e),!this.signer)switch(e.method){case"eth_requestAccounts":{let t=await this.requestSignerSelection(e),r=this.initSigner(t);await r.handshake(e),this.signer=r,nE.setItem(n_,t);break}case"wallet_sendCalls":{let t=this.initSigner("scw");await t.handshake({method:"handshake"});let r=await t.request(e);return await t.cleanup(),r}case"wallet_getCallsStatus":return r1(e,"https://rpc.wallet.coinbase.com");case"net_version":return 1;case"eth_chainId":return rP(1);default:throw rh("Must call 'eth_requestAccounts' before other methods")}return await this.signer.request(e)}catch(i){let e,t,{code:r}=i;return r===re&&this.disconnect(),Promise.reject((e=function(e,{shouldIncludeStack:t=!1}={}){var r,i;let n={};if(e&&"object"==typeof e&&!Array.isArray(e)&&ro(e,"code")&&Number.isInteger(r=e.code)&&(ri[r.toString()]||(i=r)>=-32099&&i<=-32e3))n.code=e.code,e.message&&"string"==typeof e.message?(n.message=e.message,ro(e,"data")&&(n.data=e.data)):(n.message=rs(n.code),n.data={originalError:ra(e)});else n.code=t7,n.message=rl(e,"message")?e.message:rn,n.data={originalError:ra(e)};return t&&(n.stack=rl(e,"stack")?e.stack:void 0),n}(function(e){var t;if("string"==typeof e)return{message:e,code:t7};if(r9(e)){let r=e.errorMessage,i=null!=(t=e.errorCode)?t:r.match(/(denied|rejected)/i)?t9:void 0;return Object.assign(Object.assign({},e),{message:r,code:i,data:{method:e.method}})}return e}(i),{shouldIncludeStack:!0}),(t=new URL("https://docs.cloud.coinbase.com/wallet-sdk/docs/errors")).searchParams.set("version",rX),t.searchParams.set("code",e.code.toString()),t.searchParams.set("message",e.message),Object.assign(Object.assign({},e),{docUrl:t.href})))}}async enable(){return console.warn('.enable() has been deprecated. Please use .request({ method: "eth_requestAccounts" }) instead.'),await this.request({method:"eth_requestAccounts"})}async disconnect(){var e;await (null==(e=this.signer)?void 0:e.cleanup()),this.signer=null,t8.clearAll(),this.emit("disconnect",rf("User initiated disconnection"))}requestSignerSelection(e){return nA({communicator:this.communicator,preference:this.preference,metadata:this.metadata,handshakeRequest:e,callback:this.emit.bind(this)})}initSigner(e){return function(e){let{signerType:t,metadata:r,communicator:i,callback:n}=e;switch(t){case"scw":return new r6({metadata:r,callback:n,communicator:i});case"walletlink":return new nv({metadata:r,callback:n})}}({signerType:e,metadata:this.metadata,communicator:this.communicator,callback:this.emit.bind(this)})}}let nU={options:"all"};function nD(e){new t8("CBWSDK").setItem("VERSION",rX),nk();let t={metadata:{appName:e.appName||"Dapp",appLogoUrl:e.appLogoUrl||"",appChainIds:e.appChainIds||[]},preference:Object.assign(nU,null!=(r=e.preference)?r:{})};var r,i=t.preference;if(i){if(!["all","smartWalletOnly","eoaOnly"].includes(i.options))throw Error(`Invalid options: ${i.options}`);if(i.attribution&&void 0!==i.attribution.auto&&void 0!==i.attribution.dataSuffix)throw Error("Attribution cannot contain both auto and dataSuffix properties")}let n=null;return{getProvider:()=>{var e;let r;return n||(n=null!=(e=function({metadata:e,preference:t}){var r,i;let{appName:n,appLogoUrl:s,appChainIds:a}=e;if("smartWalletOnly"!==t.options){let e=globalThis.coinbaseWalletExtension;if(e)return null==(r=e.setAppInfo)||r.call(e,n,s,a,t),e}let o=function(){var e,t;try{let r=globalThis;return null!=(e=r.ethereum)?e:null==(t=r.top)?void 0:t.ethereum}catch(e){return}}();if(null==o?void 0:o.isCoinbaseBrowser)return null==(i=o.setAppInfo)||i.call(o,n,s,a,t),o}(r={metadata:t.metadata,preference:t.preference}))?e:new nM(r)),n}}}var nj=e.i(740382),nL=e.i(484916),nB=e.i(33750),nW=e.i(675107),nF=e.i(796516),nH=e.i(823838),nq=e.i(880841),nz=e.i(656450),n$=e.i(320065);let nK="/api/v1/sessions",nV="/api/v1/sessions/logout",nJ="/api/v1/siwe/init",nZ="/api/v1/siwe/authenticate",nG="/api/v1/siwe/link",nY="/api/v1/siwe/link_smart_wallet",nQ="/api/v1/siwe/unlink",nX="/api/v1/siwe/transfer",n0="/api/v1/siws/init",n1="/api/v1/siws/authenticate",n2="/api/v1/siws/link",n3="/api/v1/siws/unlink",n5="/api/v1/siws/transfer",n8="/api/v1/farcaster/init",n6="/api/v1/farcaster/authenticate",n4="/api/v1/farcaster/link",n7="/api/v1/farcaster/status",n9="/api/v1/farcaster/unlink",se="/api/v1/farcaster/transfer",st="/api/v1/passwordless/init",sr="/api/v1/passwordless/authenticate",si="/api/v1/passwordless/link",sn="/api/v1/passwordless/unlink",ss="/api/v1/passwordless/update",sa="/api/v1/passwordless/transfer",so="/api/v1/passwordless_sms/init",sl="/api/v1/passwordless_sms/link",sc="/api/v1/passwordless_sms/unlink",sd="/api/v1/passwordless_sms/authenticate",su="/api/v1/passwordless_sms/update",sh="/api/v1/passwordless_sms/transfer",sp="/api/v1/oauth/init",sf="/api/v1/oauth/authenticate",sy="/api/v1/oauth/link",sg="/api/v1/oauth/unlink",sm="/api/v1/oauth/transfer",sw="/api/v1/passkeys/link/init",sb="/api/v1/passkeys/authenticate/init",sv="/api/v1/passkeys/register/init",s_="/api/v1/passkeys/link",sE="/api/v1/passkeys/authenticate",sA="/api/v1/passkeys/register",sS="/api/v1/telegram/authenticate",sI="/api/v1/telegram/link",sk="/api/v1/telegram/unlink",sT="/api/v1/telegram/transfer",sx="/api/v1/mfa/passwordless_sms/init",sC="/api/v1/mfa/passkeys/init",sP="/api/v1/users/me/accept_terms",sO="/api/v1/analytics_events",sR="/api/v1/custom_jwt_account/authenticate",sN="/api/v1/custom_jwt_account/link",sM="/api/v1/guest/authenticate",sU="/api/v1/plugins/moonpay_on_ramp/sign",sD="/api/v1/funding/coinbase_on_ramp/init",sj="/api/v1/funding/coinbase_on_ramp/status",sL="/api/v1/wallets/revoke",sB="/api/v1/users/me",sW="/api/v1/scan/transaction";e.s(["$",()=>nX,"A",()=>nV,"B",()=>sO,"C",()=>sM,"D",()=>sx,"E",()=>sC,"F",()=>sP,"G",()=>sn,"H",()=>sc,"I",()=>nQ,"J",()=>n3,"K",()=>sg,"L",()=>n9,"M",()=>sk,"N",()=>sL,"O",()=>sU,"P",()=>sD,"Q",()=>sj,"R",()=>nJ,"S",()=>nZ,"T",()=>nG,"U",()=>nY,"V",()=>n0,"W",()=>n1,"X",()=>sm,"Y",()=>n5,"Z",()=>sT,"_",()=>se,"a",()=>si,"a0",()=>sh,"a1",()=>sa,"a2",()=>n2,"a3",()=>sB,"a4",()=>sW,"a5",()=>"api/v2/farcaster/init","a6",()=>"api/v2/farcaster/authenticate","a8",()=>"/api/v1/recovery/oauth/authenticate","a9",()=>"/api/v1/recovery/oauth/init_icloud","aa",()=>"/api/v1/recovery/oauth/init","b",()=>st,"c",()=>n4,"d",()=>n8,"e",()=>n7,"f",()=>n6,"g",()=>sy,"h",()=>sp,"i",()=>sA,"j",()=>sE,"k",()=>s_,"l",()=>sv,"m",()=>sb,"n",()=>sw,"o",()=>sf,"p",()=>sr,"q",()=>sd,"r",()=>sl,"s",()=>so,"t",()=>su,"u",()=>ss,"v",()=>sS,"w",()=>sI,"x",()=>sR,"y",()=>sN,"z",()=>nK],902737);var sF=e.i(428720),sH=e.i(166953),sq=e.i(997053),sz=e.i(197845),s$=e.i(803959);function sK(e){"function"==typeof queueMicrotask?queueMicrotask(e):Promise.resolve().then(e).catch(e=>setTimeout(()=>{throw e}))}function sV(){let e=[],t={addEventListener:(e,r,i,n)=>(e.addEventListener(r,i,n),t.add(()=>e.removeEventListener(r,i,n))),requestAnimationFrame(...e){let r=requestAnimationFrame(...e);return t.add(()=>cancelAnimationFrame(r))},nextFrame:(...e)=>t.requestAnimationFrame(()=>t.requestAnimationFrame(...e)),setTimeout(...e){let r=setTimeout(...e);return t.add(()=>clearTimeout(r))},microTask(...e){let r={current:!0};return sK(()=>{r.current&&e[0]()}),t.add(()=>{r.current=!1})},style(e,t,r){let i=e.style.getPropertyValue(t);return Object.assign(e.style,{[t]:r}),this.add(()=>{Object.assign(e.style,{[t]:i})})},group(e){let t=sV();return e(t),this.add(()=>t.dispose())},add:t=>(e.includes(t)||e.push(t),()=>{let r=e.indexOf(t);if(r>=0)for(let t of e.splice(r,1))t()}),dispose(){for(let t of e.splice(0))t()}};return t}function sJ(){let[e]=(0,F.useState)(sV);return(0,F.useEffect)(()=>()=>e.dispose(),[e]),e}e.s(["disposables",()=>sV],544508),e.s(["useDisposables",()=>sJ],746725);var sZ=Object.defineProperty,sG=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?sZ(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r,r};let sY=new class{constructor(){sG(this,"current",this.detect()),sG(this,"handoffState","pending"),sG(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return"server"===this.current}get isClient(){return"client"===this.current}detect(){return"undefined"==typeof window||"undefined"==typeof document?"server":"client"}handoff(){"pending"===this.handoffState&&(this.handoffState="complete")}get isHandoffComplete(){return"complete"===this.handoffState}},sQ=(e,t)=>{sY.isServer?(0,F.useEffect)(e,t):(0,F.useLayoutEffect)(e,t)};function sX(e){let t=(0,F.useRef)(e);return sQ(()=>{t.current=e},[e]),t}e.s(["useIsoMorphicEffect",()=>sQ],835696);let s0=function(e){let t=sX(e);return F.default.useCallback((...e)=>t.current(...e),[t])};function s1(){let e=(0,F.useRef)(!1);return sQ(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function s2(){let e,t=(e="undefined"==typeof document,"useSyncExternalStore"in F&&(0,F.useSyncExternalStore)(()=>()=>{},()=>!1,()=>!e)),[r,i]=F.useState(sY.isHandoffComplete);return r&&!1===sY.isHandoffComplete&&i(!1),F.useEffect(()=>{!0!==r&&i(!0)},[r]),F.useEffect(()=>sY.handoff(),[]),!t&&r}e.s(["useEvent",()=>s0],914189);let s3=Symbol();function s5(e,t=!0){return Object.assign(e,{[s3]:t})}function s8(...e){let t=(0,F.useRef)(e);(0,F.useEffect)(()=>{t.current=e},[e]);let r=s0(e=>{for(let r of t.current)null!=r&&("function"==typeof r?r(e):r.current=e)});return e.every(e=>null==e||(null==e?void 0:e[s3]))?void 0:r}e.s(["optionalRef",()=>s5,"useSyncRefs",()=>s8],294316);var s6=e.i(247167);void 0!==s6.default&&"undefined"!=typeof globalThis&&"undefined"!=typeof Element&&(null==(CO=null==s6.default?void 0:s6.default.env)?void 0:CO.NODE_ENV)==="test"&&void 0===(null==(CR=null==Element?void 0:Element.prototype)?void 0:CR.getAnimations)&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var s4=((f=s4||{})[f.None=0]="None",f[f.Closed=1]="Closed",f[f.Enter=2]="Enter",f[f.Leave=4]="Leave",f);function s7(e){let t={};for(let r in e)!0===e[r]&&(t[`data-${r}`]="");return t}function s9(e,t,r,i){let[n,s]=(0,F.useState)(r),{hasFlag:a,addFlag:o,removeFlag:l}=function(e=0){let[t,r]=(0,F.useState)(e),i=(0,F.useCallback)(e=>r(e),[]),n=(0,F.useCallback)(e=>r(t=>t|e),[]),s=(0,F.useCallback)(e=>(t&e)===e,[t]);return{flags:t,setFlag:i,addFlag:n,hasFlag:s,removeFlag:(0,F.useCallback)(e=>r(t=>t&~e),[]),toggleFlag:(0,F.useCallback)(e=>r(t=>t^e),[])}}(e&&n?3:0),c=(0,F.useRef)(!1),d=(0,F.useRef)(!1);return sQ(()=>{var n;if(e){if(r&&s(!0),!t){r&&o(3);return}return null==(n=null==i?void 0:i.start)||n.call(i,r),function(e,{prepare:t,run:r,done:i,inFlight:n}){let s=sV();return function(e,{inFlight:t,prepare:r}){if(null!=t&&t.current)return r();let i=e.style.transition;e.style.transition="none",r(),e.offsetHeight,e.style.transition=i}(e,{prepare:t,inFlight:n}),s.nextFrame(()=>{r(),s.requestAnimationFrame(()=>{s.add(function(e,t){var r,i;let n=sV();if(!e)return n.dispose;let s=!1;n.add(()=>{s=!0});let a=null!=(i=null==(r=e.getAnimations)?void 0:r.call(e).filter(e=>e instanceof CSSTransition))?i:[];return 0===a.length?t():Promise.allSettled(a.map(e=>e.finished)).then(()=>{s||t()}),n.dispose}(e,i))})}),s.dispose}(t,{inFlight:c,prepare(){d.current?d.current=!1:d.current=c.current,c.current=!0,d.current||(r?(o(3),l(4)):(o(4),l(2)))},run(){d.current?r?(l(3),o(4)):(l(4),o(3)):r?l(1):o(1)},done(){var e,n,a,o;d.current&&(null!=(o=null==(a=(n=t).getAnimations)?void 0:a.call(n))?o:[]).some(e=>e instanceof CSSTransition&&"finished"!==e.playState)||(c.current=!1,l(7),r||s(!1),null==(e=null==i?void 0:i.end)||e.call(i,r))}})}},[e,r,t,sJ()]),e?[n,{closed:a(1),enter:a(2),leave:a(4),transition:a(2)||a(4)}]:[r,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}e.s(["transitionDataAttributes",()=>s7,"useTransition",()=>s9],83733);let ae=(0,F.createContext)(null);ae.displayName="OpenClosedContext";var at=((y=at||{})[y.Open=1]="Open",y[y.Closed=2]="Closed",y[y.Closing=4]="Closing",y[y.Opening=8]="Opening",y);function ar(){return(0,F.useContext)(ae)}function ai({value:e,children:t}){return F.default.createElement(ae.Provider,{value:e},t)}function an({children:e}){return F.default.createElement(ae.Provider,{value:null},e)}function as(...e){return Array.from(new Set(e.flatMap(e=>"string"==typeof e?e.split(" "):[]))).filter(Boolean).join(" ")}function aa(e,t,...r){if(e in t){let i=t[e];return"function"==typeof i?i(...r):i}let i=Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(e=>`"${e}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,aa),i}e.s(["OpenClosedProvider",()=>ai,"ResetOpenClosedProvider",()=>an,"State",()=>at,"useOpenClosed",()=>ar],233137),e.s(["match",()=>aa],397701);var ao=((g=ao||{})[g.None=0]="None",g[g.RenderStrategy=1]="RenderStrategy",g[g.Static=2]="Static",g),al=((m=al||{})[m.Unmount=0]="Unmount",m[m.Hidden=1]="Hidden",m);function ac(){let e,t,r=(e=(0,F.useRef)([]),t=(0,F.useCallback)(t=>{for(let r of e.current)null!=r&&("function"==typeof r?r(t):r.current=t)},[]),(...r)=>{if(!r.every(e=>null==e))return e.current=r,t});return(0,F.useCallback)(e=>(function({ourProps:e,theirProps:t,slot:r,defaultTag:i,features:n,visible:s=!0,name:a,mergeRefs:o}){o=null!=o?o:au;let l=ah(t,e);if(s)return ad(l,r,i,a,o);let c=null!=n?n:0;if(2&c){let{static:e=!1,...t}=l;if(e)return ad(t,r,i,a,o)}if(1&c){let{unmount:e=!0,...t}=l;return aa(+!e,{0:()=>null,1:()=>ad({...t,hidden:!0,style:{display:"none"}},r,i,a,o)})}return ad(l,r,i,a,o)})({mergeRefs:r,...e}),[r])}function ad(e,t={},r,i,n){let{as:s=r,children:a,refName:o="ref",...l}=ag(e,["unmount","static"]),c=void 0!==e.ref?{[o]:e.ref}:{},d="function"==typeof a?a(t):a;"className"in l&&l.className&&"function"==typeof l.className&&(l.className=l.className(t)),l["aria-labelledby"]&&l["aria-labelledby"]===l.id&&(l["aria-labelledby"]=void 0);let u={};if(t){let e=!1,r=[];for(let[i,n]of Object.entries(t))"boolean"==typeof n&&(e=!0),!0===n&&r.push(i.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`));if(e)for(let e of(u["data-headlessui-state"]=r.join(" "),r))u[`data-${e}`]=""}if(am(s)&&(Object.keys(ay(l)).length>0||Object.keys(ay(u)).length>0))if(!(0,F.isValidElement)(d)||Array.isArray(d)&&d.length>1||am(d.type)){if(Object.keys(ay(l)).length>0)throw Error(['Passing props on "Fragment"!',"",`The current component <${i} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(ay(l)).concat(Object.keys(ay(u))).map(e=>`  - ${e}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(e=>`  - ${e}`).join(`
`)].join(`
`))}else{var h;let e=d.props,t=null==e?void 0:e.className,r="function"==typeof t?(...e)=>as(t(...e),l.className):as(t,l.className),i=ah(d.props,ay(ag(l,["ref"])));for(let e in u)e in i&&delete u[e];return(0,F.cloneElement)(d,Object.assign({},i,u,c,{ref:n((h=d,F.default.version.split(".")[0]>="19"?h.props.ref:h.ref),c.ref)},r?{className:r}:{}))}return(0,F.createElement)(s,Object.assign({},ag(l,["ref"]),!am(s)&&c,!am(s)&&u),d)}function au(...e){return e.every(e=>null==e)?void 0:t=>{for(let r of e)null!=r&&("function"==typeof r?r(t):r.current=t)}}function ah(...e){if(0===e.length)return{};if(1===e.length)return e[0];let t={},r={};for(let i of e)for(let e in i)e.startsWith("on")&&"function"==typeof i[e]?(null!=r[e]||(r[e]=[]),r[e].push(i[e])):t[e]=i[e];if(t.disabled||t["aria-disabled"])for(let e in r)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(e)&&(r[e]=[e=>{var t;return null==(t=null==e?void 0:e.preventDefault)?void 0:t.call(e)}]);for(let e in r)Object.assign(t,{[e](t,...i){for(let n of r[e]){if((t instanceof Event||(null==t?void 0:t.nativeEvent)instanceof Event)&&t.defaultPrevented)return;n(t,...i)}}});return t}function ap(...e){if(0===e.length)return{};if(1===e.length)return e[0];let t={},r={};for(let i of e)for(let e in i)e.startsWith("on")&&"function"==typeof i[e]?(null!=r[e]||(r[e]=[]),r[e].push(i[e])):t[e]=i[e];for(let e in r)Object.assign(t,{[e](...t){for(let i of r[e])null==i||i(...t)}});return t}function af(e){var t;return Object.assign((0,F.forwardRef)(e),{displayName:null!=(t=e.displayName)?t:e.name})}function ay(e){let t=Object.assign({},e);for(let e in t)void 0===t[e]&&delete t[e];return t}function ag(e,t=[]){let r=Object.assign({},e);for(let e of t)e in r&&delete r[e];return r}function am(e){return e===F.Fragment||e===Symbol.for("react.fragment")}function aw(e){var t;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||!am(null!=(t=e.as)?t:aS)||1===F.default.Children.count(e.children)}e.s(["RenderFeatures",()=>ao,"RenderStrategy",()=>al,"compact",()=>ay,"forwardRefWithAs",()=>af,"isFragment",()=>am,"mergeProps",()=>ap,"useRender",()=>ac],700020);let ab=(0,F.createContext)(null);ab.displayName="TransitionContext";var av=((w=av||{}).Visible="visible",w.Hidden="hidden",w);let a_=(0,F.createContext)(null);function aE(e){return"children"in e?aE(e.children):e.current.filter(({el:e})=>null!==e.current).filter(({state:e})=>"visible"===e).length>0}function aA(e,t){let r=sX(e),i=(0,F.useRef)([]),n=s1(),s=sJ(),a=s0((e,t=al.Hidden)=>{let a=i.current.findIndex(({el:t})=>t===e);-1!==a&&(aa(t,{[al.Unmount](){i.current.splice(a,1)},[al.Hidden](){i.current[a].state="hidden"}}),s.microTask(()=>{var e;!aE(i)&&n.current&&(null==(e=r.current)||e.call(r))}))}),o=s0(e=>{let t=i.current.find(({el:t})=>t===e);return t?"visible"!==t.state&&(t.state="visible"):i.current.push({el:e,state:"visible"}),()=>a(e,al.Unmount)}),l=(0,F.useRef)([]),c=(0,F.useRef)(Promise.resolve()),d=(0,F.useRef)({enter:[],leave:[]}),u=s0((e,r,i)=>{l.current.splice(0),t&&(t.chains.current[r]=t.chains.current[r].filter(([t])=>t!==e)),null==t||t.chains.current[r].push([e,new Promise(e=>{l.current.push(e)})]),null==t||t.chains.current[r].push([e,new Promise(e=>{Promise.all(d.current[r].map(([e,t])=>t)).then(()=>e())})]),"enter"===r?c.current=c.current.then(()=>null==t?void 0:t.wait.current).then(()=>i(r)):i(r)}),h=s0((e,t,r)=>{Promise.all(d.current[t].splice(0).map(([e,t])=>t)).then(()=>{var e;null==(e=l.current.shift())||e()}).then(()=>r(t))});return(0,F.useMemo)(()=>({children:i,register:o,unregister:a,onStart:u,onStop:h,wait:c,chains:d}),[o,a,i,u,h,d,c])}a_.displayName="NestingContext";let aS=F.Fragment,aI=ao.RenderStrategy,ak=af(function(e,t){let{show:r,appear:i=!1,unmount:n=!0,...s}=e,a=(0,F.useRef)(null),o=s8(...aw(e)?[a,t]:null===t?[]:[t]);s2();let l=ar();if(void 0===r&&null!==l&&(r=(l&at.Open)===at.Open),void 0===r)throw Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[c,d]=(0,F.useState)(r?"visible":"hidden"),u=aA(()=>{r||d("hidden")}),[h,p]=(0,F.useState)(!0),f=(0,F.useRef)([r]);sQ(()=>{!1!==h&&f.current[f.current.length-1]!==r&&(f.current.push(r),p(!1))},[f,r]);let y=(0,F.useMemo)(()=>({show:r,appear:i,initial:h}),[r,i,h]);sQ(()=>{r?d("visible"):aE(u)||null===a.current||d("hidden")},[r,u]);let g={unmount:n},m=s0(()=>{var t;h&&p(!1),null==(t=e.beforeEnter)||t.call(e)}),w=s0(()=>{var t;h&&p(!1),null==(t=e.beforeLeave)||t.call(e)}),b=ac();return F.default.createElement(a_.Provider,{value:u},F.default.createElement(ab.Provider,{value:y},b({ourProps:{...g,as:F.Fragment,children:F.default.createElement(aT,{ref:o,...g,...s,beforeEnter:m,beforeLeave:w})},theirProps:{},defaultTag:F.Fragment,features:aI,visible:"visible"===c,name:"Transition"})))}),aT=af(function(e,t){var r,i;let{transition:n=!0,beforeEnter:s,afterEnter:a,beforeLeave:o,afterLeave:l,enter:c,enterFrom:d,enterTo:u,entered:h,leave:p,leaveFrom:f,leaveTo:y,...g}=e,[m,w]=(0,F.useState)(null),b=(0,F.useRef)(null),v=aw(e),_=s8(...v?[b,t,w]:null===t?[]:[t]),E=null==(r=g.unmount)||r?al.Unmount:al.Hidden,{show:A,appear:S,initial:I}=function(){let e=(0,F.useContext)(ab);if(null===e)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),[k,T]=(0,F.useState)(A?"visible":"hidden"),x=function(){let e=(0,F.useContext)(a_);if(null===e)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),{register:C,unregister:P}=x;sQ(()=>C(b),[C,b]),sQ(()=>{if(E===al.Hidden&&b.current)return A&&"visible"!==k?void T("visible"):aa(k,{hidden:()=>P(b),visible:()=>C(b)})},[k,b,C,P,A,E]);let O=s2();sQ(()=>{if(v&&O&&"visible"===k&&null===b.current)throw Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[b,k,O,v]);let R=I&&!S,N=S&&A&&I,M=(0,F.useRef)(!1),U=aA(()=>{M.current||(T("hidden"),P(b))},x),D=s0(e=>{M.current=!0,U.onStart(b,e?"enter":"leave",e=>{"enter"===e?null==s||s():"leave"===e&&(null==o||o())})}),j=s0(e=>{let t=e?"enter":"leave";M.current=!1,U.onStop(b,t,e=>{"enter"===e?null==a||a():"leave"===e&&(null==l||l())}),"leave"!==t||aE(U)||(T("hidden"),P(b))});(0,F.useEffect)(()=>{v&&n||(D(A),j(A))},[A,v,n]);let[,L]=s9(!(!n||!v||!O||R),m,A,{start:D,end:j}),B=ay({ref:_,className:(null==(i=as(g.className,N&&c,N&&d,L.enter&&c,L.enter&&L.closed&&d,L.enter&&!L.closed&&u,L.leave&&p,L.leave&&!L.closed&&f,L.leave&&L.closed&&y,!L.transition&&A&&h))?void 0:i.trim())||void 0,...s7(L)}),W=0;"visible"===k&&(W|=at.Open),"hidden"===k&&(W|=at.Closed),A&&"hidden"===k&&(W|=at.Opening),A||"visible"!==k||(W|=at.Closing);let H=ac();return F.default.createElement(a_.Provider,{value:U},F.default.createElement(ai,{value:W},H({ourProps:B,theirProps:g,defaultTag:aS,features:aI,visible:"visible"===k,name:"Transition.Child"})))}),ax=af(function(e,t){let r=null!==(0,F.useContext)(ab),i=null!==ar();return F.default.createElement(F.default.Fragment,null,!r&&i?F.default.createElement(ak,{ref:t,...e}):F.default.createElement(aT,{ref:t,...e}))}),aC=Object.assign(ak,{Child:ax,Root:ak});var aP=((b=aP||{}).Space=" ",b.Enter="Enter",b.Escape="Escape",b.Backspace="Backspace",b.Delete="Delete",b.ArrowLeft="ArrowLeft",b.ArrowUp="ArrowUp",b.ArrowRight="ArrowRight",b.ArrowDown="ArrowDown",b.Home="Home",b.End="End",b.PageUp="PageUp",b.PageDown="PageDown",b.Tab="Tab",b);function aO(e,t,r,i){let n=sX(r);(0,F.useEffect)(()=>{function r(e){n.current(e)}return(e=null!=e?e:window).addEventListener(t,r,i),()=>e.removeEventListener(t,r,i)},[e,t,i])}e.s(["Keys",()=>aP],998348);class aR extends Map{constructor(e){super(),this.factory=e}get(e){let t=super.get(e);return void 0===t&&(t=this.factory(e),this.set(e,t)),t}}var aN=Object.defineProperty,aM=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},aU=(e,t,r)=>(aM(e,t,"read from private field"),r?r.call(e):t.get(e)),aD=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},aj=(e,t,r,i)=>(aM(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r);class aL{constructor(e){aD(this,CN,{}),aD(this,CM,new aR(()=>new Set)),aD(this,CU,new Set),((e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?aN(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r})(this,"disposables",sV()),aj(this,CN,e),sY.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return aU(this,CN)}subscribe(e,t){if(sY.isServer)return()=>{};let r={selector:e,callback:t,current:e(aU(this,CN))};return aU(this,CU).add(r),this.disposables.add(()=>{aU(this,CU).delete(r)})}on(e,t){return sY.isServer?()=>{}:(aU(this,CM).get(e).add(t),this.disposables.add(()=>{aU(this,CM).get(e).delete(t)}))}send(e){let t=this.reduce(aU(this,CN),e);if(t!==aU(this,CN)){for(let e of(aj(this,CN,t),aU(this,CU))){let t=e.selector(aU(this,CN));aB(e.current,t)||(e.current=t,e.callback(t))}for(let t of aU(this,CM).get(e.type))t(aU(this,CN),e)}}}function aB(e,t){return!!Object.is(e,t)||"object"==typeof e&&null!==e&&"object"==typeof t&&null!==t&&(Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&aW(e[Symbol.iterator](),t[Symbol.iterator]()):e instanceof Map&&t instanceof Map||e instanceof Set&&t instanceof Set?e.size===t.size&&aW(e.entries(),t.entries()):!!(aF(e)&&aF(t))&&aW(Object.entries(e)[Symbol.iterator](),Object.entries(t)[Symbol.iterator]()))}function aW(e,t){for(;;){let r=e.next(),i=t.next();if(r.done&&i.done)return!0;if(r.done||i.done||!Object.is(r.value,i.value))return!1}}function aF(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;let t=Object.getPrototypeOf(e);return null===t||null===Object.getPrototypeOf(t)}function aH(e){let[t,r]=e(),i=sV();return(...e)=>{t(...e),i.dispose(),i.microTask(r)}}CN=new WeakMap,CM=new WeakMap,CU=new WeakMap,e.s(["Machine",()=>aL,"batch",()=>aH,"shallowEqual",()=>aB],825720);var aq=Object.defineProperty,az=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?aq(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r,r},a$=((v=a$||{})[v.Push=0]="Push",v[v.Pop=1]="Pop",v);let aK={0(e,t){let r=t.id,i=e.stack,n=e.stack.indexOf(r);if(-1!==n){let t=e.stack.slice();return t.splice(n,1),t.push(r),i=t,{...e,stack:i}}return{...e,stack:[...e.stack,r]}},1(e,t){let r=t.id,i=e.stack.indexOf(r);if(-1===i)return e;let n=e.stack.slice();return n.splice(i,1),{...e,stack:n}}};class aV extends aL{constructor(){super(...arguments),az(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),az(this,"selectors",{isTop:(e,t)=>e.stack[e.stack.length-1]===t,inStack:(e,t)=>e.stack.includes(t)})}static new(){return new aV({stack:[]})}reduce(e,t){return aa(t.type,aK,e,t)}}let aJ=new aR(()=>aV.new());e.s(["ActionTypes",()=>a$,"stackMachines",()=>aJ],341650);var aZ=e.i(313027);function aG(e,t,r=aB){return(0,aZ.useSyncExternalStoreWithSelector)(s0(t=>e.subscribe(aY,t)),s0(()=>e.state),s0(()=>e.state),s0(t),r)}function aY(e){return e}function aQ(e,t){let r=(0,F.useId)(),i=aJ.get(t),[n,s]=aG(i,(0,F.useCallback)(e=>[i.selectors.isTop(e,r),i.selectors.inStack(e,r)],[i,r]));return sQ(()=>{if(e)return i.actions.push(r),()=>i.actions.pop(r)},[i,e,r]),!!e&&(!s||n)}function aX(e){var t;return sY.isServer?null:null==e?document:null!=(t=null==e?void 0:e.ownerDocument)?t:document}function a0(e){var t,r;return sY.isServer?null:null==e?document:null!=(r=null==(t=null==e?void 0:e.getRootNode)?void 0:t.call(e))?r:document}function a1(e){var t,r;return null!=(r=null==(t=a0(e))?void 0:t.activeElement)?r:null}function a2(e){return a1(e)===e}e.s(["useSlice",()=>aG],140407),e.s(["getActiveElement",()=>a1,"getOwnerDocument",()=>aX,"getRootNode",()=>a0,"isActiveElement",()=>a2],402155);let a3=new Map,a5=new Map;function a8(e){var t;let r=null!=(t=a5.get(e))?t:0;return a5.set(e,r+1),0!==r||(a3.set(e,{"aria-hidden":e.getAttribute("aria-hidden"),inert:e.inert}),e.setAttribute("aria-hidden","true"),e.inert=!0),()=>(function(e){var t;let r=null!=(t=a5.get(e))?t:1;if(1===r?a5.delete(e):a5.set(e,r-1),1!==r)return;let i=a3.get(e);i&&(null===i["aria-hidden"]?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",i["aria-hidden"]),e.inert=i.inert,a3.delete(e))})(e)}function a6(e,{allowed:t,disallowed:r}={}){let i=aQ(e,"inert-others");sQ(()=>{var e,n;if(!i)return;let s=sV();for(let t of null!=(e=null==r?void 0:r())?e:[])t&&s.add(a8(t));let a=null!=(n=null==t?void 0:t())?n:[];for(let e of a){if(!e)continue;let t=aX(e);if(!t)continue;let r=e.parentElement;for(;r&&r!==t.body;){for(let e of r.children)a.some(t=>e.contains(t))||s.add(a8(e));r=r.parentElement}}return s.dispose},[i,t,r])}function a4(e){return"object"==typeof e&&null!==e&&"nodeType"in e}function a7(e){return a4(e)&&"tagName"in e}function a9(e){return a7(e)&&"accessKey"in e}function oe(e){return a7(e)&&"tabIndex"in e}function ot(e){return a7(e)&&"style"in e}function or(e){return a9(e)&&"IFRAME"===e.nodeName}function oi(e){return a9(e)&&"INPUT"===e.nodeName}function on(e){return a9(e)&&"LABEL"===e.nodeName}function os(e){return a9(e)&&"FIELDSET"===e.nodeName}function oa(e){return a9(e)&&"LEGEND"===e.nodeName}function oo(e){return!!a7(e)&&e.matches('a[href],audio[controls],button,details,embed,iframe,img[usemap],input:not([type="hidden"]),label,select,textarea,video[controls]')}function ol(e,t,r){let i=sX(e=>{let t=e.getBoundingClientRect();0===t.x&&0===t.y&&0===t.width&&0===t.height&&r()});(0,F.useEffect)(()=>{if(!e)return;let r=null===t?null:a9(t)?t:t.current;if(!r)return;let n=sV();if("undefined"!=typeof ResizeObserver){let e=new ResizeObserver(()=>i.current(r));e.observe(r),n.add(()=>e.disconnect())}if("undefined"!=typeof IntersectionObserver){let e=new IntersectionObserver(()=>i.current(r));e.observe(r),n.add(()=>e.disconnect())}return()=>n.dispose()},[t,i,e])}e.s(["useInertOthers",()=>a6],684653),e.s(["hasInlineStyle",()=>ot,"isElement",()=>a7,"isHTMLElement",()=>a9,"isHTMLFieldSetElement",()=>os,"isHTMLIframeElement",()=>or,"isHTMLInputElement",()=>oi,"isHTMLLabelElement",()=>on,"isHTMLLegendElement",()=>oa,"isHTMLorSVGElement",()=>oe,"isInteractiveElement",()=>oo,"isNode",()=>a4],813581),e.s(["useOnDisappear",()=>ol],877891);let oc=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),od=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var ou=((_=ou||{})[_.First=1]="First",_[_.Previous=2]="Previous",_[_.Next=4]="Next",_[_.Last=8]="Last",_[_.WrapAround=16]="WrapAround",_[_.NoScroll=32]="NoScroll",_[_.AutoFocus=64]="AutoFocus",_),oh=((E=oh||{})[E.Error=0]="Error",E[E.Overflow=1]="Overflow",E[E.Success=2]="Success",E[E.Underflow=3]="Underflow",E),op=((A=op||{})[A.Previous=-1]="Previous",A[A.Next=1]="Next",A);function of(e=document.body){return null==e?[]:Array.from(e.querySelectorAll(oc)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}var oy=((S=oy||{})[S.Strict=0]="Strict",S[S.Loose=1]="Loose",S);function og(e,t=0){var r;return e!==(null==(r=aX(e))?void 0:r.body)&&aa(t,{0:()=>e.matches(oc),1(){let t=e;for(;null!==t;){if(t.matches(oc))return!0;t=t.parentElement}return!1}})}function om(e){sV().nextFrame(()=>{let t=a1(e);t&&oe(t)&&!og(t,0)&&ob(e)})}var ow=((I=ow||{})[I.Keyboard=0]="Keyboard",I[I.Mouse=1]="Mouse",I);function ob(e){null==e||e.focus({preventScroll:!0})}function ov(e,t=e=>e){return e.slice().sort((e,r)=>{let i=t(e),n=t(r);if(null===i||null===n)return 0;let s=i.compareDocumentPosition(n);return s&Node.DOCUMENT_POSITION_FOLLOWING?-1:s&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function o_(e,t,r=null===e?document.body:a0(e)){return oE(of(r),t,{relativeTo:e})}function oE(e,t,{sorted:r=!0,relativeTo:i=null,skipElements:n=[]}={}){var s,a,o;let l=Array.isArray(e)?e.length>0?a0(e[0]):document:a0(e),c=Array.isArray(e)?r?ov(e):e:64&t?function(e=document.body){return null==e?[]:Array.from(e.querySelectorAll(od)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}(e):of(e);n.length>0&&c.length>1&&(c=c.filter(e=>!n.some(t=>null!=t&&"current"in t?(null==t?void 0:t.current)===e:t===e))),i=null!=i?i:null==l?void 0:l.activeElement;let d=(()=>{if(5&t)return 1;if(10&t)return -1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=(()=>{if(1&t)return 0;if(2&t)return Math.max(0,c.indexOf(i))-1;if(4&t)return Math.max(0,c.indexOf(i))+1;if(8&t)return c.length-1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),h=32&t?{preventScroll:!0}:{},p=0,f=c.length,y;do{if(p>=f||p+f<=0)return 0;let e=u+p;if(16&t)e=(e+f)%f;else{if(e<0)return 3;if(e>=f)return 1}null==(y=c[e])||y.focus(h),p+=d}while(y!==a1(y))return 6&t&&null!=(o=null==(a=null==(s=y)?void 0:s.matches)?void 0:a.call(s,"textarea,input"))&&o&&y.select(),2}function oA(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function oS(){return oA()||/Android/gi.test(window.navigator.userAgent)}function oI(e,t,r,i){let n=sX(r);(0,F.useEffect)(()=>{if(e)return document.addEventListener(t,r,i),()=>document.removeEventListener(t,r,i);function r(e){n.current(e)}},[e,t,i])}function ok(e,t,r,i){let n=sX(r);(0,F.useEffect)(()=>{if(e)return window.addEventListener(t,r,i),()=>window.removeEventListener(t,r,i);function r(e){n.current(e)}},[e,t,i])}function oT(e,t,r){let i=sX(r),n=(0,F.useCallback)(function(e,r){if(e.defaultPrevented)return;let n=r(e);if(null!==n&&n.getRootNode().contains(n)&&n.isConnected){for(let r of function e(t){return"function"==typeof t?e(t()):Array.isArray(t)||t instanceof Set?t:[t]}(t))if(null!==r&&(r.contains(n)||e.composed&&e.composedPath().includes(r)))return;return og(n,oy.Loose)||-1===n.tabIndex||e.preventDefault(),i.current(e,n)}},[i,t]),s=(0,F.useRef)(null);oI(e,"pointerdown",e=>{var t,r;oS()||(s.current=(null==(r=null==(t=e.composedPath)?void 0:t.call(e))?void 0:r[0])||e.target)},!0),oI(e,"pointerup",e=>{if(oS()||!s.current)return;let t=s.current;return s.current=null,n(e,()=>t)},!0);let a=(0,F.useRef)({x:0,y:0});oI(e,"touchstart",e=>{a.current.x=e.touches[0].clientX,a.current.y=e.touches[0].clientY},!0),oI(e,"touchend",e=>{let t={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY};if(!(Math.abs(t.x-a.current.x)>=30||Math.abs(t.y-a.current.y)>=30))return n(e,()=>oe(e.target)?e.target:null)},!0),ok(e,"blur",e=>n(e,()=>or(window.document.activeElement)?window.document.activeElement:null),!0)}function ox(...e){return(0,F.useMemo)(()=>aX(...e),[...e])}"undefined"!=typeof window&&"undefined"!=typeof document&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{1===e.detail?delete document.documentElement.dataset.headlessuiFocusVisible:0===e.detail&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0)),e.s(["Focus",()=>ou,"FocusResult",()=>oh,"FocusableMode",()=>oy,"focusElement",()=>ob,"focusFrom",()=>o_,"focusIn",()=>oE,"focusableSelector",()=>oc,"isFocusableElement",()=>og,"restoreFocusIfNecessary",()=>om,"sortByDomNode",()=>ov],652265),e.s(["useDocumentEvent",()=>oI],22357),e.s(["useOutsideClick",()=>oT],952744),e.s(["useOwnerDocument",()=>ox],605083);var oC=((k=oC||{})[k.None=1]="None",k[k.Focusable=2]="Focusable",k[k.Hidden=4]="Hidden",k);let oP=af(function(e,t){var r;let{features:i=1,...n}=e,s={ref:t,"aria-hidden":(2&i)==2||(null!=(r=n["aria-hidden"])?r:void 0),hidden:(4&i)==4||void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(4&i)==4&&(2&i)!=2&&{display:"none"}}};return ac()({ourProps:s,theirProps:n,slot:{},defaultTag:"span",name:"Hidden"})}),oO=(0,F.createContext)(null);function oR({children:e,node:t}){let[r,i]=(0,F.useState)(null),n=oN(null!=t?t:r);return F.default.createElement(oO.Provider,{value:n},e,null===n&&F.default.createElement(oP,{features:oC.Hidden,ref:e=>{var t,r;if(e){for(let n of null!=(r=null==(t=aX(e))?void 0:t.querySelectorAll("html > *, body > *"))?r:[])if(n!==document.body&&n!==document.head&&a7(n)&&null!=n&&n.contains(e)){i(n);break}}}}))}function oN(e=null){var t;return null!=(t=(0,F.useContext)(oO))?t:e}function oM(e){let t={};for(let r of e)Object.assign(t,r(t));return t}let oU=(Cy=()=>new Map,Cg={PUSH(e,t){var r;let i=null!=(r=this.get(e))?r:{doc:e,count:0,d:sV(),meta:new Set,computedMeta:{}};return i.count++,i.meta.add(t),i.computedMeta=oM(i.meta),this.set(e,i),this},POP(e,t){let r=this.get(e);return r&&(r.count--,r.meta.delete(t),r.computedMeta=oM(r.meta)),this},SCROLL_PREVENT(e){let t,r={doc:e.doc,d:e.d,meta:()=>e.computedMeta},i=[oA()?{before({doc:e,d:t,meta:r}){function i(e){for(let t of r().containers)for(let r of t())if(r.contains(e))return!0;return!1}t.microTask(()=>{var r;if("auto"!==window.getComputedStyle(e.documentElement).scrollBehavior){let r=sV();r.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>r.dispose()))}let n=null!=(r=window.scrollY)?r:window.pageYOffset,s=null;t.addEventListener(e,"click",t=>{if(oe(t.target))try{let r=t.target.closest("a");if(!r)return;let{hash:n}=new URL(r.href),a=e.querySelector(n);oe(a)&&!i(a)&&(s=a)}catch{}},!0),t.group(r=>{t.addEventListener(e,"touchstart",e=>{if(r.dispose(),oe(e.target)&&ot(e.target))if(i(e.target)){let t=e.target;for(;t.parentElement&&i(t.parentElement);)t=t.parentElement;r.style(t,"overscrollBehavior","contain")}else r.style(e.target,"touchAction","none")})}),t.addEventListener(e,"touchmove",e=>{if(oe(e.target)&&!oi(e.target))if(i(e.target)){let t=e.target;for(;t.parentElement&&""!==t.dataset.headlessuiPortal&&!(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth);)t=t.parentElement;""===t.dataset.headlessuiPortal&&e.preventDefault()}else e.preventDefault()},{passive:!1}),t.add(()=>{var e;n!==(null!=(e=window.scrollY)?e:window.pageYOffset)&&window.scrollTo(0,n),s&&s.isConnected&&(s.scrollIntoView({block:"nearest"}),s=null)})})}}:{},{before({doc:e}){var r;let i=e.documentElement;t=Math.max(0,(null!=(r=e.defaultView)?r:window).innerWidth-i.clientWidth)},after({doc:e,d:r}){let i=e.documentElement,n=Math.max(0,i.clientWidth-i.offsetWidth),s=Math.max(0,t-n);r.style(i,"paddingRight",`${s}px`)}},{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}];i.forEach(({before:e})=>null==e?void 0:e(r)),i.forEach(({after:e})=>null==e?void 0:e(r))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}},T=Cy(),x=new Set,{getSnapshot:()=>T,subscribe:e=>(x.add(e),()=>x.delete(e)),dispatch(e,...t){let r=Cg[e].call(T,...t);r&&(T=r,x.forEach(e=>e()))}});function oD(e,t,r=()=>[document.body]){!function(e,t,r=()=>({containers:[]})){let i=(0,F.useSyncExternalStore)(oU.subscribe,oU.getSnapshot,oU.getSnapshot),n=t?i.get(t):void 0;n&&n.count,sQ(()=>{if(!(!t||!e))return oU.dispatch("PUSH",t,r),()=>oU.dispatch("POP",t,r)},[e,t])}(aQ(e,"scroll-lock"),t,e=>{var t;return{containers:[...null!=(t=e.containers)?t:[],r]}})}function oj(e){return(0,F.useMemo)(()=>e,Object.values(e))}oU.subscribe(()=>{let e=oU.getSnapshot(),t=new Map;for(let[r]of e)t.set(r,r.documentElement.style.overflow);for(let r of e.values()){let e="hidden"===t.get(r.doc),i=0!==r.count;(i&&!e||!i&&e)&&oU.dispatch(r.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",r),0===r.count&&oU.dispatch("TEARDOWN",r)}}),e.s(["useScrollLock",()=>oD],101852),e.s(["useSlot",()=>oj],255743);let oL=(0,F.createContext)(()=>{});function oB({value:e,children:t}){return F.default.createElement(oL.Provider,{value:e},t)}let oW=(0,F.createContext)(!1);function oF(e){return F.default.createElement(oW.Provider,{value:e.force},e.children)}let oH=(0,F.createContext)(void 0);function oq(){return(0,F.useContext)(oH)}e.s(["useDisabled",()=>oq],601893);let oz=(0,F.createContext)(null);function o$(){let[e,t]=(0,F.useState)([]);return[e.length>0?e.join(" "):void 0,(0,F.useMemo)(()=>function(e){let r=s0(e=>(t(t=>[...t,e]),()=>t(t=>{let r=t.slice(),i=r.indexOf(e);return -1!==i&&r.splice(i,1),r}))),i=(0,F.useMemo)(()=>({register:r,slot:e.slot,name:e.name,props:e.props,value:e.value}),[r,e.slot,e.name,e.props,e.value]);return F.default.createElement(oz.Provider,{value:i},e.children)},[t])]}oz.displayName="DescriptionContext";let oK=Object.assign(af(function(e,t){let r=(0,F.useId)(),i=oq(),{id:n=`headlessui-description-${r}`,...s}=e,a=function e(){let t=(0,F.useContext)(oz);if(null===t){let t=Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,e),t}return t}(),o=s8(t);sQ(()=>a.register(n),[n,a.register]);let l=oj({...a.slot,disabled:i||!1}),c={ref:o,...a.props,id:n};return ac()({ourProps:c,theirProps:s,slot:l,defaultTag:"p",name:a.name||"Description"})}),{});function oV(e){let t=s0(e),r=(0,F.useRef)(!1);(0,F.useEffect)(()=>(r.current=!1,()=>{r.current=!0,sK(()=>{r.current&&t()})}),[t])}e.s(["Description",()=>oK,"useDescriptions",()=>o$],35889),e.s(["useOnUnmount",()=>oV],526599);var oJ=((C=oJ||{})[C.Forwards=0]="Forwards",C[C.Backwards=1]="Backwards",C);function oZ(e,t){let r=(0,F.useRef)([]),i=s0(e);(0,F.useEffect)(()=>{let e=[...r.current];for(let[n,s]of t.entries())if(r.current[n]!==s){let n=i(t,e);return r.current=t,n}},[i,...t])}let oG=[];function oY(){"loading"!==document.readyState&&((()=>{function e(e){if(!oe(e.target)||e.target===document.body||oG[0]===e.target)return;let t=e.target;t=t.closest(oc),oG.unshift(null!=t?t:e.target),(oG=oG.filter(e=>null!=e&&e.isConnected)).splice(10)}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})})(),document.removeEventListener("DOMContentLoaded",oY))}function oQ(e){if(!e)return new Set;if("function"==typeof e)return new Set(e());let t=new Set;for(let r of e.current)a7(r.current)&&t.add(r.current);return t}"undefined"!=typeof window&&"undefined"!=typeof document&&(document.addEventListener("DOMContentLoaded",oY),oY());var oX=((P=oX||{})[P.None=0]="None",P[P.InitialFocus=1]="InitialFocus",P[P.TabLock=2]="TabLock",P[P.FocusLock=4]="FocusLock",P[P.RestoreFocus=8]="RestoreFocus",P[P.AutoFocus=16]="AutoFocus",P);let o0=Object.assign(af(function(e,t){let r,i=(0,F.useRef)(null),n=s8(i,t),{initialFocus:s,initialFocusFallback:a,containers:o,features:l=15,...c}=e;s2()||(l=0);let d=ox(i.current);!function(e,{ownerDocument:t}){let r=!!(8&e),i=function(e=!0){let t=(0,F.useRef)(oG.slice());return oZ(([e],[r])=>{!0===r&&!1===e&&sK(()=>{t.current.splice(0)}),!1===r&&!0===e&&(t.current=oG.slice())},[e,oG,t]),s0(()=>{var e;return null!=(e=t.current.find(e=>null!=e&&e.isConnected))?e:null})}(r);oZ(()=>{r||a2(null==t?void 0:t.body)&&ob(i())},[r]),oV(()=>{r&&ob(i())})}(l,{ownerDocument:d});let u=function(e,{ownerDocument:t,container:r,initialFocus:i,initialFocusFallback:n}){let s=(0,F.useRef)(null),a=aQ(!!(1&e),"focus-trap#initial-focus"),o=s1();return oZ(()=>{if(0===e)return;if(!a){null!=n&&n.current&&ob(n.current);return}let l=r.current;l&&sK(()=>{if(!o.current)return;let r=null==t?void 0:t.activeElement;if(null!=i&&i.current){if((null==i?void 0:i.current)===r){s.current=r;return}}else if(l.contains(r)){s.current=r;return}if(null!=i&&i.current)ob(i.current);else{if(16&e){if(oE(l,ou.First|ou.AutoFocus)!==oh.Error)return}else if(oE(l,ou.First)!==oh.Error)return;if(null!=n&&n.current&&(ob(n.current),(null==t?void 0:t.activeElement)===n.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}s.current=null==t?void 0:t.activeElement})},[n,a,e]),s}(l,{ownerDocument:d,container:i,initialFocus:s,initialFocusFallback:a});!function(e,{ownerDocument:t,container:r,containers:i,previousActiveElement:n}){let s=s1(),a=!!(4&e);aO(null==t?void 0:t.defaultView,"focus",e=>{if(!a||!s.current)return;let t=oQ(i);a9(r.current)&&t.add(r.current);let o=n.current;if(!o)return;let l=e.target;a9(l)?o1(t,l)?(n.current=l,ob(l)):(e.preventDefault(),e.stopPropagation(),ob(o)):ob(n.current)},!0)}(l,{ownerDocument:d,container:i,containers:o,previousActiveElement:u});let h=(r=(0,F.useRef)(0),ok(!0,"keydown",e=>{"Tab"===e.key&&(r.current=+!!e.shiftKey)},!0),r),p=s0(e=>{if(!a9(i.current))return;let t=i.current;aa(h.current,{[oJ.Forwards]:()=>{oE(t,ou.First,{skipElements:[e.relatedTarget,a]})},[oJ.Backwards]:()=>{oE(t,ou.Last,{skipElements:[e.relatedTarget,a]})}})}),f=aQ(!!(2&l),"focus-trap#tab-lock"),y=sJ(),g=(0,F.useRef)(!1),m=ac();return F.default.createElement(F.default.Fragment,null,f&&F.default.createElement(oP,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:p,features:oC.Focusable}),m({ourProps:{ref:n,onKeyDown(e){"Tab"==e.key&&(g.current=!0,y.requestAnimationFrame(()=>{g.current=!1}))},onBlur(e){if(!(4&l))return;let t=oQ(o);a9(i.current)&&t.add(i.current);let r=e.relatedTarget;oe(r)&&"true"!==r.dataset.headlessuiFocusGuard&&(o1(t,r)||(g.current?oE(i.current,aa(h.current,{[oJ.Forwards]:()=>ou.Next,[oJ.Backwards]:()=>ou.Previous})|ou.WrapAround,{relativeTo:e.target}):oe(e.target)&&ob(e.target)))}},theirProps:c,defaultTag:"div",name:"FocusTrap"}),f&&F.default.createElement(oP,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:p,features:oC.Focusable}))}),{features:oX});function o1(e,t){for(let r of e)if(r.contains(t))return!0;return!1}var o2=e.i(174080);let o3=F.Fragment,o5=af(function(e,t){let{ownerDocument:r=null,...i}=e,n=(0,F.useRef)(null),s=s8(s5(e=>{n.current=e}),t),a=ox(n.current),o=function(e){let t=(0,F.useContext)(oW),r=(0,F.useContext)(o6),[i,n]=(0,F.useState)(()=>{var i;if(!t&&null!==r)return null!=(i=r.current)?i:null;if(sY.isServer)return null;let n=null==e?void 0:e.getElementById("headlessui-portal-root");if(n)return n;if(null===e)return null;let s=e.createElement("div");return s.setAttribute("id","headlessui-portal-root"),e.body.appendChild(s)});return(0,F.useEffect)(()=>{null!==i&&(null!=e&&e.body.contains(i)||null==e||e.body.appendChild(i))},[i,e]),(0,F.useEffect)(()=>{t||null!==r&&n(r.current)},[r,n,t]),i}(null!=r?r:a),l=(0,F.useContext)(o4),c=sJ(),d=ac();return oV(()=>{var e;o&&o.childNodes.length<=0&&(null==(e=o.parentElement)||e.removeChild(o))}),o?(0,o2.createPortal)(F.default.createElement("div",{"data-headlessui-portal":"",ref:e=>{c.dispose(),l&&e&&c.add(l.register(e))}},d({ourProps:{ref:s},theirProps:i,slot:{},defaultTag:o3,name:"Portal"})),o):null}),o8=F.Fragment,o6=(0,F.createContext)(null),o4=(0,F.createContext)(null);function o7(){let e=(0,F.useContext)(o4),t=(0,F.useRef)([]),r=s0(r=>(t.current.push(r),e&&e.register(r),()=>i(r))),i=s0(r=>{let i=t.current.indexOf(r);-1!==i&&t.current.splice(i,1),e&&e.unregister(r)}),n=(0,F.useMemo)(()=>({register:r,unregister:i,portals:t}),[r,i,t]);return[t,(0,F.useMemo)(()=>function({children:e}){return F.default.createElement(o4.Provider,{value:n},e)},[n])]}let o9=af(function(e,t){let r=s8(t),{enabled:i=!0,ownerDocument:n,...s}=e,a=ac();return i?F.default.createElement(o5,{...s,ownerDocument:n,ref:r}):a({ourProps:{ref:r},theirProps:s,slot:{},defaultTag:o3,name:"Portal"})}),le=af(function(e,t){let{target:r,...i}=e,n={ref:s8(t)},s=ac();return F.default.createElement(o6.Provider,{value:r},s({ourProps:n,theirProps:i,defaultTag:o8,name:"Popover.Group"}))}),lt=Object.assign(o9,{Group:le});e.s(["Portal",()=>lt,"PortalGroup",()=>le,"useNestedPortals",()=>o7],635307);var lr=((O=lr||{})[O.Open=0]="Open",O[O.Closed=1]="Closed",O),li=((R=li||{})[R.SetTitleId=0]="SetTitleId",R);let ln={0:(e,t)=>e.titleId===t.id?e:{...e,titleId:t.id}},ls=(0,F.createContext)(null);function la(e){let t=(0,F.useContext)(ls);if(null===t){let t=Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,la),t}return t}function lo(e,t){return aa(t.type,ln,e,t)}ls.displayName="DialogContext";let ll=af(function(e,t){let r=(0,F.useId)(),{id:i=`headlessui-dialog-${r}`,open:n,onClose:s,initialFocus:a,role:o="dialog",autoFocus:l=!0,__demoMode:c=!1,unmount:d=!1,...u}=e,h=(0,F.useRef)(!1);o="dialog"===o||"alertdialog"===o?o:(h.current||(h.current=!0,console.warn(`Invalid role [${o}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog");let p=ar();void 0===n&&null!==p&&(n=(p&at.Open)===at.Open);let f=(0,F.useRef)(null),y=s8(f,t),g=ox(f.current),m=+!n,[w,b]=(0,F.useReducer)(lo,{titleId:null,descriptionId:null,panelRef:(0,F.createRef)()}),v=s0(()=>s(!1)),_=s0(e=>b({type:0,id:e})),E=!!s2()&&0===m,[A,S]=o7(),I=oN(),{resolveContainers:k}=function({defaultContainers:e=[],portals:t,mainTreeNode:r}={}){let i=s0(()=>{var i,n;let s=aX(r),a=[];for(let t of e)null!==t&&(a7(t)?a.push(t):"current"in t&&a7(t.current)&&a.push(t.current));if(null!=t&&t.current)for(let e of t.current)a.push(e);for(let e of null!=(i=null==s?void 0:s.querySelectorAll("html > *, body > *"))?i:[])e!==document.body&&e!==document.head&&a7(e)&&"headlessui-portal-root"!==e.id&&(r&&(e.contains(r)||e.contains(null==(n=null==r?void 0:r.getRootNode())?void 0:n.host))||a.some(t=>e.contains(t))||a.push(e));return a});return{resolveContainers:i,contains:s0(e=>i().some(t=>t.contains(e)))}}({mainTreeNode:I,portals:A,defaultContainers:[{get current(){var T;return null!=(T=w.panelRef.current)?T:f.current}}]}),x=null!==p&&(p&at.Closing)===at.Closing;a6(!c&&!x&&E,{allowed:s0(()=>{var e,t;return[null!=(t=null==(e=f.current)?void 0:e.closest("[data-headlessui-portal]"))?t:null]}),disallowed:s0(()=>{var e;return[null!=(e=null==I?void 0:I.closest("body > *:not(#headlessui-portal-root)"))?e:null]})});let C=aJ.get(null);sQ(()=>{if(E)return C.actions.push(i),()=>C.actions.pop(i)},[C,i,E]);let P=aG(C,(0,F.useCallback)(e=>C.selectors.isTop(e,i),[C,i]));oT(P,k,e=>{e.preventDefault(),v()}),function(e,t="undefined"!=typeof document?document.defaultView:null,r){let i=aQ(e,"escape");aO(t,"keydown",e=>{i&&(e.defaultPrevented||e.key===aP.Escape&&r(e))})}(P,null==g?void 0:g.defaultView,e=>{e.preventDefault(),e.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur(),v()}),oD(!c&&!x&&E,g,k),ol(E,f,v);let[O,R]=o$(),N=(0,F.useMemo)(()=>[{dialogState:m,close:v,setTitleId:_,unmount:d},w],[m,v,_,d,w]),M=oj({open:0===m}),U={ref:y,id:i,role:o,tabIndex:-1,"aria-modal":c?void 0:0===m||void 0,"aria-labelledby":w.titleId,"aria-describedby":O,unmount:d},D=!function(){var e;let[t]=(0,F.useState)(()=>"undefined"!=typeof window&&"function"==typeof window.matchMedia?window.matchMedia("(pointer: coarse)"):null),[r,i]=(0,F.useState)(null!=(e=null==t?void 0:t.matches)&&e);return sQ(()=>{if(t)return t.addEventListener("change",e),()=>t.removeEventListener("change",e);function e(e){i(e.matches)}},[t]),r}(),j=oX.None;E&&!c&&(j|=oX.RestoreFocus,j|=oX.TabLock,l&&(j|=oX.AutoFocus),D&&(j|=oX.InitialFocus));let L=ac();return F.default.createElement(an,null,F.default.createElement(oF,{force:!0},F.default.createElement(lt,null,F.default.createElement(ls.Provider,{value:N},F.default.createElement(le,{target:f},F.default.createElement(oF,{force:!1},F.default.createElement(R,{slot:M},F.default.createElement(S,null,F.default.createElement(o0,{initialFocus:a,initialFocusFallback:f,containers:k,features:j},F.default.createElement(oB,{value:v},L({ourProps:U,theirProps:u,slot:M,defaultTag:lc,features:ld,visible:0===m,name:"Dialog"})))))))))))}),lc="div",ld=ao.RenderStrategy|ao.Static,lu=af(function(e,t){let{transition:r=!1,open:i,...n}=e,s=ar(),a=e.hasOwnProperty("open")||null!==s,o=e.hasOwnProperty("onClose");if(!a&&!o)throw Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!a)throw Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!o)throw Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!s&&"boolean"!=typeof e.open)throw Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${e.open}`);if("function"!=typeof e.onClose)throw Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${e.onClose}`);return(void 0!==i||r)&&!n.static?F.default.createElement(oR,null,F.default.createElement(aC,{show:i,transition:r,unmount:n.unmount},F.default.createElement(ll,{ref:t,...n}))):F.default.createElement(oR,null,F.default.createElement(ll,{ref:t,open:i,...n}))}),lh=af(function(e,t){let r=(0,F.useId)(),{id:i=`headlessui-dialog-panel-${r}`,transition:n=!1,...s}=e,[{dialogState:a,unmount:o},l]=la("Dialog.Panel"),c=s8(t,l.panelRef),d=oj({open:0===a}),u=s0(e=>{e.stopPropagation()}),h=n?ax:F.Fragment,p=ac();return F.default.createElement(h,{...n?{unmount:o}:{}},p({ourProps:{ref:c,id:i,onClick:u},theirProps:s,slot:d,defaultTag:"div",name:"Dialog.Panel"}))}),lp=Object.assign(lu,{Panel:lh,Title:(af(function(e,t){let{transition:r=!1,...i}=e,[{dialogState:n,unmount:s}]=la("Dialog.Backdrop"),a=oj({open:0===n}),o=r?ax:F.Fragment,l=ac();return F.default.createElement(o,{...r?{unmount:s}:{}},l({ourProps:{ref:t,"aria-hidden":!0},theirProps:i,slot:a,defaultTag:"div",name:"Dialog.Backdrop"}))}),af(function(e,t){let r=(0,F.useId)(),{id:i=`headlessui-dialog-title-${r}`,...n}=e,[{dialogState:s,setTitleId:a}]=la("Dialog.Title"),o=s8(t);(0,F.useEffect)(()=>(a(i),()=>a(null)),[i,a]);let l=oj({open:0===s});return ac()({ourProps:{ref:o,id:i},theirProps:n,slot:l,defaultTag:"h2",name:"Dialog.Title"})})),Description:oK});var lf=e.i(219298),ly=e.i(277945),lg=e.i(648512),lm=e.i(36610),lw=e.i(275221),lb=e.i(44314),lv=e.i(140965);let l_=BigInt(0),lE=BigInt(1);function lA(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function lS(e){if(!lA(e))throw Error("Uint8Array expected")}function lI(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)}function lk(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function lT(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?l_:BigInt("0x"+e)}let lx="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,lC=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function lP(e){if(lS(e),lx)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=lC[e[r]];return t}function lO(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function lR(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(lx)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,n=0;t<r;t++,n+=2){let r=lO(e.charCodeAt(n)),s=lO(e.charCodeAt(n+1));if(void 0===r||void 0===s)throw Error('hex string expected, got non-hex character "'+(e[n]+e[n+1])+'" at index '+n);i[t]=16*r+s}return i}function lN(e){return lT(lP(e))}function lM(e){return lS(e),lT(lP(Uint8Array.from(e).reverse()))}function lU(e,t){return lR(e.toString(16).padStart(2*t,"0"))}function lD(e,t){return lU(e,t).reverse()}function lj(e,t,r){let i;if("string"==typeof t)try{i=lR(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(lA(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let n=i.length;if("number"==typeof r&&n!==r)throw Error(e+" of length "+r+" expected, got "+n);return i}function lL(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];lS(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}let lB=e=>"bigint"==typeof e&&l_<=e;function lW(e,t,r){return lB(e)&&lB(t)&&lB(r)&&t<=e&&e<r}function lF(e,t,r,i){if(!lW(t,r,i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}let lH=e=>(lE<<BigInt(e))-lE,lq=e=>new Uint8Array(e),lz={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||lA(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function l$(e,t,r={}){let i=(t,r,i)=>{let n=lz[r];if("function"!=typeof n)throw Error("invalid validator function");let s=e[t];if((!i||void 0!==s)&&!n(s,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+s)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0);return e}function lK(e){let t=new WeakMap;return(r,...i)=>{let n=t.get(r);if(void 0!==n)return n;let s=e(r,...i);return t.set(r,s),s}}let lV=BigInt(0),lJ=BigInt(1),lZ=BigInt(2),lG=BigInt(3),lY=BigInt(4),lQ=BigInt(5),lX=BigInt(8);function l0(e,t){let r=e%t;return r>=lV?r:t+r}function l1(e,t,r){let i=e;for(;t-- >lV;)i*=i,i%=r;return i}function l2(e,t){if(e===lV)throw Error("invert: expected non-zero number");if(t<=lV)throw Error("invert: expected positive modulus, got "+t);let r=l0(e,t),i=t,n=lV,s=lJ,a=lJ,o=lV;for(;r!==lV;){let e=i/r,t=i%r,l=n-a*e,c=s-o*e;i=r,r=t,n=a,s=o,a=l,o=c}if(i!==lJ)throw Error("invert: does not exist");return l0(n,t)}function l3(e,t){let r=(e.ORDER+lJ)/lY,i=e.pow(t,r);if(!e.eql(e.sqr(i),t))throw Error("Cannot find square root");return i}function l5(e,t){let r=(e.ORDER-lQ)/lX,i=e.mul(t,lZ),n=e.pow(i,r),s=e.mul(t,n),a=e.mul(e.mul(s,lZ),n),o=e.mul(s,e.sub(a,e.ONE));if(!e.eql(e.sqr(o),t))throw Error("Cannot find square root");return o}let l8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function l6(e){return l$(e,l8.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function l4(e,t,r=!1){let i=Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((t,r,n)=>e.is0(r)?t:(i[n]=t,e.mul(t,r)),e.ONE),s=e.inv(n);return t.reduceRight((t,r,n)=>e.is0(r)?t:(i[n]=e.mul(t,i[n]),e.mul(t,r)),s),i}function l7(e,t){let r=(e.ORDER-lJ)/lZ,i=e.pow(t,r),n=e.eql(i,e.ONE),s=e.eql(i,e.ZERO),a=e.eql(i,e.neg(e.ONE));if(!n&&!s&&!a)throw Error("invalid Legendre symbol result");return n?1:s?0:-1}function l9(e,t){void 0!==t&&(0,io.anumber)(t);let r=void 0!==t?t:e.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function ce(e,t,r=!1,i={}){let n;if(e<=lV)throw Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:s,nByteLength:a}=l9(e,t);if(a>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let o=Object.freeze({ORDER:e,isLE:r,BITS:s,BYTES:a,MASK:lH(s),ZERO:lV,ONE:lJ,create:t=>l0(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return lV<=t&&t<e},is0:e=>e===lV,isOdd:e=>(e&lJ)===lJ,neg:t=>l0(-t,e),eql:(e,t)=>e===t,sqr:t=>l0(t*t,e),add:(t,r)=>l0(t+r,e),sub:(t,r)=>l0(t-r,e),mul:(t,r)=>l0(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<lV)throw Error("invalid exponent, negatives unsupported");if(r===lV)return e.ONE;if(r===lJ)return t;let i=e.ONE,n=t;for(;r>lV;)r&lJ&&(i=e.mul(i,n)),n=e.sqr(n),r>>=lJ;return i})(o,e,t),div:(t,r)=>l0(t*l2(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>l2(t,e),sqrt:i.sqrt||(t=>(n||(n=e%lY===lG?l3:e%lX===lQ?l5:function(e){if(e<BigInt(3))throw Error("sqrt is not defined for small field");let t=e-lJ,r=0;for(;t%lZ===lV;)t/=lZ,r++;let i=lZ,n=ce(e);for(;1===l7(n,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return l3;let s=n.pow(i,t),a=(t+lJ)/lZ;return function(e,i){if(e.is0(i))return i;if(1!==l7(e,i))throw Error("Cannot find square root");let n=r,o=e.mul(e.ONE,s),l=e.pow(i,t),c=e.pow(i,a);for(;!e.eql(l,e.ONE);){if(e.is0(l))return e.ZERO;let t=1,r=e.sqr(l);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===n)throw Error("Cannot find square root");let i=lJ<<BigInt(n-t-1),s=e.pow(o,i);n=t,o=e.sqr(s),l=e.mul(l,o),c=e.mul(c,s)}return c}}(e)),n(o,t))),toBytes:e=>r?lD(e,a):lU(e,a),fromBytes:e=>{if(e.length!==a)throw Error("Field.fromBytes: expected "+a+" bytes, got "+e.length);return r?lM(e):lN(e)},invertBatch:e=>l4(o,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(o)}function ct(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function cr(e){let t=ct(e);return t+Math.ceil(t/2)}let ci=BigInt(0),cn=BigInt(1);function cs(e,t){let r=t.negate();return e?r:t}function ca(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function co(e,t){ca(e,t);let r=Math.ceil(t/e)+1,i=2**(e-1),n=2**e;return{windows:r,windowSize:i,mask:lH(e),maxNumber:n,shiftBy:BigInt(e)}}function cl(e,t,r){let{windowSize:i,mask:n,maxNumber:s,shiftBy:a}=r,o=Number(e&n),l=e>>a;o>i&&(o-=s,l+=cn);let c=t*i,d=c+Math.abs(o)-1,u=0===o;return{nextN:l,offset:d,isZero:u,isNeg:o<0,isNegF:t%2!=0,offsetF:c}}let cc=new WeakMap,cd=new WeakMap;function cu(e){return cd.get(e)||1}function ch(e){return l6(e.Fp),l$(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...l9(e.n,e.nBitLength),...e,...{p:e.Fp.ORDER}})}function cp(e){void 0!==e.lowS&&lI("lowS",e.lowS),void 0!==e.prehash&&lI("prehash",e.prehash)}let cf={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{let{Err:r}=cf;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,n=lk(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let s=i>127?lk(n.length/2|128):"";return lk(e)+s+n+t},decode(e,t){let{Err:r}=cf,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let n=t[i++],s=0;if(128&n){let e=127&n;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let a=t.subarray(i,i+e);if(a.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===a[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of a)s=s<<8|e;if(i+=e,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=n;let a=t.subarray(i,i+s);if(a.length!==s)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(i+s)}}},_int:{encode(e){let{Err:t}=cf;if(e<cy)throw new t("integer: negative integers are not allowed");let r=lk(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=cf;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return lN(e)}},toSig(e){let{Err:t,_int:r,_tlv:i}=cf,n=lj("signature",e),{v:s,l:a}=i.decode(48,n);if(a.length)throw new t("invalid signature: left bytes after parsing");let{v:o,l:l}=i.decode(2,s),{v:c,l:d}=i.decode(2,l);if(d.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(o),s:r.decode(c)}},hexFromSig(e){let{_tlv:t,_int:r}=cf,i=t.encode(2,r.encode(e.r)),n=t.encode(2,r.encode(e.s));return t.encode(48,i+n)}},cy=BigInt(0),cg=BigInt(1),cm=BigInt(2),cw=BigInt(3),cb=BigInt(4),cv=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),c_=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),cE=BigInt(0),cA=BigInt(1),cS=BigInt(2),cI=(e,t)=>(e+t/cS)/t,ck=ce(cv,void 0,void 0,{sqrt:function(e){let t=BigInt(3),r=BigInt(6),i=BigInt(11),n=BigInt(22),s=BigInt(23),a=BigInt(44),o=BigInt(88),l=e*e*e%cv,c=l*l*e%cv,d=l1(c,t,cv)*c%cv,u=l1(d,t,cv)*c%cv,h=l1(u,cS,cv)*l%cv,p=l1(h,i,cv)*h%cv,f=l1(p,n,cv)*p%cv,y=l1(f,a,cv)*f%cv,g=l1(y,o,cv)*y%cv,m=l1(g,a,cv)*f%cv,w=l1(m,t,cv)*c%cv,b=l1(w,s,cv)*p%cv,v=l1(b,r,cv)*l%cv,_=l1(v,cS,cv);if(!ck.eql(ck.sqr(_),e))throw Error("Cannot find square root");return _}}),cT=(Cm={a:cE,b:BigInt(7),Fp:ck,n:c_,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-cA*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),n=BigInt("0x100000000000000000000000000000000"),s=cI(t*e,c_),a=cI(-r*e,c_),o=l0(e-s*t-a*i,c_),l=l0(-s*r-a*t,c_),c=o>n,d=l>n;if(c&&(o=c_-o),d&&(l=c_-l),o>n||l>n)throw Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:c,k1:o,k2neg:d,k2:l}}}},Cw=lb.sha256,{...(N=e=>(function(e){let t,r=(l$(t=ch(e),{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})),{Fp:i,n:n,nByteLength:s,nBitLength:a}=r,o=i.BYTES+1,l=2*i.BYTES+1;function c(e){return l0(e,n)}let{ProjectivePoint:d,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:p}=function(e){var t;let r=function(e){let t=ch(e);l$(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});let{endo:r,Fp:i,a:n}=t;if(r){if(!i.eql(n,i.ZERO))throw Error("invalid endo: CURVE.a must be 0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...t})}(e),{Fp:i}=r,n=ce(r.n,r.nBitLength),s=r.toBytes||((e,t,r)=>{let n=t.toAffine();return lL(Uint8Array.from([4]),i.toBytes(n.x),i.toBytes(n.y))}),a=r.fromBytes||(e=>{let t=e.subarray(1);return{x:i.fromBytes(t.subarray(0,i.BYTES)),y:i.fromBytes(t.subarray(i.BYTES,2*i.BYTES))}});function o(e){let{a:t,b:n}=r,s=i.sqr(e),a=i.mul(s,e);return i.add(i.add(a,i.mul(e,t)),n)}function l(e,t){let r=i.sqr(t),n=o(e);return i.eql(r,n)}if(!l(r.Gx,r.Gy))throw Error("bad curve params: generator point");let c=i.mul(i.pow(r.a,cw),cb),d=i.mul(i.sqr(r.b),BigInt(27));if(i.is0(i.add(c,d)))throw Error("bad curve params: a or b");function u(e){let t,{allowedPrivateKeyLengths:i,nByteLength:n,wrapPrivateKey:s,n:a}=r;if(i&&"bigint"!=typeof e){if(lA(e)&&(e=lP(e)),"string"!=typeof e||!i.includes(e.length))throw Error("invalid private key");e=e.padStart(2*n,"0")}try{t="bigint"==typeof e?e:lN(lj("private key",e,n))}catch(t){throw Error("invalid private key, expected hex or "+n+" bytes, got "+typeof e)}return s&&(t=l0(t,a)),lF("private key",t,cg,a),t}function h(e){if(!(e instanceof y))throw Error("ProjectivePoint expected")}let p=lK((e,t)=>{let{px:r,py:n,pz:s}=e;if(i.eql(s,i.ONE))return{x:r,y:n};let a=e.is0();null==t&&(t=a?i.ONE:i.inv(s));let o=i.mul(r,t),l=i.mul(n,t),c=i.mul(s,t);if(a)return{x:i.ZERO,y:i.ZERO};if(!i.eql(c,i.ONE))throw Error("invZ was invalid");return{x:o,y:l}}),f=lK(e=>{if(e.is0()){if(r.allowInfinityPoint&&!i.is0(e.py))return;throw Error("bad point: ZERO")}let{x:t,y:n}=e.toAffine();if(!i.isValid(t)||!i.isValid(n))throw Error("bad point: x or y not FE");if(!l(t,n))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class y{constructor(e,t,r){if(null==e||!i.isValid(e))throw Error("x required");if(null==t||!i.isValid(t)||i.is0(t))throw Error("y required");if(null==r||!i.isValid(r))throw Error("z required");this.px=e,this.py=t,this.pz=r,Object.freeze(this)}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!i.isValid(t)||!i.isValid(r))throw Error("invalid affine point");if(e instanceof y)throw Error("projective point not allowed");let n=e=>i.eql(e,i.ZERO);return n(t)&&n(r)?y.ZERO:new y(t,r,i.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){let t=l4(i,e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(y.fromAffine)}static fromHex(e){let t=y.fromAffine(a(lj("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return y.BASE.multiply(u(e))}static msm(e,t){return function(e,t,r,i){if(!Array.isArray(r))throw Error("array expected");r.forEach((t,r)=>{if(!(t instanceof e))throw Error("invalid point at index "+r)});if(!Array.isArray(i))throw Error("array of scalars expected");i.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)});let n=r.length,s=i.length;if(n!==s)throw Error("arrays of points and scalars must have equal length");let a=e.ZERO,o=function(e){let t;for(t=0;e>l_;e>>=lE,t+=1);return t}(BigInt(n)),l=1;o>12?l=o-3:o>4?l=o-2:o>0&&(l=2);let c=lH(l),d=Array(Number(c)+1).fill(a),u=Math.floor((t.BITS-1)/l)*l,h=a;for(let e=u;e>=0;e-=l){d.fill(a);for(let t=0;t<s;t++){let n=Number(i[t]>>BigInt(e)&c);d[n]=d[n].add(r[t])}let t=a;for(let e=d.length-1,r=a;e>0;e--)r=r.add(d[e]),t=t.add(r);if(h=h.add(t),0!==e)for(let e=0;e<l;e++)h=h.double()}return h}(y,n,e,t)}_setWindowSize(e){w.setWindowSize(this,e)}assertValidity(){f(this)}hasEvenY(){let{y:e}=this.toAffine();if(i.isOdd)return!i.isOdd(e);throw Error("Field doesn't support isOdd")}equals(e){h(e);let{px:t,py:r,pz:n}=this,{px:s,py:a,pz:o}=e,l=i.eql(i.mul(t,o),i.mul(s,n)),c=i.eql(i.mul(r,o),i.mul(a,n));return l&&c}negate(){return new y(this.px,i.neg(this.py),this.pz)}double(){let{a:e,b:t}=r,n=i.mul(t,cw),{px:s,py:a,pz:o}=this,l=i.ZERO,c=i.ZERO,d=i.ZERO,u=i.mul(s,s),h=i.mul(a,a),p=i.mul(o,o),f=i.mul(s,a);return f=i.add(f,f),d=i.mul(s,o),d=i.add(d,d),l=i.mul(e,d),c=i.mul(n,p),c=i.add(l,c),l=i.sub(h,c),c=i.add(h,c),c=i.mul(l,c),l=i.mul(f,l),d=i.mul(n,d),p=i.mul(e,p),f=i.sub(u,p),f=i.mul(e,f),f=i.add(f,d),d=i.add(u,u),u=i.add(d,u),u=i.add(u,p),u=i.mul(u,f),c=i.add(c,u),p=i.mul(a,o),p=i.add(p,p),u=i.mul(p,f),l=i.sub(l,u),d=i.mul(p,h),d=i.add(d,d),new y(l,c,d=i.add(d,d))}add(e){h(e);let{px:t,py:n,pz:s}=this,{px:a,py:o,pz:l}=e,c=i.ZERO,d=i.ZERO,u=i.ZERO,p=r.a,f=i.mul(r.b,cw),g=i.mul(t,a),m=i.mul(n,o),w=i.mul(s,l),b=i.add(t,n),v=i.add(a,o);b=i.mul(b,v),v=i.add(g,m),b=i.sub(b,v),v=i.add(t,s);let _=i.add(a,l);return v=i.mul(v,_),_=i.add(g,w),v=i.sub(v,_),_=i.add(n,s),c=i.add(o,l),_=i.mul(_,c),c=i.add(m,w),_=i.sub(_,c),u=i.mul(p,v),c=i.mul(f,w),u=i.add(c,u),c=i.sub(m,u),u=i.add(m,u),d=i.mul(c,u),m=i.add(g,g),m=i.add(m,g),w=i.mul(p,w),v=i.mul(f,v),m=i.add(m,w),w=i.sub(g,w),w=i.mul(p,w),v=i.add(v,w),g=i.mul(m,v),d=i.add(d,g),g=i.mul(_,v),c=i.mul(b,c),c=i.sub(c,g),g=i.mul(b,m),u=i.mul(_,u),new y(c,d,u=i.add(u,g))}subtract(e){return this.add(e.negate())}is0(){return this.equals(y.ZERO)}wNAF(e){return w.wNAFCached(this,e,y.normalizeZ)}multiplyUnsafe(e){let{endo:t,n:n}=r;lF("scalar",e,cy,n);let s=y.ZERO;if(e===cy)return s;if(this.is0()||e===cg)return this;if(!t||w.hasPrecomputes(this))return w.wNAFCachedUnsafe(this,e,y.normalizeZ);let{k1neg:a,k1:o,k2neg:l,k2:c}=t.splitScalar(e),d=s,u=s,h=this;for(;o>cy||c>cy;)o&cg&&(d=d.add(h)),c&cg&&(u=u.add(h)),h=h.double(),o>>=cg,c>>=cg;return a&&(d=d.negate()),l&&(u=u.negate()),u=new y(i.mul(u.px,t.beta),u.py,u.pz),d.add(u)}multiply(e){let t,n,{endo:s,n:a}=r;if(lF("scalar",e,cg,a),s){let{k1neg:r,k1:a,k2neg:o,k2:l}=s.splitScalar(e),{p:c,f:d}=this.wNAF(a),{p:u,f:h}=this.wNAF(l);c=w.constTimeNegate(r,c),u=w.constTimeNegate(o,u),u=new y(i.mul(u.px,s.beta),u.py,u.pz),t=c.add(u),n=d.add(h)}else{let{p:r,f:i}=this.wNAF(e);t=r,n=i}return y.normalizeZ([t,n])[0]}multiplyAndAddUnsafe(e,t,r){let i=y.BASE,n=(e,t)=>t!==cy&&t!==cg&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t),s=n(this,t).add(n(e,r));return s.is0()?void 0:s}toAffine(e){return p(this,e)}isTorsionFree(){let{h:e,isTorsionFree:t}=r;if(e===cg)return!0;if(t)return t(y,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:e,clearCofactor:t}=r;return e===cg?this:t?t(y,this):this.multiplyUnsafe(r.h)}toRawBytes(e=!0){return lI("isCompressed",e),this.assertValidity(),s(y,this,e)}toHex(e=!0){return lI("isCompressed",e),lP(this.toRawBytes(e))}}y.BASE=new y(r.Gx,r.Gy,i.ONE),y.ZERO=new y(i.ZERO,i.ONE,i.ZERO);let{endo:g,nBitLength:m}=r,w=(t=g?Math.ceil(m/2):m,{constTimeNegate:cs,hasPrecomputes:e=>1!==cu(e),unsafeLadder(e,t,r=y.ZERO){let i=e;for(;t>ci;)t&cn&&(r=r.add(i)),i=i.double(),t>>=cn;return r},precomputeWindow(e,r){let{windows:i,windowSize:n}=co(r,t),s=[],a=e,o=a;for(let e=0;e<i;e++){o=a,s.push(o);for(let e=1;e<n;e++)o=o.add(a),s.push(o);a=o.double()}return s},wNAF(e,r,i){let n=y.ZERO,s=y.BASE,a=co(e,t);for(let e=0;e<a.windows;e++){let{nextN:t,offset:o,isZero:l,isNeg:c,isNegF:d,offsetF:u}=cl(i,e,a);i=t,l?s=s.add(cs(d,r[u])):n=n.add(cs(c,r[o]))}return{p:n,f:s}},wNAFUnsafe(e,r,i,n=y.ZERO){let s=co(e,t);for(let e=0;e<s.windows&&i!==ci;e++){let{nextN:t,offset:a,isZero:o,isNeg:l}=cl(i,e,s);if(i=t,!o){let e=r[a];n=n.add(l?e.negate():e)}}return n},getPrecomputes(e,t,r){let i=cc.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&cc.set(t,r(i))),i},wNAFCached(e,t,r){let i=cu(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)},wNAFCachedUnsafe(e,t,r,i){let n=cu(e);return 1===n?this.unsafeLadder(e,t,i):this.wNAFUnsafe(n,this.getPrecomputes(n,e,r),t,i)},setWindowSize(e,r){ca(r,t),cd.set(e,r),cc.delete(e)}});return{CURVE:r,ProjectivePoint:y,normPrivateKeyToScalar:u,weierstrassEquation:o,isWithinCurveOrder:function(e){return lW(e,cg,r.n)}}}({...r,toBytes(e,t,r){let n=t.toAffine(),s=i.toBytes(n.x);return(lI("isCompressed",r),r)?lL(Uint8Array.from([t.hasEvenY()?2:3]),s):lL(Uint8Array.from([4]),s,i.toBytes(n.y))},fromBytes(e){let t=e.length,r=e[0],n=e.subarray(1);if(t===o&&(2===r||3===r)){let e,t=lN(n);if(!lW(t,cg,i.ORDER))throw Error("Point is not on curve");let s=h(t);try{e=i.sqrt(s)}catch(e){throw Error("Point is not on curve"+(e instanceof Error?": "+e.message:""))}return(1&r)==1!=((e&cg)===cg)&&(e=i.neg(e)),{x:t,y:e}}if(t===l&&4===r)return{x:i.fromBytes(n.subarray(0,i.BYTES)),y:i.fromBytes(n.subarray(i.BYTES,2*i.BYTES))};throw Error("invalid Point, expected length of "+o+", or uncompressed "+l+", got "+t)}}),f=(e,t,r)=>lN(e.slice(t,r));class y{constructor(e,t,r){lF("r",e,cg,n),lF("s",t,cg,n),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){return new y(f(e=lj("compactSignature",e,2*s),0,s),f(e,s,2*s))}static fromDER(e){let{r:t,s:r}=cf.toSig(lj("DER",e));return new y(t,r)}assertValidity(){}addRecoveryBit(e){return new y(this.r,this.s,e)}recoverPublicKey(e){let{r:t,s,recovery:a}=this,o=w(lj("msgHash",e));if(null==a||![0,1,2,3].includes(a))throw Error("recovery id invalid");let l=2===a||3===a?t+r.n:t;if(l>=i.ORDER)throw Error("recovery id 2 or 3 invalid");let u=(1&a)==0?"02":"03",h=d.fromHex(u+lP(lU(l,i.BYTES))),p=l2(l,n),f=c(-o*p),y=c(s*p),g=d.BASE.multiplyAndAddUnsafe(h,f,y);if(!g)throw Error("point at infinify");return g.assertValidity(),g}hasHighS(){return this.s>n>>cg}normalizeS(){return this.hasHighS()?new y(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return lR(this.toDERHex())}toDERHex(){return cf.hexFromSig(this)}toCompactRawBytes(){return lR(this.toCompactHex())}toCompactHex(){return lP(lU(this.r,s))+lP(lU(this.s,s))}}function g(e){if("bigint"==typeof e)return!1;if(e instanceof d)return!0;let t=lj("key",e).length,n=i.BYTES,a=n+1;if(!r.allowedPrivateKeyLengths&&s!==a)return t===a||t===2*n+1}let m=r.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=lN(e),r=8*e.length-a;return r>0?t>>BigInt(r):t},w=r.bits2int_modN||function(e){return c(m(e))},b=lH(a);function v(e){return lF("num < 2^"+a,e,cy,b),lU(e,s)}let _={lowS:r.lowS,prehash:!1},E={lowS:r.lowS,prehash:!1};return d.BASE._setWindowSize(8),{CURVE:r,getPublicKey:function(e,t=!0){return d.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(!0===g(e))throw Error("first arg must be private key");if(!1===g(t))throw Error("second arg must be public key");return d.fromHex(t).multiply(u(e)).toRawBytes(r)},sign:function(e,t,s=_){let{seed:a,k2sig:o}=function(e,t,s=_){if(["recovered","canonical"].some(e=>e in s))throw Error("sign() legacy options not supported");let{hash:a,randomBytes:o}=r,{lowS:l,prehash:h,extraEntropy:f}=s;null==l&&(l=!0),e=lj("msgHash",e),cp(s),h&&(e=lj("prehashed msgHash",a(e)));let g=w(e),b=u(t),E=[v(b),v(g)];if(null!=f&&!1!==f){let e=!0===f?o(i.BYTES):f;E.push(lj("extraEntropy",e))}return{seed:lL(...E),k2sig:function(e){var t;let r=m(e);if(!p(r))return;let i=l2(r,n),s=d.BASE.multiply(r).toAffine(),a=c(s.x);if(a===cy)return;let o=c(i*c(g+a*b));if(o===cy)return;let u=2*(s.x!==a)|Number(s.y&cg),h=o;return l&&o>n>>cg&&(h=(t=o)>n>>cg?c(-t):t,u^=1),new y(a,h,u)}}}(e,t,s);return(function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=lq(e),n=lq(e),s=0,a=()=>{i.fill(1),n.fill(0),s=0},o=(...e)=>r(n,i,...e),l=(e=lq(0))=>{let t;if(n=o((t=[0],Uint8Array.from(t)),e),i=o(),0!==e.length){let t;n=o((t=[1],Uint8Array.from(t)),e),i=o()}},c=()=>{if(s++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(i=o()).slice();r.push(t),e+=i.length}return lL(...r)};return(e,t)=>{let r;for(a(),l(e);!(r=t(c()));)l();return a(),r}})(r.hash.outputLen,r.nByteLength,r.hmac)(a,o)},verify:function(e,t,i,s=E){let a,o;t=lj("msgHash",t),i=lj("publicKey",i);let{lowS:l,prehash:u,format:h}=s;if(cp(s),"strict"in s)throw Error("options.strict was renamed to lowS");if(void 0!==h&&"compact"!==h&&"der"!==h)throw Error("format must be compact or der");let p="string"==typeof e||lA(e),f=!p&&!h&&"object"==typeof e&&null!==e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!p&&!f)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(f&&(o=new y(e.r,e.s)),p){try{"compact"!==h&&(o=y.fromDER(e))}catch(e){if(!(e instanceof cf.Err))throw e}o||"der"===h||(o=y.fromCompact(e))}a=d.fromHex(i)}catch(e){return!1}if(!o||l&&o.hasHighS())return!1;u&&(t=r.hash(t));let{r:g,s:m}=o,b=w(t),v=l2(m,n),_=c(b*v),A=c(g*v),S=d.BASE.multiplyAndAddUnsafe(a,_,A)?.toAffine();return!!S&&c(S.x)===g},ProjectivePoint:d,Signature:y,utils:{isValidPrivateKey(e){try{return u(e),!0}catch(e){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let e=cr(r.n);return function(e,t,r=!1){let i=e.length,n=ct(t),s=cr(t);if(i<16||i<s||i>1024)throw Error("expected "+s+"-1024 bytes of input, got "+i);let a=l0(r?lM(e):lN(e),t-lJ)+lJ;return r?lD(a,n):lU(a,n)}(r.randomBytes(e),r.n)},precompute:(e=8,t=d.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}})({...Cm,...{hash:e,hmac:(t,...r)=>(0,lv.hmac)(e,t,(0,io.concatBytes)(...r)),randomBytes:io.randomBytes}}))(Cw),create:N});cT.ProjectivePoint;let cx=(M=[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(e=>BigInt(e))).map(e=>Array.from(e).reverse()),(e,t)=>{let[r,i,n,s]=M.map(t=>t.reduce((t,r)=>ck.add(ck.mul(t,e),r))),[a,o]=l4(ck,[i,s],!0);return e=ck.mul(r,a),t=ck.mul(t,ck.mul(n,o)),{x:e,y:t}}),cC=function(e,t){if(l6(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let r=function(e,t){let r=e.ORDER,i=cy;for(let e=r-cg;e%cm===cy;e/=cm)i+=cg;let n=i,s=cm<<n-cg-cg,a=s*cm,o=(r-cg)/a,l=(o-cg)/cm,c=a-cg,d=e.pow(t,o),u=e.pow(t,(o+cg)/cm),h=(t,r)=>{let i=d,a=e.pow(r,c),o=e.sqr(a);o=e.mul(o,r);let h=e.mul(t,o);h=e.pow(h,l),h=e.mul(h,a),a=e.mul(h,r),o=e.mul(h,t);let p=e.mul(o,a);h=e.pow(p,s);let f=e.eql(h,e.ONE);a=e.mul(o,u),h=e.mul(p,i),o=e.cmov(a,o,f),p=e.cmov(h,p,f);for(let t=n;t>cg;t--){let r=t-cm;r=cm<<r-cg;let n=e.pow(p,r),s=e.eql(n,e.ONE);a=e.mul(o,i),i=e.mul(i,i),n=e.mul(p,i),o=e.cmov(a,o,s),p=e.cmov(n,p,s)}return{isValid:f,value:o}};if(e.ORDER%cb===cw){let r=(e.ORDER-cw)/cb,i=e.sqrt(e.neg(t));h=(t,n)=>{let s=e.sqr(n),a=e.mul(t,n);s=e.mul(s,a);let o=e.pow(s,r);o=e.mul(o,a);let l=e.mul(o,i),c=e.mul(e.sqr(o),n),d=e.eql(c,t),u=e.cmov(l,o,d);return{isValid:d,value:u}}}return h}(e,t.Z);if(!e.isOdd)throw Error("Fp.isOdd is not implemented!");return i=>{let n,s,a,o,l,c,d,u;n=e.sqr(i),n=e.mul(n,t.Z),s=e.sqr(n),s=e.add(s,n),a=e.add(s,e.ONE),a=e.mul(a,t.B),o=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),o=e.mul(o,t.A),s=e.sqr(a),c=e.sqr(o),l=e.mul(c,t.A),s=e.add(s,l),s=e.mul(s,a),c=e.mul(c,o),l=e.mul(c,t.B),s=e.add(s,l),d=e.mul(n,a);let{isValid:h,value:p}=r(s,c);u=e.mul(n,i),u=e.mul(u,p),d=e.cmov(d,a,h),u=e.cmov(u,p,h);let f=e.isOdd(i)===e.isOdd(u);u=e.cmov(e.neg(u),u,f);let y=l4(e,[o],!0)[0];return{x:d=e.mul(d,y),y:u}}}(ck,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:ck.create(BigInt("-11"))});!function(e,t,r){if("function"!=typeof t)throw Error("mapToCurve() must be defined")}(cT.ProjectivePoint,e=>{let{x:t,y:r}=cC(ck.create(e[0]));return cx(t,r)},(ck.ORDER,lb.sha256));class cP extends Error{constructor(e,t={}){const r=(()=>{if(t.cause instanceof cP){if(t.cause.details)return t.cause.details;if(t.cause.shortMessage)return t.cause.shortMessage}return t.cause&&"details"in t.cause&&"string"==typeof t.cause.details?t.cause.details:t.cause?.message?t.cause.message:t.details})(),i=t.cause instanceof cP&&t.cause.docsPath||t.docsPath,n=`https://oxlib.sh${i??""}`;super([e||"An error occurred.",...t.metaMessages?["",...t.metaMessages]:[],...r||i?["",r?`Details: ${r}`:void 0,i?`See: ${n}`:void 0]:[]].filter(e=>"string"==typeof e).join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"ox@0.1.1"}),this.cause=t.cause,this.details=r,this.docs=n,this.docsPath=i,this.shortMessage=e}walk(e){return function e(t,r){return r?.(t)?t:t&&"object"==typeof t&&"cause"in t&&t.cause?e(t.cause,r):r?null:t}(this,e)}}function cO(e,t){if(cF(e)>t)throw new cK({givenSize:cF(e),maxSize:t})}function cR(e,t={}){let{dir:r,size:i=32}=t;if(0===i)return e;let n=e.replace("0x","");if(n.length>2*i)throw new cJ({size:Math.ceil(n.length/2),targetSize:i,type:"Hex"});return`0x${n["right"===r?"padEnd":"padStart"](2*i,"0")}`}function cN(e,t,r){return JSON.stringify(e,(e,r)=>"function"==typeof t?t(e,r):"bigint"==typeof r?r.toString()+"#__bigint":r,r)}let cM=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function cU(...e){return`0x${e.reduce((e,t)=>e+t.replace("0x",""),"")}`}function cD(e){return e instanceof Uint8Array?cj(e):Array.isArray(e)?cj(new Uint8Array(e)):e}function cj(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=cM[e[t]];let i=`0x${r}`;return"number"==typeof t.size?(cO(i,t.size),cB(i,t.size)):i}function cL(e,t={}){var r;let i,{signed:n,size:s}=t,a=BigInt(e);s?i=n?(1n<<8n*BigInt(s)-1n)-1n:2n**(8n*BigInt(s))-1n:"number"==typeof e&&(i=BigInt(Number.MAX_SAFE_INTEGER));let o="bigint"==typeof i&&n?-i-1n:0;if(i&&a>i||a<o){let t="bigint"==typeof e?"n":"";throw new cq({max:i?`${i}${t}`:void 0,min:`${o}${t}`,signed:n,size:s,value:`${e}${t}`})}let l=(n&&a<0?(1n<<BigInt(8*s))+BigInt(a):a).toString(16),c=`0x${l}`;return s?(r=c,cR(r,{dir:"left",size:s})):c}function cB(e,t){return cR(e,{dir:"right",size:t})}function cW(e,t,r,i={}){let{strict:n}=i;if("number"==typeof t&&t>0&&t>cF(e)-1)throw new cV({offset:t,position:"start",size:cF(e)});let s=`0x${e.replace("0x","").slice((t??0)*2,(r??e.length)*2)}`;return n&&function(e,t,r){if("number"==typeof t&&"number"==typeof r&&cF(e)!==r-t)throw new cV({offset:r,position:"end",size:cF(e)})}(s,t,r),s}function cF(e){return Math.ceil((e.length-2)/2)}function cH(e){return function(e,t={}){let{dir:r="left"}=t,i=e.replace("0x",""),n=0;for(let e=0;e<i.length-1;e++)if("0"===i["left"===r?e:i.length-e-1].toString())n++;else break;return"0"===(i="left"===r?i.slice(n):i.slice(0,i.length-n))?"0x":"right"===r&&i.length%2==1?`0x${i}0`:`0x${i}`}(e,{dir:"left"})}class cq extends cP{constructor({max:e,min:t,signed:r,size:i,value:n}){super(`Number \`${n}\` is not in safe${i?` ${8*i}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${t}\` to \`${e}\`)`:`(above \`${t}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class cz extends cP{constructor(e){super(`Value \`${"object"==typeof e?cN(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class c$ extends cP{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}class cK extends cP{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class cV extends cP{constructor({offset:e,position:t,size:r}){super(`Slice ${"start"===t?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}class cJ extends cP{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}function cZ(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}let cG=new TextEncoder;function cY(e){var t;return e instanceof Uint8Array?e:"string"==typeof e?cQ(e):(t=e)instanceof Uint8Array?t:new Uint8Array(t)}function cQ(e,t={}){let{size:r}=t,i=e;r&&(cO(e,r),i=cB(e,r));let n=i.slice(2);n.length%2&&(n=`0${n}`);let s=n.length/2,a=new Uint8Array(s);for(let e=0,t=0;e<s;e++){let r=cZ(n.charCodeAt(t++)),i=cZ(n.charCodeAt(t++));if(void 0===r||void 0===i)throw new cP(`Invalid byte sequence ("${n[t-2]}${n[t-1]}" in "${n}").`);a[e]=16*r+i}return a}class cX extends cP{constructor(e){super(`Value \`${"object"==typeof e?cN(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class c0 extends cP{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class c1 extends cP{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}let c2=2n**256n-1n;function c3(e,t={}){let{recovered:r}=t;if(void 0===e.r||void 0===e.s||r&&void 0===e.yParity)throw new dy({signature:e});if(e.r<0n||e.r>c2)throw new dg({value:e.r});if(e.s<0n||e.s>c2)throw new dm({value:e.s});if("number"==typeof e.yParity&&0!==e.yParity&&1!==e.yParity)throw new dw({value:e.yParity})}function c5(e){return c8(cj(e))}function c8(e){if(130!==e.length&&132!==e.length)throw new df({signature:e});let t=BigInt(cW(e,0,32)),r=BigInt(cW(e,32,64)),i=(()=>{let t=Number(`0x${e.slice(130)}`);if(!Number.isNaN(t))try{return dh(t)}catch{throw new dw({value:t})}})();return void 0===i?{r:t,s:r}:{r:t,s:r,yParity:i}}function c6(e){if(void 0!==e.r&&void 0!==e.s)return c4(e)}function c4(e){let t="string"==typeof e?c8(e):e instanceof Uint8Array?c5(e):"string"==typeof e.r?dt(e):e.v?de(e):{r:e.r,s:e.s,...void 0!==e.yParity?{yParity:e.yParity}:{}};return c3(t),t}function c7(e){return c9(cj(e))}function c9(e){let{r:t,s:r}=cT.Signature.fromDER(cD(e).slice(2));return{r:t,s:r}}function de(e){return{r:e.r,s:e.s,yParity:dh(e.v)}}function dt(e){let t=(()=>{let t=e.v?Number(e.v):void 0,r=e.yParity?Number(e.yParity):void 0;if("number"==typeof t&&"number"!=typeof r&&(r=dh(t)),"number"!=typeof r)throw new dw({value:e.yParity});return r})();return{r:BigInt(e.r),s:BigInt(e.s),yParity:t}}function dr(e){let[t,r,i]=e;return c4({r:"0x"===r?0n:BigInt(r),s:"0x"===i?0n:BigInt(i),yParity:"0x"===t?0:Number(t)})}function di(e){return cQ(dn(e))}function dn(e){c3(e);let t=e.r,r=e.s;return cU(cL(t,{size:32}),cL(r,{size:32}),"number"==typeof e.yParity?cL(dp(e.yParity),{size:1}):"0x")}function ds(e){return new cT.Signature(e.r,e.s).toDERRawBytes()}function da(e){let t=new cT.Signature(e.r,e.s);return`0x${t.toDERHex()}`}function dl(e){return{r:e.r,s:e.s,v:dp(e.yParity)}}function dc(e){let{r:t,s:r,yParity:i}=e;return{r:cL(t,{size:32}),s:cL(r,{size:32}),yParity:0===i?"0x0":"0x1"}}function dd(e){let{r:t,s:r,yParity:i}=e;return[i?"0x01":"0x",0n===t?"0x":cH(cL(t)),0n===r?"0x":cH(cL(r))]}function du(e,t={}){try{return c3(e,t),!0}catch{return!1}}function dh(e){if(0===e||27===e)return 0;if(1===e||28===e)return 1;if(e>=35)return+(e%2==0);throw new db({value:e})}function dp(e){if(0===e)return 27;if(1===e)return 28;throw new dw({value:e})}class df extends cP{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${cF(cD(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class dy extends cP{constructor({signature:e}){super(`Signature \`${cN(e)}\` is missing either an \`r\`, \`s\`, or \`yParity\` property.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.MissingPropertiesError"})}}class dg extends cP{constructor({value:e}){super(`Value \`${e}\` is an invalid r value. r must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidRError"})}}class dm extends cP{constructor({value:e}){super(`Value \`${e}\` is an invalid s value. s must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSError"})}}class dw extends cP{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class db extends cP{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}e.s(["InvalidRError",()=>dg,"InvalidSError",()=>dm,"InvalidSerializedSizeError",()=>df,"InvalidVError",()=>db,"InvalidYParityError",()=>dw,"MissingPropertiesError",()=>dy,"assert",()=>c3,"extract",()=>c6,"from",()=>c4,"fromBytes",()=>c5,"fromDerBytes",()=>c7,"fromDerHex",()=>c9,"fromHex",()=>c8,"fromLegacy",()=>de,"fromRpc",()=>dt,"fromTuple",()=>dr,"toBytes",()=>di,"toDerBytes",()=>ds,"toDerHex",()=>da,"toHex",()=>dn,"toLegacy",()=>dl,"toRpc",()=>dc,"toTuple",()=>dd,"vToYParity",()=>dh,"validate",()=>du,"yParityToV",()=>dp],869859);var dv=e.i(869859),dv=dv;class d_ extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){let t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){let e=this.keys().next().value;e&&this.delete(e)}return this}}let dE={checksum:new d_(8192)}.checksum;var dA=e.i(145535);function dS(e,t={}){let{as:r="string"==typeof e?"Hex":"Bytes"}=t,i=(0,dA.keccak_256)(cY(e));return"Bytes"===r?i:cj(i)}function dI(e,t={}){let{compressed:r}=t,{prefix:i,x:n,y:s}=e;if(!1===r||"bigint"==typeof n&&"bigint"==typeof s){if(4!==i)throw new dP({prefix:i,cause:new dR});return}if(!0===r||"bigint"==typeof n&&void 0===s){if(3!==i&&2!==i)throw new dP({prefix:i,cause:new dO});return}throw new dC({publicKey:e})}function dk(e){let t=(()=>{if(function(e,t={}){let{strict:r=!1}=t;try{return!function(e,t={}){let{strict:r=!1}=t;if(!e||"string"!=typeof e)throw new cz(e);if(r&&!/^0x[0-9a-fA-F]*$/.test(e)||!e.startsWith("0x"))throw new c$(e)}(e,{strict:r}),!0}catch{return!1}}(e))return dT(e);if(function(e){try{if(!(e instanceof Uint8Array)&&(!e||"object"!=typeof e||!("BYTES_PER_ELEMENT"in e)||1!==e.BYTES_PER_ELEMENT||"Uint8Array"!==e.constructor.name))throw new cX(e);return!0}catch{return!1}}(e))return dT(cj(e));let{prefix:t,x:r,y:i}=e;return"bigint"==typeof r&&"bigint"==typeof i?{prefix:t??4,x:r,y:i}:{prefix:t,x:r}})();return dI(t),t}function dT(e){if(132!==e.length&&130!==e.length&&68!==e.length)throw new dN({publicKey:e});if(130===e.length)return{prefix:4,x:BigInt(cW(e,0,32)),y:BigInt(cW(e,32,64))};if(132===e.length){let t=Number(cW(e,0,1));return{prefix:t,x:BigInt(cW(e,1,33)),y:BigInt(cW(e,33,65))}}return{prefix:Number(cW(e,0,1)),x:BigInt(cW(e,1,33))}}function dx(e,t={}){dI(e);let{prefix:r,x:i,y:n}=e,{includePrefix:s=!0}=t;return cU(s?cL(r,{size:1}):"0x",cL(i,{size:32}),"bigint"==typeof n?cL(n,{size:32}):"0x")}class dC extends cP{constructor({publicKey:e}){super(`Value \`${cN(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class dP extends cP{constructor({prefix:e,cause:t}){super(`Prefix "${e}" is invalid.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class dO extends cP{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class dR extends cP{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}class dN extends cP{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${cF(cD(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}}let dM=/^0x[a-fA-F0-9]{40}$/;function dU(e,t={}){let{strict:r=!0}=t;if(!dM.test(e))throw new dj({address:e,cause:new dL});if(r){if(e.toLowerCase()===e)return;if(dD(e)!==e)throw new dj({address:e,cause:new dB})}}function dD(e){if(dE.has(e))return dE.get(e);dU(e,{strict:!1});let t=e.substring(2).toLowerCase(),r=dS(function(e,t={}){let{size:r}=t,i=cG.encode(e);if("number"==typeof r){var n;if(i.length>r)throw new c0({givenSize:i.length,maxSize:r});return n=i,function(e,t={}){let{dir:r,size:i=32}=t;if(0===i)return e;if(e.length>i)throw new c1({size:e.length,targetSize:i,type:"Bytes"});let n=new Uint8Array(i);for(let t=0;t<i;t++){let s="right"===r;n[s?t:i-t-1]=e[s?t:e.length-t-1]}return n}(n,{dir:"right",size:r})}return i}(t),{as:"Bytes"}),i=t.split("");for(let e=0;e<40;e+=2)r[e>>1]>>4>=8&&i[e]&&(i[e]=i[e].toUpperCase()),(15&r[e>>1])>=8&&i[e+1]&&(i[e+1]=i[e+1].toUpperCase());let n=`0x${i.join("")}`;return dE.set(e,n),n}class dj extends cP{constructor({address:e,cause:t}){super(`Address "${e}" is invalid.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class dL extends cP{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class dB extends cP{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}function dW(e={}){let{as:t="Hex"}=e,r=dq({as:t}),i=dF({privateKey:r});return{privateKey:r,publicKey:i}}function dF(e){let{privateKey:t}=e;return dk(cT.ProjectivePoint.fromPrivateKey(cD(t).slice(2)))}function dH(e){let{as:t="Hex",privateKey:r,publicKey:i}=e,n=cT.ProjectivePoint.fromHex(dx(i).slice(2)).multiply(cT.utils.normPrivateKeyToScalar(cD(r).slice(2))).toRawBytes(!0);return"Hex"===t?cj(n):n}function dq(e={}){let{as:t="Hex"}=e,r=cT.utils.randomPrivateKey();return"Hex"===t?cj(r):r}function dz(e){return function(e,t={}){let r=dS(`0x${dx(e).slice(4)}`).substring(26);return function(e,t={}){let{checksum:r=!1}=t;return(dU(e),r)?dD(e):e}(`0x${r}`,t)}(d$(e))}function d$(e){let{payload:t,signature:r}=e,{r:i,s:n,yParity:s}=r;return dk(new cT.Signature(BigInt(i),BigInt(n)).addRecoveryBit(s).recoverPublicKey(cD(t).substring(2)))}function dK(e){let{extraEntropy:t=!1,hash:r,payload:i,privateKey:n}=e,{r:s,s:a,recovery:o}=cT.sign(cY(i),cY(n),{extraEntropy:"boolean"==typeof t?t:cD(t).slice(2),lowS:!0,...r?{prehash:!0}:{}});return{r:s,s:a,yParity:o}}function dV(e){let{address:t,hash:r,payload:i,publicKey:n,signature:s}=e;if(t){var a;return a=dz({payload:i,signature:s}),dU(t,{strict:!1}),dU(a,{strict:!1}),t.toLowerCase()===a.toLowerCase()}return cT.verify(s,cY(i),function(e,t={}){return cQ(dx(e,t))}(n),...r?[{prehash:!0,lowS:!0}]:[])}e.s(["createKeyPair",()=>dW,"getPublicKey",()=>dF,"getSharedSecret",()=>dH,"noble",0,cT,"randomPrivateKey",()=>dq,"recoverAddress",()=>dz,"recoverPublicKey",()=>d$,"sign",()=>dK,"verify",()=>dV],520735);var dJ=e.i(520735),dJ=dJ,dZ=e.i(103476),dG=e.i(626335),dY=e.i(425748),dQ=e.i(121609);e.i(262265);var dX=e.i(773912),d0=e.i(120483),d1=e.i(310998),d2=e.i(281223),d3=e.i(5625),d5=e.i(735071),d8=e.i(31794),d6=Object.defineProperty,d4=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?d6(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class d7{constructor(e){d4(this,"nodeValue"),d4(this,"sizeInBytes"),d4(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class d9{constructor(e){d4(this,"lengthInNodes"),d4(this,"sizeInBytes"),d4(this,"head"),d4(this,"tail"),d4(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){let t=new d7(e);if(t.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=t):this.head=t,this.tail=t,this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;let e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){let e=[],t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};let t=e.value;return e=e.next,{done:!1,value:t}}}}}var ue=Object.defineProperty,ut=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?ue(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class ur{constructor(e,t=1024e3){ut(this,"logs"),ut(this,"level"),ut(this,"levelValue"),ut(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=d5.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new d9(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===d5.levels.values.error?console.error(e):t===d5.levels.values.warn?console.warn(e):t===d5.levels.values.debug?console.debug(e):t===d5.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append((0,d8.safeJsonStringify)({timestamp:new Date().toISOString(),log:e}));let t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new d9(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){let t=this.getLogArray();return t.push((0,d8.safeJsonStringify)({extraMetadata:e})),new Blob(t,{type:"application/json"})}}var ui=Object.defineProperty;class un{constructor(e,t=1024e3){((e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?ui(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r})(this,"baseChunkLogger"),this.baseChunkLogger=new ur(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){let t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}var us=Object.defineProperty,ua=Object.defineProperties,uo=Object.getOwnPropertyDescriptors,ul=Object.getOwnPropertySymbols,uc=Object.prototype.hasOwnProperty,ud=Object.prototype.propertyIsEnumerable,uu=(e,t,r)=>t in e?us(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uh=(e,t)=>{for(var r in t||(t={}))uc.call(t,r)&&uu(e,r,t[r]);if(ul)for(var r of ul(t))ud.call(t,r)&&uu(e,r,t[r]);return e};function up(e){let[t,r]=e.split(":");return{namespace:t,reference:r}}function uf(e,t=[]){let r=[];return Object.keys(e).forEach(i=>{if(t.length&&!t.includes(i))return;let n=e[i];r.push(...n.accounts)}),r}function uy(e,t){return e.includes(":")?[e]:t.chains||[]}var ug=Object.defineProperty,um=Object.defineProperties,uw=Object.getOwnPropertyDescriptors,ub=Object.getOwnPropertySymbols,uv=Object.prototype.hasOwnProperty,u_=Object.prototype.propertyIsEnumerable,uE=(e,t,r)=>t in e?ug(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uA=(e,t)=>{for(var r in t||(t={}))uv.call(t,r)&&uE(e,r,t[r]);if(ub)for(var r of ub(t))u_.call(t,r)&&uE(e,r,t[r]);return e},uS=(e,t,r)=>uE(e,"symbol"!=typeof t?t+"":t,r);let uI="react-native",uk="node",uT="browser";function ux(){return"u">typeof s6.default&&"u">typeof s6.default.versions&&"u">typeof s6.default.versions.node}function uC(){return!(0,lm.getDocument)()&&!!(0,lm.getNavigator)()&&"ReactNative"===navigator.product}function uP(){return!ux()&&!!(0,lm.getNavigator)()&&!!(0,lm.getDocument)()}function uO(){return uC()?uI:ux()?uk:uP()?uT:"unknown"}function uR(){var t;try{return uC()&&"u">typeof(null==e.g?void 0:e.g.Application)?null==(t=e.g.Application)?void 0:t.applicationId:void 0}catch{return}}function uN(){return(0,lw.getWindowMetadata)()||{name:"",description:"",url:"",icons:[""]}}function uM(t,r,i){var n;let s,a=function(){if(uO()===uI&&"u">typeof(null==e.g?void 0:e.g.Platform)){let{OS:t,Version:r}=e.g.Platform;return[t,r].join("-")}let t=(0,ly.detect)();if(null===t)return"unknown";let r=t.os?t.os.replace(" ","").toLowerCase():"unknown";return"browser"===t.type?[r,t.name,t.version].join("-"):[r,t.version].join("-")}(),o=(s=uO())===uT?[s,(null==(n=(0,lm.getLocation)())?void 0:n.host)||"unknown"].join(":"):s;return[[t,r].join("-"),["js",i].join("-"),a,o].join("/")}function uU(e,t){return e.filter(e=>t.includes(e)).length===e.length}function uD(e){return Object.fromEntries(e.entries())}function uj(e){return new Map(Object.entries(e))}function uL(e=lg.FIVE_MINUTES,t){let r,i,n,s,a=(0,lg.toMiliseconds)(e||lg.FIVE_MINUTES);return{resolve:e=>{n&&r&&(clearTimeout(n),r(e),s=Promise.resolve(e))},reject:e=>{n&&i&&(clearTimeout(n),i(e))},done:()=>new Promise((e,o)=>{if(s)return e(s);n=setTimeout(()=>{let e=Error(t);s=Promise.reject(e),o(e)},a),r=e,i=o})}}function uB(e,t,r){return new Promise(async(i,n)=>{let s=setTimeout(()=>n(Error(r)),t);try{let t=await e;i(t)}catch(e){n(e)}clearTimeout(s)})}function uW(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw Error(`Unknown expirer target type: ${e}`)}function uF(e){let[t,r]=e.split(":"),i={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)i.topic=r;else if("id"===t&&Number.isInteger(Number(r)))i.id=Number(r);else throw Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return i}function uH(e,t){return(0,lg.fromMiliseconds)((t||Date.now())+(0,lg.toMiliseconds)(e))}function uq(e){return Date.now()>=(0,lg.toMiliseconds)(e)}function uz(e,t){return`${e}${t?`:${t}`:""}`}function u$(e=[],t=[]){return[...new Set([...e,...t])]}async function uK({id:t,topic:r,wcDeepLink:i}){var n,s;try{if(!i)return;let a="string"==typeof i?JSON.parse(i):i,o=a?.href;if("string"!=typeof o)return;let l=function(e,t,r){let i=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let n=`${e}`;if(e.startsWith("https://t.me")){let t=e.includes("?")?"&startapp=":"?startapp=";n=`${n}${t}${function(e,t=!1){let r=t6.Buffer.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(i,!0)}`}else n=`${n}/wc?${i}`;return n}(o,t,r),c=uO();if(c===uT){let e;if(!(null!=(n=(0,lm.getDocument)())&&n.hasFocus()))return void console.warn("Document does not have focus, skipping deeplink.");s=l,e="_self",!function(){try{return window.self!==window.top}catch{return!1}}()?(window.TelegramWebviewProxy||window.Telegram||window.TelegramWebviewProxyProto||s.startsWith("https://")||s.startsWith("http://"))&&(e="_blank"):e="_top",window.open(s,e,"noreferrer noopener")}else c===uI&&"u">typeof(null==e.g?void 0:e.g.Linking)&&await e.g.Linking.openURL(l)}catch(e){console.error(e)}}async function uV(e,t){let r="";try{if(uP()&&(r=localStorage.getItem(t)))return r;r=await e.getItem(t)}catch(e){console.error(e)}return r}function uJ(e,t){if(!e.includes(t))return null;let r=e.split(/([&,?,=])/),i=r.indexOf(t);return r[i+2]}function uZ(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function uG(){return"u">typeof s6.default&&"true"===s6.default.env.IS_VITEST}function uY(e){return t6.Buffer.from(e,"base64").toString("utf-8")}class uQ{constructor({limit:e}){uS(this,"limit"),uS(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){let e=this.set.values().next().value;e&&this.set.delete(e)}this.set.add(e)}}has(e){return this.set.has(e)}}let uX=BigInt(0x100000000-1),u0=BigInt(32);function u1(e,t=!1){return t?{h:Number(e&uX),l:Number(e>>u0&uX)}:{h:0|Number(e>>u0&uX),l:0|Number(e&uX)}}function u2(e,t=!1){let r=e.length,i=new Uint32Array(r),n=new Uint32Array(r);for(let s=0;s<r;s++){let{h:r,l:a}=u1(e[s],t);[i[s],n[s]]=[r,a]}return[i,n]}let u3=(e,t,r)=>e>>>r,u5=(e,t,r)=>e<<32-r|t>>>r,u8=(e,t,r)=>e>>>r|t<<32-r,u6=(e,t,r)=>e<<32-r|t>>>r,u4=(e,t,r)=>e<<64-r|t>>>r-32,u7=(e,t,r)=>e>>>r-32|t<<64-r;function u9(e,t,r,i){let n=(t>>>0)+(i>>>0);return{h:e+r+(n/0x100000000|0)|0,l:0|n}}let he=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),ht=(e,t,r,i)=>t+r+i+(e/0x100000000|0)|0,hr=(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),hi=(e,t,r,i,n)=>t+r+i+n+(e/0x100000000|0)|0,hn=(e,t,r,i,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(n>>>0),hs=(e,t,r,i,n,s)=>t+r+i+n+s+(e/0x100000000|0)|0,ha="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function ho(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function hl(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function hc(e,...t){if(!ho(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function hd(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.createHasher");hl(e.outputLen),hl(e.blockLen)}function hu(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function hh(e,t){hc(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function hp(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function hf(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function hy(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function hg(e,t){return e<<32-t|e>>>t}let hm=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function hw(e){return e<<24&0xff000000|e<<8&0xff0000|e>>>8&65280|e>>>24&255}let hb=hm?e=>e:e=>hw(e),hv=hm?e=>e:function(e){for(let t=0;t<e.length;t++)e[t]=hw(e[t]);return e},h_="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,hE=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function hA(e){if(hc(e),h_)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=hE[e[r]];return t}function hS(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function hI(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(h_)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,n=0;t<r;t++,n+=2){let r=hS(e.charCodeAt(n)),s=hS(e.charCodeAt(n+1));if(void 0===r||void 0===s)throw Error('hex string expected, got non-hex character "'+(e[n]+e[n+1])+'" at index '+n);i[t]=16*r+s}return i}function hk(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function hT(e){return"string"==typeof e&&(e=hk(e)),hc(e),e}function hx(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];hc(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}class hC{}function hP(e){let t=t=>e().update(hT(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function hO(e=32){if(ha&&"function"==typeof ha.getRandomValues)return ha.getRandomValues(new Uint8Array(e));if(ha&&"function"==typeof ha.randomBytes)return Uint8Array.from(ha.randomBytes(e));throw Error("crypto.getRandomValues must be defined")}let hR=BigInt(0),hN=BigInt(1),hM=BigInt(2),hU=BigInt(7),hD=BigInt(256),hj=BigInt(113),hL=[],hB=[],hW=[];for(let e=0,t=hN,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],hL.push(2*(5*i+r)),hB.push((e+1)*(e+2)/2%64);let n=hR;for(let e=0;e<7;e++)(t=(t<<hN^(t>>hU)*hj)%hD)&hM&&(n^=hN<<(hN<<BigInt(e))-hN);hW.push(n)}let hF=u2(hW,!0),hH=hF[0],hq=hF[1],hz=(e,t,r)=>r>32?t<<r-32|e>>>64-r:e<<r|t>>>32-r,h$=(e,t,r)=>r>32?e<<r-32|t>>>64-r:t<<r|e>>>32-r;class hK extends hC{constructor(e,t,r,i=!1,n=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=n,hl(r),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=hp(this.state)}clone(){return this._cloneInto()}keccak(){hv(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,n=(t+2)%10,s=r[n],a=r[n+1],o=hz(s,a,1)^r[i],l=h$(s,a,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=o,e[t+r+1]^=l}let t=e[2],n=e[3];for(let r=0;r<24;r++){let i=hB[r],s=hz(t,n,i),a=h$(t,n,i),o=hL[r];t=e[o],n=e[o+1],e[o]=s,e[o+1]=a}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=hH[i],e[1]^=hq[i]}hf(r)}(this.state32,this.rounds),hv(this.state32),this.posOut=0,this.pos=0}update(e){hu(this),hc(e=hT(e));let{blockLen:t,state:r}=this,i=e.length;for(let n=0;n<i;){let s=Math.min(t-this.pos,i-n);for(let t=0;t<s;t++)r[this.pos++]^=e[n++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){hu(this,!1),hc(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,n=e.length;i<n;){this.posOut>=r&&this.keccak();let s=Math.min(r-this.posOut,n-i);e.set(t.subarray(this.posOut,this.posOut+s),i),this.posOut+=s,i+=s}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return hl(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(hh(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,hf(this.state)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:n,enableXOF:s}=this;return e||(e=new hK(t,r,i,s,n)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=n,e.suffix=r,e.outputLen=i,e.enableXOF=s,e.destroyed=this.destroyed,e}}let hV=hP(()=>new hK(136,1,32));class hJ extends hC{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=hy(this.buffer)}update(e){hu(this),hc(e=hT(e));let{view:t,buffer:r,blockLen:i}=this,n=e.length;for(let s=0;s<n;){let a=Math.min(i-this.pos,n-s);if(a===i){let t=hy(e);for(;i<=n-s;s+=i)this.process(t,s);continue}r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){hu(this),hh(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:n}=this,{pos:s}=this;t[s++]=128,hf(this.buffer.subarray(s)),this.padOffset>i-s&&(this.process(r,0),s=0);for(let e=s;e<i;e++)t[e]=0;(function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),s=BigInt(0xffffffff),a=Number(r>>n&s),o=Number(r&s),l=4*!!i,c=4*!i;e.setUint32(t+l,a,i),e.setUint32(t+c,o,i)})(r,i-8,BigInt(8*this.length),n),this.process(r,0);let a=hy(e),o=this.outputLen;if(o%4)throw Error("_sha2: outputLen should be aligned to 32bit");let l=o/4,c=this.get();if(l>c.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<l;e++)a.setUint32(4*e,c[e],n)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:n,destroyed:s,pos:a}=this;return e.destroyed=s,e.finished=n,e.length=i,e.pos=a,i%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}let hZ=Uint32Array.from([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),hG=Uint32Array.from([0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]),hY=Uint32Array.from([0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179]),hQ=Uint32Array.from([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),hX=new Uint32Array(64);class h0 extends hJ{constructor(e=32){super(64,e,8,!1),this.A=0|hZ[0],this.B=0|hZ[1],this.C=0|hZ[2],this.D=0|hZ[3],this.E=0|hZ[4],this.F=0|hZ[5],this.G=0|hZ[6],this.H=0|hZ[7]}get(){let{A:e,B:t,C:r,D:i,E:n,F:s,G:a,H:o}=this;return[e,t,r,i,n,s,a,o]}set(e,t,r,i,n,s,a,o){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|n,this.F=0|s,this.G=0|a,this.H=0|o}process(e,t){for(let r=0;r<16;r++,t+=4)hX[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=hX[e-15],r=hX[e-2],i=hg(t,7)^hg(t,18)^t>>>3,n=hg(r,17)^hg(r,19)^r>>>10;hX[e]=n+hX[e-7]+i+hX[e-16]|0}let{A:r,B:i,C:n,D:s,E:a,F:o,G:l,H:c}=this;for(let e=0;e<64;e++){var d,u,h,p;let t=c+(hg(a,6)^hg(a,11)^hg(a,25))+((d=a)&o^~d&l)+hQ[e]+hX[e]|0,f=(hg(r,2)^hg(r,13)^hg(r,22))+((u=r)&(h=i)^u&(p=n)^h&p)|0;c=l,l=o,o=a,a=s+t|0,s=n,n=i,i=r,r=t+f|0}r=r+this.A|0,i=i+this.B|0,n=n+this.C|0,s=s+this.D|0,a=a+this.E|0,o=o+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(r,i,n,s,a,o,l,c)}roundClean(){hf(hX)}destroy(){this.set(0,0,0,0,0,0,0,0),hf(this.buffer)}}let h1=u2(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),h2=h1[0],h3=h1[1],h5=new Uint32Array(80),h8=new Uint32Array(80);class h6 extends hJ{constructor(e=64){super(128,e,16,!1),this.Ah=0|hY[0],this.Al=0|hY[1],this.Bh=0|hY[2],this.Bl=0|hY[3],this.Ch=0|hY[4],this.Cl=0|hY[5],this.Dh=0|hY[6],this.Dl=0|hY[7],this.Eh=0|hY[8],this.El=0|hY[9],this.Fh=0|hY[10],this.Fl=0|hY[11],this.Gh=0|hY[12],this.Gl=0|hY[13],this.Hh=0|hY[14],this.Hl=0|hY[15]}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:n,Cl:s,Dh:a,Dl:o,Eh:l,El:c,Fh:d,Fl:u,Gh:h,Gl:p,Hh:f,Hl:y}=this;return[e,t,r,i,n,s,a,o,l,c,d,u,h,p,f,y]}set(e,t,r,i,n,s,a,o,l,c,d,u,h,p,f,y){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|i,this.Ch=0|n,this.Cl=0|s,this.Dh=0|a,this.Dl=0|o,this.Eh=0|l,this.El=0|c,this.Fh=0|d,this.Fl=0|u,this.Gh=0|h,this.Gl=0|p,this.Hh=0|f,this.Hl=0|y}process(e,t){for(let r=0;r<16;r++,t+=4)h5[r]=e.getUint32(t),h8[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|h5[e-15],r=0|h8[e-15],i=u8(t,r,1)^u8(t,r,8)^u3(t,r,7),n=u6(t,r,1)^u6(t,r,8)^u5(t,r,7),s=0|h5[e-2],a=0|h8[e-2],o=u8(s,a,19)^u4(s,a,61)^u3(s,a,6),l=hr(n,u6(s,a,19)^u7(s,a,61)^u5(s,a,6),h8[e-7],h8[e-16]),c=hi(l,i,o,h5[e-7],h5[e-16]);h5[e]=0|c,h8[e]=0|l}let{Ah:r,Al:i,Bh:n,Bl:s,Ch:a,Cl:o,Dh:l,Dl:c,Eh:d,El:u,Fh:h,Fl:p,Gh:f,Gl:y,Hh:g,Hl:m}=this;for(let e=0;e<80;e++){let t=u8(d,u,14)^u8(d,u,18)^u4(d,u,41),w=u6(d,u,14)^u6(d,u,18)^u7(d,u,41),b=d&h^~d&f,v=hn(m,w,u&p^~u&y,h3[e],h8[e]),_=hs(v,g,t,b,h2[e],h5[e]),E=0|v,A=u8(r,i,28)^u4(r,i,34)^u4(r,i,39),S=u6(r,i,28)^u7(r,i,34)^u7(r,i,39),I=r&n^r&a^n&a,k=i&s^i&o^s&o;g=0|f,m=0|y,f=0|h,y=0|p,h=0|d,p=0|u,({h:d,l:u}=u9(0|l,0|c,0|_,0|E)),l=0|a,c=0|o,a=0|n,o=0|s,n=0|r,s=0|i;let T=he(E,S,k);r=ht(T,_,A,I),i=0|T}({h:r,l:i}=u9(0|this.Ah,0|this.Al,0|r,0|i)),({h:n,l:s}=u9(0|this.Bh,0|this.Bl,0|n,0|s)),({h:a,l:o}=u9(0|this.Ch,0|this.Cl,0|a,0|o)),({h:l,l:c}=u9(0|this.Dh,0|this.Dl,0|l,0|c)),({h:d,l:u}=u9(0|this.Eh,0|this.El,0|d,0|u)),({h,l:p}=u9(0|this.Fh,0|this.Fl,0|h,0|p)),({h:f,l:y}=u9(0|this.Gh,0|this.Gl,0|f,0|y)),({h:g,l:m}=u9(0|this.Hh,0|this.Hl,0|g,0|m)),this.set(r,i,n,s,a,o,l,c,d,u,h,p,f,y,g,m)}roundClean(){hf(h5,h8)}destroy(){hf(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class h4 extends h6{constructor(){super(48),this.Ah=0|hG[0],this.Al=0|hG[1],this.Bh=0|hG[2],this.Bl=0|hG[3],this.Ch=0|hG[4],this.Cl=0|hG[5],this.Dh=0|hG[6],this.Dl=0|hG[7],this.Eh=0|hG[8],this.El=0|hG[9],this.Fh=0|hG[10],this.Fl=0|hG[11],this.Gh=0|hG[12],this.Gl=0|hG[13],this.Hh=0|hG[14],this.Hl=0|hG[15]}}let h7=Uint32Array.from([0x22312194,0xfc2bf72c,0x9f555fa3,0xc84c64c2,0x2393b86b,0x6f53b151,0x96387719,0x5940eabd,0x96283ee2,0xa88effe3,0xbe5e1e25,0x53863992,0x2b0199fc,0x2c85b8aa,0xeb72ddc,0x81c52ca2]);class h9 extends h6{constructor(){super(32),this.Ah=0|h7[0],this.Al=0|h7[1],this.Bh=0|h7[2],this.Bl=0|h7[3],this.Ch=0|h7[4],this.Cl=0|h7[5],this.Dh=0|h7[6],this.Dl=0|h7[7],this.Eh=0|h7[8],this.El=0|h7[9],this.Fh=0|h7[10],this.Fl=0|h7[11],this.Gh=0|h7[12],this.Gl=0|h7[13],this.Hh=0|h7[14],this.Hl=0|h7[15]}}let pe=hP(()=>new h0),pt=hP(()=>new h6),pr=hP(()=>new h4),pi=hP(()=>new h9),pn=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),ps=Uint32Array.from([0xf3bcc908,0x6a09e667,0x84caa73b,0xbb67ae85,0xfe94f82b,0x3c6ef372,0x5f1d36f1,0xa54ff53a,0xade682d1,0x510e527f,0x2b3e6c1f,0x9b05688c,0xfb41bd6b,0x1f83d9ab,0x137e2179,0x5be0cd19]),pa=new Uint32Array(32);function po(e,t,r,i,n,s){let a=n[s],o=n[s+1],l=pa[2*e],c=pa[2*e+1],d=pa[2*t],u=pa[2*t+1],h=pa[2*r],p=pa[2*r+1],f=pa[2*i],y=pa[2*i+1],g=he(l,d,a);c=ht(g,c,u,o),l=0|g,({Dh:y,Dl:f}={Dh:y^c,Dl:f^l}),({Dh:y,Dl:f}={Dh:f,Dl:y}),({h:p,l:h}=u9(p,h,y,f)),({Bh:u,Bl:d}={Bh:u^p,Bl:d^h}),({Bh:u,Bl:d}={Bh:u8(u,d,24),Bl:u6(u,d,24)}),pa[2*e]=l,pa[2*e+1]=c,pa[2*t]=d,pa[2*t+1]=u,pa[2*r]=h,pa[2*r+1]=p,pa[2*i]=f,pa[2*i+1]=y}function pl(e,t,r,i,n,s){let a=n[s],o=n[s+1],l=pa[2*e],c=pa[2*e+1],d=pa[2*t],u=pa[2*t+1],h=pa[2*r],p=pa[2*r+1],f=pa[2*i],y=pa[2*i+1],g=he(l,d,a);c=ht(g,c,u,o),l=0|g,({Dh:y,Dl:f}={Dh:y^c,Dl:f^l}),({Dh:y,Dl:f}={Dh:u8(y,f,16),Dl:u6(y,f,16)}),({h:p,l:h}=u9(p,h,y,f)),({Bh:u,Bl:d}={Bh:u^p,Bl:d^h}),({Bh:u,Bl:d}={Bh:u4(u,d,63),Bl:u7(u,d,63)}),pa[2*e]=l,pa[2*e+1]=c,pa[2*t]=d,pa[2*t+1]=u,pa[2*r]=h,pa[2*r+1]=p,pa[2*i]=f,pa[2*i+1]=y}class pc extends hC{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,hl(e),hl(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=hp(this.buffer)}update(e){hu(this),hc(e=hT(e));let{blockLen:t,buffer:r,buffer32:i}=this,n=e.length,s=e.byteOffset,a=e.buffer;for(let o=0;o<n;){this.pos===t&&(hv(i),this.compress(i,0,!1),hv(i),this.pos=0);let l=Math.min(t-this.pos,n-o),c=s+o;if(l===t&&!(c%4)&&o+l<n){let e=new Uint32Array(a,c,Math.floor((n-o)/4));hv(e);for(let r=0;o+t<n;r+=i.length,o+=t)this.length+=t,this.compress(e,r,!1);hv(e);continue}r.set(e.subarray(o,o+l),this.pos),this.pos+=l,this.length+=l,o+=l}return this}digestInto(e){hu(this),hh(e,this);let{pos:t,buffer32:r}=this;this.finished=!0,hf(this.buffer.subarray(t)),hv(r),this.compress(r,0,!0),hv(r);let i=hp(e);this.get().forEach((e,t)=>i[t]=hb(e))}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){let{buffer:t,length:r,finished:i,destroyed:n,outputLen:s,pos:a}=this;return e||(e=new this.constructor({dkLen:s})),e.set(...this.get()),e.buffer.set(t),e.destroyed=n,e.finished=i,e.length=r,e.pos=a,e.outputLen=s,e}clone(){return this._cloneInto()}}class pd extends pc{constructor(e={}){const t=void 0===e.dkLen?64:e.dkLen;super(128,t),this.v0l=0|ps[0],this.v0h=0|ps[1],this.v1l=0|ps[2],this.v1h=0|ps[3],this.v2l=0|ps[4],this.v2h=0|ps[5],this.v3l=0|ps[6],this.v3h=0|ps[7],this.v4l=0|ps[8],this.v4h=0|ps[9],this.v5l=0|ps[10],this.v5h=0|ps[11],this.v6l=0|ps[12],this.v6h=0|ps[13],this.v7l=0|ps[14],this.v7h=0|ps[15],function(e,t={},r,i,n){if(hl(64),e<0||e>64)throw Error("outputLen bigger than keyLen");let{key:s,salt:a,personalization:o}=t;if(void 0!==s&&(s.length<1||s.length>64))throw Error("key length must be undefined or 1..64");if(void 0!==a&&16!==a.length)throw Error("salt must be undefined or 16");if(void 0!==o&&16!==o.length)throw Error("personalization must be undefined or 16")}(t,e,0,0,0);let{key:r,personalization:i,salt:n}=e,s=0;if(void 0!==r&&(s=(r=hT(r)).length),this.v0l^=this.outputLen|s<<8|0x1010000,void 0!==n){const e=hp(n=hT(n));this.v4l^=hb(e[0]),this.v4h^=hb(e[1]),this.v5l^=hb(e[2]),this.v5h^=hb(e[3])}if(void 0!==i){const e=hp(i=hT(i));this.v6l^=hb(e[0]),this.v6h^=hb(e[1]),this.v7l^=hb(e[2]),this.v7h^=hb(e[3])}if(void 0!==r){const e=new Uint8Array(this.blockLen);e.set(r),this.update(e)}}get(){let{v0l:e,v0h:t,v1l:r,v1h:i,v2l:n,v2h:s,v3l:a,v3h:o,v4l:l,v4h:c,v5l:d,v5h:u,v6l:h,v6h:p,v7l:f,v7h:y}=this;return[e,t,r,i,n,s,a,o,l,c,d,u,h,p,f,y]}set(e,t,r,i,n,s,a,o,l,c,d,u,h,p,f,y){this.v0l=0|e,this.v0h=0|t,this.v1l=0|r,this.v1h=0|i,this.v2l=0|n,this.v2h=0|s,this.v3l=0|a,this.v3h=0|o,this.v4l=0|l,this.v4h=0|c,this.v5l=0|d,this.v5h=0|u,this.v6l=0|h,this.v6h=0|p,this.v7l=0|f,this.v7h=0|y}compress(e,t,r){this.get().forEach((e,t)=>pa[t]=e),pa.set(ps,16);let{h:i,l:n}=u1(BigInt(this.length));pa[24]=ps[8]^n,pa[25]=ps[9]^i,r&&(pa[28]=~pa[28],pa[29]=~pa[29]);let s=0;for(let r=0;r<12;r++)po(0,4,8,12,e,t+2*pn[s++]),pl(0,4,8,12,e,t+2*pn[s++]),po(1,5,9,13,e,t+2*pn[s++]),pl(1,5,9,13,e,t+2*pn[s++]),po(2,6,10,14,e,t+2*pn[s++]),pl(2,6,10,14,e,t+2*pn[s++]),po(3,7,11,15,e,t+2*pn[s++]),pl(3,7,11,15,e,t+2*pn[s++]),po(0,5,10,15,e,t+2*pn[s++]),pl(0,5,10,15,e,t+2*pn[s++]),po(1,6,11,12,e,t+2*pn[s++]),pl(1,6,11,12,e,t+2*pn[s++]),po(2,7,8,13,e,t+2*pn[s++]),pl(2,7,8,13,e,t+2*pn[s++]),po(3,4,9,14,e,t+2*pn[s++]),pl(3,4,9,14,e,t+2*pn[s++]);this.v0l^=pa[0]^pa[16],this.v0h^=pa[1]^pa[17],this.v1l^=pa[2]^pa[18],this.v1h^=pa[3]^pa[19],this.v2l^=pa[4]^pa[20],this.v2h^=pa[5]^pa[21],this.v3l^=pa[6]^pa[22],this.v3h^=pa[7]^pa[23],this.v4l^=pa[8]^pa[24],this.v4h^=pa[9]^pa[25],this.v5l^=pa[10]^pa[26],this.v5h^=pa[11]^pa[27],this.v6l^=pa[12]^pa[28],this.v6h^=pa[13]^pa[29],this.v7l^=pa[14]^pa[30],this.v7h^=pa[15]^pa[31],hf(pa)}destroy(){this.destroyed=!0,hf(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}let pu=(Cb=e=>new pd(e),(U=(e,t)=>Cb(t).update(hT(e)).digest()).outputLen=(D=Cb({})).outputLen,U.blockLen=D.blockLen,U.create=e=>Cb(e),U);function ph(e){let t=`Ethereum Signed Message:
${e.length}`,r=new TextEncoder().encode(t+e);return"0x"+t6.Buffer.from(hV(r)).toString("hex")}async function pp(e,t,r,i,n,s){switch(r.t){case"eip191":var a,o,l;let c;return await (a=e,o=t,l=r.s,c=dv.fromHex(l),dJ.recoverAddress({payload:ph(o),signature:c}).toLowerCase()===a.toLowerCase());case"eip1271":return await pf(e,t,r.s,i,n,s);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function pf(e,t,r,i,n,s){let a=up(i);if(!a.namespace||!a.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{let a="0x1626ba7e",o=r.substring(2),l=(o.length/2).toString(16).padStart(64,"0"),c=(t.startsWith("0x")?t:ph(t)).substring(2),d=a+c+"0000000000000000000000000000000000000000000000000000000000000040"+l+o,u=await fetch(`${s||"https://rpc.walletconnect.org/v1"}/?chainId=${i}&projectId=${n}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:d},"latest"]})}),{result:h}=await u.json();return!!h&&h.slice(0,a.length).toLowerCase()===a.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}function py(e){let t=new Uint8Array(pe(function(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);if("object"==typeof e&&null!=e&&e.data)return new Uint8Array(Object.values(e.data));if("object"==typeof e&&e)return new Uint8Array(Object.values(e));throw Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}(e)));return dZ.default.encode(t)}function pg(e){let t=t6.Buffer.from(e,"base64"),r=(0,dG.decode)(t).txn;if(!r)throw Error("Invalid signed transaction: missing 'txn' field");let i=(0,dY.encode)(r),n=t6.Buffer.from("TX"),s=pi(t6.Buffer.concat([n,t6.Buffer.from(i)]));return sH.base32.encode(s).replace(/=+$/,"")}function pm(e){let t=[],r=BigInt(e);for(;r>=BigInt(128);)t.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return t.push(Number(r)),t6.Buffer.from(t)}var pw=Object.defineProperty,pb=Object.defineProperties,pv=Object.getOwnPropertyDescriptors,p_=Object.getOwnPropertySymbols,pE=Object.prototype.hasOwnProperty,pA=Object.prototype.propertyIsEnumerable,pS=(e,t,r)=>t in e?pw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;let pI=e=>e?.split(":"),pk=e=>{let t=e&&pI(e);if(t)return t[2]+":"+t[3]},pT=e=>{let t=e&&pI(e);if(t)return t.pop()};async function px(e){let{cacao:t,projectId:r}=e,{s:i,p:n}=t,s=pC(n,n.iss),a=pT(n.iss);return await pp(a,s,i,pk(n.iss),r)}let pC=(e,t)=>{let r=`${e.domain} wants you to sign in with your Ethereum account:`,i=pT(t);if(!e.aud&&!e.uri)throw Error("Either `aud` or `uri` is required to construct the message");let n=e.statement||void 0,s=`URI: ${e.aud||e.uri}`,a=`Version: ${e.version}`,o=`Chain ID: ${(e=>{let t=e&&pI(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]})(t)}`,l=`Nonce: ${e.nonce}`,c=`Issued At: ${e.iat}`,d=e.exp?`Expiration Time: ${e.exp}`:void 0,u=e.nbf?`Not Before: ${e.nbf}`:void 0,h=e.requestId?`Request ID: ${e.requestId}`:void 0,p=e.resources?`Resources:${e.resources.map(e=>`
- ${e}`).join("")}`:void 0,f=pU(e.resources);return f&&(n=function(e="",t){pP(t);let r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;let i=[],n=0;Object.keys(t.att).forEach(e=>{let r=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));r.sort((e,t)=>e.action.localeCompare(t.action));let s={};r.forEach(e=>{s[e.ability]||(s[e.ability]=[]),s[e.ability].push(e.action)});let a=Object.keys(s).map(t=>(n++,`(${n}) '${t}': '${s[t].join("', '")}' for '${e}'.`));i.push(a.join(", ").replace(".,","."))});let s=i.join(" "),a=`${r}${s}`;return`${e?e+" ":""}${a}`}(n,pR(f))),[r,i,"",n,"",s,a,o,l,c,d,u,h,p].filter(e=>null!=e).join(`
`)};function pP(e){if(!e)throw Error("No recap provided, value is undefined");if(!e.att)throw Error("No `att` property found");let t=Object.keys(e.att);if(!(null!=t&&t.length))throw Error("No resources found in `att` property");t.forEach(t=>{let r=e.att[t];if(Array.isArray(r)||"object"!=typeof r)throw Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(e=>{let t=r[e];if(!Array.isArray(t))throw Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function pO(e){return pP(e),`urn:recap:${t6.Buffer.from(JSON.stringify(e)).toString("base64").replace(/=/g,"")}`}function pR(e){var t;let r=(t=e.replace("urn:recap:",""),JSON.parse(t6.Buffer.from(t,"base64").toString("utf-8")));return pP(r),r}function pN(e){var t;let r=pR(e);pP(r);let i=null==(t=r.att)?void 0:t.eip155;return i?Object.keys(i).map(e=>e.split("/")[1]):[]}function pM(e){let t=pR(e);pP(t);let r=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&r.push(e[0].chains)})}),[...new Set(r.flat())]}function pU(e){if(!e)return;let t=e?.[e.length-1];return t&&t.includes("urn:recap:")?t:void 0}function pD(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function pj(e){if("boolean"!=typeof e)throw Error(`boolean expected, not ${e}`)}function pL(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function pB(e,...t){if(!pD(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function pW(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function pF(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function pH(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}let pq=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function pz(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(pD(e))e=pV(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function p$(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&t.byteOffset%4!=0)throw Error("invalid output, must be aligned");return t}function pK(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),s=BigInt(0xffffffff),a=Number(r>>n&s),o=Number(r&s),l=4*!!i,c=4*!i;e.setUint32(t+l,a,i),e.setUint32(t+c,o,i)}function pV(e){return Uint8Array.from(e)}let pJ=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),pZ=pJ("expand 16-byte k"),pG=pJ("expand 32-byte k"),pY=pF(pZ),pQ=pF(pG);function pX(e,t){return e<<t|e>>>32-t}function p0(e){return e.byteOffset%4==0}let p1=0x100000000-1,p2=new Uint32Array,p3=(e,t)=>255&e[t++]|(255&e[t++])<<8;class p5{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,pB(e=pz(e),32);const t=p3(e,0),r=p3(e,2),i=p3(e,4),n=p3(e,6),s=p3(e,8),a=p3(e,10),o=p3(e,12),l=p3(e,14);this.r[0]=8191&t,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|n<<9)&8191,this.r[4]=(n>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|a<<2)&8191,this.r[7]=(a>>>11|o<<5)&8065,this.r[8]=(o>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let t=0;t<8;t++)this.pad[t]=p3(e,16+2*t)}process(e,t,r=!1){let{h:i,r:n}=this,s=n[0],a=n[1],o=n[2],l=n[3],c=n[4],d=n[5],u=n[6],h=n[7],p=n[8],f=n[9],y=p3(e,t+0),g=p3(e,t+2),m=p3(e,t+4),w=p3(e,t+6),b=p3(e,t+8),v=p3(e,t+10),_=p3(e,t+12),E=p3(e,t+14),A=i[0]+(8191&y),S=i[1]+((y>>>13|g<<3)&8191),I=i[2]+((g>>>10|m<<6)&8191),k=i[3]+((m>>>7|w<<9)&8191),T=i[4]+((w>>>4|b<<12)&8191),x=i[5]+(b>>>1&8191),C=i[6]+((b>>>14|v<<2)&8191),P=i[7]+((v>>>11|_<<5)&8191),O=i[8]+((_>>>8|E<<8)&8191),R=i[9]+(E>>>5|2048*!r),N=0,M=0+A*s+5*f*S+5*p*I+5*h*k+5*u*T;N=M>>>13,M&=8191,M+=5*d*x+5*c*C+5*l*P+5*o*O+5*a*R,N+=M>>>13,M&=8191;let U=N+A*a+S*s+5*f*I+5*p*k+5*h*T;N=U>>>13,U&=8191,U+=5*u*x+5*d*C+5*c*P+5*l*O+5*o*R,N+=U>>>13,U&=8191;let D=N+A*o+S*a+I*s+5*f*k+5*p*T;N=D>>>13,D&=8191,D+=5*h*x+5*u*C+5*d*P+5*c*O+5*l*R,N+=D>>>13,D&=8191;let j=N+A*l+S*o+I*a+k*s+5*f*T;N=j>>>13,j&=8191,j+=5*p*x+5*h*C+5*u*P+5*d*O+5*c*R,N+=j>>>13,j&=8191;let L=N+A*c+S*l+I*o+k*a+T*s;N=L>>>13,L&=8191,L+=5*f*x+5*p*C+5*h*P+5*u*O+5*d*R,N+=L>>>13,L&=8191;let B=N+A*d+S*c+I*l+k*o+T*a;N=B>>>13,B&=8191,B+=x*s+5*f*C+5*p*P+5*h*O+5*u*R,N+=B>>>13,B&=8191;let W=N+A*u+S*d+I*c+k*l+T*o;N=W>>>13,W&=8191,W+=x*a+C*s+5*f*P+5*p*O+5*h*R,N+=W>>>13,W&=8191;let F=N+A*h+S*u+I*d+k*c+T*l;N=F>>>13,F&=8191,F+=x*o+C*a+P*s+5*f*O+5*p*R,N+=F>>>13,F&=8191;let H=N+A*p+S*h+I*u+k*d+T*c;N=H>>>13,H&=8191,H+=x*l+C*o+P*a+O*s+5*f*R,N+=H>>>13,H&=8191;let q=N+A*f+S*p+I*h+k*u+T*d;N=q>>>13,q&=8191,q+=x*c+C*l+P*o+O*a+R*s,N+=q>>>13,q&=8191,M=8191&(N=(N=(N<<2)+N|0)+M|0),N>>>=13,U+=N,i[0]=M,i[1]=U,i[2]=D,i[3]=j,i[4]=L,i[5]=B,i[6]=W,i[7]=F,i[8]=H,i[9]=q}finalize(){let{h:e,pad:t}=this,r=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=i,i=e[t]>>>13,e[t]&=8191;e[0]+=5*i,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+i,i=r[t]>>>13,r[t]&=8191;r[9]-=8192;let n=(1^i)-1;for(let e=0;e<10;e++)r[e]&=n;n=~n;for(let t=0;t<10;t++)e[t]=e[t]&n|r[t];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let s=e[0]+t[0];e[0]=65535&s;for(let r=1;r<8;r++)s=(e[r]+t[r]|0)+(s>>>16)|0,e[r]=65535&s;pH(r)}update(e){pW(this),pB(e=pz(e));let{buffer:t,blockLen:r}=this,i=e.length;for(let n=0;n<i;){let s=Math.min(r-this.pos,i-n);if(s===r){for(;r<=i-n;n+=r)this.process(e,n);continue}t.set(e.subarray(n,n+s),this.pos),this.pos+=s,n+=s,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){pH(this.h,this.r,this.buffer,this.pad)}digestInto(e){pW(this),function(e,t){pB(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;let{buffer:t,h:r}=this,{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let n=0;for(let t=0;t<8;t++)e[n++]=r[t]>>>0,e[n++]=r[t]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}}let p8=(Cv=e=>new p5(e),(j=(e,t)=>Cv(t).update(pz(e)).digest()).outputLen=(L=Cv(new Uint8Array(32))).outputLen,j.blockLen=L.blockLen,j.create=e=>Cv(e),j),p6=function(e,t){let{allowShortKeys:r,extendNonceFn:i,counterLength:n,counterRight:s,rounds:a}=function(e,t){if(null==t||"object"!=typeof t)throw Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw Error("core must be a function");return pL(n),pL(a),pj(s),pj(r),(t,o,l,c,d=0)=>{pB(t),pB(o),pB(l);let u=l.length;if(void 0===c&&(c=new Uint8Array(u)),pB(c),pL(d),d<0||d>=p1)throw Error("arx: counter overflow");if(c.length<u)throw Error(`arx: output (${c.length}) is shorter than data (${u})`);let h=[],p=t.length,f,y;if(32===p)h.push(f=pV(t)),y=pQ;else if(16===p&&r)(f=new Uint8Array(32)).set(t),f.set(t,16),y=pY,h.push(f);else throw Error(`arx: invalid 32-byte key, got length=${p}`);p0(o)||h.push(o=pV(o));let g=pF(f);if(i){if(24!==o.length)throw Error("arx: extended nonce must be 24 bytes");i(y,g,pF(o.subarray(0,16)),g),o=o.subarray(16)}let m=16-n;if(m!==o.length)throw Error(`arx: nonce must be ${m} or 16 bytes`);if(12!==m){let e=new Uint8Array(12);e.set(o,s?0:12-o.length),o=e,h.push(o)}return function(e,t,r,i,n,s,a,o){let l=n.length,c=new Uint8Array(64),d=pF(c),u=p0(n)&&p0(s),h=u?pF(n):p2,p=u?pF(s):p2;for(let f=0;f<l;a++){if(e(t,r,i,d,a,o),a>=p1)throw Error("arx: counter overflow");let y=Math.min(64,l-f);if(u&&64===y){let e=f/4;if(f%4!=0)throw Error("arx: invalid block position");for(let t=0,r;t<16;t++)p[r=e+t]=h[r]^d[t];f+=64;continue}for(let e=0,t;e<y;e++)s[t=f+e]=n[t]^c[e];f+=y}}(e,y,g,pF(o),l,c,d,a),pH(...h),c}}(function(e,t,r,i,n,s=20){let a=e[0],o=e[1],l=e[2],c=e[3],d=t[0],u=t[1],h=t[2],p=t[3],f=t[4],y=t[5],g=t[6],m=t[7],w=r[0],b=r[1],v=r[2],_=a,E=o,A=l,S=c,I=d,k=u,T=h,x=p,C=f,P=y,O=g,R=m,N=n,M=w,U=b,D=v;for(let e=0;e<s;e+=2)C=C+(N=pX(N^(_=_+I|0),16))|0,_=_+(I=pX(I^C,12))|0,C=C+(N=pX(N^_,8))|0,I=pX(I^C,7),P=P+(M=pX(M^(E=E+k|0),16))|0,E=E+(k=pX(k^P,12))|0,P=P+(M=pX(M^E,8))|0,k=pX(k^P,7),O=O+(U=pX(U^(A=A+T|0),16))|0,A=A+(T=pX(T^O,12))|0,O=O+(U=pX(U^A,8))|0,T=pX(T^O,7),R=R+(D=pX(D^(S=S+x|0),16))|0,S=S+(x=pX(x^R,12))|0,R=R+(D=pX(D^S,8))|0,x=pX(x^R,7),O=O+(D=pX(D^(_=_+k|0),16))|0,_=_+(k=pX(k^O,12))|0,O=O+(D=pX(D^_,8))|0,k=pX(k^O,7),R=R+(N=pX(N^(E=E+T|0),16))|0,E=E+(T=pX(T^R,12))|0,R=R+(N=pX(N^E,8))|0,T=pX(T^R,7),C=C+(M=pX(M^(A=A+x|0),16))|0,A=A+(x=pX(x^C,12))|0,C=C+(M=pX(M^A,8))|0,x=pX(x^C,7),P=P+(U=pX(U^(S=S+I|0),16))|0,S=S+(I=pX(I^P,12))|0,P=P+(U=pX(U^S,8))|0,I=pX(I^P,7);let j=0;i[j++]=a+_|0,i[j++]=o+E|0,i[j++]=l+A|0,i[j++]=c+S|0,i[j++]=d+I|0,i[j++]=u+k|0,i[j++]=h+T|0,i[j++]=p+x|0,i[j++]=f+C|0,i[j++]=y+P|0,i[j++]=g+O|0,i[j++]=m+R|0,i[j++]=n+N|0,i[j++]=w+M|0,i[j++]=b+U|0,i[j++]=v+D|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),p4=new Uint8Array(16),p7=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(p4.subarray(r))},p9=new Uint8Array(32);function fe(e,t,r,i,n){var s,a;let o,l,c=e(t,r,p9),d=p8.create(c);n&&p7(d,n),p7(d,i);let u=(s=i.length,a=n?n.length:0,pj(!0),pK(l=new DataView((o=new Uint8Array(16)).buffer,o.byteOffset,o.byteLength),0,BigInt(a),!0),pK(l,8,BigInt(s),!0),o);d.update(u);let h=d.digest();return pH(c,u),h}let ft=((e,t)=>{function r(i,...n){if(pB(i),!pq)throw Error("Non little-endian hardware is not yet supported");if(void 0!==e.nonceLength){let t=n[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?pB(t):pB(t,e.nonceLength)}let s=e.tagLength;s&&void 0!==n[1]&&pB(n[1]);let a=t(i,...n),o=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");pB(t)}},l=!1;return{encrypt(e,t){if(l)throw Error("cannot encrypt() twice with same key + nonce");return l=!0,pB(e),o(a.encrypt.length,t),a.encrypt(e,t)},decrypt(e,t){if(pB(e),s&&e.length<s)throw Error("invalid ciphertext length: smaller than tagLength="+s);return o(a.decrypt.length,t),a.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:64,nonceLength:12,tagLength:16},(e,t,r)=>({encrypt(i,n){let s=i.length;(n=p$(s+16,n,!1)).set(i);let a=n.subarray(0,-16);p6(e,t,a,a,1);let o=fe(p6,e,t,a,r);return n.set(o,s),pH(o),n},decrypt(i,n){n=p$(i.length-16,n,!1);let s=i.subarray(0,-16),a=i.subarray(-16),o=fe(p6,e,t,s,r);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}(a,o))throw Error("invalid tag");return n.set(i.subarray(0,-16)),p6(e,t,n,n,1),pH(o),n}}));class fr extends hC{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,hd(e);const r=hT(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,n=new Uint8Array(i);n.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<n.length;e++)n[e]^=54;this.iHash.update(n),this.oHash=e.create();for(let e=0;e<n.length;e++)n[e]^=106;this.oHash.update(n),hf(n)}update(e){return hu(this),this.iHash.update(e),this}digestInto(e){hu(this),hc(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:n,blockLen:s,outputLen:a}=this;return e.finished=i,e.destroyed=n,e.blockLen=s,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let fi=(e,t,r)=>new fr(e,t).update(r).digest();fi.create=(e,t)=>new fr(e,t);let fn=Uint8Array.from([0]),fs=Uint8Array.of(),fa=BigInt(0),fo=BigInt(1);function fl(e,t=""){if("boolean"!=typeof e)throw Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e);return e}function fc(e,t,r=""){let i=ho(e),n=e?.length,s=void 0!==t;if(!i||s&&n!==t)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(s?` of length ${t}`:"")+", got "+(i?`length=${n}`:`type=${typeof e}`));return e}function fd(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function fu(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?fa:BigInt("0x"+e)}function fh(e){return hc(e),fu(hA(Uint8Array.from(e).reverse()))}function fp(e,t){return hI(e.toString(16).padStart(2*t,"0"))}function ff(e,t){return fp(e,t).reverse()}function fy(e,t,r){let i;if("string"==typeof t)try{i=hI(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(ho(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let n=i.length;if("number"==typeof r&&n!==r)throw Error(e+" of length "+r+" expected, got "+n);return i}let fg=e=>"bigint"==typeof e&&fa<=e;function fm(e,t,r,i){if(!(fg(t)&&fg(r)&&fg(i))||!(r<=t)||!(t<i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}function fw(e){let t;for(t=0;e>fa;e>>=fo,t+=1);return t}let fb=e=>(fo<<BigInt(e))-fo;function fv(e,t,r={}){if(!e||"object"!=typeof e)throw Error("expected valid options object");function i(t,r,i){let n=e[t];if(i&&void 0===n)return;let s=typeof n;if(s!==r||null===n)throw Error(`param "${t}" is invalid: expected ${r}, got ${s}`)}Object.entries(t).forEach(([e,t])=>i(e,t,!1)),Object.entries(r).forEach(([e,t])=>i(e,t,!0))}function f_(e){let t=new WeakMap;return(r,...i)=>{let n=t.get(r);if(void 0!==n)return n;let s=e(r,...i);return t.set(r,s),s}}let fE=BigInt(0),fA=BigInt(1),fS=BigInt(2),fI=BigInt(3),fk=BigInt(4),fT=BigInt(5),fx=BigInt(7),fC=BigInt(8),fP=BigInt(9),fO=BigInt(16);function fR(e,t){let r=e%t;return r>=fE?r:t+r}function fN(e,t,r){let i=e;for(;t-- >fE;)i*=i,i%=r;return i}function fM(e,t){if(e===fE)throw Error("invert: expected non-zero number");if(t<=fE)throw Error("invert: expected positive modulus, got "+t);let r=fR(e,t),i=t,n=fE,s=fA;for(;r!==fE;){let e=i/r,t=i%r,a=n-s*e;i=r,r=t,n=s,s=a}if(i!==fA)throw Error("invert: does not exist");return fR(n,t)}function fU(e,t,r){if(!e.eql(e.sqr(t),r))throw Error("Cannot find square root")}function fD(e,t){let r=(e.ORDER+fA)/fk,i=e.pow(t,r);return fU(e,i,t),i}function fj(e,t){let r=(e.ORDER-fT)/fC,i=e.mul(t,fS),n=e.pow(i,r),s=e.mul(t,n),a=e.mul(e.mul(s,fS),n),o=e.mul(s,e.sub(a,e.ONE));return fU(e,o,t),o}function fL(e){if(e<fI)throw Error("sqrt is not defined for small field");let t=e-fA,r=0;for(;t%fS===fE;)t/=fS,r++;let i=fS,n=fq(e);for(;1===fF(n,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return fD;let s=n.pow(i,t),a=(t+fA)/fS;return function(e,i){if(e.is0(i))return i;if(1!==fF(e,i))throw Error("Cannot find square root");let n=r,o=e.mul(e.ONE,s),l=e.pow(i,t),c=e.pow(i,a);for(;!e.eql(l,e.ONE);){if(e.is0(l))return e.ZERO;let t=1,r=e.sqr(l);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===n)throw Error("Cannot find square root");let i=fA<<BigInt(n-t-1),s=e.pow(o,i);n=t,o=e.sqr(s),l=e.mul(l,o),c=e.mul(c,s)}return c}}let fB=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function fW(e,t,r=!1){let i=Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((t,r,n)=>e.is0(r)?t:(i[n]=t,e.mul(t,r)),e.ONE),s=e.inv(n);return t.reduceRight((t,r,n)=>e.is0(r)?t:(i[n]=e.mul(t,i[n]),e.mul(t,r)),s),i}function fF(e,t){let r=(e.ORDER-fA)/fS,i=e.pow(t,r),n=e.eql(i,e.ONE),s=e.eql(i,e.ZERO),a=e.eql(i,e.neg(e.ONE));if(!n&&!s&&!a)throw Error("invalid Legendre symbol result");return n?1:s?0:-1}function fH(e,t){void 0!==t&&hl(t);let r=void 0!==t?t:e.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function fq(e,t,r=!1,i={}){let n;if(e<=fE)throw Error("invalid field: expected ORDER > 0, got "+e);let s,a,o=!1,l;if("object"==typeof t&&null!=t){if(i.sqrt||r)throw Error("cannot specify opts in two arguments");t.BITS&&(s=t.BITS),t.sqrt&&(a=t.sqrt),"boolean"==typeof t.isLE&&(r=t.isLE),"boolean"==typeof t.modFromBytes&&(o=t.modFromBytes),l=t.allowedLengths}else"number"==typeof t&&(s=t),i.sqrt&&(a=i.sqrt);let{nBitLength:c,nByteLength:d}=fH(e,s);if(d>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let u=Object.freeze({ORDER:e,isLE:r,BITS:c,BYTES:d,MASK:fb(c),ZERO:fE,ONE:fA,allowedLengths:l,create:t=>fR(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return fE<=t&&t<e},is0:e=>e===fE,isValidNot0:e=>!u.is0(e)&&u.isValid(e),isOdd:e=>(e&fA)===fA,neg:t=>fR(-t,e),eql:(e,t)=>e===t,sqr:t=>fR(t*t,e),add:(t,r)=>fR(t+r,e),sub:(t,r)=>fR(t-r,e),mul:(t,r)=>fR(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<fE)throw Error("invalid exponent, negatives unsupported");if(r===fE)return e.ONE;if(r===fA)return t;let i=e.ONE,n=t;for(;r>fE;)r&fA&&(i=e.mul(i,n)),n=e.sqr(n),r>>=fA;return i})(u,e,t),div:(t,r)=>fR(t*fM(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>fM(t,e),sqrt:a||(t=>{let r,i,s,a,o,l;return n||(n=e%fk===fI?fD:e%fC===fT?fj:e%fO===fP?(r=fq(e),s=(i=fL(e))(r,r.neg(r.ONE)),a=i(r,s),o=i(r,r.neg(s)),l=(e+fx)/fO,(e,t)=>{let r=e.pow(t,l),i=e.mul(r,s),n=e.mul(r,a),c=e.mul(r,o),d=e.eql(e.sqr(i),t),u=e.eql(e.sqr(n),t);r=e.cmov(r,i,d),i=e.cmov(c,n,u);let h=e.eql(e.sqr(i),t),p=e.cmov(r,i,h);return fU(e,p,t),p}):fL(e)),n(u,t)}),toBytes:e=>r?ff(e,d):fp(e,d),fromBytes:(t,i=!0)=>{if(l){if(!l.includes(t.length)||t.length>d)throw Error("Field.fromBytes: expected "+l+" bytes, got "+t.length);let e=new Uint8Array(d);e.set(t,r?0:e.length-t.length),t=e}if(t.length!==d)throw Error("Field.fromBytes: expected "+d+" bytes, got "+t.length);let n=r?fh(t):fu(hA(t));if(o&&(n=fR(n,e)),!i&&!u.isValid(n))throw Error("invalid field element: outside of range 0..ORDER");return n},invertBatch:e=>fW(u,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(u)}function fz(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function f$(e){let t=fz(e);return t+Math.ceil(t/2)}let fK=BigInt(0),fV=BigInt(1);function fJ(e,t){let r=t.negate();return e?r:t}function fZ(e,t){let r=fW(e.Fp,t.map(e=>e.Z));return t.map((t,i)=>e.fromAffine(t.toAffine(r[i])))}function fG(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function fY(e,t){fG(e,t);let r=Math.ceil(t/e)+1,i=2**(e-1),n=2**e;return{windows:r,windowSize:i,mask:fb(e),maxNumber:n,shiftBy:BigInt(e)}}function fQ(e,t,r){let{windowSize:i,mask:n,maxNumber:s,shiftBy:a}=r,o=Number(e&n),l=e>>a;o>i&&(o-=s,l+=fV);let c=t*i;return{nextN:l,offset:c+Math.abs(o)-1,isZero:0===o,isNeg:o<0,isNegF:t%2!=0,offsetF:c}}let fX=new WeakMap,f0=new WeakMap;function f1(e){return f0.get(e)||1}function f2(e){if(e!==fK)throw Error("invalid wNAF")}class f3{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,r=this.ZERO){let i=e;for(;t>fK;)t&fV&&(r=r.add(i)),i=i.double(),t>>=fV;return r}precomputeWindow(e,t){let{windows:r,windowSize:i}=fY(t,this.bits),n=[],s=e,a=s;for(let e=0;e<r;e++){a=s,n.push(a);for(let e=1;e<i;e++)a=a.add(s),n.push(a);s=a.double()}return n}wNAF(e,t,r){if(!this.Fn.isValid(r))throw Error("invalid scalar");let i=this.ZERO,n=this.BASE,s=fY(e,this.bits);for(let e=0;e<s.windows;e++){let{nextN:a,offset:o,isZero:l,isNeg:c,isNegF:d,offsetF:u}=fQ(r,e,s);r=a,l?n=n.add(fJ(d,t[u])):i=i.add(fJ(c,t[o]))}return f2(r),{p:i,f:n}}wNAFUnsafe(e,t,r,i=this.ZERO){let n=fY(e,this.bits);for(let e=0;e<n.windows&&r!==fK;e++){let{nextN:s,offset:a,isZero:o,isNeg:l}=fQ(r,e,n);if(r=s,!o){let e=t[a];i=i.add(l?e.negate():e)}}return f2(r),i}getPrecomputes(e,t,r){let i=fX.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(i=r(i)),fX.set(t,i))),i}cached(e,t,r){let i=f1(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)}unsafe(e,t,r,i){let n=f1(e);return 1===n?this._unsafeLadder(e,t,i):this.wNAFUnsafe(n,this.getPrecomputes(n,e,r),t,i)}createCache(e,t){fG(t,this.bits),f0.set(e,t),fX.delete(e)}hasCache(e){return 1!==f1(e)}}function f5(e,t,r){if(!t)return fq(e,{isLE:r});if(t.ORDER!==e)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return fv(t,fB.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),t}BigInt(0),BigInt(1),BigInt(2),BigInt(8),hk("HashToScalar-");let f8=BigInt(0),f6=BigInt(1),f4=BigInt(2),f7=BigInt(1),f9=BigInt(2),ye=BigInt(3),yt=BigInt(5),yr=BigInt(8),yi=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),yn={p:yi,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:yr,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")},ys=function(e){let{P:t,type:r,adjustScalarBytes:i,powPminus2:n,randomBytes:s}=(fv(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})),a="x25519"===r;if(!a&&"x448"!==r)throw Error("invalid type");let o=s||hO,l=a?255:448,c=a?32:56,d=BigInt(a?9:5),u=BigInt(a?121665:39081),h=a?f4**BigInt(254):f4**BigInt(447),p=h+(a?BigInt(8)*f4**BigInt(251)-f6:BigInt(4)*f4**BigInt(445)-f6)+f6,f=e=>fR(e,t),y=ff(f(d),c);function g(e,r){let s,o=function(e,r){fm("u",e,f8,t),fm("scalar",r,h,p);let i=f6,s=f8,a=e,o=f6,c=f8;for(let t=BigInt(l-1);t>=f8;t--){let n=r>>t&f6;c^=n,({x_2:i,x_3:a}=w(c,i,a)),({x_2:s,x_3:o}=w(c,s,o)),c=n;let l=i+s,d=f(l*l),h=i-s,p=f(h*h),y=d-p,g=a+o,m=f((a-o)*l),b=f(g*h),v=m+b,_=m-b;a=f(v*v),o=f(e*f(_*_)),i=f(d*p),s=f(y*(d+f(u*y)))}return{x_2:i,x_3:a}=w(c,i,a),{x_2:s,x_3:o}=w(c,s,o),f(i*n(s))}((s=fy("u coordinate",r,c),a&&(s[31]&=127),f(fh(s))),fh(i(fy("scalar",e,c))));if(o===f8)throw Error("invalid private or public key received");return ff(f(o),c)}function m(e){return g(e,y)}function w(e,t,r){let i=f(e*(t-r));return{x_2:t=f(t-i),x_3:r=f(r+i)}}let b={secretKey:c,publicKey:c,seed:c},v=(e=o(c))=>(hc(e,b.seed),e);return{keygen:function(e){let t=v(e);return{secretKey:t,publicKey:m(t)}},getSharedSecret:(e,t)=>g(e,t),getPublicKey:e=>m(e),scalarMult:g,scalarMultBase:m,utils:{randomSecretKey:v,randomPrivateKey:v},GuBytes:y.slice(),lengths:b}}({P:B=fq(yn.p,{isLE:!0}).ORDER,type:"x25519",powPminus2:e=>{let t,r,i,n,s,a,o,l,c,d,u,h,p,f,{pow_p_5_8:y,b2:g}=(t=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),a=fN(s=e*e%yi*e%yi,f9,yi)*s%yi,o=fN(a,f7,yi)*e%yi,l=fN(o,yt,yi)*o%yi,c=fN(l,t,yi)*l%yi,d=fN(c,r,yi)*c%yi,u=fN(d,i,yi)*d%yi,h=fN(u,n,yi)*u%yi,p=fN(h,n,yi)*u%yi,f=fN(p,t,yi)*l%yi,{pow_p_5_8:fN(f,f9,yi)*e%yi,b2:s});return fR(fN(y,ye,B)*g,B)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}}),ya=(e,t)=>(e+(e>=0?t:-t)/yh)/t;function yo(e){if(!["compact","recovered","der"].includes(e))throw Error('Signature format must be "compact", "recovered", or "der"');return e}function yl(e,t){let r={};for(let i of Object.keys(t))r[i]=void 0===e[i]?t[i]:e[i];return fl(r.lowS,"lowS"),fl(r.prehash,"prehash"),void 0!==r.format&&yo(r.format),r}let yc={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{let{Err:r}=yc;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,n=fd(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let s=i>127?fd(n.length/2|128):"";return fd(e)+s+n+t},decode(e,t){let{Err:r}=yc,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let n=t[i++],s=0;if(128&n){let e=127&n;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let a=t.subarray(i,i+e);if(a.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===a[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of a)s=s<<8|e;if(i+=e,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=n;let a=t.subarray(i,i+s);if(a.length!==s)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(i+s)}}},_int:{encode(e){let{Err:t}=yc;if(e<yd)throw new t("integer: negative integers are not allowed");let r=fd(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=yc;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return fu(hA(e))}},toSig(e){let{Err:t,_int:r,_tlv:i}=yc,n=fy("signature",e),{v:s,l:a}=i.decode(48,n);if(a.length)throw new t("invalid signature: left bytes after parsing");let{v:o,l:l}=i.decode(2,s),{v:c,l:d}=i.decode(2,l);if(d.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(o),s:r.decode(c)}},hexFromSig(e){let{_tlv:t,_int:r}=yc,i=t.encode(2,r.encode(e.r)),n=t.encode(2,r.encode(e.s));return t.encode(48,i+n)}},yd=BigInt(0),yu=BigInt(1),yh=BigInt(2),yp=BigInt(3),yf=BigInt(4);function yy(e,t){let r,{BYTES:i}=e;if("bigint"==typeof t)r=t;else{let n=fy("private key",t);try{r=e.fromBytes(n)}catch{throw Error(`invalid private key: expected ui8a of size ${i}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw Error("invalid private key: out of range [1..N-1]");return r}function yg(e){return Uint8Array.of(e?2:3)}function ym(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function yw(e,t){let r=t=>(function(e){let t,{CURVE:r,curveOpts:i,hash:n,ecdsaOpts:s}=function(e){let t,r,i,n,{CURVE:s,curveOpts:a}=(t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,i=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(e=>Math.ceil(e/2)))):void 0,n={Fp:r,Fn:fq(t.n,{BITS:e.nBitLength,allowedLengths:i,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes},{CURVE:t,curveOpts:n}),o={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:s,curveOpts:a,hash:e.hash,ecdsaOpts:o}}(e),a=function(e,t,r={}){hd(t),fv(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let i=r.randomBytes||hO,n=r.hmac||((e,...r)=>fi(t,e,hx(...r))),{Fp:s,Fn:a}=e,{ORDER:o,BITS:l}=a,{keygen:c,getPublicKey:d,getSharedSecret:u,utils:h,lengths:p}=function(e,t={}){let{Fn:r}=e,i=t.randomBytes||hO,n=Object.assign(ym(e.Fp,r),{seed:f$(r.ORDER)});function s(e){try{return!!yy(r,e)}catch{return!1}}function a(e=i(n.seed)){return function(e,t,r=!1){let i=e.length,n=fz(t),s=f$(t);if(i<16||i<s||i>1024)throw Error("expected "+s+"-1024 bytes of input, got "+i);let a=fR(r?fh(e):fu(hA(e)),t-fA)+fA;return r?ff(a,n):fp(a,n)}(fc(e,n.seed,"seed"),r.ORDER)}function o(t,i=!0){return e.BASE.multiply(yy(r,t)).toBytes(i)}function l(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;let{secretKey:i,publicKey:s,publicKeyUncompressed:a}=n;if(r.allowedLengths||i===s)return;let o=fy("key",t).length;return o===s||o===a}return Object.freeze({getPublicKey:o,getSharedSecret:function(t,i,n=!0){if(!0===l(t))throw Error("first arg must be private key");if(!1===l(i))throw Error("second arg must be public key");let s=yy(r,t);return e.fromHex(i).multiply(s).toBytes(n)},keygen:function(e){let t=a(e);return{secretKey:t,publicKey:o(t)}},Point:e,utils:{isValidSecretKey:s,isValidPublicKey:function(t,r){let{publicKey:i,publicKeyUncompressed:s}=n;try{let n=t.length;return(!0!==r||n===i)&&(!1!==r||n===s)&&!!e.fromBytes(t)}catch{return!1}},randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:e=>yy(r,e),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)},lengths:n})}(e,r),f={prehash:!1,lowS:"boolean"==typeof r.lowS&&r.lowS,format:void 0,extraEntropy:!1},y="compact";function g(e,t){if(!a.isValidNot0(t))throw Error(`invalid signature ${e}: out of range 1..Point.Fn.ORDER`);return t}class m{constructor(e,t,r){this.r=g("r",e),this.s=g("s",t),null!=r&&(this.recovery=r),Object.freeze(this)}static fromBytes(e,t=y){var r,i;let n,s;if(r=e,yo(i=t),s=p.signature,fc(r,"compact"===i?s:"recovered"===i?s+1:void 0,`${i} signature`),"der"===t){let{r:t,s:r}=yc.toSig(fc(e));return new m(t,r)}"recovered"===t&&(n=e[0],t="compact",e=e.subarray(1));let o=a.BYTES,l=e.subarray(0,o),c=e.subarray(o,2*o);return new m(a.fromBytes(l),a.fromBytes(c),n)}static fromHex(e,t){return this.fromBytes(hI(e),t)}addRecoveryBit(e){return new m(this.r,this.s,e)}recoverPublicKey(t){let r=s.ORDER,{r:i,s:n,recovery:l}=this;if(null==l||![0,1,2,3].includes(l))throw Error("recovery id invalid");if(o*yh<r&&l>1)throw Error("recovery id is ambiguous for h>1 curve");let c=2===l||3===l?i+o:i;if(!s.isValid(c))throw Error("recovery id 2 or 3 invalid");let d=s.toBytes(c),u=e.fromBytes(hx(yg((1&l)==0),d)),h=a.inv(c),p=b(fy("msgHash",t)),f=a.create(-p*h),y=a.create(n*h),g=e.BASE.multiplyUnsafe(f).add(u.multiplyUnsafe(y));if(g.is0())throw Error("point at infinify");return g.assertValidity(),g}hasHighS(){return this.s>o>>yu}toBytes(e=y){if(yo(e),"der"===e)return hI(yc.hexFromSig(this));let t=a.toBytes(this.r),r=a.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw Error("recovery bit must be present");return hx(Uint8Array.of(this.recovery),t,r)}return hx(t,r)}toHex(e){return hA(this.toBytes(e))}assertValidity(){}static fromCompact(e){return m.fromBytes(fy("sig",e),"compact")}static fromDER(e){return m.fromBytes(fy("sig",e),"der")}normalizeS(){return this.hasHighS()?new m(this.r,a.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return hA(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return hA(this.toBytes("compact"))}}let w=r.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=fu(hA(e)),r=8*e.length-l;return r>0?t>>BigInt(r):t},b=r.bits2int_modN||function(e){return a.create(w(e))},v=fb(l);function _(e){return fm("num < 2^"+l,e,yd,v),a.toBytes(e)}function E(e,r){return fc(e,void 0,"message"),r?fc(t(e),void 0,"prehashed message"):e}return Object.freeze({keygen:c,getPublicKey:d,getSharedSecret:u,utils:h,lengths:p,Point:e,sign:function(r,s,l={}){let{seed:c,k2sig:d}=function(t,r,n){if(["recovered","canonical"].some(e=>e in n))throw Error("sign() legacy options not supported");let{lowS:s,prehash:l,extraEntropy:c}=yl(n,f),d=b(t=E(t,l)),u=yy(a,r),h=[_(u),_(d)];if(null!=c&&!1!==c){let e=!0===c?i(p.secretKey):c;h.push(fy("extraEntropy",e))}return{seed:hx(...h),k2sig:function(t){let r=w(t);if(!a.isValidNot0(r))return;let i=a.inv(r),n=e.BASE.multiply(r).toAffine(),l=a.create(n.x);if(l===yd)return;let c=a.create(i*a.create(d+l*u));if(c===yd)return;let h=2*(n.x!==l)|Number(n.y&yu),p=c;return s&&c>o>>yu&&(p=a.neg(c),h^=1),new m(l,p,h)}}}(r=fy("message",r),s,l);return(function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=e=>new Uint8Array(e),n=i(e),s=i(e),a=0,o=()=>{n.fill(1),s.fill(0),a=0},l=(...e)=>r(s,n,...e),c=(e=i(0))=>{s=l(Uint8Array.of(0),e),n=l(),0!==e.length&&(s=l(Uint8Array.of(1),e),n=l())},d=()=>{if(a++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(n=l()).slice();r.push(t),e+=n.length}return hx(...r)};return(e,t)=>{let r;for(o(),c(e);!(r=t(d()));)c();return o(),r}})(t.outputLen,a.BYTES,n)(c,d)},verify:function(t,r,i,n={}){let{lowS:s,prehash:o,format:l}=yl(n,f);if(i=fy("publicKey",i),r=E(fy("message",r),o),"strict"in n)throw Error("options.strict was renamed to lowS");let c=void 0===l?function(e){let t,r="string"==typeof e||ho(e),i=!r&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!r&&!i)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(i)t=new m(e.r,e.s);else if(r){try{t=m.fromBytes(fy("sig",e),"der")}catch(e){if(!(e instanceof yc.Err))throw e}if(!t)try{t=m.fromBytes(fy("sig",e),"compact")}catch{return!1}}return t||!1}(t):m.fromBytes(fy("sig",t),l);if(!1===c)return!1;try{let t=e.fromBytes(i);if(s&&c.hasHighS())return!1;let{r:n,s:o}=c,l=b(r),d=a.inv(o),u=a.create(l*d),h=a.create(n*d),p=e.BASE.multiplyUnsafe(u).add(t.multiplyUnsafe(h));return!p.is0()&&a.create(p.x)===n}catch{return!1}},recoverPublicKey:function(e,t,r={}){let{prehash:i}=yl(r,f);return t=E(t,i),m.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:m,hash:t})}(function(e,t={}){let r=function(e,t,r={},i){if(void 0===i&&(i="edwards"===e),!t||"object"!=typeof t)throw Error(`expected valid ${e} CURVE object`);for(let e of["p","n","h"]){let r=t[e];if(!("bigint"==typeof r&&r>fK))throw Error(`CURVE.${e} must be positive bigint`)}let n=f5(t.p,r.Fp,i),s=f5(t.n,r.Fn,i);for(let r of["Gx","Gy","a","weierstrass"===e?"b":"d"])if(!n.isValid(t[r]))throw Error(`CURVE.${r} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:n,Fn:s}}("weierstrass",e,t),{Fp:i,Fn:n}=r,s=r.CURVE,{h:a,n:o}=s;fv(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:l}=t;if(l&&(!i.is0(s.a)||"bigint"!=typeof l.beta||!Array.isArray(l.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let c=ym(i,n);function d(){if(!i.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let u=t.toBytes||function(e,t,r){let{x:n,y:s}=t.toAffine(),a=i.toBytes(n);return(fl(r,"isCompressed"),r)?(d(),hx(yg(!i.isOdd(s)),a)):hx(Uint8Array.of(4),a,i.toBytes(s))},h=t.fromBytes||function(e){fc(e,void 0,"Point");let{publicKey:t,publicKeyUncompressed:r}=c,n=e.length,s=e[0],a=e.subarray(1);if(n===t&&(2===s||3===s)){let e,t=i.fromBytes(a);if(!i.isValid(t))throw Error("bad point: is not on curve, wrong x");let r=p(t);try{e=i.sqrt(r)}catch(e){throw Error("bad point: is not on curve, sqrt error"+(e instanceof Error?": "+e.message:""))}return d(),(1&s)==1!==i.isOdd(e)&&(e=i.neg(e)),{x:t,y:e}}if(n===r&&4===s){let e=i.BYTES,t=i.fromBytes(a.subarray(0,e)),r=i.fromBytes(a.subarray(e,2*e));if(!f(t,r))throw Error("bad point: is not on curve");return{x:t,y:r}}throw Error(`bad point: got length ${n}, expected compressed=${t} or uncompressed=${r}`)};function p(e){let t=i.sqr(e),r=i.mul(t,e);return i.add(i.add(r,i.mul(e,s.a)),s.b)}function f(e,t){let r=i.sqr(t),n=p(e);return i.eql(r,n)}if(!f(s.Gx,s.Gy))throw Error("bad curve params: generator point");let y=i.mul(i.pow(s.a,yp),yf),g=i.mul(i.sqr(s.b),BigInt(27));if(i.is0(i.add(y,g)))throw Error("bad curve params: a or b");function m(e,t,r=!1){if(!i.isValid(t)||r&&i.is0(t))throw Error(`bad point coordinate ${e}`);return t}function w(e){if(!(e instanceof A))throw Error("ProjectivePoint expected")}function b(e){if(!l||!l.basises)throw Error("no endo");return function(e,t,r){let[[i,n],[s,a]]=t,o=ya(a*e,r),l=ya(-n*e,r),c=e-o*i-l*s,d=-o*n-l*a,u=c<yd,h=d<yd;u&&(c=-c),h&&(d=-d);let p=fb(Math.ceil(fw(r)/2))+yu;if(c<yd||c>=p||d<yd||d>=p)throw Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:u,k1:c,k2neg:h,k2:d}}(e,l.basises,n.ORDER)}let v=f_((e,t)=>{let{X:r,Y:n,Z:s}=e;if(i.eql(s,i.ONE))return{x:r,y:n};let a=e.is0();null==t&&(t=a?i.ONE:i.inv(s));let o=i.mul(r,t),l=i.mul(n,t),c=i.mul(s,t);if(a)return{x:i.ZERO,y:i.ZERO};if(!i.eql(c,i.ONE))throw Error("invZ was invalid");return{x:o,y:l}}),_=f_(e=>{if(e.is0()){if(t.allowInfinityPoint&&!i.is0(e.Y))return;throw Error("bad point: ZERO")}let{x:r,y:n}=e.toAffine();if(!i.isValid(r)||!i.isValid(n))throw Error("bad point: x or y not field elements");if(!f(r,n))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function E(e,t,r,n,s){return r=new A(i.mul(r.X,e),r.Y,r.Z),t=fJ(n,t),r=fJ(s,r),t.add(r)}class A{constructor(e,t,r){this.X=m("x",e),this.Y=m("y",t,!0),this.Z=m("z",r),Object.freeze(this)}static CURVE(){return s}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!i.isValid(t)||!i.isValid(r))throw Error("invalid affine point");if(e instanceof A)throw Error("projective point not allowed");return i.is0(t)&&i.is0(r)?A.ZERO:new A(t,r,i.ONE)}static fromBytes(e){let t=A.fromAffine(h(fc(e,void 0,"point")));return t.assertValidity(),t}static fromHex(e){return A.fromBytes(fy("pointHex",e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return I.createCache(this,e),t||this.multiply(yp),this}assertValidity(){_(this)}hasEvenY(){let{y:e}=this.toAffine();if(!i.isOdd)throw Error("Field doesn't support isOdd");return!i.isOdd(e)}equals(e){w(e);let{X:t,Y:r,Z:n}=this,{X:s,Y:a,Z:o}=e,l=i.eql(i.mul(t,o),i.mul(s,n)),c=i.eql(i.mul(r,o),i.mul(a,n));return l&&c}negate(){return new A(this.X,i.neg(this.Y),this.Z)}double(){let{a:e,b:t}=s,r=i.mul(t,yp),{X:n,Y:a,Z:o}=this,l=i.ZERO,c=i.ZERO,d=i.ZERO,u=i.mul(n,n),h=i.mul(a,a),p=i.mul(o,o),f=i.mul(n,a);return f=i.add(f,f),d=i.mul(n,o),d=i.add(d,d),l=i.mul(e,d),c=i.mul(r,p),c=i.add(l,c),l=i.sub(h,c),c=i.add(h,c),c=i.mul(l,c),l=i.mul(f,l),d=i.mul(r,d),p=i.mul(e,p),f=i.sub(u,p),f=i.mul(e,f),f=i.add(f,d),d=i.add(u,u),u=i.add(d,u),u=i.add(u,p),u=i.mul(u,f),c=i.add(c,u),p=i.mul(a,o),p=i.add(p,p),u=i.mul(p,f),l=i.sub(l,u),d=i.mul(p,h),d=i.add(d,d),new A(l,c,d=i.add(d,d))}add(e){w(e);let{X:t,Y:r,Z:n}=this,{X:a,Y:o,Z:l}=e,c=i.ZERO,d=i.ZERO,u=i.ZERO,h=s.a,p=i.mul(s.b,yp),f=i.mul(t,a),y=i.mul(r,o),g=i.mul(n,l),m=i.add(t,r),b=i.add(a,o);m=i.mul(m,b),b=i.add(f,y),m=i.sub(m,b),b=i.add(t,n);let v=i.add(a,l);return b=i.mul(b,v),v=i.add(f,g),b=i.sub(b,v),v=i.add(r,n),c=i.add(o,l),v=i.mul(v,c),c=i.add(y,g),v=i.sub(v,c),u=i.mul(h,b),c=i.mul(p,g),u=i.add(c,u),c=i.sub(y,u),u=i.add(y,u),d=i.mul(c,u),y=i.add(f,f),y=i.add(y,f),g=i.mul(h,g),b=i.mul(p,b),y=i.add(y,g),g=i.sub(f,g),g=i.mul(h,g),b=i.add(b,g),f=i.mul(y,b),d=i.add(d,f),f=i.mul(v,b),c=i.mul(m,c),c=i.sub(c,f),f=i.mul(m,y),u=i.mul(v,u),new A(c,d,u=i.add(u,f))}subtract(e){return this.add(e.negate())}is0(){return this.equals(A.ZERO)}multiply(e){let r,i,{endo:s}=t;if(!n.isValidNot0(e))throw Error("invalid scalar: out of range");let a=e=>I.cached(this,e,e=>fZ(A,e));if(s){let{k1neg:t,k1:n,k2neg:o,k2:l}=b(e),{p:c,f:d}=a(n),{p:u,f:h}=a(l);i=d.add(h),r=E(s.beta,c,u,t,o)}else{let{p:t,f:n}=a(e);r=t,i=n}return fZ(A,[r,i])[0]}multiplyUnsafe(e){let{endo:r}=t;if(!n.isValid(e))throw Error("invalid scalar: out of range");if(e===yd||this.is0())return A.ZERO;if(e===yu)return this;if(I.hasCache(this))return this.multiply(e);if(!r)return I.unsafe(this,e);{let{k1neg:t,k1:i,k2neg:n,k2:s}=b(e),{p1:a,p2:o}=function(e,t,r,i){let n=t,s=e.ZERO,a=e.ZERO;for(;r>fK||i>fK;)r&fV&&(s=s.add(n)),i&fV&&(a=a.add(n)),n=n.double(),r>>=fV,i>>=fV;return{p1:s,p2:a}}(A,this,i,s);return E(r.beta,a,o,t,n)}}multiplyAndAddUnsafe(e,t,r){let i=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return i.is0()?void 0:i}toAffine(e){return v(this,e)}isTorsionFree(){let{isTorsionFree:e}=t;return a===yu||(e?e(A,this):I.unsafe(this,o).is0())}clearCofactor(){let{clearCofactor:e}=t;return a===yu?this:e?e(A,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(e=!0){return fl(e,"isCompressed"),this.assertValidity(),u(A,this,e)}toHex(e=!0){return hA(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(e=!0){return this.toBytes(e)}_setWindowSize(e){this.precompute(e)}static normalizeZ(e){return fZ(A,e)}static msm(e,t){return function(e,t,r,i){(function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})})(r,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}(i,t);let n=r.length,s=i.length;if(n!==s)throw Error("arrays of points and scalars must have equal length");let a=e.ZERO,o=fw(BigInt(n)),l=1;o>12?l=o-3:o>4?l=o-2:o>0&&(l=2);let c=fb(l),d=Array(Number(c)+1).fill(a),u=Math.floor((t.BITS-1)/l)*l,h=a;for(let e=u;e>=0;e-=l){d.fill(a);for(let t=0;t<s;t++){let n=Number(i[t]>>BigInt(e)&c);d[n]=d[n].add(r[t])}let t=a;for(let e=d.length-1,r=a;e>0;e--)r=r.add(d[e]),t=t.add(r);if(h=h.add(t),0!==e)for(let e=0;e<l;e++)h=h.double()}return h}(A,n,e,t)}static fromPrivateKey(e){return A.BASE.multiply(yy(n,e))}}A.BASE=new A(s.Gx,s.Gy,i.ONE),A.ZERO=new A(i.ZERO,i.ONE,i.ZERO),A.Fp=i,A.Fn=n;let S=n.BITS,I=new f3(A,t.endo?Math.ceil(S/2):S);return A.BASE.precompute(8),A}(r,i),n,s);return t=a.Point,Object.assign({},a,{ProjectivePoint:t,CURVE:Object.assign({},e,fH(t.Fn.ORDER,t.Fn.BITS))})})({...e,hash:t});return{...r(t),create:r}}let yb={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},yv={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},y_={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},yE=fq(yb.p),yA=fq(yv.p),yS=fq(y_.p),yI=yw({...yb,Fp:yE,lowS:!1},pe);yw({...yv,Fp:yA,lowS:!1},pr),yw({...y_,Fp:yS,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},pt);let yk="base10",yT="base16",yx="base64pad",yC="base64url",yP="utf8";function yO(){let e=hO(32);return(0,dX.toString)(e,yT)}function yR(e){let t=pe((0,d0.fromString)(e,yT));return(0,dX.toString)(t,yT)}function yN(e){let t=pe((0,d0.fromString)(e,yP));return(0,dX.toString)(t,yT)}function yM(e){return(0,d0.fromString)(`${e}`,yk)}function yU(e){return Number((0,dX.toString)(e,yk))}function yD(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function yj(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4;return t+"=".repeat(r)}function yL(e){if(2===yU(e.type))return(0,dX.toString)((0,d1.concat)([e.type,e.sealed]),yx);if(1===yU(e.type)){if(typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return(0,dX.toString)((0,d1.concat)([e.type,e.senderPublicKey,e.iv,e.sealed]),yx)}return(0,dX.toString)((0,d1.concat)([e.type,e.iv,e.sealed]),yx)}function yB(e){let t=(e.encoding||yx)===yC?yj(e.encoded):e.encoded,r=(0,d0.fromString)(t,yx),i=r.slice(0,1);if(1===yU(i)){let e=r.slice(1,33),t=r.slice(33,45);return{type:i,sealed:r.slice(45),iv:t,senderPublicKey:e}}if(2===yU(i))return{type:i,sealed:r.slice(1),iv:hO(12)};let n=r.slice(1,13);return{type:i,sealed:r.slice(13),iv:n}}function yW(e){let t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function yF(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function yH(e){return e?.relay||{protocol:"irn"}}function yq(e){let t=d2.RELAY_JSONRPC[e];if(typeof t>"u")throw Error(`Relay Protocol not supported: ${e}`);return t}var yz=Object.defineProperty,y$=Object.defineProperties,yK=Object.getOwnPropertyDescriptors,yV=Object.getOwnPropertySymbols,yJ=Object.prototype.hasOwnProperty,yZ=Object.prototype.propertyIsEnumerable,yG=(e,t,r)=>t in e?yz(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,yY=(e,t)=>{for(var r in t||(t={}))yJ.call(t,r)&&yG(e,r,t[r]);if(yV)for(var r of yV(t))yZ.call(t,r)&&yG(e,r,t[r]);return e};function yQ(e){var t;if(!e.includes("wc:")){let t=uY(e);null!=t&&t.includes("wc:")&&(e=t)}let r=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),i=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,r),s=e.substring(r+1,i).split("@"),a=Object.fromEntries(new URLSearchParams("u">typeof i?e.substring(i):"").entries()),o="string"==typeof a.methods?a.methods.split(","):void 0;return{protocol:n,topic:(t=s[0]).startsWith("//")?t.substring(2):t,version:parseInt(s[1],10),symKey:a.symKey,relay:function(e,t="-"){let r={},i="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(i)){let n=t.replace(i,""),s=e[t];r[n]=s}}),r}(a),methods:o,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function yX(e){let t=new URLSearchParams;return Object.entries(yY(yY(y$(yY({},function(e,t="-"){let r={};return Object.keys(e).forEach(i=>{e[i]&&(r["relay"+t+i]=e[i])}),r}(e.relay)),yK({symKey:e.symKey})),e.expiryTimestamp&&{expiryTimestamp:e.expiryTimestamp.toString()}),e.methods&&{methods:e.methods.join(",")})).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,r])=>{void 0!==r&&t.append(e,String(r))}),`${e.protocol}:${e.topic}@${e.version}?${t}`}function y0(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}var y1=Object.defineProperty,y2=Object.defineProperties,y3=Object.getOwnPropertyDescriptors,y5=Object.getOwnPropertySymbols,y8=Object.prototype.hasOwnProperty,y6=Object.prototype.propertyIsEnumerable,y4=(e,t,r)=>t in e?y1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y7=(e,t)=>{for(var r in t||(t={}))y8.call(t,r)&&y4(e,r,t[r]);if(y5)for(var r of y5(t))y6.call(t,r)&&y4(e,r,t[r]);return e},y9=(e,t)=>y2(e,y3(t));function ge(e){let t=[];return e.forEach(e=>{let[r,i]=e.split(":");t.push(`${r}:${i}`)}),t}function gt(e){return e.includes(":")}function gr(e){return gt(e)?e.split(":")[0]:e}function gi(e){var t,r,i;let n={};if(!gd(e))return n;for(let[s,a]of Object.entries(e)){let e=gt(s)?[s]:a.chains,o=a.methods||[],l=a.events||[],c=gr(s);n[c]=y9(y7({},n[c]),{chains:u$(e,null==(t=n[c])?void 0:t.chains),methods:u$(o,null==(r=n[c])?void 0:r.methods),events:u$(l,null==(i=n[c])?void 0:i.events)})}return n}function gn(e,t){var r;let i,n=(r=t=t.map(e=>e.replace("did:pkh:","")),i={},r?.forEach(e=>{var t;let[r,n]=e.split(":");i[r]||(i[r]={accounts:[],chains:[],events:[],methods:[]}),i[r].accounts.push(e),null==(t=i[r].chains)||t.push(`${r}:${n}`)}),i);for(let[t,r]of Object.entries(n))r.methods?r.methods=u$(r.methods,e):r.methods=e,r.events=["chainChanged","accountsChanged"];return n}let gs={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},ga={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function go(e,t){let{message:r,code:i}=ga[e];return{message:t?`${r} ${t}`:r,code:i}}function gl(e,t){let{message:r,code:i}=gs[e];return{message:t?`${r} ${t}`:r,code:i}}function gc(e,t){return!!Array.isArray(e)&&(!("u">typeof t)||!e.length||e.every(t))}function gd(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function gu(e){return typeof e>"u"}function gh(e,t){return!!(t&&gu(e))||"string"==typeof e&&!!e.trim().length}function gp(e,t){return!!(t&&gu(e))||"number"==typeof e&&!isNaN(e)}function gf(e){return!!(gh(e,!1)&&e.includes(":"))&&2===e.split(":").length}function gy(e){let t=!0;return gc(e)?e.length&&(t=e.every(e=>gh(e,!1))):t=!1,t}function gg(e,t){let r=null;return Object.values(e).forEach(e=>{var i;let n;if(r)return;let s=(i=`${t}, namespace`,n=null,gy(e?.methods)?gy(e?.events)||(n=gl("UNSUPPORTED_EVENTS",`${i}, events should be an array of strings or empty array for no events`)):n=gl("UNSUPPORTED_METHODS",`${i}, methods should be an array of strings or empty array for no methods`),n);s&&(r=s)}),r}function gm(e,t){let r=null;if(e&&gd(e)){let i,n=gg(e,t);n&&(r=n);let s=(i=null,Object.values(e).forEach(e=>{var r,n;let s;if(i)return;let a=(r=e?.accounts,n=`${t} namespace`,s=null,gc(r)?r.forEach(e=>{s||function(e){if(gh(e,!1)&&e.includes(":")){let t=e.split(":");if(3===t.length){let e=t[0]+":"+t[1];return!!t[2]&&gf(e)}}return!1}(e)||(s=gl("UNSUPPORTED_ACCOUNTS",`${n}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):s=gl("UNSUPPORTED_ACCOUNTS",`${n}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),s);a&&(i=a)}),i);s&&(r=s)}else r=go("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function gw(e){return gh(e.protocol,!0)}function gb(e){return"u">typeof e}function gv(e,t){let r;return!(!gf(t)||!(r=[],Object.values(e).forEach(e=>{r.push(...ge(e.accounts))}),r).includes(t))}function g_(e,t,r){var i,n;let s,a,o=null,l=(s={},Object.keys(i=e).forEach(e=>{var t;e.includes(":")?s[e]=i[e]:null==(t=i[e].chains)||t.forEach(t=>{s[t]={methods:i[e].methods,events:i[e].events}})}),s),c=(a={},Object.keys(n=t).forEach(e=>{if(e.includes(":"))a[e]=n[e];else{let t=ge(n[e].accounts);t?.forEach(t=>{a[t]={accounts:n[e].accounts.filter(e=>e.includes(`${t}:`)),methods:n[e].methods,events:n[e].events}})}}),a),d=Object.keys(l),u=Object.keys(c),h=gE(Object.keys(e)),p=gE(Object.keys(t)),f=h.filter(e=>!p.includes(e));return f.length&&(o=go("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${f.toString()}
      Received: ${Object.keys(t).toString()}`)),uU(d,u)||(o=go("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${d.toString()}
      Approved: ${u.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||o)return;let i=ge(t[e].accounts);i.includes(e)||(o=go("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}
        Required: ${e}
        Approved: ${i.toString()}`))}),d.forEach(e=>{o||(uU(l[e].methods,c[e].methods)?uU(l[e].events,c[e].events)||(o=go("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):o=go("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))}),o}function gE(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}function gA(){let e=uO();return new Promise(t=>{switch(e){case uT:t(uP()&&navigator?.onLine);break;case uI:t(gS());break;default:t(!0)}})}async function gS(){if(uC()&&null!=e.g&&e.g.NetInfo){let t=await (null==e.g?void 0:e.g.NetInfo.fetch());return t?.isConnected}return!0}let gI={};class gk{static get(e){return gI[e]}static set(e,t){gI[e]=t}static delete(e){delete gI[e]}}function gT(e){return new Uint8Array(e.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function gx({logger:e,name:t}){var r,i,n,s;let a,o,l,c="string"==typeof e?("u">typeof(r={opts:{level:e,name:t}}).loggerOverride&&"string"!=typeof r.loggerOverride?{logger:r.loggerOverride,chunkLoggerController:null}:(l=new un(null==(n=(i=r).opts)?void 0:n.level,i.maxSizeInBytes),{logger:(0,d5.default)((a=uh({},i.opts),o={level:"trace",browser:ua(uh({},null==(s=i.opts)?void 0:s.browser),uo({write:e=>l.write(e)}))},ua(a,uo(o)))),chunkLoggerController:l})).logger:e;return c.level="string"==typeof e?e:e.level,c}var gC=e.i(180476),gP=e.i(499276),gO=e.i(852532);let gR="custom_context";var gN=Object.defineProperty,gM=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?gN(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class gU{constructor(e){gM(this,"nodeValue"),gM(this,"sizeInBytes"),gM(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class gD{constructor(e){gM(this,"lengthInNodes"),gM(this,"sizeInBytes"),gM(this,"head"),gM(this,"tail"),gM(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){let t=new gU(e);if(t.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=t):this.head=t,this.tail=t,this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;let e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){let e=[],t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};let t=e.value;return e=e.next,{done:!1,value:t}}}}}var gj=Object.defineProperty,gL=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?gj(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class gB{constructor(e,t=1024e3){gL(this,"logs"),gL(this,"level"),gL(this,"levelValue"),gL(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=gO.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new gD(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===gO.levels.values.error?console.error(e):t===gO.levels.values.warn?console.warn(e):t===gO.levels.values.debug?console.debug(e):t===gO.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append((0,d8.safeJsonStringify)({timestamp:new Date().toISOString(),log:e}));let t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new gD(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){let t=this.getLogArray();return t.push((0,d8.safeJsonStringify)({extraMetadata:e})),new Blob(t,{type:"application/json"})}}var gW=Object.defineProperty;class gF{constructor(e,t=1024e3){((e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?gW(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r})(this,"baseChunkLogger"),this.baseChunkLogger=new gB(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){let t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}var gH=Object.defineProperty,gq=Object.defineProperties,gz=Object.getOwnPropertyDescriptors,g$=Object.getOwnPropertySymbols,gK=Object.prototype.hasOwnProperty,gV=Object.prototype.propertyIsEnumerable,gJ=(e,t,r)=>t in e?gH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,gZ=(e,t)=>{for(var r in t||(t={}))gK.call(t,r)&&gJ(e,r,t[r]);if(g$)for(var r of g$(t))gV.call(t,r)&&gJ(e,r,t[r]);return e};function gG(e,t=gR){return e[t]||""}function gY(e,t,r=gR){let i=function(e,t,r=gR){let i=gG(e,r);return i.trim()?`${i}/${t}`:t}(e,t,r);return function(e,t,r=gR){return e[r]=t,e}(e.child({context:i}),i,r)}e.i(826606);var gQ=e.i(81775),gX=Object.defineProperty,g0=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?gX(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class g1 extends gQ.IEvents{constructor(e){super(),this.opts=e,g0(this,"protocol","wc"),g0(this,"version",2)}}var g2=Object.defineProperty;class g3 extends gQ.IEvents{constructor(e,t){super(),this.core=e,this.logger=t,((e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?g2(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r})(this,"records",new Map)}}class g5{constructor(e,t){this.logger=e,this.core=t}}class g8 extends gQ.IEvents{constructor(e,t){super(),this.relayer=e,this.logger=t}}class g6 extends gQ.IEvents{constructor(e){super()}}class g4{constructor(e,t,r,i){this.core=e,this.logger=t,this.name=r}}class g7 extends gQ.IEvents{constructor(e,t){super(),this.relayer=e,this.logger=t}}class g9 extends gQ.IEvents{constructor(e,t){super(),this.core=e,this.logger=t}}class me{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}}class mt{constructor(e,t){this.projectId=e,this.logger=t}}class mr{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}}var mi=Object.defineProperty,mn=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?mi(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};lf.default;class ms{constructor(e){this.opts=e,mn(this,"protocol","wc"),mn(this,"version",2)}}lf.EventEmitter;class ma{constructor(e){this.client=e}}var mo=e.i(501365);e.i(424047);var ml=e.i(329193),mc=e.i(850967),md=e.i(112324);let mu="core",mh=`wc@2:${mu}:`,mp={database:":memory:"},mf="client_ed25519_seed",my=lg.ONE_DAY,mg=lg.SIX_HOURS,mm="wss://relay.walletconnect.org",mw="relayer_message",mb="relayer_message_ack",mv="relayer_connection_stalled",m_="relayer_publish",mE="payload",mA="connect",mS="disconnect",mI="error",mk="2.22.4",mT="link_mode",mx="relay",mC="inbound",mP="WALLETCONNECT_LINK_MODE_APPS",mO="subscription_created",mR="subscription_deleted",mN=(lg.THIRTY_DAYS,lg.FIVE_SECONDS,lg.THIRTY_DAYS,{wc_pairingDelete:{req:{ttl:lg.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:lg.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:lg.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:lg.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:lg.ONE_DAY,prompt:!1,tag:0},res:{ttl:lg.ONE_DAY,prompt:!1,tag:0}}}),mM="pairing_create",mU="pairing_delete",mD="history_created",mj="history_updated",mL="history_deleted",mB="expirer_created",mW="expirer_deleted",mF="expirer_expired",mH=(lg.ONE_DAY,"https://verify.walletconnect.org"),mq=`${mH}/v3`,mz=["https://verify.walletconnect.com",mH],m$="malformed_pairing_uri",mK="session_approve_started";var mV=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<e.length;n++){var s=e.charAt(n),a=s.charCodeAt(0);if(255!==r[a])throw TypeError(s+" is ambiguous");r[a]=n}var o=e.length,l=e.charAt(0),c=Math.log(o)/Math.log(256),d=Math.log(256)/Math.log(o);function u(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,n=0;e[t]===l;)i++,t++;for(var s=(e.length-t)*c+1>>>0,a=new Uint8Array(s);e[t];){var d=r[e.charCodeAt(t)];if(255===d)return;for(var u=0,h=s-1;(0!==d||u<n)&&-1!==h;h--,u++)d+=o*a[h]>>>0,a[h]=d%256>>>0,d=d/256>>>0;if(0!==d)throw Error("Non-zero carry");n=u,t++}if(" "!==e[t]){for(var p=s-n;p!==s&&0===a[p];)p++;for(var f=new Uint8Array(i+(s-p)),y=i;p!==s;)f[y++]=a[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,n=0,s=t.length;n!==s&&0===t[n];)n++,r++;for(var a=(s-n)*d+1>>>0,c=new Uint8Array(a);n!==s;){for(var u=t[n],h=0,p=a-1;(0!==u||h<i)&&-1!==p;p--,h++)u+=256*c[p]>>>0,c[p]=u%o>>>0,u=u/o>>>0;if(0!==u)throw Error("Non-zero carry");i=h,n++}for(var f=a-i;f!==a&&0===c[f];)f++;for(var y=l.repeat(r);f<a;++f)y+=e.charAt(c[f]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw Error(`Non-${t} character`)}}};let mJ=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")};class mZ{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class mG{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return mQ(this,e)}}class mY{constructor(e){this.decoders=e}or(e){return mQ(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let mQ=(e,t)=>new mY({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class mX{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new mZ(e,t,r),this.decoder=new mG(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let m0=({name:e,prefix:t,encode:r,decode:i})=>new mX(e,t,r,i),m1=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:n}=mV(r,t);return m0({prefix:e,name:t,encode:i,decode:e=>mJ(n(e))})},m2=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>m0({prefix:t,name:e,encode:e=>((e,t,r)=>{let i="="===t[t.length-1],n=(1<<r)-1,s="",a=0,o=0;for(let i=0;i<e.length;++i)for(o=o<<8|e[i],a+=8;a>r;)a-=r,s+=t[n&o>>a];if(a&&(s+=t[n&o<<r-a]),i)for(;s.length*r&7;)s+="=";return s})(e,i,r),decode:t=>((e,t,r,i)=>{let n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;let a=new Uint8Array(s*r/8|0),o=0,l=0,c=0;for(let t=0;t<s;++t){let s=n[e[t]];if(void 0===s)throw SyntaxError(`Non-${i} character`);l=l<<r|s,(o+=r)>=8&&(o-=8,a[c++]=255&l>>o)}if(o>=r||255&l<<8-o)throw SyntaxError("Unexpected end of data");return a})(t,i,r,e)});var m3=Object.freeze({__proto__:null,identity:m0({prefix:"\0",name:"identity",encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)})}),m5=Object.freeze({__proto__:null,base2:m2({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),m8=Object.freeze({__proto__:null,base8:m2({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),m6=Object.freeze({__proto__:null,base10:m1({prefix:"9",name:"base10",alphabet:"0123456789"})}),m4=Object.freeze({__proto__:null,base16:m2({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:m2({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})}),m7=Object.freeze({__proto__:null,base32:m2({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper:m2({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad:m2({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper:m2({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex:m2({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper:m2({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad:m2({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper:m2({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:m2({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),m9=Object.freeze({__proto__:null,base36:m1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:m1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),we=Object.freeze({__proto__:null,base58btc:m1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:m1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})}),wt=Object.freeze({__proto__:null,base64:m2({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad:m2({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url:m2({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:m2({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let wr=Array.from(""),wi=wr.reduce((e,t,r)=>(e[r]=t,e),[]),wn=wr.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);var ws=Object.freeze({__proto__:null,base256emoji:m0({prefix:"",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=wi[t],"")},decode:function(e){let t=[];for(let r of e){let e=wn[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}})});function wa(e,t,r){t=t||[],r=r||0;for(var i=r;e>=0x80000000;)t[r++]=255&e|128,e/=128;for(;-128&e;)t[r++]=255&e|128,e>>>=7;return t[r]=0|e,wa.bytes=r-i+1,t}var wo=function(e){return e<128?1:e<16384?2:e<2097152?3:e<0x10000000?4:e<0x800000000?5:e<0x40000000000?6:e<0x2000000000000?7:e<0x100000000000000?8:e<0x8000000000000000?9:10};let wl=(e,t,r=0)=>(wa(e,t,r),t),wc=(e,t)=>{let r=t.byteLength,i=wo(e),n=i+wo(r),s=new Uint8Array(n+r);return wl(e,s,0),wl(r,s,i),s.set(t,n),new wd(e,r,t,s)};class wd{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}let wu=({name:e,code:t,encode:r})=>new wh(e,t,r);class wh{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?wc(this.code,t):t.then(e=>wc(this.code,e))}throw Error("Unknown type, must be binary type")}}let wp=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var wf=Object.freeze({__proto__:null,sha256:wu({name:"sha2-256",code:18,encode:wp("SHA-256")}),sha512:wu({name:"sha2-512",code:19,encode:wp("SHA-512")})}),wy=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:mJ,digest:e=>wc(0,mJ(e))}});new TextEncoder,new TextDecoder;let wg={...m3,...m5,...m8,...m6,...m4,...m7,...m9,...we,...wt,...ws};function wm(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function ww(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...wf,...wy});let wb=ww("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),wv=ww("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?wm(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),w_={utf8:wb,"utf-8":wb,hex:wg.base16,latin1:wv,ascii:wv,binary:wv,...wg};var wE=Object.defineProperty,wA=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?wE(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class wS{constructor(e,t){this.core=e,this.logger=t,wA(this,"keychain",new Map),wA(this,"name","keychain"),wA(this,"version","0.3"),wA(this,"initialized",!1),wA(this,"storagePrefix",mh),wA(this,"init",async()=>{if(!this.initialized){let e=await this.getKeyChain();"u">typeof e&&(this.keychain=e),this.initialized=!0}}),wA(this,"has",e=>(this.isInitialized(),this.keychain.has(e))),wA(this,"set",async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()}),wA(this,"get",e=>{this.isInitialized();let t=this.keychain.get(e);if(typeof t>"u"){let{message:t}=go("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}),wA(this,"del",async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()}),this.core=e,this.logger=gY(t,this.name)}get context(){return gG(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,uD(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?uj(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=go("NOT_INITIALIZED",this.name);throw Error(e)}}}var wI=Object.defineProperty,wk=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?wI(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class wT{constructor(e,t,r){this.core=e,this.logger=t,wk(this,"name","crypto"),wk(this,"keychain"),wk(this,"randomSessionIdentifier",yO()),wk(this,"initialized",!1),wk(this,"clientId"),wk(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),wk(this,"hasKeys",e=>(this.isInitialized(),this.keychain.has(e))),wk(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;let e=await this.getClientSeed(),t=dQ.generateKeyPair(e),r=dQ.encodeIss(t.publicKey);return this.clientId=r,r}),wk(this,"generateKeyPair",()=>{let e,t;this.isInitialized();let r=(e=ys.utils.randomPrivateKey(),t=ys.getPublicKey(e),{privateKey:(0,dX.toString)(e,yT),publicKey:(0,dX.toString)(t,yT)});return this.setPrivateKey(r.publicKey,r.privateKey)}),wk(this,"signJWT",async e=>{this.isInitialized();let t=await this.getClientSeed(),r=dQ.generateKeyPair(t),i=this.randomSessionIdentifier;return await dQ.signJWT(i,e,my,r)}),wk(this,"generateSharedKey",(e,t,r)=>{var i,n,s;let a,o;this.isInitialized();let l=(i=this.getPrivateKey(e),a=ys.getSharedSecret((0,d0.fromString)(i,yT),(0,d0.fromString)(t,yT)),n=void 0,o=function(e,t,r,i=32){hd(e),hl(i);let n=e.outputLen;if(i>255*n)throw Error("Length should be <= 255*HashLen");let s=Math.ceil(i/n);void 0===r&&(r=fs);let a=new Uint8Array(s*n),o=fi.create(e,t),l=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let e=0;e<s;e++)fn[0]=e+1,l.update(0===e?fs:c).update(r).update(fn).digestInto(c),a.set(c,n*e),o._cloneInto(l);return o.destroy(),l.destroy(),hf(c,fn),a.slice(0,i)}(pe,(s=void 0,hd(pe),void 0===s&&(s=new Uint8Array(pe.outputLen)),fi(pe,hT(s),hT(a))),n,32),(0,dX.toString)(o,yT));return this.setSymKey(l,r)}),wk(this,"setSymKey",async(e,t)=>{this.isInitialized();let r=t||yR(e);return await this.keychain.set(r,e),r}),wk(this,"deleteKeyPair",async e=>{this.isInitialized(),await this.keychain.del(e)}),wk(this,"deleteSymKey",async e=>{this.isInitialized(),await this.keychain.del(e)}),wk(this,"encode",async(e,t,r)=>{this.isInitialized();let i=yW(r),n=(0,d8.safeJsonStringify)(t);if(2===i.type){var s;let e,t,i;return s=r?.encoding,e=yM(2),t=hO(12),i=yL({type:e,sealed:(0,d0.fromString)(n,yP),iv:t}),s===yC?yD(i):i}if(yF(i)){let t=i.senderPublicKey,r=i.receiverPublicKey;e=await this.generateSharedKey(t,r)}let a=this.getSymKey(e),{type:o,senderPublicKey:l}=i;return function(e){let t=yM("u">typeof e.type?e.type:0);if(1===yU(t)&&typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let r="u">typeof e.senderPublicKey?(0,d0.fromString)(e.senderPublicKey,yT):void 0,i="u">typeof e.iv?(0,d0.fromString)(e.iv,yT):hO(12),n=yL({type:t,sealed:ft((0,d0.fromString)(e.symKey,yT),i).encrypt((0,d0.fromString)(e.message,yP)),iv:i,senderPublicKey:r});return e.encoding===yC?yD(n):n}({type:o,symKey:a,message:n,senderPublicKey:l,encoding:r?.encoding})}),wk(this,"decode",async(e,t,r)=>{let i;this.isInitialized();let n=yW({type:yU((i=yB({encoded:t,encoding:r?.encoding})).type),senderPublicKey:"u">typeof i.senderPublicKey?(0,dX.toString)(i.senderPublicKey,yT):void 0,receiverPublicKey:r?.receiverPublicKey});if(2===n.type){let e=function(e,t){let{sealed:r}=yB({encoded:e,encoding:t});return(0,dX.toString)(r,yP)}(t,r?.encoding);return(0,d8.safeJsonParse)(e)}if(yF(n)){let t=n.receiverPublicKey,r=n.senderPublicKey;e=await this.generateSharedKey(t,r)}try{let i=this.getSymKey(e),n=function(e){let t=(0,d0.fromString)(e.symKey,yT),{sealed:r,iv:i}=yB({encoded:e.encoded,encoding:e.encoding}),n=ft(t,i).decrypt(r);if(null===n)throw Error("Failed to decrypt");return(0,dX.toString)(n,yP)}({symKey:i,encoded:t,encoding:r?.encoding});return(0,d8.safeJsonParse)(n)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}}),wk(this,"getPayloadType",(e,t=yx)=>yU(yB({encoded:e,encoding:t}).type)),wk(this,"getPayloadSenderPublicKey",(e,t=yx)=>{let r=yB({encoded:e,encoding:t});return r.senderPublicKey?(0,dX.toString)(r.senderPublicKey,yT):void 0}),this.core=e,this.logger=gY(t,this.name),this.keychain=r||new wS(this.core,this.logger)}get context(){return gG(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(mf)}catch{e=yO(),await this.keychain.set(mf,e)}return function(e,t="utf8"){let r=w_[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?wm(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=go("NOT_INITIALIZED",this.name);throw Error(e)}}}var wx=Object.defineProperty,wC=Object.defineProperties,wP=Object.getOwnPropertyDescriptors,wO=Object.getOwnPropertySymbols,wR=Object.prototype.hasOwnProperty,wN=Object.prototype.propertyIsEnumerable,wM=(e,t,r)=>t in e?wx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,wU=(e,t,r)=>wM(e,"symbol"!=typeof t?t+"":t,r);class wD extends g5{constructor(e,t){super(e,t),this.logger=e,this.core=t,wU(this,"messages",new Map),wU(this,"messagesWithoutClientAck",new Map),wU(this,"name","messages"),wU(this,"version","0.3"),wU(this,"initialized",!1),wU(this,"storagePrefix",mh),wU(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let e=await this.getRelayerMessages();"u">typeof e&&(this.messages=e);let t=await this.getRelayerMessagesWithoutClientAck();"u">typeof t&&(this.messagesWithoutClientAck=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}}),wU(this,"set",async(e,t,r)=>{this.isInitialized();let i=yN(t),n=this.messages.get(e);if(typeof n>"u"&&(n={}),"u">typeof n[i])return i;if(n[i]=t,this.messages.set(e,n),r===mC){let r=this.messagesWithoutClientAck.get(e)||{};this.messagesWithoutClientAck.set(e,wC(((e,t)=>{for(var r in t||(t={}))wR.call(t,r)&&wM(e,r,t[r]);if(wO)for(var r of wO(t))wN.call(t,r)&&wM(e,r,t[r]);return e})({},r),wP({[i]:t})))}return await this.persist(),i}),wU(this,"get",e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t}),wU(this,"getWithoutAck",e=>{this.isInitialized();let t={};for(let r of e){let e=this.messagesWithoutClientAck.get(r)||{};t[r]=Object.values(e)}return t}),wU(this,"has",(e,t)=>(this.isInitialized(),"u">typeof this.get(e)[yN(t)])),wU(this,"ack",async(e,t)=>{this.isInitialized();let r=this.messagesWithoutClientAck.get(e);if(typeof r>"u")return;let i=yN(t);delete r[i],0===Object.keys(r).length?this.messagesWithoutClientAck.delete(e):this.messagesWithoutClientAck.set(e,r),await this.persist()}),wU(this,"del",async e=>{this.isInitialized(),this.messages.delete(e),this.messagesWithoutClientAck.delete(e),await this.persist()}),this.logger=gY(e,this.name),this.core=t}get context(){return gG(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,uD(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,uD(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?uj(e):void 0}async getRelayerMessagesWithoutClientAck(){let e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return"u">typeof e?uj(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:e}=go("NOT_INITIALIZED",this.name);throw Error(e)}}}var wj=Object.defineProperty,wL=Object.defineProperties,wB=Object.getOwnPropertyDescriptors,wW=Object.getOwnPropertySymbols,wF=Object.prototype.hasOwnProperty,wH=Object.prototype.propertyIsEnumerable,wq=(e,t,r)=>t in e?wj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,wz=(e,t)=>{for(var r in t||(t={}))wF.call(t,r)&&wq(e,r,t[r]);if(wW)for(var r of wW(t))wH.call(t,r)&&wq(e,r,t[r]);return e},w$=(e,t,r)=>wq(e,"symbol"!=typeof t?t+"":t,r);class wK extends g8{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,w$(this,"events",new lf.EventEmitter),w$(this,"name","publisher"),w$(this,"queue",new Map),w$(this,"publishTimeout",(0,lg.toMiliseconds)(lg.ONE_MINUTE)),w$(this,"initialPublishTimeout",(0,lg.toMiliseconds)(15*lg.ONE_SECOND)),w$(this,"needsTransportRestart",!1),w$(this,"publish",async(e,t,r)=>{var i,n,s,a,o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});let l=r?.ttl||mg,c=r?.prompt||!1,d=r?.tag||0,u=r?.id||(0,ml.getBigIntRpcId)().toString(),h=yq(yH().protocol),p={id:u,method:r?.publishMethod||h.publish,params:wz({topic:e,message:t,ttl:l,prompt:c,tag:d,attestation:r?.attestation},r?.tvf)},f=`Failed to publish payload, please try again. id:${u} tag:${d}`;try{gu(null==(i=p.params)?void 0:i.prompt)&&(null==(n=p.params)||delete n.prompt),gu(null==(s=p.params)?void 0:s.tag)&&(null==(a=p.params)||delete a.tag);let o=new Promise(async e=>{let t=({id:r})=>{var i;(null==(i=p.id)?void 0:i.toString())===r.toString()&&(this.removeRequestFromQueue(r),this.relayer.events.removeListener(m_,t),e())};this.relayer.events.on(m_,t);let i=uB(new Promise((e,t)=>{this.rpcPublish(p,r).then(e).catch(e=>{this.logger.warn(e,e?.message),t(e)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${u} tag:${d}`);try{await i,this.events.removeListener(m_,t)}catch(e){this.queue.set(u,{request:p,opts:r,attempt:1}),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:u,topic:e,message:t,opts:r}}),await uB(o,this.publishTimeout,f)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(o=r?.internal)&&o.throwOnFailedPublish)throw e}finally{this.queue.delete(u)}}),w$(this,"publishCustom",async e=>{var t,r,i,n,s;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:e});let{payload:a,opts:o={}}=e,{attestation:l,tvf:c,publishMethod:d,prompt:u,tag:h,ttl:p=lg.FIVE_MINUTES}=o,f=o.id||(0,ml.getBigIntRpcId)().toString(),y=yq(yH().protocol),g=d||y.publish,m={id:f,method:g,params:wz(wL(wz({},a),wB({ttl:p,prompt:u,tag:h,attestation:l})),c)},w=`Failed to publish custom payload, please try again. id:${f} tag:${h}`;try{gu(null==(t=m.params)?void 0:t.prompt)&&(null==(r=m.params)||delete r.prompt),gu(null==(i=m.params)?void 0:i.tag)&&(null==(n=m.params)||delete n.tag);let e=new Promise(async e=>{let t=({id:r})=>{var i;(null==(i=m.id)?void 0:i.toString())===r.toString()&&(this.removeRequestFromQueue(r),this.relayer.events.removeListener(m_,t),e())};this.relayer.events.on(m_,t);let r=uB(new Promise((e,t)=>{this.rpcPublish(m,o).then(e).catch(e=>{this.logger.warn(e,e?.message),t(e)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${g} id:${f} tag:${h}`);try{await r,this.events.removeListener(m_,t)}catch(e){this.queue.set(f,{request:m,opts:o,attempt:1}),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:f,payload:a,opts:o}}),await uB(e,this.publishTimeout,w)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(s=o?.internal)&&s.throwOnFailedPublish)throw e}finally{this.queue.delete(f)}}),w$(this,"on",(e,t)=>{this.events.on(e,t)}),w$(this,"once",(e,t)=>{this.events.once(e,t)}),w$(this,"off",(e,t)=>{this.events.off(e,t)}),w$(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.relayer=e,this.logger=gY(t,this.name),this.registerEventListeners()}get context(){return gG(this.logger)}async rpcPublish(e,t){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});let r=await this.relayer.request(e);return this.relayer.events.emit(m_,wz(wz({},e),t)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{var r;let i=e.attempt+1;this.queue.set(t,wL(wz({},e),wB({attempt:i}))),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${null==(r=e.request.params)?void 0:r.tag}, attempt: ${i}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(gC.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(mv);return}this.checkQueue()}),this.relayer.on(mb,e=>{this.removeRequestFromQueue(e.id.toString())})}}var wV=Object.defineProperty,wJ=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?wV(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class wZ{constructor(){wJ(this,"map",new Map),wJ(this,"set",(e,t)=>{let r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),wJ(this,"get",e=>this.map.get(e)||[]),wJ(this,"exists",(e,t)=>this.get(e).includes(t)),wJ(this,"delete",(e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;let r=this.get(e);if(!this.exists(e,t))return;let i=r.filter(e=>e!==t);i.length?this.map.set(e,i):this.map.delete(e)}),wJ(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var wG=Object.defineProperty,wY=Object.defineProperties,wQ=Object.getOwnPropertyDescriptors,wX=Object.getOwnPropertySymbols,w0=Object.prototype.hasOwnProperty,w1=Object.prototype.propertyIsEnumerable,w2=(e,t,r)=>t in e?wG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,w3=(e,t)=>{for(var r in t||(t={}))w0.call(t,r)&&w2(e,r,t[r]);if(wX)for(var r of wX(t))w1.call(t,r)&&w2(e,r,t[r]);return e},w5=(e,t,r)=>w2(e,"symbol"!=typeof t?t+"":t,r);class w8 extends g7{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,w5(this,"subscriptions",new Map),w5(this,"topicMap",new wZ),w5(this,"events",new lf.EventEmitter),w5(this,"name","subscription"),w5(this,"version","0.3"),w5(this,"pending",new Map),w5(this,"cached",[]),w5(this,"initialized",!1),w5(this,"storagePrefix",mh),w5(this,"subscribeTimeout",(0,lg.toMiliseconds)(lg.ONE_MINUTE)),w5(this,"initialSubscribeTimeout",(0,lg.toMiliseconds)(15*lg.ONE_SECOND)),w5(this,"clientId"),w5(this,"batchSubscribeTopicsLimit",500),w5(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),w5(this,"subscribe",async(e,t)=>{var r;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{let i=yH(t),n={topic:e,relay:i,transportType:t?.transportType};null!=(r=t?.internal)&&r.skipSubscribe||this.pending.set(e,n);let s=await this.rpcSubscribe(e,i,t);return"string"==typeof s&&(this.onSubscribe(s,n),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),s}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}}),w5(this,"unsubscribe",async(e,t)=>{this.isInitialized(),"u">typeof t?.id?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)}),w5(this,"isSubscribed",e=>new Promise(t=>{t(this.topicMap.topics.includes(e))})),w5(this,"isKnownTopic",e=>new Promise(t=>{t(this.topicMap.topics.includes(e)||this.pending.has(e)||this.cached.some(t=>t.topic===e))})),w5(this,"on",(e,t)=>{this.events.on(e,t)}),w5(this,"once",(e,t)=>{this.events.once(e,t)}),w5(this,"off",(e,t)=>{this.events.off(e,t)}),w5(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),w5(this,"start",async()=>{await this.onConnect()}),w5(this,"stop",async()=>{await this.onDisconnect()}),w5(this,"restart",async()=>{await this.restore(),await this.onRestart()}),w5(this,"checkPending",async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;let e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}),w5(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(gC.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.events.on(mO,async e=>{this.logger.info(`Emitting ${mO}`),this.logger.debug({type:"event",event:mO,data:e}),await this.persist()}),this.events.on(mR,async e=>{this.logger.info(`Emitting ${mR}`),this.logger.debug({type:"event",event:mR,data:e}),await this.persist()})}),this.relayer=e,this.logger=gY(t,this.name),this.clientId=""}get context(){return gG(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){let r=this.topicMap.get(e);await Promise.all(r.map(async r=>await this.unsubscribeById(e,r,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{let i=yH(r);await this.restartToComplete({topic:e,id:t,relay:i}),await this.rpcUnsubscribe(e,t,i);let n=gl("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,n),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,r){var i,n;let s=await this.getSubscriptionId(e);if(null!=(i=r?.internal)&&i.skipSubscribe)return s;r&&r?.transportType!==mx||await this.restartToComplete({topic:e,id:e,relay:t});let a={method:yq(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});let o=null==(n=r?.internal)?void 0:n.throwOnFailedPublish;try{if(r?.transportType===mT)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(e=>this.logger.warn(e))},(0,lg.toMiliseconds)(lg.ONE_SECOND)),s;let t=new Promise(async t=>{let r=i=>{i.topic===e&&(this.events.removeListener(mO,r),t(i.id))};this.events.on(mO,r);try{let i=await uB(new Promise((e,t)=>{this.relayer.request(a).catch(e=>{this.logger.warn(e,e?.message),t(e)}).then(e)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(mO,r),t(i)}catch{}}),i=await uB(t,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!i&&o)throw Error(`Subscribing to ${e} failed, please try again`);return i?s:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(mv),o)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;let t={method:yq(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await uB(new Promise(e=>{this.relayer.request(t).catch(e=>this.logger.warn(e)).then(e)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(mv)}}async rpcBatchFetchMessages(e){let t;if(!e.length)return;let r={method:yq(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{t=await await uB(new Promise((e,t)=>{this.relayer.request(r).catch(e=>{this.logger.warn(e),t(e)}).then(e)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(mv)}return t}rpcUnsubscribe(e,t,r){let i={method:yq(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,wY(w3({},t),wQ({id:e}))),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,w3({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,w3({},t)),this.topicMap.set(t.topic,e),this.events.emit(mO,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:t}=go("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(mR,wY(w3({},r),wQ({reason:t})))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit("subscription_sync")}async onRestart(){if(this.cached.length){let e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){let t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit("subscription_resubscribed")}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(e=>{var t;return e.topic===(null==(t=this.subscriptions.get(e.id))?void 0:t.topic)})){let{message:e}=go("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async e=>wY(w3({},e),wQ({id:await this.getSubscriptionId(e.topic)}))))))}async batchFetchMessages(e){var t;if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);let r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await (t=(0,lg.toMiliseconds)(lg.ONE_SECOND),new Promise(e=>setTimeout(e,t))),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:e}=go("NOT_INITIALIZED",this.name);throw Error(e)}}async restartToComplete(e){this.relayer.connected||this.relayer.connecting||(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return yN(e+await this.getClientId())}}var w6=Object.defineProperty,w4=Object.getOwnPropertySymbols,w7=Object.prototype.hasOwnProperty,w9=Object.prototype.propertyIsEnumerable,be=(e,t,r)=>t in e?w6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,bt=(e,t)=>{for(var r in t||(t={}))w7.call(t,r)&&be(e,r,t[r]);if(w4)for(var r of w4(t))w9.call(t,r)&&be(e,r,t[r]);return e},br=(e,t,r)=>be(e,"symbol"!=typeof t?t+"":t,r);class bi extends g6{constructor(t){var r;super(t),br(this,"protocol","wc"),br(this,"version",2),br(this,"core"),br(this,"logger"),br(this,"events",new lf.EventEmitter),br(this,"provider"),br(this,"messages"),br(this,"subscriber"),br(this,"publisher"),br(this,"name","relayer"),br(this,"transportExplicitlyClosed",!1),br(this,"initialized",!1),br(this,"connectionAttemptInProgress",!1),br(this,"relayUrl"),br(this,"projectId"),br(this,"packageName"),br(this,"bundleId"),br(this,"hasExperiencedNetworkDisruption",!1),br(this,"pingTimeout"),br(this,"heartBeatTimeout",(0,lg.toMiliseconds)(lg.THIRTY_SECONDS+lg.FIVE_SECONDS)),br(this,"reconnectTimeout"),br(this,"connectPromise"),br(this,"reconnectInProgress",!1),br(this,"requestsInFlight",[]),br(this,"connectTimeout",(0,lg.toMiliseconds)(15*lg.ONE_SECOND)),br(this,"request",async e=>{var t,r;this.logger.debug("Publishing Request Payload");let i=e.id||(0,ml.getBigIntRpcId)().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");let n=`${i}:${(null==(r=e.params)?void 0:r.tag)||""}`;this.requestsInFlight.push(n);let s=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter(e=>e!==n),s}catch(e){throw this.logger.debug(`Failed to Publish Request: ${i}`),e}}),br(this,"resetPingTimeout",()=>{ux()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,t,r,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(i=null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.terminate)||i.call(r)}catch(e){this.logger.warn(e,e?.message)}},this.heartBeatTimeout))}),br(this,"onPayloadHandler",e=>{this.onProviderPayload(e),this.resetPingTimeout()}),br(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit("relayer_connect")}),br(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),br(this,"onProviderErrorHandler",e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit("relayer_error",e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),br(this,"registerProviderListeners",()=>{this.provider.on(mE,this.onPayloadHandler),this.provider.on(mA,this.onConnectHandler),this.provider.on(mS,this.onDisconnectHandler),this.provider.on(mI,this.onProviderErrorHandler)}),this.core=t.core,this.logger=gx({logger:null!=(r=t.logger)?r:"error",name:this.name}),this.messages=new wD(this.logger,t.core),this.subscriber=new w8(this,this.logger),this.publisher=new wK(this,this.logger),this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||mm,uC()&&"u">typeof(null==e.g?void 0:e.g.Platform)&&(null==e.g?void 0:e.g.Platform.OS)==="android"?this.packageName=uR():uC()&&"u">typeof(null==e.g?void 0:e.g.Platform)&&(null==e.g?void 0:e.g.Platform.OS)==="ios"&&(this.bundleId=uR()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return gG(this.logger)}get connected(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===1}get connecting(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===0||void 0!==this.connectPromise}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:mx},"outbound")}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,t){var r,i,n;this.isInitialized(),null!=t&&t.transportType&&t?.transportType!=="relay"||await this.toEstablishConnection();let s=typeof(null==(r=t?.internal)?void 0:r.throwOnFailedPublish)>"u"||(null==(i=t?.internal)?void 0:i.throwOnFailedPublish),a=(null==(n=this.subscriber.topicMap.get(e))?void 0:n[0])||"",o,l=t=>{t.topic===e&&(this.subscriber.off(mO,l),o())};return await Promise.all([new Promise(e=>{o=e,this.subscriber.on(mO,l)}),new Promise(async(r,i)=>{a=await this.subscriber.subscribe(e,bt({internal:{throwOnFailedPublish:s}},t)).catch(e=>{s&&i(e)})||a,r()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await uB(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics)return void this.logger.info("Starting WS connection skipped because the client has no topics to work with.");if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await gA())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0)return void this.logger.trace("Batch message events is empty. Ignoring...");let t=e.sort((e,t)=>e.publishedAt-t.publishedAt);for(let e of(this.logger.debug(`Batch of ${t.length} message events sorted`),t))try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e,"Error while processing batch message event: "+e?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){let{topic:r}=e;if(!t.sessionExists){let e=uH(lg.FIVE_MINUTES);await this.core.pairing.pairings.set(r,{topic:r,expiry:e,relay:{protocol:"irn"},active:!1})}this.events.emit(mw,e),await this.recordMessageEvent(e,mC)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(e,t)=>{let r=()=>{t(Error("Connection interrupted while trying to connect"))};this.provider.once(mS,r),await uB(new Promise((e,t)=>{this.provider.connect().then(e).catch(t)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(e=>{t(e)}).finally(()=>{this.provider.off(mS,r),clearTimeout(this.reconnectTimeout)}),await new Promise(async(e,r)=>{let i=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(mS,i),await this.subscriber.start().then(e).catch(r).finally(()=>{this.provider.off(mS,i)})}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){await this.subscriber.stop(),this.logger.warn({},e.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(e=>setTimeout(e,(0,lg.toMiliseconds)(+t))),t++}}startPingTimeout(){var e,t,r,i,n;if(ux())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(n=null==(i=null==(r=this.provider)?void 0:r.connection)?void 0:i.socket)||n.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(e){this.logger.warn(e,e?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new mo.JsonRpcProvider(new md.default(function({protocol:e,version:t,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:a,bundleId:o,packageName:l}){var c,d;let u,h=r.split("?"),p=uM(e,t,i),f=(c=h[1]||"",d={auth:n,ua:p,projectId:s,useOnCloseEvent:a||void 0,packageName:l||void 0,bundleId:o||void 0},u=new URLSearchParams(c),Object.entries(d).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,t])=>{null!=t&&u.set(e,String(t))}),u.toString());return h[0]+"?"+f}({sdkVersion:mk,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){let{topic:r,message:i}=e;await this.messages.set(r,i,t)}async shouldIgnoreMessageEvent(e){let{topic:t,message:r}=e;if(!r||0===r.length)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;let i=this.messages.has(t,r);return i&&this.logger.warn(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,mc.isJsonRpcRequest)(e)){if(!e.method.endsWith("_subscription"))return;let t=e.params,{topic:r,message:i,publishedAt:n,attestation:s}=t.data,a={topic:r,message:i,publishedAt:n,transportType:mx,attestation:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(bt({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else(0,mc.isJsonRpcResponse)(e)&&this.events.emit(mb,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,mC),this.events.emit(mw,e))}async acknowledgePayload(e){let t=(0,ml.formatJsonRpcResult)(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(mE,this.onPayloadHandler),this.provider.off(mA,this.onConnectHandler),this.provider.off(mS,this.onDisconnectHandler),this.provider.off(mI,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let t=await gA();(function(t){var r,i;switch(uO()){case uT:r=t,!uC()&&uP()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)));break;case uI:i=t,uC()&&null!=e.g&&e.g.NetInfo&&e.g?.NetInfo.addEventListener(e=>i(e?.isConnected))}})(async e=>{t!==e&&(t=e,e?await this.transportOpen().catch(e=>this.logger.error(e,e?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(gC.HEARTBEAT_EVENTS.pulse,async()=>{var e;if(!this.transportExplicitlyClosed&&!this.connected&&(!(uP()&&(0,lm.getDocument)())||(null==(e=(0,lm.getDocument)())?void 0:e.visibilityState)==="visible"))try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit("relayer_disconnect"),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,lg.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){let{message:e}=go("NOT_INITIALIZED",this.name);throw Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise)return void await this.connectPromise;await this.connect()}}}function bn(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function bs(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}let ba="[object Arguments]",bo="[object Object]";function bl(){}function bc(e){if(!e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}var bd=Object.defineProperty,bu=Object.getOwnPropertySymbols,bh=Object.prototype.hasOwnProperty,bp=Object.prototype.propertyIsEnumerable,bf=(e,t,r)=>t in e?bd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,by=(e,t)=>{for(var r in t||(t={}))bh.call(t,r)&&bf(e,r,t[r]);if(bu)for(var r of bu(t))bp.call(t,r)&&bf(e,r,t[r]);return e},bg=(e,t,r)=>bf(e,"symbol"!=typeof t?t+"":t,r);class bm extends g4{constructor(e,t,r,i=mh,n){super(e,t,r,i),this.core=e,this.logger=t,this.name=r,bg(this,"map",new Map),bg(this,"version","0.3"),bg(this,"cached",[]),bg(this,"initialized",!1),bg(this,"getKey"),bg(this,"storagePrefix",mh),bg(this,"recentlyDeleted",[]),bg(this,"recentlyDeletedLimit",200),bg(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>{var t;this.getKey&&null!==e&&!gu(e)?this.map.set(this.getKey(e),e):(null==(t=e?.proposer)?void 0:t.publicKey)?this.map.set(e.id,e):e?.topic&&this.map.set(e.topic,e)}),this.cached=[],this.initialized=!0)}),bg(this,"set",async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())}),bg(this,"get",e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e))),bg(this,"getAll",e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(r=>{var i;return i=t[r],function e(t,r,i,n,s,a,o){let l=o(t,r,i,n,s,a);if(void 0!==l)return l;if(typeof t==typeof r)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return t===r;case"number":return t===r||Object.is(t,r)}return function t(r,i,n,s){if(Object.is(r,i))return!0;let a=bs(r),o=bs(i);if(a===ba&&(a=bo),o===ba&&(o=bo),a!==o)return!1;switch(a){case"[object String]":return r.toString()===i.toString();case"[object Number]":{let e=r.valueOf(),t=i.valueOf();return e===t||Number.isNaN(e)&&Number.isNaN(t)}case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(r.valueOf(),i.valueOf());case"[object RegExp]":return r.source===i.source&&r.flags===i.flags;case"[object Function]":return r===i}let l=(n=n??new Map).get(r),c=n.get(i);if(null!=l&&null!=c)return l===i;n.set(r,i),n.set(i,r);try{switch(a){case"[object Map]":if(r.size!==i.size)return!1;for(let[t,a]of r.entries())if(!i.has(t)||!e(a,i.get(t),t,r,i,n,s))return!1;return!0;case"[object Set]":{if(r.size!==i.size)return!1;let t=Array.from(r.values()),a=Array.from(i.values());for(let o=0;o<t.length;o++){let l=t[o],c=a.findIndex(t=>e(l,t,void 0,r,i,n,s));if(-1===c)return!1;a.splice(c,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if("u">typeof t6.Buffer&&t6.Buffer.isBuffer(r)!==t6.Buffer.isBuffer(i)||r.length!==i.length)return!1;for(let t=0;t<r.length;t++)if(!e(r[t],i[t],t,r,i,n,s))return!1;return!0;case"[object ArrayBuffer]":return r.byteLength===i.byteLength&&t(new Uint8Array(r),new Uint8Array(i),n,s);case"[object DataView]":return r.byteLength===i.byteLength&&r.byteOffset===i.byteOffset&&t(new Uint8Array(r),new Uint8Array(i),n,s);case"[object Error]":return r.name===i.name&&r.message===i.message;case bo:{if(!(t(r.constructor,i.constructor,n,s)||bc(r)&&bc(i)))return!1;let a=[...Object.keys(r),...bn(r)],o=[...Object.keys(i),...bn(i)];if(a.length!==o.length)return!1;for(let t=0;t<a.length;t++){let o=a[t],l=r[o];if(!Object.hasOwn(i,o))return!1;let c=i[o];if(!e(l,c,o,r,i,n,s))return!1}return!0}default:return!1}}finally{n.delete(r),n.delete(i)}}(t,r,a,o)}(i,e[r],void 0,void 0,void 0,void 0,bl)})):this.values)),bg(this,"update",async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});let r=by(by({},this.getData(e)),t);this.map.set(e,r),await this.persist()}),bg(this,"delete",async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())}),this.logger=gY(t,this.name),this.storagePrefix=i,this.getKey=n}get context(){return gG(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){let{message:t}=go("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),Error(t)}let{message:t}=go("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:e}=go("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=go("NOT_INITIALIZED",this.name);throw Error(e)}}}var bw=Object.defineProperty,bb=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?bw(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class bv{constructor(e,t){this.core=e,this.logger=t,bb(this,"name","pairing"),bb(this,"version","0.3"),bb(this,"events",new lf.default),bb(this,"pairings"),bb(this,"initialized",!1),bb(this,"storagePrefix",mh),bb(this,"ignoredPayloadTypes",[1]),bb(this,"registeredMethods",[]),bb(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),bb(this,"register",({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]}),bb(this,"create",async e=>{this.isInitialized();let t=yO(),r=await this.core.crypto.setSymKey(t),i=uH(lg.FIVE_MINUTES),n={protocol:"irn"},s={topic:r,expiry:i,relay:n,active:!1,methods:e?.methods},a=yX({protocol:this.core.protocol,version:this.core.version,topic:r,symKey:t,relay:n,expiryTimestamp:i,methods:e?.methods});return this.events.emit(mM,s),this.core.expirer.set(r,i),await this.pairings.set(r,s),await this.core.relayer.subscribe(r,{transportType:e?.transportType,internal:e?.internal}),{topic:r,uri:a}}),bb(this,"pair",async e=>{let t;this.isInitialized();let r=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:["pairing_started"]}});this.isValidPair(e,r);let{topic:i,symKey:n,relay:s,expiryTimestamp:a,methods:o}=yQ(e.uri);if(r.props.properties.topic=i,r.addTrace("pairing_uri_validation_success"),r.addTrace("pairing_uri_not_expired"),this.pairings.keys.includes(i)){if(t=this.pairings.get(i),r.addTrace("existing_pairing"),t.active)throw r.setError("active_pairing_already_exists"),Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);r.addTrace("pairing_not_expired")}let l=a||uH(lg.FIVE_MINUTES),c={topic:i,relay:s,expiry:l,active:!1,methods:o};this.core.expirer.set(i,l),await this.pairings.set(i,c),r.addTrace("store_new_pairing"),e.activatePairing&&await this.activate({topic:i}),this.events.emit(mM,c),r.addTrace("emit_inactive_pairing"),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(n,i),r.addTrace("subscribing_pairing_topic");try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{r.setError("no_internet_connection")}try{await this.core.relayer.subscribe(i,{relay:s})}catch(e){throw r.setError("subscribe_pairing_topic_failure"),e}return r.addTrace("subscribe_pairing_topic_success"),c}),bb(this,"activate",async({topic:e})=>{this.isInitialized();let t=uH(lg.FIVE_MINUTES);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})}),bb(this,"ping",async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:t}=e;if(this.pairings.keys.includes(t)){let e=await this.sendRequest(t,"wc_pairingPing",{}),{done:r,resolve:i,reject:n}=uL();this.events.once(uz("pairing_ping",e),({error:e})=>{e?n(e):i()}),await r()}}),bb(this,"updateExpiry",async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})}),bb(this,"updateMetadata",async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})}),bb(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),bb(this,"disconnect",async e=>{this.isInitialized(),await this.isValidDisconnect(e);let{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",gl("USER_DISCONNECTED")),await this.deletePairing(t))}),bb(this,"formatUriFromPairing",e=>{this.isInitialized();let{topic:t,relay:r,expiry:i,methods:n}=e,s=this.core.crypto.keychain.get(t);return yX({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:s,relay:r,expiryTimestamp:i,methods:n})}),bb(this,"sendRequest",async(e,t,r)=>{let i=(0,ml.formatJsonRpcRequest)(t,r),n=await this.core.crypto.encode(e,i),s=mN[t].req;return this.core.history.set(e,i),this.core.relayer.publish(e,n,s),i.id}),bb(this,"sendResult",async(e,t,r)=>{let i=(0,ml.formatJsonRpcResult)(e,r),n=await this.core.crypto.encode(t,i),s=mN[(await this.core.history.get(t,e)).request.method].res;await this.core.relayer.publish(t,n,s),await this.core.history.resolve(i)}),bb(this,"sendError",async(e,t,r)=>{let i=(0,ml.formatJsonRpcError)(e,r),n=await this.core.crypto.encode(t,i),s=(await this.core.history.get(t,e)).request.method,a=mN[s]?mN[s].res:mN.unregistered_method.res;await this.core.relayer.publish(t,n,a),await this.core.history.resolve(i)}),bb(this,"deletePairing",async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,gl("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])}),bb(this,"cleanup",async()=>{let e=this.pairings.getAll().filter(e=>uq(e.expiry));await Promise.all(e.map(e=>this.deletePairing(e.topic)))}),bb(this,"onRelayEventRequest",async e=>{let{topic:t,payload:r}=e;switch(r.method){case"wc_pairingPing":return await this.onPairingPingRequest(t,r);case"wc_pairingDelete":return await this.onPairingDeleteRequest(t,r);default:return await this.onUnknownRpcMethodRequest(t,r)}}),bb(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r}=e,i=(await this.core.history.get(t,r.id)).request.method;return"wc_pairingPing"===i?this.onPairingPingResponse(t,r):this.onUnknownRpcMethodResponse(i)}),bb(this,"onPairingPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.events.emit("pairing_ping",{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),bb(this,"onPairingPingResponse",(e,t)=>{let{id:r}=t;setTimeout(()=>{(0,mc.isJsonRpcResult)(t)?this.events.emit(uz("pairing_ping",r),{}):(0,mc.isJsonRpcError)(t)&&this.events.emit(uz("pairing_ping",r),{error:t.error})},500)}),bb(this,"onPairingDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(mU,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),bb(this,"onUnknownRpcMethodRequest",async(e,t)=>{let{id:r,method:i}=t;try{if(this.registeredMethods.includes(i))return;let t=gl("WC_METHOD_UNSUPPORTED",i);await this.sendError(r,e,t),this.logger.error(t)}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),bb(this,"onUnknownRpcMethodResponse",e=>{this.registeredMethods.includes(e)||this.logger.error(gl("WC_METHOD_UNSUPPORTED",e))}),bb(this,"isValidPair",(e,t)=>{var r;if(!gb(e)){let{message:r}=go("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(m$),Error(r)}if(!function(e){function t(e){try{return"u">typeof new URL(e)}catch{return!1}}try{if(gh(e,!1)){if(t(e))return!0;let r=uY(e);return t(r)}}catch{}return!1}(e.uri)){let{message:r}=go("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(m$),Error(r)}let i=yQ(e?.uri);if(!(null!=(r=i?.relay)&&r.protocol)){let{message:e}=go("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(m$),Error(e)}if(!(null!=i&&i.symKey)){let{message:e}=go("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(m$),Error(e)}if(null!=i&&i.expiryTimestamp&&(0,lg.toMiliseconds)(i?.expiryTimestamp)<Date.now()){t.setError("pairing_expired");let{message:e}=go("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(e)}}),bb(this,"isValidPing",async e=>{if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),bb(this,"isValidDisconnect",async e=>{if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),bb(this,"isValidPairingTopic",async e=>{if(!gh(e,!1)){let{message:t}=go("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.pairings.keys.includes(e)){let{message:t}=go("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(uq(this.pairings.get(e).expiry)){await this.deletePairing(e);let{message:t}=go("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}),this.core=e,this.logger=gY(t,this.name),this.pairings=new bm(this.core,this.logger,this.name,this.storagePrefix)}get context(){return gG(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=go("NOT_INITIALIZED",this.name);throw Error(e)}}registerRelayerEvents(){this.core.relayer.on(mw,async e=>{let{topic:t,message:r,transportType:i}=e;if(this.pairings.keys.includes(t)&&i!==mT&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{let e=await this.core.crypto.decode(t,r);(0,mc.isJsonRpcRequest)(e)?(this.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e})):(0,mc.isJsonRpcResponse)(e)&&(await this.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e}),this.core.history.delete(t,e.id)),await this.core.relayer.messages.ack(t,r)}catch(e){this.logger.error(e)}})}registerExpirerEvents(){this.core.expirer.on(mF,async e=>{let{topic:t}=uF(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}var b_=Object.defineProperty,bE=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?b_(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class bA extends g3{constructor(e,t){super(e,t),this.core=e,this.logger=t,bE(this,"records",new Map),bE(this,"events",new lf.EventEmitter),bE(this,"name","history"),bE(this,"version","0.3"),bE(this,"cached",[]),bE(this,"initialized",!1),bE(this,"storagePrefix",mh),bE(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.records.set(e.id,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),bE(this,"set",(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;let i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:uH(lg.THIRTY_DAYS)};this.records.set(i.id,i),this.persist(),this.events.emit(mD,i)}),bE(this,"resolve",async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;let t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=(0,mc.isJsonRpcError)(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(mj,t))}),bE(this,"get",async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t))),bE(this,"delete",(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(r=>{r.topic===e&&("u">typeof t&&r.id!==t||(this.records.delete(r.id),this.events.emit(mL,r)))}),this.persist()}),bE(this,"exists",async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e)),bE(this,"on",(e,t)=>{this.events.on(e,t)}),bE(this,"once",(e,t)=>{this.events.once(e,t)}),bE(this,"off",(e,t)=>{this.events.off(e,t)}),bE(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=gY(t,this.name)}get context(){return gG(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if("u">typeof t.response)return;let r={topic:t.topic,request:(0,ml.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:t}=go("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit("history_sync")}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:e}=go("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(mD,e=>{this.logger.info(`Emitting ${mD}`),this.logger.debug({type:"event",event:mD,record:e})}),this.events.on(mj,e=>{this.logger.info(`Emitting ${mj}`),this.logger.debug({type:"event",event:mj,record:e})}),this.events.on(mL,e=>{this.logger.info(`Emitting ${mL}`),this.logger.debug({type:"event",event:mL,record:e})}),this.core.heartbeat.on(gC.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,lg.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(mL,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=go("NOT_INITIALIZED",this.name);throw Error(e)}}}var bS=Object.defineProperty,bI=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?bS(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class bk extends g9{constructor(e,t){super(e,t),this.core=e,this.logger=t,bI(this,"expirations",new Map),bI(this,"events",new lf.EventEmitter),bI(this,"name","expirer"),bI(this,"version","0.3"),bI(this,"cached",[]),bI(this,"initialized",!1),bI(this,"storagePrefix",mh),bI(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.expirations.set(e.target,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),bI(this,"has",e=>{try{let t=this.formatTarget(e);return"u">typeof this.getExpiration(t)}catch{return!1}}),bI(this,"set",(e,t)=>{this.isInitialized();let r=this.formatTarget(e),i={target:r,expiry:t};this.expirations.set(r,i),this.checkExpiry(r,i),this.events.emit(mB,{target:r,expiration:i})}),bI(this,"get",e=>{this.isInitialized();let t=this.formatTarget(e);return this.getExpiration(t)}),bI(this,"del",e=>{if(this.isInitialized(),this.has(e)){let t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit(mW,{target:t,expiration:r})}}),bI(this,"on",(e,t)=>{this.events.on(e,t)}),bI(this,"once",(e,t)=>{this.events.once(e,t)}),bI(this,"off",(e,t)=>{this.events.off(e,t)}),bI(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=gY(t,this.name)}get context(){return gG(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return uW("topic",e);if("number"==typeof e)return uW("id",e);let{message:t}=go("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit("expirer_sync")}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:e}=go("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:t}=go("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),Error(t)}return t}checkExpiry(e,t){let{expiry:r}=t;(0,lg.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(mF,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(gC.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(mB,e=>{this.logger.info(`Emitting ${mB}`),this.logger.debug({type:"event",event:mB,data:e}),this.persist()}),this.events.on(mF,e=>{this.logger.info(`Emitting ${mF}`),this.logger.debug({type:"event",event:mF,data:e}),this.persist()}),this.events.on(mW,e=>{this.logger.info(`Emitting ${mW}`),this.logger.debug({type:"event",event:mW,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=go("NOT_INITIALIZED",this.name);throw Error(e)}}}var bT=Object.defineProperty,bx=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?bT(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class bC extends me{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,bx(this,"name","verify-api"),bx(this,"abortController"),bx(this,"isDevEnv"),bx(this,"verifyUrlV3",mq),bx(this,"storagePrefix",mh),bx(this,"version",2),bx(this,"publicKey"),bx(this,"fetchPromise"),bx(this,"init",async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,lg.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),bx(this,"register",async e=>{if(!uP()||this.isDevEnv)return;let t=window.location.origin,{id:r,decryptedId:i}=e,n=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${r}&decryptedId=${i}`;try{let e=(0,lm.getDocument)(),t=this.startAbortTimer(5*lg.ONE_SECOND),i=await new Promise((i,s)=>{let a=()=>{window.removeEventListener("message",l),e.body.removeChild(o),s("attestation aborted")};this.abortController.signal.addEventListener("abort",a);let o=e.createElement("iframe");o.src=n,o.style.display="none",o.addEventListener("error",a,{signal:this.abortController.signal});let l=n=>{if(n.data&&"string"==typeof n.data)try{let s=JSON.parse(n.data);if("verify_attestation"===s.type){if((0,dQ.decodeJWT)(s.attestation).payload.id!==r)return;clearInterval(t),e.body.removeChild(o),this.abortController.signal.removeEventListener("abort",a),window.removeEventListener("message",l),i(null===s.attestation?"":s.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(o),window.addEventListener("message",l,{signal:this.abortController.signal})});return this.logger.debug(i,"jwt attestation"),i}catch(e){this.logger.warn(e)}return""}),bx(this,"resolve",async e=>{if(this.isDevEnv)return"";let{attestationId:t,hash:r,encryptedId:i}=e;if(""===t)return void this.logger.debug("resolve: attestationId is empty, skipping");if(t){if((0,dQ.decodeJWT)(t).payload.id!==i)return;let e=await this.isValidJwtAttestation(t);if(e)return e.isVerified?e:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!r)return;let n=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(r,n)}),bx(this,"fetchAttestation",async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);let r=this.startAbortTimer(5*lg.ONE_SECOND),i=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(r),200===i.status?await i.json():void 0}),bx(this,"getVerifyUrl",e=>{let t=e||mH;return mz.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${mH}`),t=mH),t}),bx(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let e=this.startAbortTimer(lg.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}}),bx(this,"persistPublicKey",async e=>{this.logger.debug(e,"persisting public key to local storage"),await this.store.setItem(this.storeKey,e),this.publicKey=e}),bx(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),bx(this,"isValidJwtAttestation",async e=>{let t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}let r=await this.fetchAndPersistPublicKey();try{if(r)return this.validateAttestation(e,r)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}}),bx(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),bx(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async e=>{let t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))});let e=await this.fetchPromise;return this.fetchPromise=void 0,e}),bx(this,"validateAttestation",(e,t)=>{let r=function(e,t){let r,i,[n,s,a]=e.split("."),o=t6.Buffer.from(yj(a),"base64");if(64!==o.length)throw Error("Invalid signature length");let l=o.slice(0,32),c=o.slice(32,64),d=pe(`${n}.${s}`),u=(r=t6.Buffer.from(t.x,"base64"),i=t6.Buffer.from(t.y,"base64"),(0,d1.concat)([new Uint8Array([4]),r,i]));if(!yI.verify((0,d1.concat)([l,c]),d,u))throw Error("Invalid signature");return(0,dQ.decodeJWT)(e).payload}(e,t.publicKey),i={hasExpired:(0,lg.toMiliseconds)(r.exp)<Date.now(),payload:r};if(i.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:i.payload.origin,isScam:i.payload.isScam,isVerified:i.payload.isVerified}}),this.logger=gY(t,this.name),this.abortController=new AbortController,this.isDevEnv=uG(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return gG(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,lg.toMiliseconds)(e))}}var bP=Object.defineProperty,bO=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?bP(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class bR extends mt{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,bO(this,"context","echo"),bO(this,"registerDeviceToken",async e=>{let{clientId:t,token:r,notificationType:i,enableEncrypted:n=!1}=e,s=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:i,token:r,always_raw:n})})}),this.logger=gY(t,this.context)}}var bN=Object.defineProperty,bM=Object.getOwnPropertySymbols,bU=Object.prototype.hasOwnProperty,bD=Object.prototype.propertyIsEnumerable,bj=(e,t,r)=>t in e?bN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,bL=(e,t)=>{for(var r in t||(t={}))bU.call(t,r)&&bj(e,r,t[r]);if(bM)for(var r of bM(t))bD.call(t,r)&&bj(e,r,t[r]);return e},bB=(e,t,r)=>bj(e,"symbol"!=typeof t?t+"":t,r);class bW extends mr{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,bB(this,"context","event-client"),bB(this,"storagePrefix",mh),bB(this,"storageVersion",.1),bB(this,"events",new Map),bB(this,"shouldPersist",!1),bB(this,"init",async()=>{if(!uG())try{let e={eventId:uZ(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:uM(this.core.relayer.protocol,this.core.relayer.version,mk)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}}),bB(this,"createEvent",e=>{let{event:t="ERROR",type:r="",properties:{topic:i,trace:n}}=e,s=uZ(),a=this.core.projectId||"",o=bL({eventId:s,timestamp:Date.now(),props:{event:t,type:r,properties:{topic:i,trace:n}},bundleId:a,domain:this.getAppDomain()},this.setMethods(s));return this.telemetryEnabled&&(this.events.set(s,o),this.shouldPersist=!0),o}),bB(this,"getEvent",e=>{let{eventId:t,topic:r}=e;if(t)return this.events.get(t);let i=Array.from(this.events.values()).find(e=>e.props.properties.topic===r);if(i)return bL(bL({},i),this.setMethods(i.eventId))}),bB(this,"deleteEvent",e=>{let{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0}),bB(this,"setEventListeners",()=>{this.core.heartbeat.on(gC.HEARTBEAT_EVENTS.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(e=>{(0,lg.fromMiliseconds)(Date.now())-(0,lg.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)})})}),bB(this,"setMethods",e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)})),bB(this,"addTrace",(e,t)=>{let r=this.events.get(e);r&&(r.props.properties.trace.push(t),this.events.set(e,r),this.shouldPersist=!0)}),bB(this,"setError",(e,t)=>{let r=this.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),this.events.set(e,r),this.shouldPersist=!0)}),bB(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),bB(this,"restore",async()=>{try{let e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach(e=>{this.events.set(e.eventId,bL(bL({},e),this.setMethods(e.eventId)))})}catch(e){this.logger.warn(e)}}),bB(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let e=[];for(let[t,r]of this.events)r.props.type&&e.push(r);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(let t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}}),bB(this,"sendEvent",async e=>{let t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${mk}${t}`,{method:"POST",body:JSON.stringify(e)})}),bB(this,"getAppDomain",()=>uN().url),this.logger=gY(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var bF=Object.defineProperty,bH=Object.getOwnPropertySymbols,bq=Object.prototype.hasOwnProperty,bz=Object.prototype.propertyIsEnumerable,b$=(e,t,r)=>t in e?bF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,bK=(e,t)=>{for(var r in t||(t={}))bq.call(t,r)&&b$(e,r,t[r]);if(bH)for(var r of bH(t))bz.call(t,r)&&b$(e,r,t[r]);return e},bV=(e,t,r)=>b$(e,"symbol"!=typeof t?t+"":t,r);class bJ extends g1{constructor(e){var t;super(e),bV(this,"protocol","wc"),bV(this,"version",2),bV(this,"name",mu),bV(this,"relayUrl"),bV(this,"projectId"),bV(this,"customStoragePrefix"),bV(this,"events",new lf.EventEmitter),bV(this,"logger"),bV(this,"heartbeat"),bV(this,"relayer"),bV(this,"crypto"),bV(this,"storage"),bV(this,"history"),bV(this,"expirer"),bV(this,"pairing"),bV(this,"verify"),bV(this,"echoClient"),bV(this,"linkModeSupportedApps"),bV(this,"eventClient"),bV(this,"initialized",!1),bV(this,"logChunkController"),bV(this,"on",(e,t)=>this.events.on(e,t)),bV(this,"once",(e,t)=>this.events.once(e,t)),bV(this,"off",(e,t)=>this.events.off(e,t)),bV(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),bV(this,"dispatchEnvelope",({topic:e,message:t,sessionExists:r})=>{if(!e||!t)return;let i={topic:e,message:t,publishedAt:Date.now(),transportType:mT};this.relayer.onLinkMessageEvent(i,{sessionExists:r})});const r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(e){console.warn("Failed to copy global core",e)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||mm,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const{logger:i,chunkLoggerController:n}=function(e){var t,r,i;let n,s,a;return"u">typeof e.loggerOverride&&"string"!=typeof e.loggerOverride?{logger:e.loggerOverride,chunkLoggerController:null}:(a=new gF(null==(r=(t=e).opts)?void 0:r.level,t.maxSizeInBytes),{logger:(0,gO.default)((n=gZ({},t.opts),s={level:"trace",browser:gq(gZ({},null==(i=t.opts)?void 0:i.browser),gz({write:e=>a.write(e)}))},gq(n,gz(s)))),chunkLoggerController:a})}({opts:function(e){return gq(gZ({},e),gz({level:e?.level||"info"}))}({level:"string"==typeof e?.logger&&e.logger?e.logger:"error",name:mu}),maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=n,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=gY(i,this.name),this.heartbeat=new gC.HeartBeat,this.crypto=new wT(this,this.logger,e?.keychain),this.history=new bA(this,this.logger),this.expirer=new bk(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new gP.default(bK(bK({},mp),e?.storageOptions)),this.relayer=new bi({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new bv(this,this.logger),this.verify=new bC(this,this.logger,this.storage),this.echoClient=new bR(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new bW(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){let t=new bJ(e);await t.initialize();let r=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",r),t}get context(){return gG(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(mP,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(mP)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;let t=`_walletConnectCore_${e}`,r=`${t}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[t]}catch(e){console.warn("Failed to get global WalletConnect core",e);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;let r=`_walletConnectCore_${(null==(t=e.opts)?void 0:t.customStoragePrefix)||""}`;globalThis[r]=e}catch(e){console.warn("Failed to set global WalletConnect core",e)}}isGlobalCoreDisabled(){try{return"u">typeof s6.default&&"true"===s6.default.env.DISABLE_GLOBAL_CORE}catch{return!0}}}let bZ="client",bG=`wc@2:${bZ}:`,bY="WALLETCONNECT_DEEPLINK_CHOICE",bQ=(lg.THIRTY_DAYS,"Proposal expired"),bX=lg.SEVEN_DAYS,b0={wc_sessionPropose:{req:{ttl:lg.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:lg.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:lg.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:lg.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:lg.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:lg.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:lg.ONE_DAY,prompt:!1,tag:1104},res:{ttl:lg.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:lg.ONE_DAY,prompt:!1,tag:1106},res:{ttl:lg.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:lg.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:lg.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:lg.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:lg.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:lg.ONE_DAY,prompt:!1,tag:1112},res:{ttl:lg.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:lg.ONE_DAY,prompt:!1,tag:1114},res:{ttl:lg.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:lg.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:lg.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:lg.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:lg.FIVE_MINUTES,prompt:!1,tag:1119}}},b1={min:lg.FIVE_MINUTES,max:lg.SEVEN_DAYS},b2="IDLE",b3="ACTIVE",b5={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},b8=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],b6="wc@1.5:auth:",b4=`${b6}:PUB_KEY`;var b7=Object.defineProperty,b9=Object.defineProperties,ve=Object.getOwnPropertyDescriptors,vt=Object.getOwnPropertySymbols,vr=Object.prototype.hasOwnProperty,vi=Object.prototype.propertyIsEnumerable,vn=(e,t,r)=>t in e?b7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,vs=(e,t)=>{for(var r in t||(t={}))vr.call(t,r)&&vn(e,r,t[r]);if(vt)for(var r of vt(t))vi.call(t,r)&&vn(e,r,t[r]);return e},va=(e,t,r)=>vn(e,"symbol"!=typeof t?t+"":t,r);class vo extends ma{constructor(t){super(t),va(this,"name","engine"),va(this,"events",new lf.default),va(this,"initialized",!1),va(this,"requestQueue",{state:b2,queue:[]}),va(this,"sessionRequestQueue",{state:b2,queue:[]}),va(this,"emittedSessionRequests",new uQ({limit:500})),va(this,"requestQueueDelay",lg.ONE_SECOND),va(this,"expectedPairingMethodMap",new Map),va(this,"recentlyDeletedMap",new Map),va(this,"recentlyDeletedLimit",200),va(this,"relayMessageCache",[]),va(this,"pendingSessions",new Map),va(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(b0)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,lg.toMiliseconds)(this.requestQueueDelay)))}),va(this,"connect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let t=b9(vs({},e),ve({requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}}));await this.isValidConnect(t),t.optionalNamespaces=function(e,t){var r,i,n,s,a,o;let l=gi(e),c=gi(t),d={};for(let e of Object.keys(l).concat(Object.keys(c)))d[e]={chains:u$(null==(r=l[e])?void 0:r.chains,null==(i=c[e])?void 0:i.chains),methods:u$(null==(n=l[e])?void 0:n.methods,null==(s=c[e])?void 0:s.methods),events:u$(null==(a=l[e])?void 0:a.events,null==(o=c[e])?void 0:o.events)};return d}(t.requiredNamespaces,t.optionalNamespaces),t.requiredNamespaces={};let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:n,sessionProperties:s,scopedProperties:a,relays:o}=t,l=r,c,d=!1;try{if(l){let e=this.client.core.pairing.pairings.get(l);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),d=e.active}}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${l}) failed`),e}if(!l||!d){let{topic:e,uri:t}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});l=e,c=t}if(!l){let{message:e}=go("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw Error(e)}let u=await this.client.core.crypto.generateKeyPair(),h=b0.wc_sessionPropose.req.ttl||lg.FIVE_MINUTES,p=uH(h),f=b9(vs(vs({requiredNamespaces:i,optionalNamespaces:n,relays:o??[{protocol:"irn"}],proposer:{publicKey:u,metadata:this.client.metadata},expiryTimestamp:p,pairingTopic:l},s&&{sessionProperties:s}),a&&{scopedProperties:a}),ve({id:(0,ml.payloadId)()})),y=uz("session_connect",f.id),{reject:g,resolve:m,done:w}=uL(h,bQ),b=({id:e})=>{e===f.id&&(this.client.events.off("proposal_expire",b),this.pendingSessions.delete(f.id),this.events.emit(y,{error:{message:bQ,code:0}}))};return this.client.events.on("proposal_expire",b),this.events.once(y,({error:e,session:t})=>{this.client.events.off("proposal_expire",b),e?g(e):t&&m(t)}),await this.sendProposeSession({proposal:f,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:f.id}}}),await this.setProposal(f.id,f),{uri:c,approval:w}}),va(this,"pair",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}}),va(this,"approve",async e=>{var t,r,i;let n=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[mK]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw n.setError("no_internet_connection"),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),n.setError("proposal_not_found"),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),n.setError("session_approve_namespace_validation_failure"),e}let{id:s,relayProtocol:a,namespaces:o,sessionProperties:l,scopedProperties:c,sessionConfig:d}=e,u=this.client.proposal.get(s);this.client.core.eventClient.deleteEvent({eventId:n.eventId});let{pairingTopic:h,proposer:p,requiredNamespaces:f,optionalNamespaces:y}=u,g=null==(r=this.client.core.eventClient)?void 0:r.getEvent({topic:h});g||(g=null==(i=this.client.core.eventClient)?void 0:i.createEvent({type:mK,properties:{topic:h,trace:[mK,"session_namespaces_validation_success"]}}));let m=await this.client.core.crypto.generateKeyPair(),w=p.publicKey,b=await this.client.core.crypto.generateSharedKey(m,w),v=vs(vs(vs({relay:{protocol:a??"irn"},namespaces:o,controller:{publicKey:m,metadata:this.client.metadata},expiry:uH(bX)},l&&{sessionProperties:l}),c&&{scopedProperties:c}),d&&{sessionConfig:d});g.addTrace("subscribing_session_topic");try{await this.client.core.relayer.subscribe(b,{transportType:mx,internal:{skipSubscribe:!0}})}catch(e){throw g.setError("subscribe_session_topic_failure"),e}g.addTrace("subscribe_session_topic_success");let _=b9(vs({},v),ve({topic:b,requiredNamespaces:f,optionalNamespaces:y,pairingTopic:h,acknowledged:!1,self:v.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:m,transportType:mx}));await this.client.session.set(b,_),g.addTrace("store_session");try{await this.sendApproveSession({sessionTopic:b,proposal:u,pairingProposalResponse:{relay:{protocol:a??"irn"},responderPublicKey:m},sessionSettleRequest:v,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:s}}}),g.addTrace("session_approve_publish_success")}catch(e){throw this.client.logger.error(e),this.client.session.delete(b,gl("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(b),e}return this.client.core.eventClient.deleteEvent({eventId:g.eventId}),await this.client.core.pairing.updateMetadata({topic:h,metadata:p.metadata}),await this.deleteProposal(s),await this.client.core.pairing.activate({topic:h}),await this.setExpiry(b,uH(bX)),{topic:b,acknowledged:()=>Promise.resolve(this.client.session.get(b))}}),va(this,"reject",async e=>{let t;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}let{id:r,reason:i}=e;try{t=this.client.proposal.get(r).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),e}t&&await this.sendError({id:r,topic:t,error:i,rpcOpts:b0.wc_sessionPropose.reject}),await this.deleteProposal(r)}),va(this,"update",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}let{topic:t,namespaces:r}=e,{done:i,resolve:n,reject:s}=uL(),a=(0,ml.payloadId)(),o=(0,ml.getBigIntRpcId)().toString(),l=this.client.session.get(t).namespaces;return this.events.once(uz("session_update",a),({error:e})=>{e?s(e):n()}),await this.client.session.update(t,{namespaces:r}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:r},throwOnFailedPublish:!0,clientRpcId:a,relayRpcId:o}).catch(e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:l}),s(e)}),{acknowledged:i}}),va(this,"extend",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}let{topic:t}=e,r=(0,ml.payloadId)(),{done:i,resolve:n,reject:s}=uL();return this.events.once(uz("session_extend",r),({error:e})=>{e?s(e):n()}),await this.setExpiry(t,uH(bX)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:r,throwOnFailedPublish:!0}).catch(e=>{s(e)}),{acknowledged:i}}),va(this,"request",async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}let{chainId:t,request:r,topic:i,expiry:n=b0.wc_sessionRequest.req.ttl}=e,s=this.client.session.get(i);s?.transportType===mx&&await this.confirmOnlineStateOrThrow();let a=(0,ml.payloadId)(),o=(0,ml.getBigIntRpcId)().toString(),{done:l,resolve:c,reject:d}=uL(n,"Request expired. Please try again.");this.events.once(uz("session_request",a),({error:e,result:t})=>{e?d(e):c(t)});let u="wc_sessionRequest",h=this.getAppLinkIfEnabled(s.peer.metadata,s.transportType);if(h)return await this.sendRequest({clientRpcId:a,relayRpcId:o,topic:i,method:u,params:{request:b9(vs({},r),ve({expiryTimestamp:uH(n)})),chainId:t},expiry:n,throwOnFailedPublish:!0,appLink:h}).catch(e=>d(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:a}),await l();let p={request:b9(vs({},r),ve({expiryTimestamp:uH(n)})),chainId:t};return await Promise.all([new Promise(async e=>{await this.sendRequest({clientRpcId:a,relayRpcId:o,topic:i,method:u,params:p,expiry:n,throwOnFailedPublish:!0,tvf:this.getTVFParams(a,p)}).catch(e=>d(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:a}),e()}),new Promise(async e=>{var t;if(!(null!=(t=s.sessionConfig)&&t.disableDeepLink)){let e=await uV(this.client.core.storage,bY);await uK({id:a,topic:i,wcDeepLink:e})}e()}),l()]).then(e=>e[2])}),va(this,"respond",async e=>{var t,r;this.isInitialized();let i=this.client.core.eventClient.createEvent({properties:{topic:e?.topic||(null==(r=null==(t=e?.response)?void 0:t.id)?void 0:r.toString()),trace:["session_request_response_started"]}});try{await this.isValidRespond(e)}catch(e){throw i.addTrace(e?.message),i.setError("session_request_response_validation_failure"),e}i.addTrace("session_request_response_validation_success");let{topic:n,response:s}=e,{id:a}=s,o=this.client.session.get(n);o.transportType===mx&&await this.confirmOnlineStateOrThrow();let l=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);try{i.addTrace("session_request_response_publish_started"),(0,mc.isJsonRpcResult)(s)?await this.sendResult({id:a,topic:n,result:s.result,throwOnFailedPublish:!0,appLink:l}):(0,mc.isJsonRpcError)(s)&&await this.sendError({id:a,topic:n,error:s.error,appLink:l}),this.cleanupAfterResponse(e)}catch(e){throw i.addTrace(e?.message),i.setError("session_request_response_publish_failure"),e}}),va(this,"ping",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}let{topic:t}=e;if(this.client.session.keys.includes(t)){let e=(0,ml.payloadId)(),r=(0,ml.getBigIntRpcId)().toString(),{done:i,resolve:n,reject:s}=uL();this.events.once(uz("session_ping",e),({error:e})=>{e?s(e):n()}),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:r}),i()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))}),va(this,"emit",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);let{topic:t,event:r,chainId:i}=e,n=(0,ml.getBigIntRpcId)().toString(),s=(0,ml.payloadId)();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:r,chainId:i},throwOnFailedPublish:!0,relayRpcId:n,clientRpcId:s})}),va(this,"disconnect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);let{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:gl("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(t))await this.client.core.pairing.disconnect({topic:t});else{let{message:e}=go("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw Error(e)}}),va(this,"find",e=>(this.isInitialized(),this.client.session.getAll().filter(t=>(function(e,t){let{requiredNamespaces:r}=t,i=Object.keys(e.namespaces),n=Object.keys(r),s=!0;return!!uU(n,i)&&(i.forEach(t=>{let{accounts:i,methods:n,events:a}=e.namespaces[t],o=ge(i),l=r[t];uU(uy(t,l),o)&&uU(l.methods,n)&&uU(l.events,a)||(s=!1)}),s)})(t,e)))),va(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),va(this,"authenticate",async(e,t)=>{var r,i,n,s,a;let o;this.isInitialized(),this.isValidAuthenticate(e);let l=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(r=this.client.metadata.redirect)?void 0:r.linkMode),c=l?mT:mx;c===mx&&await this.confirmOnlineStateOrThrow();let{chains:d,statement:u="",uri:h,domain:p,nonce:f,type:y,exp:g,nbf:m,methods:w=[],expiry:b}=e,v=[...e.resources||[]],{topic:_,uri:E}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:c});this.client.logger.info({message:"Generated new pairing",pairing:{topic:_,uri:E}});let A=await this.client.core.crypto.generateKeyPair(),S=yR(A);if(await Promise.all([this.client.auth.authKeys.set(b4,{responseTopic:S,publicKey:A}),this.client.auth.pairingTopics.set(S,{topic:S,pairingTopic:_})]),await this.client.core.relayer.subscribe(S,{transportType:c}),this.client.logger.info(`sending request to new pairing topic: ${_}`),w.length>0){let e,t,{namespace:r}=up(d[0]),o=pO(function(e,t,r,i={}){return r?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:function(e,t,r={}){return Object.assign({},...(t=t?.sort((e,t)=>e.localeCompare(t))).map(t=>({[`${e}/${t}`]:[r]})))}(t,r,i)}}}(r,"request",w));pU(v)&&(i=o,n=v.pop(),o=pO((s=pR(i),a=pR(n),pP(s),pP(a),e=Object.keys(s.att).concat(Object.keys(a.att)).sort((e,t)=>e.localeCompare(t)),t={att:{}},e.forEach(e=>{var r,i;Object.keys((null==(r=s.att)?void 0:r[e])||{}).concat(Object.keys((null==(i=a.att)?void 0:i[e])||{})).sort((e,t)=>e.localeCompare(t)).forEach(r=>{var i,n;t.att[e]=pb(((e,t)=>{for(var r in t||(t={}))pE.call(t,r)&&pS(e,r,t[r]);if(p_)for(var r of p_(t))pA.call(t,r)&&pS(e,r,t[r]);return e})({},t.att[e]),pv({[r]:(null==(i=s.att[e])?void 0:i[r])||(null==(n=a.att[e])?void 0:n[r])}))})}),t))),v.push(o)}let I=b&&b>b0.wc_sessionAuthenticate.req.ttl?b:b0.wc_sessionAuthenticate.req.ttl,k={authPayload:{type:y??"caip122",chains:d,statement:u,aud:h,domain:p,version:"1",nonce:f,iat:new Date().toISOString(),exp:g,nbf:m,resources:v},requester:{publicKey:A,metadata:this.client.metadata},expiryTimestamp:uH(I)},T={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:d,methods:[...new Set(["personal_sign",...w])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:_,proposer:{publicKey:A,metadata:this.client.metadata},expiryTimestamp:uH(b0.wc_sessionPropose.req.ttl),id:(0,ml.payloadId)()},{done:x,resolve:C,reject:P}=uL(I,"Request expired"),O=(0,ml.payloadId)(),R=uz("session_connect",T.id),N=uz("session_request",O),M=async({error:e,session:t})=>{this.events.off(N,U),e?P(e):t&&C({session:t})},U=async e=>{var r,i,n;let s;if(await this.deletePendingAuthRequest(O,{message:"fulfilled",code:0}),e.error){let t=gl("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(R,M),P(e.error.message))}await this.deleteProposal(T.id),this.events.off(R,M);let{cacaos:a,responder:o}=e.result,l=[],d=[];for(let e of a){await px({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),P(gl("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:t}=e,r=pU(t.resources),i=[pk(t.iss)],n=pT(t.iss);if(r){let e=pN(r),t=pM(r);l.push(...e),i.push(...t)}for(let e of i)d.push(`${e}:${n}`)}let u=await this.client.core.crypto.generateSharedKey(A,o.publicKey);l.length>0&&(s={topic:u,acknowledged:!0,self:{publicKey:A,metadata:this.client.metadata},peer:o,controller:o.publicKey,expiry:uH(bX),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:_,namespaces:gn([...new Set(l)],[...new Set(d)]),transportType:c},await this.client.core.relayer.subscribe(u,{transportType:c}),await this.client.session.set(u,s),_&&await this.client.core.pairing.updateMetadata({topic:_,metadata:o.metadata}),s=this.client.session.get(u)),null!=(r=this.client.metadata.redirect)&&r.linkMode&&null!=(i=o.metadata.redirect)&&i.linkMode&&null!=(n=o.metadata.redirect)&&n.universal&&t&&(this.client.core.addLinkModeSupportedApp(o.metadata.redirect.universal),this.client.session.update(u,{transportType:mT})),C({auths:a,session:s})};this.events.once(R,M),this.events.once(N,U);try{if(l){let e=(0,ml.formatJsonRpcRequest)("wc_sessionAuthenticate",k,O);this.client.core.history.set(_,e);let r=await this.client.core.crypto.encode("",e,{type:2,encoding:yC});o=y0(t,_,r)}else await Promise.all([this.sendRequest({topic:_,method:"wc_sessionAuthenticate",params:k,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:O}),this.sendRequest({topic:_,method:"wc_sessionPropose",params:T,expiry:b0.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:T.id})])}catch(e){throw this.events.off(R,M),this.events.off(N,U),e}return await this.setProposal(T.id,T),await this.setAuthRequest(O,{request:b9(vs({},k),ve({verifyContext:{}})),pairingTopic:_,transportType:c}),{uri:o??E,response:x}}),va(this,"approveSessionAuthenticate",async e=>{let t,{id:r,auths:i}=e,n=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:["authenticated_session_approve_started"]}});try{this.isInitialized()}catch(e){throw n.setError("no_internet_connection"),e}let s=this.getPendingAuthRequest(r);if(!s)throw n.setError("authenticated_session_pending_request_not_found"),Error(`Could not find pending auth request with id ${r}`);let a=s.transportType||mx;a===mx&&await this.confirmOnlineStateOrThrow();let o=s.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),c=yR(o),d={type:1,receiverPublicKey:o,senderPublicKey:l},u=[],h=[];for(let e of i){if(!await px({cacao:e,projectId:this.client.core.projectId})){n.setError("invalid_cacao");let e=gl("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:c,error:e,encodeOpts:d}),Error(e.message)}n.addTrace("cacaos_verified");let{p:t}=e,i=pU(t.resources),s=[pk(t.iss)],a=pT(t.iss);if(i){let e=pN(i),t=pM(i);u.push(...e),s.push(...t)}for(let e of s)h.push(`${e}:${a}`)}let p=await this.client.core.crypto.generateSharedKey(l,o);if(n.addTrace("create_authenticated_session_topic"),u?.length>0){t={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:o,metadata:s.requester.metadata},controller:o,expiry:uH(bX),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:s.pairingTopic,namespaces:gn([...new Set(u)],[...new Set(h)]),transportType:a},n.addTrace("subscribing_authenticated_session_topic");try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(e){throw n.setError("subscribe_authenticated_session_topic_failure"),e}n.addTrace("subscribe_authenticated_session_topic_success"),await this.client.session.set(p,t),n.addTrace("store_authenticated_session"),await this.client.core.pairing.updateMetadata({topic:s.pairingTopic,metadata:s.requester.metadata})}n.addTrace("publishing_authenticated_session_approve");try{await this.sendResult({topic:c,id:r,result:{cacaos:i,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(s.requester.metadata,a)})}catch(e){throw n.setError("authenticated_session_approve_publish_failure"),e}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:s.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:n.eventId}),{session:t}}),va(this,"rejectSessionAuthenticate",async e=>{this.isInitialized();let{id:t,reason:r}=e,i=this.getPendingAuthRequest(t);if(!i)throw Error(`Could not find pending auth request with id ${t}`);i.transportType===mx&&await this.confirmOnlineStateOrThrow();let n=i.requester.publicKey,s=await this.client.core.crypto.generateKeyPair(),a=yR(n);await this.sendError({id:t,topic:a,error:r,encodeOpts:{type:1,receiverPublicKey:n,senderPublicKey:s},rpcOpts:b0.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.deleteProposal(t)}),va(this,"formatAuthMessage",e=>{this.isInitialized();let{request:t,iss:r}=e;return pC(t,r)}),va(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)}),va(this,"cleanupDuplicatePairings",async e=>{if(e.pairingTopic)try{let t=this.client.core.pairing.pairings.get(e.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter(r=>{var i,n;return(null==(i=r.peerMetadata)?void 0:i.url)&&(null==(n=r.peerMetadata)?void 0:n.url)===e.peer.metadata.url&&r.topic&&r.topic!==t.topic});if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map(e=>this.client.core.pairing.disconnect({topic:e.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}}),va(this,"deleteSession",async e=>{var t;let{topic:r,expirerHasDeleted:i=!1,emitEvent:n=!0,id:s=0}=e,{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await this.client.session.delete(r,gl("USER_DISCONNECTED")),this.addToRecentlyDeleted(r,"session"),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r),this.client.core.storage.removeItem(bY).catch(e=>this.client.logger.warn(e)),this.getPendingSessionRequests().forEach(e=>{e.topic===r&&this.deletePendingSessionRequest(e.id,gl("USER_DISCONNECTED"))}),r===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=b2),n&&this.client.events.emit("session_delete",{id:s,topic:r})}),va(this,"deleteProposal",async(e,t)=>{if(t)try{let t=this.client.proposal.get(e),r=this.client.core.eventClient.getEvent({topic:t.pairingTopic});r?.setError("proposal_expired")}catch{}await Promise.all([this.client.proposal.delete(e,gl("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")}),va(this,"deletePendingSessionRequest",async(e,t,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(t=>t.id!==e),r&&(this.sessionRequestQueue.state=b2,this.client.events.emit("session_request_expire",{id:e}))}),va(this,"deletePendingAuthRequest",async(e,t,r=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)])}),va(this,"setExpiry",async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))}),va(this,"setProposal",async(e,t)=>{this.client.core.expirer.set(e,uH(b0.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)}),va(this,"setAuthRequest",async(e,t)=>{let{request:r,pairingTopic:i,transportType:n=mx}=t;this.client.core.expirer.set(e,r.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:r.authPayload,requester:r.requester,expiryTimestamp:r.expiryTimestamp,id:e,pairingTopic:i,verifyContext:r.verifyContext,transportType:n})}),va(this,"setPendingSessionRequest",async e=>{let{id:t,topic:r,params:i,verifyContext:n}=e,s=i.request.expiryTimestamp||uH(b0.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,s),await this.client.pendingRequest.set(t,{id:t,topic:r,params:i,verifyContext:n})}),va(this,"sendRequest",async t=>{let r,i,{topic:n,method:s,params:a,expiry:o,relayRpcId:l,clientRpcId:c,throwOnFailedPublish:d,appLink:u,tvf:h,publishOpts:p={}}=t,f=(0,ml.formatJsonRpcRequest)(s,a,c),y=!!u;try{let e=y?yC:yx;r=await this.client.core.crypto.encode(n,f,{encoding:e})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),e}if(b8.includes(s)){let e=yN(JSON.stringify(f)),t=yN(r);i=await this.client.core.verify.register({id:t,decryptedId:e})}let g=vs(vs({},b0[s].req),p);if(g.attestation=i,o&&(g.ttl=o),l&&(g.id=l),this.client.core.history.set(n,f),y){let t=y0(u,n,r);await e.g.Linking.openURL(t,this.client.name)}else{let e;g.tvf=b9(vs({},h),ve({correlationId:f.id})),d?(e=vs({},g.internal),g.internal=b9(e,ve({throwOnFailedPublish:!0})),await this.client.core.relayer.publish(n,r,g)):this.client.core.relayer.publish(n,r,g).catch(e=>this.client.logger.error(e))}return f.id}),va(this,"sendProposeSession",async e=>{let{proposal:t,publishOpts:r}=e,i=(0,ml.formatJsonRpcRequest)("wc_sessionPropose",t,t.id);this.client.core.history.set(t.pairingTopic,i);let n=await this.client.core.crypto.encode(t.pairingTopic,i,{encoding:yx}),s=yN(JSON.stringify(i)),a=yN(n),o=await this.client.core.verify.register({id:a,decryptedId:s});await this.client.core.relayer.publishCustom({payload:{pairingTopic:t.pairingTopic,sessionProposal:n},opts:b9(vs({},r),ve({publishMethod:"wc_proposeSession",attestation:o}))})}),va(this,"sendApproveSession",async e=>{let{sessionTopic:t,pairingProposalResponse:r,proposal:i,sessionSettleRequest:n,publishOpts:s}=e,a=(0,ml.formatJsonRpcResult)(i.id,r),o=await this.client.core.crypto.encode(i.pairingTopic,a,{encoding:yx}),l=(0,ml.formatJsonRpcRequest)("wc_sessionSettle",n,s?.id),c=await this.client.core.crypto.encode(t,l,{encoding:yx});this.client.core.history.set(t,l),await this.client.core.relayer.publishCustom({payload:{sessionTopic:t,pairingTopic:i.pairingTopic,sessionProposalResponse:o,sessionSettlementRequest:c},opts:b9(vs({},s),ve({publishMethod:"wc_approveSession"}))})}),va(this,"sendResult",async t=>{let r,i,n,{id:s,topic:a,result:o,throwOnFailedPublish:l,encodeOpts:c,appLink:d}=t,u=(0,ml.formatJsonRpcResult)(s,o),h=d&&"u">typeof(null==e.g?void 0:e.g.Linking);try{let e,t,i=h?yC:yx;r=await this.client.core.crypto.encode(a,u,(e=vs({},c||{}),t={encoding:i},b9(e,ve(t))))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${a} failed`),e}try{let e=(i=await this.client.core.history.get(a,s)).request;try{n=this.getTVFParams(s,e.params,o)}catch(e){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${e?.message}`)}}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${a}, ${s}) failed`),e}if(h){let t=y0(d,a,r);await e.g.Linking.openURL(t,this.client.name)}else{let e,t=b0[i.request.method].res;t.tvf=b9(vs({},n),ve({correlationId:s})),l?(e=vs({},t.internal),t.internal=b9(e,ve({throwOnFailedPublish:!0})),await this.client.core.relayer.publish(a,r,t)):this.client.core.relayer.publish(a,r,t).catch(e=>this.client.logger.error(e))}await this.client.core.history.resolve(u)}),va(this,"sendError",async t=>{let r,i,{id:n,topic:s,error:a,encodeOpts:o,rpcOpts:l,appLink:c}=t,d=(0,ml.formatJsonRpcError)(n,a),u=c&&"u">typeof(null==e.g?void 0:e.g.Linking);try{let e,t,i=u?yC:yx;r=await this.client.core.crypto.encode(s,d,(e=vs({},o||{}),t={encoding:i},b9(e,ve(t))))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),e}try{i=await this.client.core.history.get(s,n)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),e}if(u){let t=y0(c,s,r);await e.g.Linking.openURL(t,this.client.name)}else{let e=i.request.method,t=l||b0[e].res;this.client.core.relayer.publish(s,r,t)}await this.client.core.history.resolve(d)}),va(this,"cleanup",async()=>{let e=[],t=[];this.client.session.getAll().forEach(t=>{let r=!1;uq(t.expiry)&&(r=!0),this.client.core.crypto.keychain.has(t.topic)||(r=!0),r&&e.push(t.topic)}),this.client.proposal.getAll().forEach(e=>{uq(e.expiryTimestamp)&&t.push(e.id)}),await Promise.all([...e.map(e=>this.deleteSession({topic:e})),...t.map(e=>this.deleteProposal(e))])}),va(this,"onProviderMessageEvent",async e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):await this.onRelayMessage(e)}),va(this,"onRelayEventRequest",async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()}),va(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===b3)return void this.client.logger.info("Request queue already active, skipping...");for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=b3;let e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=b2}),va(this,"processRequest",async e=>{let{topic:t,payload:r,attestation:i,transportType:n,encryptedId:s}=e,a=r.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:a}))switch(a){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:r,attestation:i,encryptedId:s});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,r);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,r);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,r);case"wc_sessionPing":return await this.onSessionPingRequest(t,r);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,r);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:r,attestation:i,encryptedId:s,transportType:n});case"wc_sessionEvent":return await this.onSessionEventRequest(t,r);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:r,attestation:i,encryptedId:s,transportType:n});default:return this.client.logger.info(`Unsupported request method ${a}`)}}),va(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r,transportType:i}=e,n=(await this.client.core.history.get(t,r.id)).request.method;switch(n){case"wc_sessionPropose":return this.onSessionProposeResponse(t,r,i);case"wc_sessionSettle":return this.onSessionSettleResponse(t,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,r);case"wc_sessionExtend":return this.onSessionExtendResponse(t,r);case"wc_sessionPing":return this.onSessionPingResponse(t,r);case"wc_sessionRequest":return this.onSessionRequestResponse(t,r);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,r);default:return this.client.logger.info(`Unsupported response method ${n}`)}}),va(this,"onRelayEventUnknownPayload",e=>{let{topic:t}=e,{message:r}=go("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw Error(r)}),va(this,"shouldIgnorePairingRequest",e=>{let{topic:t,requestMethod:r}=e,i=this.expectedPairingMethodMap.get(t);return!(!i||i.includes(r))&&!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),va(this,"onSessionProposeRequest",async e=>{let{topic:t,payload:r,attestation:i,encryptedId:n}=e,{params:s,id:a}=r;try{let e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError("proposal_listener_not_found")),this.isValidConnect(vs({},r.params));let o=s.expiryTimestamp||uH(b0.wc_sessionPropose.req.ttl),l=vs({id:a,pairingTopic:t,expiryTimestamp:o,attestation:i,encryptedId:n},s);await this.setProposal(a,l);let c=await this.getVerifyContext({attestationId:i,hash:yN(JSON.stringify(r)),encryptedId:n,metadata:l.proposer.metadata});e?.addTrace("emit_session_proposal"),this.client.events.emit("session_proposal",{id:a,params:l,verifyContext:c})}catch(e){await this.sendError({id:a,topic:t,error:e,rpcOpts:b0.wc_sessionPropose.autoReject}),this.client.logger.error(e)}}),va(this,"onSessionProposeResponse",async(e,t,r)=>{let{id:i}=t;if((0,mc.isJsonRpcResult)(t)){let{result:n}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:n});let s=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:s});let a=s.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:a});let o=n.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:o});let l=await this.client.core.crypto.generateSharedKey(a,o);this.pendingSessions.set(i,{sessionTopic:l,pairingTopic:e,proposalId:i,publicKey:a});let c=await this.client.core.relayer.subscribe(l,{transportType:r});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:c}),await this.client.core.pairing.activate({topic:e})}else if((0,mc.isJsonRpcError)(t)){await this.deleteProposal(i);let e=uz("session_connect",i);if(0===this.events.listenerCount(e))throw Error(`emitting ${e} without any listeners, 954`);this.events.emit(e,{error:t.error})}}),va(this,"onSessionSettleRequest",async(e,t)=>{let{id:r,params:i}=t;try{let r,n;this.isValidSessionSettleRequest(i);let{relay:s,controller:a,expiry:o,namespaces:l,sessionProperties:c,scopedProperties:d,sessionConfig:u}=t.params,h=[...this.pendingSessions.values()].find(t=>t.sessionTopic===e);if(!h)return this.client.logger.error(`Pending session not found for topic ${e}`);let p=this.client.proposal.get(h.proposalId),f=(r=vs(vs(vs({topic:e,relay:s,expiry:o,namespaces:l,acknowledged:!0,pairingTopic:h.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:h.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},c&&{sessionProperties:c}),d&&{scopedProperties:d}),u&&{sessionConfig:u}),n={transportType:mx},b9(r,ve(n)));await this.client.session.set(f.topic,f),await this.setExpiry(f.topic,f.expiry),await this.client.core.pairing.updateMetadata({topic:h.pairingTopic,metadata:f.peer.metadata}),this.client.events.emit("session_connect",{session:f}),this.events.emit(uz("session_connect",h.proposalId),{session:f}),this.pendingSessions.delete(h.proposalId),this.deleteProposal(h.proposalId,!1),this.cleanupDuplicatePairings(f),await this.sendResult({id:t.id,topic:e,result:!0})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),va(this,"onSessionSettleResponse",async(e,t)=>{let{id:r}=t;(0,mc.isJsonRpcResult)(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(uz("session_approve",r),{})):(0,mc.isJsonRpcError)(t)&&(await this.client.session.delete(e,gl("USER_DISCONNECTED")),this.events.emit(uz("session_approve",r),{error:t.error}))}),va(this,"onSessionUpdateRequest",async(e,t)=>{let{params:r,id:i}=t;try{let t=`${e}_session_update`,n=gk.get(t);if(n&&this.isRequestOutOfSync(n,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:e,error:gl("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(vs({topic:e},r));try{gk.set(t,i),await this.client.session.update(e,{namespaces:r.namespaces}),await this.sendResult({id:i,topic:e,result:!0})}catch(e){throw gk.delete(t),e}this.client.events.emit("session_update",{id:i,topic:e,params:r})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),va(this,"isRequestOutOfSync",(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3)),va(this,"onSessionUpdateResponse",(e,t)=>{let{id:r}=t,i=uz("session_update",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,mc.isJsonRpcResult)(t)?this.events.emit(uz("session_update",r),{}):(0,mc.isJsonRpcError)(t)&&this.events.emit(uz("session_update",r),{error:t.error})}),va(this,"onSessionExtendRequest",async(e,t)=>{let{id:r}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,uH(bX)),await this.sendResult({id:r,topic:e,result:!0}),this.client.events.emit("session_extend",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),va(this,"onSessionExtendResponse",(e,t)=>{let{id:r}=t,i=uz("session_extend",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,mc.isJsonRpcResult)(t)?this.events.emit(uz("session_extend",r),{}):(0,mc.isJsonRpcError)(t)&&this.events.emit(uz("session_extend",r),{error:t.error})}),va(this,"onSessionPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),va(this,"onSessionPingResponse",(e,t)=>{let{id:r}=t,i=uz("session_ping",r);setTimeout(()=>{if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners 2176`);(0,mc.isJsonRpcResult)(t)?this.events.emit(uz("session_ping",r),{}):(0,mc.isJsonRpcError)(t)&&this.events.emit(uz("session_ping",r),{error:t.error})},500)}),va(this,"onSessionDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),await Promise.all([new Promise(t=>{this.client.core.relayer.once(m_,async()=>{t(await this.deleteSession({topic:e,id:r}))})}),this.sendResult({id:r,topic:e,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:gl("USER_DISCONNECTED")})]).catch(e=>this.client.logger.error(e))}catch(e){this.client.logger.error(e)}}),va(this,"onSessionRequest",async e=>{var t,r,i;let{topic:n,payload:s,attestation:a,encryptedId:o,transportType:l}=e,{id:c,params:d}=s;try{await this.isValidRequest(vs({topic:n},d));let e=this.client.session.get(n),s=await this.getVerifyContext({attestationId:a,hash:yN(JSON.stringify((0,ml.formatJsonRpcRequest)("wc_sessionRequest",d,c))),encryptedId:o,metadata:e.peer.metadata,transportType:l}),u={id:c,topic:n,params:d,verifyContext:s};await this.setPendingSessionRequest(u),l===mT&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(r=e.peer.metadata.redirect)?void 0:r.universal),null!=(i=this.client.signConfig)&&i.disableRequestQueue?this.emitSessionRequest(u):(this.addSessionRequestToSessionRequestQueue(u),this.processSessionRequestQueue())}catch(e){await this.sendError({id:c,topic:n,error:e}),this.client.logger.error(e)}}),va(this,"onSessionRequestResponse",(e,t)=>{let{id:r}=t,i=uz("session_request",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,mc.isJsonRpcResult)(t)?this.events.emit(uz("session_request",r),{result:t.result}):(0,mc.isJsonRpcError)(t)&&this.events.emit(uz("session_request",r),{error:t.error})}),va(this,"onSessionEventRequest",async(e,t)=>{let{id:r,params:i}=t;try{let t=`${e}_session_event_${i.event.name}`,n=gk.get(t);if(n&&this.isRequestOutOfSync(n,r))return void this.client.logger.info(`Discarding out of sync request - ${r}`);this.isValidEmit(vs({topic:e},i)),this.client.events.emit("session_event",{id:r,topic:e,params:i}),gk.set(t,r)}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),va(this,"onSessionAuthenticateResponse",(e,t)=>{let{id:r}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),(0,mc.isJsonRpcResult)(t)?this.events.emit(uz("session_request",r),{result:t.result}):(0,mc.isJsonRpcError)(t)&&this.events.emit(uz("session_request",r),{error:t.error})}),va(this,"onSessionAuthenticateRequest",async e=>{var t;let{topic:r,payload:i,attestation:n,encryptedId:s,transportType:a}=e;try{let{requester:e,authPayload:o,expiryTimestamp:l}=i.params,c=await this.getVerifyContext({attestationId:n,hash:yN(JSON.stringify(i)),encryptedId:s,metadata:e.metadata,transportType:a}),d={requester:e,pairingTopic:r,id:i.id,authPayload:o,verifyContext:c,expiryTimestamp:l};await this.setAuthRequest(i.id,{request:d,pairingTopic:r,transportType:a}),a===mT&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:r,params:i.params,id:i.id,verifyContext:c})}catch(s){this.client.logger.error(s);let e=i.params.requester.publicKey,t=await this.client.core.crypto.generateKeyPair(),n=this.getAppLinkIfEnabled(i.params.requester.metadata,a);await this.sendError({id:i.id,topic:r,error:s,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:t},rpcOpts:b0.wc_sessionAuthenticate.autoReject,appLink:n})}}),va(this,"addSessionRequestToSessionRequestQueue",e=>{this.sessionRequestQueue.queue.push(e)}),va(this,"cleanupAfterResponse",e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=b2,this.processSessionRequestQueue()},(0,lg.toMiliseconds)(this.requestQueueDelay))}),va(this,"cleanupPendingSentRequestsForTopic",({topic:e,error:t})=>{let r=this.client.core.history.pending;r.length>0&&r.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{let r=uz("session_request",e.request.id);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);this.events.emit(uz("session_request",e.request.id),{error:t})})}),va(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===b3)return void this.client.logger.info("session request queue is already active.");let e=this.sessionRequestQueue.queue[0];if(!e)return void this.client.logger.info("session request queue is empty.");try{this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}}),va(this,"emitSessionRequest",e=>{this.emittedSessionRequests.has(e.id)?this.client.logger.warn({id:e.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${e.id}`):(this.sessionRequestQueue.state=b3,this.emittedSessionRequests.add(e.id),this.client.events.emit("session_request",e))}),va(this,"onPairingCreated",e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;let t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:(0,ml.formatJsonRpcRequest)("wc_sessionPropose",b9(vs({},t),ve({requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties})),t.id),attestation:t.attestation,encryptedId:t.encryptedId})}),va(this,"isValidConnect",async e=>{let t;if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw Error(t)}let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:n,sessionProperties:s,scopedProperties:a,relays:o}=e;if(gu(r)||await this.isValidPairingTopic(r),t=!1,o?o&&gc(o)&&o.length&&o.forEach(e=>{t=gw(e)}):t=!0,!t){let{message:e}=go("MISSING_OR_INVALID",`connect() relays: ${o}`);throw Error(e)}if(i&&!gu(i)&&0!==gd(i)){let e="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(e):this.client.logger.warn(e),this.validateNamespaces(i,"requiredNamespaces")}if(n&&!gu(n)&&0!==gd(n)&&this.validateNamespaces(n,"optionalNamespaces"),s&&!gu(s)&&this.validateSessionProps(s,"sessionProperties"),a&&!gu(a)){this.validateSessionProps(a,"scopedProperties");let e=Object.keys(i||{}).concat(Object.keys(n||{}));if(!Object.keys(a).every(t=>e.includes(t.split(":")[0])))throw Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(e)}`)}}),va(this,"validateNamespaces",(e,t)=>{let r=function(e,t,r){let i=null;if(e&&gd(e)){let n,s=gg(e,t);s&&(i=s);let a=(n=null,Object.entries(e).forEach(([e,i])=>{var s,a;let o;if(n)return;let l=(s=uy(e,i),a=`${t} ${r}`,o=null,gc(s)&&s.length?s.forEach(e=>{o||gf(e)||(o=gl("UNSUPPORTED_CHAINS",`${a}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):gf(e)||(o=gl("UNSUPPORTED_CHAINS",`${a}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),o);l&&(n=l)}),n);a&&(i=a)}else i=go("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return i}(e,"connect()",t);if(r)throw Error(r.message)}),va(this,"isValidApprove",async e=>{if(!gb(e))throw Error(go("MISSING_OR_INVALID",`approve() params: ${e}`).message);let{id:t,namespaces:r,relayProtocol:i,sessionProperties:n,scopedProperties:s}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);let a=this.client.proposal.get(t),o=gm(r,"approve()");if(o)throw Error(o.message);let l=g_(a.requiredNamespaces,r,"approve()");if(l)throw Error(l.message);if(!gh(i,!0)){let{message:e}=go("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw Error(e)}if(n&&!gu(n)&&this.validateSessionProps(n,"sessionProperties"),s&&!gu(s)){this.validateSessionProps(s,"scopedProperties");let e=new Set(Object.keys(r));if(!Object.keys(s).every(t=>e.has(t.split(":")[0])))throw Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(s)}, approved namespaces: ${Array.from(e).join(", ")}`)}}),va(this,"isValidReject",async e=>{if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`reject() params: ${e}`);throw Error(t)}let{id:t,reason:r}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!r||"object"!=typeof r||!r.code||!gp(r.code,!1)||!r.message||!gh(r.message,!1)){let{message:e}=go("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw Error(e)}}),va(this,"isValidSessionSettleRequest",e=>{let t;if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw Error(t)}let{relay:r,controller:i,namespaces:n,expiry:s}=e;if(!gw(r)){let{message:e}=go("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(e)}let a=(t=null,gh(i?.publicKey,!1)||(t=go("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),t);if(a)throw Error(a.message);let o=gm(n,"onSessionSettleRequest()");if(o)throw Error(o.message);if(uq(s)){let{message:e}=go("EXPIRED","onSessionSettleRequest()");throw Error(e)}}),va(this,"isValidUpdate",async e=>{if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`update() params: ${e}`);throw Error(t)}let{topic:t,namespaces:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);let i=this.client.session.get(t),n=gm(r,"update()");if(n)throw Error(n.message);let s=g_(i.requiredNamespaces,r,"update()");if(s)throw Error(s.message)}),va(this,"isValidExtend",async e=>{if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`extend() params: ${e}`);throw Error(t)}let{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)}),va(this,"isValidRequest",async e=>{var t;let r;if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`request() params: ${e}`);throw Error(t)}let{topic:i,request:n,chainId:s,expiry:a}=e;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);let{namespaces:o}=this.client.session.get(i);if(!gv(o,s)){let{message:e}=go("MISSING_OR_INVALID",`request() chainId: ${s}`);throw Error(e)}if(gu(n)||!gh(n.method,!1)){let{message:e}=go("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw Error(e)}if(!(gh(t=n.method,!1)&&(r=[],Object.values(o).forEach(e=>{ge(e.accounts).includes(s)&&r.push(...e.methods)}),r).includes(t))){let{message:e}=go("MISSING_OR_INVALID",`request() method: ${n.method}`);throw Error(e)}if(a&&(!gp(a,!1)||!(a<=b1.max)||!(a>=b1.min))){let{message:e}=go("MISSING_OR_INVALID",`request() expiry: ${a}. Expiry must be a number (in seconds) between ${b1.min} and ${b1.max}`);throw Error(e)}}),va(this,"isValidRespond",async e=>{var t;if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`respond() params: ${e}`);throw Error(t)}let{topic:r,response:i}=e;try{await this.isValidSessionTopic(r)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(gu(i)||gu(i.result)&&gu(i.error)||!gp(i.id,!1)||!gh(i.jsonrpc,!1)){let{message:e}=go("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw Error(e)}let n=this.client.pendingRequest.get(i.id);if(n.topic!==r){let{message:e}=go("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${i.id}, expected topic: ${n.topic}, received topic: ${r}`);throw Error(e)}}),va(this,"isValidPing",async e=>{if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),va(this,"isValidEmit",async e=>{var t;let r;if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`emit() params: ${e}`);throw Error(t)}let{topic:i,event:n,chainId:s}=e;await this.isValidSessionTopic(i);let{namespaces:a}=this.client.session.get(i);if(!gv(a,s)){let{message:e}=go("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw Error(e)}if(gu(n)||!gh(n.name,!1)||!(gh(t=n.name,!1)&&(r=[],Object.values(a).forEach(e=>{ge(e.accounts).includes(s)&&r.push(...e.events)}),r).includes(t))){let{message:e}=go("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw Error(e)}}),va(this,"isValidDisconnect",async e=>{if(!gb(e)){let{message:t}=go("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),va(this,"isValidAuthenticate",e=>{let{chains:t,uri:r,domain:i,nonce:n}=e;if(!Array.isArray(t)||0===t.length)throw Error("chains is required and must be a non-empty array");if(!gh(r,!1))throw Error("uri is required parameter");if(!gh(i,!1))throw Error("domain is required parameter");if(!gh(n,!1))throw Error("nonce is required parameter");if([...new Set(t.map(e=>up(e).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:s}=up(t[0]);if("eip155"!==s)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),va(this,"getVerifyContext",async e=>{let{attestationId:t,hash:r,encryptedId:i,metadata:n,transportType:s}=e,a={verified:{verifyUrl:n.verifyUrl||mH,validation:"UNKNOWN",origin:n.url||""}};try{if(s===mT){let e=this.getAppLinkIfEnabled(n,s);return a.verified.validation=e&&new URL(e).origin===new URL(n.url).origin?"VALID":"INVALID",a}let e=await this.client.core.verify.resolve({attestationId:t,hash:r,encryptedId:i,verifyUrl:n.verifyUrl});e&&(a.verified.origin=e.origin,a.verified.isScam=e.isScam,a.verified.validation=e.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(a)}`),a}),va(this,"validateSessionProps",(e,t)=>{Object.values(e).forEach((r,i)=>{if(null==r){let{message:n}=go("MISSING_OR_INVALID",`${t} must contain an existing value for each key. Received: ${r} for key ${Object.keys(e)[i]}`);throw Error(n)}})}),va(this,"getPendingAuthRequest",e=>{let t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),va(this,"addToRecentlyDeleted",(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0,t=this.recentlyDeletedLimit/2;for(let r of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(r)}}}),va(this,"checkRecentlyDeleted",e=>{let t=this.recentlyDeletedMap.get(e);if(t){let{message:r}=go("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw Error(r)}}),va(this,"isLinkModeEnabled",(t,r)=>{var i,n,s,a,o,l,c,d,u;return!!t&&r===mT&&(null==(n=null==(i=this.client.metadata)?void 0:i.redirect)?void 0:n.linkMode)===!0&&(null==(a=null==(s=this.client.metadata)?void 0:s.redirect)?void 0:a.universal)!==void 0&&(null==(l=null==(o=this.client.metadata)?void 0:o.redirect)?void 0:l.universal)!==""&&(null==(c=t?.redirect)?void 0:c.universal)!==void 0&&(null==(d=t?.redirect)?void 0:d.universal)!==""&&(null==(u=t?.redirect)?void 0:u.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&"u">typeof(null==e.g?void 0:e.g.Linking)}),va(this,"getAppLinkIfEnabled",(e,t)=>{var r;return this.isLinkModeEnabled(e,t)?null==(r=e?.redirect)?void 0:r.universal:void 0}),va(this,"handleLinkModeMessage",({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;let t=uJ(e,"topic")||"",r=decodeURIComponent(uJ(e,"wc_ev")||""),i=this.client.session.keys.includes(t);i&&this.client.session.update(t,{transportType:mT}),this.client.core.dispatchEnvelope({topic:t,message:r,sessionExists:i})}),va(this,"registerLinkModeListeners",async()=>{var t;if(uG()||uC()&&null!=(t=this.client.metadata.redirect)&&t.linkMode){let t=null==e.g?void 0:e.g.Linking;if("u">typeof t){t.addEventListener("url",this.handleLinkModeMessage,this.client.name);let e=await t.getInitialURL();e&&setTimeout(()=>{this.handleLinkModeMessage({url:e})},50)}}}),va(this,"getTVFParams",(e,t,r)=>{var i,n,s;if(!(null!=(i=t.request)&&i.method))return{};let a={correlationId:e,rpcMethods:[t.request.method],chainId:t.chainId};try{a.txHashes=this.extractTxHashesFromResult(t.request,r),a.contractAddresses=this.isValidContractData(t.request.params)?[null==(s=null==(n=t.request.params)?void 0:n[0])?void 0:s.to]:[]}catch(e){this.client.logger.warn(e,"Error getting TVF params")}return a}),va(this,"isValidContractData",e=>{var t;if(!e)return!1;try{let r=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!r.startsWith("0x"))return!1;let i=r.slice(2);return!!/^[0-9a-fA-F]*$/.test(i)&&i.length%2==0}catch{}return!1}),va(this,"extractTxHashesFromResult",(e,t)=>{var r,i,n,s,a;try{if(!t)return[];let o=e.method,l=b5[o];if("sui_signTransaction"===o){let e,r,i,s;return[(n=t.transactionBytes,e=new Uint8Array(t6.Buffer.from(n,"base64")),r=Array.from("TransactionData::").map(e=>e.charCodeAt(0)),(i=new Uint8Array(r.length+e.length)).set(r),i.set(e,r.length),s=pu(i,{dkLen:32}),dZ.default.encode(s))]}if("near_signTransaction"===o)return[py(t)];if("near_signTransactions"===o)return t.map(e=>py(e));if("xrpl_signTransactionFor"===o||"xrpl_signTransaction"===o)return[null==(r=t.tx_json)?void 0:r.hash];if("polkadot_signTransaction"===o){let r,n,s,a;return[(i={transaction:e.params.transactionPayload,signature:t.signature},s=Uint8Array.from(t6.Buffer.from(i.signature,"hex")),a=function({publicKey:e,signature:t,payload:r}){var i,n,s;let a,o=gT(r.method),l=128|parseInt((null==(i=r.version)?void 0:i.toString())||"4"),c=(n=r.address,a=dZ.default.decode(n)[0],42===a?0:60===a?2:1),d="00"===r.era?new Uint8Array([0]):gT(r.era);if(1!==d.length&&2!==d.length)throw Error("Invalid era length");let u=parseInt(r.nonce,16),h=new Uint8Array([255&u,u>>8&255]),p=new Uint8Array([0,...e,c,...t,...d,...h,...function(e){if(e<BigInt(1)<<BigInt(6))return new Uint8Array([Number(e<<BigInt(2))]);if(e<BigInt(1)<<BigInt(14)){let t=e<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}if(e<BigInt(1)<<BigInt(30)){let t=e<<BigInt(2)|BigInt(2);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255)),Number(t>>BigInt(16)&BigInt(255)),Number(t>>BigInt(24)&BigInt(255))])}throw Error("BigInt compact encoding not supported > 2^30")}(BigInt(`0x${(s=r.tip).startsWith("0x")?s.slice(2):s}`)),...o]);return new Uint8Array([...function(e){if(e<64)return new Uint8Array([e<<2]);if(e<16384){let t=e<<2|1;return new Uint8Array([255&t,t>>8&255])}if(e<0x40000000){let t=e<<2|2;return new Uint8Array([255&t,t>>8&255,t>>16&255,t>>24&255])}throw Error("Compact encoding > 2^30 not supported")}(p.length+1),l,...p])}({publicKey:function(e){let t=dZ.default.decode(e);if(t.length<33)throw Error("Too short to contain a public key");return t.slice(1,33)}(i.transaction.address),signature:s,payload:i.transaction}),r=gT(t6.Buffer.from(a).toString("hex")),n=(0,d3.blake2b)(r,void 0,32),"0x"+t6.Buffer.from(n).toString("hex"))]}if("algo_signTxn"===o)return gc(t)?t.map(e=>pg(e)):[pg(t)];if("cosmos_signDirect"===o){let e,r,i,n,s;return[(e=t6.Buffer.from(t.signed.bodyBytes,"base64"),r=t6.Buffer.from(t.signed.authInfoBytes,"base64"),i=t6.Buffer.from(t.signature.signature,"base64"),(n=[]).push(t6.Buffer.from([10])),n.push(pm(e.length)),n.push(e),n.push(t6.Buffer.from([18])),n.push(pm(r.length)),n.push(r),n.push(t6.Buffer.from([26])),n.push(pm(i.length)),n.push(i),s=pe(t6.Buffer.concat(n)),t6.Buffer.from(s).toString("hex").toUpperCase())]}if("wallet_sendCalls"===o){let e=[];try{if("string"==typeof t)return e.push(t),e;if("object"!=typeof t)return e;null!=t&&t.id&&e.push(t.id);let r=null==(a=null==(s=t?.capabilities)?void 0:s.caip345)?void 0:a.transactionHashes;r&&e.push(...r)}catch(e){console.warn("getWalletSendCallsHashes failed: ",e)}return e}if("string"==typeof t)return[t];let c=t[l.key];if(gc(c))return"solana_signAllTransactions"===o?c.map(e=>(function(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);let i=r[0];if(0===i)throw Error("No signatures found");if(r.length<1+64*i)throw Error("Transaction data too short for claimed signature count");if(r.length<100)throw Error("Transaction too short");let n=t6.Buffer.from(e,"base64").slice(1,65);return dZ.default.encode(n)})(e)):c;if("string"==typeof c)return[c]}catch(e){this.client.logger.warn(e,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{let e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(let[e,r]of Object.entries(t))for(let t of r)try{await this.onProviderMessageEvent({topic:e,message:t,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${e}, message: ${t}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){let{message:e}=go("NOT_INITIALIZED",this.name);throw Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(mw,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){let{topic:t,message:r,attestation:i,transportType:n}=e,{publicKey:s}=this.client.auth.authKeys.keys.includes(b4)?this.client.auth.authKeys.get(b4):{responseTopic:void 0,publicKey:void 0};try{let e=await this.client.core.crypto.decode(t,r,{receiverPublicKey:s,encoding:n===mT?yC:yx});(0,mc.isJsonRpcRequest)(e)?(this.client.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e,attestation:i,transportType:n,encryptedId:yN(r)})):(0,mc.isJsonRpcResponse)(e)?(await this.client.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e,transportType:n}),this.client.core.history.delete(t,e.id)):await this.onRelayEventUnknownPayload({topic:t,payload:e,transportType:n}),await this.client.core.relayer.messages.ack(t,r)}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(mF,async e=>{let{topic:t,id:r}=uF(e.target);return r&&this.client.pendingRequest.keys.includes(r)?await this.deletePendingSessionRequest(r,go("EXPIRED"),!0):r&&this.client.auth.requests.keys.includes(r)?await this.deletePendingAuthRequest(r,go("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r})))})}registerPairingEvents(){this.client.core.pairing.events.on(mM,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(mU,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!gh(e,!1)){let{message:t}=go("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=go("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(uq(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=go("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}async isValidSessionTopic(e){if(!gh(e,!1)){let{message:t}=go("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){let{message:t}=go("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw Error(t)}if(uq(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});let{message:t}=go("EXPIRED",`session topic: ${e}`);throw Error(t)}if(!this.client.core.crypto.keychain.has(e)){let{message:t}=go("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(gh(e,!1)){let{message:t}=go("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw Error(t)}else{let{message:t}=go("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw Error(t)}}async isValidProposalId(e){if("number"!=typeof e){let{message:t}=go("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=go("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw Error(t)}if(uq(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);let{message:t}=go("EXPIRED",`proposal id: ${e}`);throw Error(t)}}}class vl extends bm{constructor(e,t){super(e,t,"proposal",bG),this.core=e,this.logger=t}}class vc extends bm{constructor(e,t){super(e,t,"session",bG),this.core=e,this.logger=t}}class vd extends bm{constructor(e,t){super(e,t,"request",bG,e=>e.id),this.core=e,this.logger=t}}class vu extends bm{constructor(e,t){super(e,t,"authKeys",b6,()=>b4),this.core=e,this.logger=t}}class vh extends bm{constructor(e,t){super(e,t,"pairingTopics",b6),this.core=e,this.logger=t}}class vp extends bm{constructor(e,t){super(e,t,"requests",b6,e=>e.id),this.core=e,this.logger=t}}var vf=Object.defineProperty,vy=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?vf(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class vg{constructor(e,t){this.core=e,this.logger=t,vy(this,"authKeys"),vy(this,"pairingTopics"),vy(this,"requests"),this.authKeys=new vu(this.core,this.logger),this.pairingTopics=new vh(this.core,this.logger),this.requests=new vp(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var vm=Object.defineProperty,vw=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?vm(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class vb extends ms{constructor(e){super(e),vw(this,"protocol","wc"),vw(this,"version",2),vw(this,"name",bZ),vw(this,"metadata"),vw(this,"core"),vw(this,"logger"),vw(this,"events",new lf.EventEmitter),vw(this,"engine"),vw(this,"session"),vw(this,"proposal"),vw(this,"pendingRequest"),vw(this,"auth"),vw(this,"signConfig"),vw(this,"on",(e,t)=>this.events.on(e,t)),vw(this,"once",(e,t)=>this.events.once(e,t)),vw(this,"off",(e,t)=>this.events.off(e,t)),vw(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),vw(this,"removeAllListeners",e=>this.events.removeAllListeners(e)),vw(this,"connect",async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"pair",async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"approve",async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"reject",async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"update",async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"extend",async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"request",async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"respond",async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"ping",async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"emit",async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"disconnect",async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"find",e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}}),vw(this,"authenticate",async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"formatAuthMessage",e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"approveSessionAuthenticate",async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),vw(this,"rejectSessionAuthenticate",async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),this.name=e?.name||bZ,this.metadata=function(e){var t,r;let i=uN();try{let n,s;return null!=e&&e.url&&i.url&&new URL(e.url).host!==new URL(i.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${i.url}. This is probably unintended and can lead to issues.`),e.url=i.url),null!=(t=e?.icons)&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(e=>""!==e)),n=uA(uA({},i),e),s={url:e?.url||i.url,name:e?.name||i.name,description:e?.description||i.description,icons:null!=(r=e?.icons)&&r.length&&e.icons.length>0?e.icons:i.icons},um(n,uw(s))}catch(t){return console.warn("Error populating app metadata",t),e||i}}(e?.metadata),this.signConfig=e?.signConfig;const t=gx({logger:e?.logger||"error",name:this.name});this.logger=t,this.core=e?.core||new bJ(e),this.session=new vc(this.core,this.logger),this.proposal=new vl(this.core,this.logger),this.pendingRequest=new vd(this.core,this.logger),this.engine=new vo(this),this.auth=new vg(this.core,this.logger)}static async init(e){let t=new vb(e);return await t.initialize(),t}get context(){return gG(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var vv=e.i(98418);function v_(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function vE(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function vA(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}let vS="[object String]",vI="[object Number]",vk="[object Boolean]",vT="[object Arguments]";function vx(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function vC(e,t,r,i=new Map,n){let s=n?.(e,t,r,i);if(null!=s)return s;if(v_(e))return e;if(i.has(e))return i.get(e);if(Array.isArray(e)){let t=Array(e.length);i.set(e,t);for(let s=0;s<e.length;s++)t[s]=vC(e[s],s,r,i,n);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){let t=new Map;for(let[s,a]of(i.set(e,t),e))t.set(s,vC(a,s,r,i,n));return t}if(e instanceof Set){let t=new Set;for(let s of(i.set(e,t),e))t.add(vC(s,void 0,r,i,n));return t}if("u">typeof t6.Buffer&&t6.Buffer.isBuffer(e))return e.subarray();if(vx(e)){let t=new(Object.getPrototypeOf(e)).constructor(e.length);i.set(e,t);for(let s=0;s<e.length;s++)t[s]=vC(e[s],s,r,i,n);return t}if(e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return i.set(e,t),vP(t,e,r,i,n),t}if("u">typeof File&&e instanceof File){let t=new File([e],e.name,{type:e.type});return i.set(e,t),vP(t,e,r,i,n),t}if(e instanceof Blob){let t=new Blob([e],{type:e.type});return i.set(e,t),vP(t,e,r,i,n),t}if(e instanceof Error){let t=new e.constructor;return i.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,vP(t,e,r,i,n),t}if("object"==typeof e&&function(e){switch(vA(e)){case vT:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case vk:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case vI:case"[object Object]":case"[object RegExp]":case"[object Set]":case vS:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(e)){let t=Object.create(Object.getPrototypeOf(e));return i.set(e,t),vP(t,e,r,i,n),t}return e}function vP(e,t,r=e,i,n){let s=[...Object.keys(t),...vE(t)];for(let a=0;a<s.length;a++){let o=s[a],l=Object.getOwnPropertyDescriptor(e,o);(null==l||l.writable)&&(e[o]=vC(t[o],o,r,i,n))}}function vO(e){var t;return t=(t,r,i,n)=>{let s;if(null!=s)return s;if("object"==typeof e)switch(Object.prototype.toString.call(e)){case vI:case vS:case vk:{let t=new e.constructor(e?.valueOf());return vP(t,e),t}case vT:{let t={};return vP(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}},vC(e,void 0,e,new Map,t)}function vR(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===vA(e)}function vN(e){return"object"==typeof e&&null!==e}function vM(){}let vU="error",vD="universal_provider",vj=`wc@2:${vD}:`,vL="https://rpc.walletconnect.org/v1/",vB="generic",vW=`${vL}bundler`,vF="call_status",vH="default_chain_changed";var vq=Object.defineProperty,vz=Object.defineProperties,v$=Object.getOwnPropertyDescriptors,vK=Object.getOwnPropertySymbols,vV=Object.prototype.hasOwnProperty,vJ=Object.prototype.propertyIsEnumerable,vZ=(e,t,r)=>t in e?vq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,vG=(e,t)=>{for(var r in t||(t={}))vV.call(t,r)&&vZ(e,r,t[r]);if(vK)for(var r of vK(t))vJ.call(t,r)&&vZ(e,r,t[r]);return e},vY=(e,t)=>vz(e,v$(t));function vQ(e,t,r){var i;let n=up(e);return(null==(i=t.rpcMap)?void 0:i[n.reference])||`${vL}?chainId=${n.namespace}:${n.reference}&projectId=${r}`}function vX(e){return e.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function v0(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>{var r,i;return(null==(r=t?.chains)?void 0:r.length)&&(null==(i=t?.chains)?void 0:i.length)>0}))}function v1(e={},t={}){return function(e,...t){return function(e,...t){let r=t.slice(0,-1),i=t[t.length-1],n=e;for(let e=0;e<r.length;e++)n=function e(t,r,i,n){if(v_(t)&&(t=Object(t)),null==r||"object"!=typeof r)return t;if(n.has(r))return function(e){if(v_(e))return e;if(Array.isArray(e)||vx(e)||e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);let t=Object.getPrototypeOf(e),r=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new r(e);if(e instanceof RegExp){let t=new r(e);return t.lastIndex=e.lastIndex,t}if(e instanceof DataView)return new r(e.buffer.slice(0));if(e instanceof Error){let t=new r(e.message);return t.stack=e.stack,t.name=e.name,t.cause=e.cause,t}return"u">typeof File&&e instanceof File?new r([e],e.name,{type:e.type,lastModified:e.lastModified}):"object"==typeof e?Object.assign(Object.create(t),e):e}(n.get(r));if(n.set(r,t),Array.isArray(r)){r=r.slice();for(let e=0;e<r.length;e++)r[e]=r[e]??void 0}let s=[...Object.keys(r),...vE(r)];for(let a=0;a<s.length;a++){let o=s[a],l=r[o],c=t[o];if(vR(l)&&(l={...l}),vR(c)&&(c={...c}),"u">typeof t6.Buffer&&t6.Buffer.isBuffer(l)&&(l=vO(l)),Array.isArray(l))if("object"==typeof c&&null!=c){let e=[],t=Reflect.ownKeys(c);for(let r=0;r<t.length;r++){let i=t[r];e[i]=c[i]}c=e}else c=[];let d=i(c,l,o,t,r,n);null!=d?t[o]=d:Array.isArray(l)||vN(c)&&vN(l)?t[o]=e(c,l,i,n):null==c&&function(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){let t=e[Symbol.toStringTag];return null!=t&&!!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable&&e.toString()===`[object ${t}]`}let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(l)?t[o]=e({},l,i,n):null==c&&vx(l)?t[o]=vO(l):(void 0===c||void 0!==l)&&(t[o]=l)}return t}(n,r[e],i,new Map);return n}(e,...t,vM)}(v0(v2(e)),v0(v2(t)))}function v2(e){var t,r,i,n,s;let a={};if(!gd(e))return a;for(let[o,l]of Object.entries(e)){let e=gt(o)?[o]:l.chains,c=l.methods||[],d=l.events||[],u=l.rpcMap||{},h=gr(o);a[h]=vY(vG(vG({},a[h]),l),{chains:u$(e,null==(t=a[h])?void 0:t.chains),methods:u$(c,null==(r=a[h])?void 0:r.methods),events:u$(d,null==(i=a[h])?void 0:i.events)}),(gd(u)||gd((null==(n=a[h])?void 0:n.rpcMap)||{}))&&(a[h].rpcMap=vG(vG({},u),null==(s=a[h])?void 0:s.rpcMap))}return a}function v3(e){return e.includes(":")?e.split(":")[2]:e}function v5(e){let t={};for(let[r,i]of Object.entries(e)){let e=i.methods||[],n=i.events||[],s=i.accounts||[],a=gt(r)?[r]:i.chains?i.chains:vX(i.accounts);t[r]={chains:a,methods:e,events:n,accounts:s}}return t}function v8(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):isNaN(Number(e=e.includes(":")?e.split(":")[1]:e))?e:Number(e)}let v6={},v4=e=>v6[e],v7=(e,t)=>{v6[e]=t};var v9=Object.defineProperty,_e=Object.getOwnPropertySymbols,_t=Object.prototype.hasOwnProperty,_r=Object.prototype.propertyIsEnumerable,_i=(e,t,r)=>t in e?v9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_n=(e,t)=>{for(var r in t||(t={}))_t.call(t,r)&&_i(e,r,t[r]);if(_e)for(var r of _e(t))_r.call(t,r)&&_i(e,r,t[r]);return e};let _s="eip155",_a=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],_o=e=>e&&e.startsWith("0x")?BigInt(e).toString(10):e,_l=e=>e&&e.startsWith("0x")?e:`0x${BigInt(e).toString(16)}`,_c=e=>Object.keys(e).filter(e=>_a.includes(e)).reduce((t,r)=>(t[r]=_d(e[r]),t),{}),_d=e=>"string"==typeof e&&function(e){try{let t=JSON.parse(e);return"object"==typeof t&&null!==t&&!Array.isArray(t)}catch{return!1}}(e)?JSON.parse(e):e;var _u=Object.defineProperty;class _h{constructor(e){((e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?_u(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r})(this,"storage"),this.storage=e}async getItem(e){return await this.storage.getItem(e)}async setItem(e,t){return await this.storage.setItem(e,t)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return r||(r=new _h(e)),r}}var _p=Object.defineProperty,_f=Object.defineProperties,_y=Object.getOwnPropertyDescriptors,_g=Object.getOwnPropertySymbols,_m=Object.prototype.hasOwnProperty,_w=Object.prototype.propertyIsEnumerable,_b=(e,t,r)=>t in e?_p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;async function _v(e,t){let r,i=up(e.result.capabilities.caip345.caip2),n=e.result.capabilities.caip345.transactionHashes,s=await Promise.allSettled(n.map(e=>__(i.reference,e,t))),a=s.filter(e=>"fulfilled"===e.status).map(e=>e.value).filter(e=>e);s.filter(e=>"rejected"===e.status).forEach(e=>console.warn("Failed to fetch transaction receipt:",e.reason));let o=!a.length||a.some(e=>!e),l=a.every(e=>e?.status==="0x1"),c=a.every(e=>e?.status==="0x0"),d=a.some(e=>e?.status==="0x0");return o?r=100:l?r=200:c?r=500:d&&(r=600),{id:e.result.id,version:e.request.version,atomic:e.request.atomicRequired,chainId:e.request.chainId,capabilities:e.result.capabilities,receipts:a,status:r}}async function __(e,t,r){return await r(parseInt(e)).request((0,ml.formatJsonRpcRequest)("eth_getTransactionReceipt",[t]))}async function _E({sendCalls:e,storage:t}){let r=await t.getItem(vF);await t.setItem(vF,_f(((e,t)=>{for(var r in t||(t={}))_m.call(t,r)&&_b(e,r,t[r]);if(_g)for(var r of _g(t))_w.call(t,r)&&_b(e,r,t[r]);return e})({},r),_y({[e.result.id]:{request:e.request,result:e.result,expiry:uH(86400)}})))}async function _A({resultId:e,storage:t}){let r=await t.getItem(vF);if(r){for(let i in delete r[e],await t.setItem(vF,r),r)uq(r[i].expiry)&&delete r[i];await t.setItem(vF,r)}}async function _S({resultId:e,storage:t}){let r=await t.getItem(vF),i=r?.[e];if(i&&!uq(i.expiry))return i;await _A({resultId:e,storage:t})}var _I=Object.defineProperty,_k=Object.defineProperties,_T=Object.getOwnPropertyDescriptors,_x=Object.getOwnPropertySymbols,_C=Object.prototype.hasOwnProperty,_P=Object.prototype.propertyIsEnumerable,_O=(e,t,r)=>t in e?_I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_R=(e,t)=>{for(var r in t||(t={}))_C.call(t,r)&&_O(e,r,t[r]);if(_x)for(var r of _x(t))_P.call(t,r)&&_O(e,r,t[r]);return e},_N=(e,t,r)=>_O(e,"symbol"!=typeof t?t+"":t,r);class _M{constructor(e){_N(this,"name","eip155"),_N(this,"client"),_N(this,"chainId"),_N(this,"namespace"),_N(this,"httpProviders"),_N(this,"events"),_N(this,"storage"),this.namespace=e.namespace,this.events=v4("events"),this.client=v4("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=_h.getStorage(this.client.core.storage)}async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t);let r=this.chainId;this.chainId=parseInt(e),this.events.emit(vH,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){let r=t||vQ(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return new mo.JsonRpcProvider(new vv.HttpConnection(r,v4("disableProviderPing")))}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=parseInt(t.includes(":")?t.split(":")[1]:t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(e){let t=e||this.chainId;return this.httpProviders[t]||(this.httpProviders=_k(_R({},this.httpProviders),_T({[t]:this.createHttpProvider(t)})),this.httpProviders[t])}async handleSwitchChain(e){var t,r;let i=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0",n=parseInt(i=i.startsWith("0x")?i:`0x${i}`,16);if(this.isChainApproved(n))this.setDefaultChain(`${n}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:null==(r=this.namespace.chains)?void 0:r[0]}),this.setDefaultChain(`${n}`);else throw Error(`Failed to switch to chain 'eip155:${n}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,r,i,n,s;let a,o=null==(r=null==(t=e.request)?void 0:t.params)?void 0:r[0],l=(null==(n=null==(i=e.request)?void 0:i.params)?void 0:n[1])||[];if(!o)throw Error("Missing address parameter in `wallet_getCapabilities` request");let c=this.client.session.get(e.topic),d=(null==(s=c?.sessionProperties)?void 0:s.capabilities)||{},u=`${o}${l.join(",")}`,h=d?.[u];if(h)return h;try{a=((e,t,r)=>{let{sessionProperties:i={},scopedProperties:n={}}=e,s={};if(!gd(n)&&!gd(i))return;let a=_c(i);for(let e of r){let r=_o(e);if(!r)continue;s[_l(r)]=a;let i=n?.[`${_s}:${r}`];if(i){let e=i?.[`${_s}:${r}:${t}`];s[_l(r)]=_n(_n({},s[_l(r)]),_c(e||i))}}for(let[e,t]of Object.entries(s))0===Object.keys(t).length&&delete s[e];return Object.keys(s).length>0?s:void 0})(c,o,l)}catch(e){console.warn("Failed to extract capabilities from session",e)}if(a)return a;let p=await this.client.request(e);try{let t,r,i,n;await this.client.session.update(e.topic,{sessionProperties:(i=_R({},c.sessionProperties||{}),n={capabilities:(t=_R({},d||{}),r={[u]:p},_k(t,_T(r)))},_k(i,_T(n)))})}catch(e){console.warn("Failed to update session with capabilities",e)}return p}async getCallStatus(e){var t,r,i;let n=this.client.session.get(e.topic),s=null==(t=n.sessionProperties)?void 0:t.bundler_name;if(s){let t=this.getBundlerUrl(e.chainId,s);try{return await this.getUserOperationReceipt(t,e)}catch(e){console.warn("Failed to fetch call status from bundler",e,t)}}let a=null==(r=n.sessionProperties)?void 0:r.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,e)}catch(e){console.warn("Failed to fetch call status from custom bundler",e,a)}let o=await _S({resultId:null==(i=e.request.params)?void 0:i[0],storage:this.storage});if(o)try{return await _v(o,this.getHttpProvider.bind(this))}catch(e){console.warn("Failed to fetch call status from stored send calls",e,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var r;let i=new URL(e),n=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,ml.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(r=t.request.params)?void 0:r[0]]))});if(!n.ok)throw Error(`Failed to fetch user operation receipt - ${n.status}`);return await n.json()}getBundlerUrl(e,t){return`${vW}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}async sendCalls(e){var t,r,i;let n=await this.client.request(e),s=null==(t=e.request.params)?void 0:t[0],a=n?.id,o=n?.capabilities||{},l=null==(r=o?.caip345)?void 0:r.caip2,c=null==(i=o?.caip345)?void 0:i.transactionHashes;return a&&l&&null!=c&&c.length&&await _E({sendCalls:{request:s,result:n},storage:this.storage}),n}}var _U=Object.defineProperty,_D=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?_U(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class _j{constructor(e){_D(this,"name",vB),_D(this,"client"),_D(this,"httpProviders"),_D(this,"events"),_D(this,"namespace"),_D(this,"chainId"),this.namespace=e.namespace,this.events=v4("events"),this.client=v4("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t);let r=this.chainId;this.chainId=e,this.events.emit(vH,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return up(e).namespace}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var e,t;let r={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(e=>{var t,i;let n=up(e),s=null==(i=null==(t=this.namespace)?void 0:t.rpcMap)?void 0:i[`${n.namespace}:${n.reference}`];r[n.reference]=this.createHttpProvider(e,s)}),r}getHttpProvider(e){let t=up(e).reference,r=this.httpProviders[t];if(typeof r>"u")throw Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||vQ(e,this.namespace,this.client.core.projectId);return new mo.JsonRpcProvider(new vv.default(r,v4("disableProviderPing")))}}var _L=Object.defineProperty,_B=Object.defineProperties,_W=Object.getOwnPropertyDescriptors,_F=Object.getOwnPropertySymbols,_H=Object.prototype.hasOwnProperty,_q=Object.prototype.propertyIsEnumerable,_z=(e,t,r)=>t in e?_L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_$=(e,t)=>{for(var r in t||(t={}))_H.call(t,r)&&_z(e,r,t[r]);if(_F)for(var r of _F(t))_q.call(t,r)&&_z(e,r,t[r]);return e},_K=(e,t,r)=>_z(e,"symbol"!=typeof t?t+"":t,r);class _V{constructor(e){var t,r;_K(this,"client"),_K(this,"namespaces"),_K(this,"optionalNamespaces"),_K(this,"sessionProperties"),_K(this,"scopedProperties"),_K(this,"events",new lf.default),_K(this,"rpcProviders",{}),_K(this,"session"),_K(this,"providerOpts"),_K(this,"logger"),_K(this,"uri"),_K(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=gx({logger:null!=(t=e.logger)?t:vU,name:null!=(r=this.providerOpts.name)?r:vD}),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){let t=new _V(e);return await t.initialize(),t}async request(e,t,r){let[i,n]=this.validateChain(t);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(i).request({request:_$({},e),chainId:`${i}:${n}`,topic:this.session.topic,expiry:r})}sendAsync(e,t,r,i){let n=new Date().getTime();this.request(e,r,i).then(e=>t(null,(0,ml.formatJsonRpcResult)(n,e))).catch(e=>t(e,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:gl("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();let{uri:r,response:i}=await this.client.authenticate(e,t);r&&(this.uri=r,this.events.emit("display_uri",r));let n=await i();if(this.session=n.session,this.session){let e=v5(this.session.namespaces);this.namespaces=v1(this.namespaces,e),await this.persist("namespaces",this.namespaces),this.onConnect()}return n}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){let{uri:t,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));let i=await r();this.session=i;let n=v5(i.namespaces);return this.namespaces=v1(this.namespaces,n),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;let[r,i]=this.validateChain(e);this.getProvider(r).setDefaultChain(i,t)}catch(e){if(!/Please call connect/.test(e.message))throw e}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");let t=this.client.pairing.getAll();if(!gc(t))return;for(let r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}catch(e){this.logger.warn(e,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await vb.init({core:this.providerOpts.core,logger:this.providerOpts.logger||vU,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error(r,"Failed to get session"),Error(`The provided session: ${null==(t=null==(e=this.providerOpts)?void 0:e.session)?void 0:t.topic} doesn't exist in the Sign client`)}else{let e=this.client.session.getAll();this.session=e[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let e=[...new Set(Object.keys(this.session.namespaces).map(e=>gr(e)))];v7("client",this.client),v7("events",this.events),v7("disableProviderPing",this.disableProviderPing),e.forEach(e=>{if(!this.session)return;let t=function(e,t){let r=Object.keys(t.namespaces).filter(t=>t.includes(e));if(!r.length)return[];let i=[];return r.forEach(e=>{let r=t.namespaces[e].accounts;i.push(...r)}),i}(e,this.session);if(t?.length===0)return;let r=vX(t),i=_B(_$({},v1(this.namespaces,this.optionalNamespaces)[e]),_W({accounts:t,chains:r}));"eip155"===e?this.rpcProviders[e]=new _M({namespace:i}):this.rpcProviders[e]=new _j({namespace:i})})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;let{topic:r}=e;r===(null==(t=this.session)?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;let{params:r,topic:i}=e;if(i!==(null==(t=this.session)?void 0:t.topic))return;let{event:n}=r;if("accountsChanged"===n.name){let e=n.data;e&&gc(e)&&this.events.emit("accountsChanged",e.map(v3))}else if("chainChanged"===n.name){let e=r.chainId,t=r.event.data,i=gr(e),n=v8(e)!==v8(t)?`${i}:${v8(t)}`:e;this.onChainChanged({currentCaipChainId:n})}else this.events.emit(n.name,n.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var r,i;if(e!==(null==(r=this.session)?void 0:r.topic))return;let{namespaces:n}=t,s=null==(i=this.client)?void 0:i.session.get(e);this.session=_B(_$({},s),_W({namespaces:n})),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===(null==(t=this.session)?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",_B(_$({},gl("USER_DISCONNECTED")),_W({data:e.topic}))))}),this.on(vH,e=>{this.onChainChanged(_B(_$({},e),_W({internal:!0})))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[vB]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])})}setNamespaces(e){let{namespaces:t={},optionalNamespaces:r={},sessionProperties:i,scopedProperties:n}=e;this.optionalNamespaces=v1(t,r),this.sessionProperties=i,this.scopedProperties=n}validateChain(e){let[t,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(e=>gr(e)).includes(t))throw Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];let i=gr(Object.keys(this.namespaces)[0]),n=this.rpcProviders[i].getDefaultChain();return[i,n]}async requestAccounts(){let[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged({currentCaipChainId:e,previousCaipChainId:t,internal:r=!1}){if(!this.namespaces)return;let[i,n]=this.validateChain(e);n&&(this.updateNamespaceChain(i,n),r?(this.events.emit("chainChanged",n),this.emitAccountsChangedOnChainChange({namespace:i,currentCaipChainId:e,previousCaipChainId:t})):this.getProvider(i).setDefaultChain(n),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:e,currentCaipChainId:t,previousCaipChainId:r}){var i,n;try{if(r===t)return;let s=null==(n=null==(i=this.session)?void 0:i.namespaces[e])?void 0:n.accounts;if(!s)return;let a=s.filter(e=>e.includes(`${t}:`)).map(v3);if(!gc(a))return;this.events.emit("accountsChanged",a)}catch(e){this.logger.warn(e,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(e,t){if(!this.namespaces)return;let r=this.namespaces[e]?e:`${e}:${t}`;this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=t):this.namespaces[r]={chains:[],methods:[],events:[],defaultChain:t}}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var r;let i=(null==(r=this.session)?void 0:r.topic)||"";await this.client.core.storage.setItem(`${vj}/${e}${i}`,t)}async getFromStore(e){var t;let r=(null==(t=this.session)?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${vj}/${e}${r}`)}async deleteFromStore(e){var t;let r=(null==(t=this.session)?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${vj}/${e}${r}`)}async cleanupStorage(){var e;try{if((null==(e=this.client)?void 0:e.session.length)>0)return;for(let e of(await this.client.core.storage.getKeys()))e.startsWith(vj)&&await this.client.core.storage.removeItem(e)}catch(e){this.logger.warn(e,"Failed to cleanup storage")}}}let _J=["eth_sendTransaction","personal_sign"],_Z=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],_G=["chainChanged","accountsChanged"],_Y=["chainChanged","accountsChanged","message","disconnect","connect"],_Q=async()=>{let{createAppKit:t}=await e.A(156814);return t};var _X=Object.defineProperty,_0=Object.defineProperties,_1=Object.getOwnPropertyDescriptors,_2=Object.getOwnPropertySymbols,_3=Object.prototype.hasOwnProperty,_5=Object.prototype.propertyIsEnumerable,_8=(e,t,r)=>t in e?_X(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_6=(e,t)=>{for(var r in t||(t={}))_3.call(t,r)&&_8(e,r,t[r]);if(_2)for(var r of _2(t))_5.call(t,r)&&_8(e,r,t[r]);return e},_4=(e,t,r)=>_8(e,"symbol"!=typeof t?t+"":t,r);function _7(e){return Number(e[0].split(":")[1])}function _9(e){return`0x${e.toString(16)}`}class Ee{constructor(){_4(this,"events",new lf.EventEmitter),_4(this,"namespace","eip155"),_4(this,"accounts",[]),_4(this,"signer"),_4(this,"chainId",1),_4(this,"modal"),_4(this,"rpc"),_4(this,"STORAGE_KEY","wc@2:ethereum_provider:"),_4(this,"on",(e,t)=>(this.events.on(e,t),this)),_4(this,"once",(e,t)=>(this.events.once(e,t),this)),_4(this,"removeListener",(e,t)=>(this.events.removeListener(e,t),this)),_4(this,"off",(e,t)=>(this.events.off(e,t),this)),_4(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}static async init(e){let t=new Ee;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,r){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),r)}get connected(){return!!this.signer.client&&this.signer.client.core.relayer.connected}get connecting(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){var t;if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);let{required:r,optional:i}=function(e){let{chains:t,optionalChains:r,methods:i,optionalMethods:n,events:s,optionalEvents:a,rpcMap:o}=e;if(!gc(t))throw Error("Invalid chains");let l={chains:t,methods:i||_J,events:s||_G,rpcMap:_6({},t.length?{[_7(t)]:o[_7(t)]}:{})},c=s?.filter(e=>!_G.includes(e)),d=i?.filter(e=>!_J.includes(e));if(!r&&!a&&!n&&!(null!=c&&c.length)&&!(null!=d&&d.length))return{required:t.length?l:void 0};let u={chains:[...new Set(c?.length&&d?.length||!r?l.chains.concat(r||[]):r)],methods:[...new Set(l.methods.concat(null!=n&&n.length?n:_Z))],events:[...new Set(l.events.concat(null!=a&&a.length?a:_Y))],rpcMap:o};return{required:t.length?l:void 0,optional:r.length?u:void 0}}(this.rpc);try{let t=await new Promise(async(t,n)=>{var s,a;let o,l;this.rpc.showQrModal&&(null==(s=this.modal)||s.open(),null==(a=this.modal)||a.subscribeState(e=>{e.open||this.signer.session||(this.signer.abortPairingAttempt(),n(Error("Connection request reset. Please try again.")))}));let c=null!=e&&e.scopedProperties?{[this.namespace]:e.scopedProperties}:void 0;await this.signer.connect((o=_6({namespaces:_6({},r&&{[this.namespace]:r})},i&&{optionalNamespaces:{[this.namespace]:i}}),l={pairingTopic:e?.pairingTopic,scopedProperties:c},_0(o,_1(l)))).then(e=>{t(e)}).catch(e=>{var t;null==(t=this.modal)||t.showErrorMessage("Unable to connect"),n(Error(e.message))})});if(!t)return;let n=uf(t.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:n),this.setAccounts(n),this.events.emit("connect",{chainId:_9(this.chainId)})}catch(e){throw this.signer.logger.error(e),e}finally{null==(t=this.modal)||t.close()}}async authenticate(e,t){var r;if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e?.chains});try{let r=await new Promise(async(r,i)=>{var n,s;let a,o;this.rpc.showQrModal&&(null==(n=this.modal)||n.open(),null==(s=this.modal)||s.subscribeState(e=>{e.open||this.signer.session||(this.signer.abortPairingAttempt(),i(Error("Connection request reset. Please try again.")))})),await this.signer.authenticate((a=_6({},e),o={chains:this.rpc.chains},_0(a,_1(o))),t).then(e=>{r(e)}).catch(e=>{var t;null==(t=this.modal)||t.showErrorMessage("Unable to connect"),i(Error(e.message))})}),i=r.session;if(i){let e=uf(i.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:e),this.setAccounts(e),this.events.emit("connect",{chainId:_9(this.chainId)})}return r}catch(e){throw this.signer.logger.error(e),e}finally{null==(r=this.modal)||r.close()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{let{params:t}=e,{event:r}=t;"accountsChanged"===r.name?(this.accounts=this.parseAccounts(r.data),this.events.emit("accountsChanged",this.accounts)):"chainChanged"===r.name?this.setChainId(this.formatChainId(r.data)):this.events.emit(r.name,r.data),this.events.emit("session_event",e)}),this.signer.on("accountsChanged",e=>{this.accounts=this.parseAccounts(e),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",e=>{let t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",_9(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",_0(_6({},gl("USER_DISCONNECTED")),_1({data:e.topic,name:"USER_DISCONNECTED"})))}),this.signer.on("display_uri",e=>{this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return"string"==typeof e&&e.startsWith(`${this.namespace}:`)}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){let t=e.filter(e=>this.isCompatibleChainId(e)).map(e=>this.parseChainId(e));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",_9(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){let t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){let[t,r,i]=e.split(":");return{chainId:`${t}:${r}`,address:i}}setAccounts(e){this.accounts=e.filter(e=>this.parseChainId(this.parseAccountId(e).chainId)===this.chainId).map(e=>this.parseAccountId(e).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,r;let i=null!=(t=e?.chains)?t:[],n=null!=(r=e?.optionalChains)?r:[],s=i.concat(n);if(!s.length)throw Error("No chains specified in either `chains` or `optionalChains`");let a=i.length?e?.methods||_J:[],o=i.length?e?.events||_G:[],l=e?.optionalMethods||[],c=e?.optionalEvents||[],d=e?.rpcMap||this.buildRpcMap(s,e.projectId),u=e?.qrModalOptions||void 0;return{chains:i?.map(e=>this.formatChainId(e)),optionalChains:n.map(e=>this.formatChainId(e)),methods:a,events:o,optionalMethods:l,optionalEvents:c,rpcMap:d,showQrModal:!!(null!=e&&e.showQrModal),qrModalOptions:u,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){let r={};return e.forEach(e=>{r[e]=this.getRpcUrl(e,t)}),r}async initialize(e){var t;if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?_7(this.rpc.chains):_7(this.rpc.optionalChains),this.signer=await _V.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let e;try{let r,i,n,s,a=await _Q(),{convertWCMToAppKitOptions:o}=await Promise.resolve().then(function(){return Eu}),l=o((r=_6({},this.rpc.qrModalOptions),i={chains:[...new Set([...this.rpc.chains,...this.rpc.optionalChains])],metadata:this.rpc.metadata,projectId:this.rpc.projectId},_0(r,_1(i))));if(!l.networks.length)throw Error("No networks found for WalletConnect");e=a((n=_6({},l),s={universalProvider:this.signer,manualWCControl:!0,enableMobileFullScreen:(null==(t=this.rpc.qrModalOptions)?void 0:t.enableMobileFullScreen)===!0},_0(n,_1(s))))}catch(e){throw console.warn(e),Error("To use QR modal, please install @reown/appkit package")}if(e)try{this.modal=e}catch(e){throw this.signer.logger.error(e),Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;let{chains:t,optionalChains:r,rpcMap:i}=e;t&&gc(t)&&(this.rpc.chains=t.map(e=>this.formatChainId(e)),t.forEach(e=>{this.rpc.rpcMap[e]=i?.[e]||this.getRpcUrl(e)})),r&&gc(r)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=r?.map(e=>this.formatChainId(e)),r.forEach(e=>{this.rpc.rpcMap[e]=i?.[e]||this.getRpcUrl(e)}))}getRpcUrl(e,t){var r;return(null==(r=this.rpc.rpcMap)?void 0:r[e])||`https://rpc.walletconnect.org/v1/?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{let e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t?.accounts),this.setAccounts(t?.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(e=>this.signer.logger.warn(e))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return"string"==typeof e||e instanceof String?[this.parseAccount(e)]:e.map(e=>this.parseAccount(e))}}var Et=Object.defineProperty,Er=Object.defineProperties,Ei=Object.getOwnPropertyDescriptors,En=Object.getOwnPropertySymbols,Es=Object.prototype.hasOwnProperty,Ea=Object.prototype.propertyIsEnumerable,Eo=(e,t,r)=>t in e?Et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,El=(e,t)=>{for(var r in t||(t={}))Es.call(t,r)&&Eo(e,r,t[r]);if(En)for(var r of En(t))Ea.call(t,r)&&Eo(e,r,t[r]);return e};let Ec=e=>{let[t,r]=e.split(":");return Ed({id:r,caipNetworkId:e,chainNamespace:t,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function Ed(e){return El({formatters:void 0,fees:void 0,serializers:void 0},e)}var Eu=Object.freeze({__proto__:null,convertWCMToAppKitOptions:function(e){var t,r,i,n,s,a,o;let l=null==(t=e.chains)?void 0:t.map(Ec).filter(Boolean);if(0===l.length)throw Error("At least one chain must be specified");let c=l.find(t=>{var r;return t.id===(null==(r=e.defaultChain)?void 0:r.id)}),d={projectId:e.projectId,networks:l,themeMode:e.themeMode,themeVariables:function(e){if(e)return{"--w3m-font-family":e["--wcm-font-family"],"--w3m-accent":e["--wcm-accent-color"],"--w3m-color-mix":e["--wcm-background-color"],"--w3m-z-index":e["--wcm-z-index"]?Number(e["--wcm-z-index"]):void 0,"--w3m-qr-color":e["--wcm-accent-color"],"--w3m-font-size-master":e["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":e["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}(e.themeVariables),chainImages:e.chainImages,connectorImages:e.walletImages,defaultNetwork:c,metadata:Er(El({},e.metadata),Ei({name:(null==(r=e.metadata)?void 0:r.name)||"WalletConnect",description:(null==(i=e.metadata)?void 0:i.description)||"Connect to WalletConnect-compatible wallets",url:(null==(n=e.metadata)?void 0:n.url)||"https://walletconnect.org",icons:(null==(s=e.metadata)?void 0:s.icons)||["https://walletconnect.org/walletconnect-logo.png"]})),showWallets:!0,featuredWalletIds:"NONE"===e.explorerRecommendedWalletIds?[]:Array.isArray(e.explorerRecommendedWalletIds)?e.explorerRecommendedWalletIds:[],excludeWalletIds:"ALL"===e.explorerExcludedWalletIds?[]:Array.isArray(e.explorerExcludedWalletIds)?e.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if(null!=(a=e.mobileWallets)&&a.length||null!=(o=e.desktopWallets)&&o.length){let t=[...(e.mobileWallets||[]).map(e=>({id:e.id,name:e.name,links:e.links})),...(e.desktopWallets||[]).map(e=>({id:e.id,name:e.name,links:{native:e.links.native,universal:e.links.universal}}))],r=[...d.featuredWalletIds||[],...d.excludeWalletIds||[]],i=t.filter(e=>!r.includes(e.id));i.length&&(d.customWallets=i)}return d},defineChain:Ed}),Eh=e.i(722262);e.i(914146);var Ep=e.i(57159),Ef=e.i(110163);e.i(189643);var Ey=e.i(85478),Eg=e.i(450223),Em=e.i(117595),Ew=Object.defineProperty,Eb=(e,t)=>{for(var r in t)Ew(e,r,{get:t[r],enumerable:!0})},Ev={84532:{usdcAddress:"0x036CbD53842c5426634e7929541eC2318f3dCF7e",usdcName:"USDC"},8453:{usdcAddress:"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",usdcName:"USD Coin"},43113:{usdcAddress:"0x5425890298aed601595a70AB815c96711a31Bc65",usdcName:"USD Coin"},43114:{usdcAddress:"0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E",usdcName:"USD Coin"},4689:{usdcAddress:"0xcdf79194c6c285077a58da47641d4dbe51f63542",usdcName:"Bridged USDC"},103:{usdcAddress:"4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU",usdcName:"USDC"},101:{usdcAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",usdcName:"USDC"},1328:{usdcAddress:"0x4fcf1784b31630811181f670aea7a7bef803eaed",usdcName:"USDC"},1329:{usdcAddress:"0xe15fc38f6d8c56af07bbcbe3baf5708a2bf42392",usdcName:"USDC"},137:{usdcAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",usdcName:"USD Coin"},80002:{usdcAddress:"0x41E94Eb019C0762f9Bfcf9Fb1E58725BfB0e7582",usdcName:"USDC"},3338:{usdcAddress:"0xbbA60da06c2c5424f03f7434542280FCAd453d10",usdcName:"USDC"},2741:{usdcAddress:"0x84a71ccd554cc1b02749b35d22f684cc8ec987e1",usdcName:"Bridged USDC"},11124:{usdcAddress:"0xe4C7fBB0a626ed208021ccabA6Be1566905E2dFc",usdcName:"Bridged USDC"},1514:{usdcAddress:"0xF1815bd50389c46847f0Bda824eC8da914045D14",usdcName:"Bridged USDC"},41923:{usdcAddress:"0x12a272A581feE5577A5dFa371afEB4b2F3a8C2F8",usdcName:"Bridged USDC (Stargate)"},0x135a9d92:{usdcAddress:"0x2e08028E3C4c2356572E096d8EF835cD5C6030bD",usdcName:"Bridged USDC (SKALE Bridge)"}},E_=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"authorizer",type:"address"},{indexed:!0,internalType:"bytes32",name:"nonce",type:"bytes32"}],name:"AuthorizationCanceled",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"authorizer",type:"address"},{indexed:!0,internalType:"bytes32",name:"nonce",type:"bytes32"}],name:"AuthorizationUsed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"_account",type:"address"}],name:"Blacklisted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newBlacklister",type:"address"}],name:"BlacklisterChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"burner",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Burn",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newMasterMinter",type:"address"}],name:"MasterMinterChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"minter",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Mint",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"minter",type:"address"},{indexed:!1,internalType:"uint256",name:"minterAllowedAmount",type:"uint256"}],name:"MinterConfigured",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"oldMinter",type:"address"}],name:"MinterRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"previousOwner",type:"address"},{indexed:!1,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[],name:"Pause",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newAddress",type:"address"}],name:"PauserChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newRescuer",type:"address"}],name:"RescuerChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"_account",type:"address"}],name:"UnBlacklisted",type:"event"},{anonymous:!1,inputs:[],name:"Unpause",type:"event"},{inputs:[],name:"CANCEL_AUTHORIZATION_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"PERMIT_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"RECEIVE_WITH_AUTHORIZATION_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"TRANSFER_WITH_AUTHORIZATION_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"authorizer",type:"address"},{internalType:"bytes32",name:"nonce",type:"bytes32"}],name:"authorizationState",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_account",type:"address"}],name:"blacklist",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"blacklister",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_amount",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"authorizer",type:"address"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"cancelAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"authorizer",type:"address"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"cancelAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"},{internalType:"uint256",name:"minterAllowedAmount",type:"uint256"}],name:"configureMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"currency",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"decrement",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"increment",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"tokenName",type:"string"},{internalType:"string",name:"tokenSymbol",type:"string"},{internalType:"string",name:"tokenCurrency",type:"string"},{internalType:"uint8",name:"tokenDecimals",type:"uint8"},{internalType:"address",name:"newMasterMinter",type:"address"},{internalType:"address",name:"newPauser",type:"address"},{internalType:"address",name:"newBlacklister",type:"address"},{internalType:"address",name:"newOwner",type:"address"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"newName",type:"string"}],name:"initializeV2",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"lostAndFound",type:"address"}],name:"initializeV2_1",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"accountsToBlacklist",type:"address[]"},{internalType:"string",name:"newSymbol",type:"string"}],name:"initializeV2_2",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_account",type:"address"}],name:"isBlacklisted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"masterMinter",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_to",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"}],name:"minterAllowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"pauser",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"receiveWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"receiveWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"}],name:"removeMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"tokenContract",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"rescueERC20",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"rescuer",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"transferWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"transferWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_account",type:"address"}],name:"unBlacklist",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unpause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_newBlacklister",type:"address"}],name:"updateBlacklister",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_newMasterMinter",type:"address"}],name:"updateMasterMinter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_newPauser",type:"address"}],name:"updatePauser",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newRescuer",type:"address"}],name:"updateRescuer",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"version",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"pure",type:"function"}];e.s([],38570),e.i(38570),(C_=CD||(CD={})).assertEqual=e=>{},C_.assertIs=function(e){},C_.assertNever=function(e){throw Error()},C_.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},C_.getValidEnumValues=e=>{let t=C_.objectKeys(e).filter(t=>"number"!=typeof e[e[t]]),r={};for(let i of t)r[i]=e[i];return C_.objectValues(r)},C_.objectValues=e=>C_.objectKeys(e).map(function(t){return e[t]}),C_.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},C_.find=(e,t)=>{for(let r of e)if(t(r))return r},C_.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,C_.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},C_.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(Cj||(Cj={})).mergeShapes=(e,t)=>({...e,...t});let EE=CD.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),EA=e=>{switch(typeof e){case"undefined":return EE.undefined;case"string":return EE.string;case"number":return Number.isNaN(e)?EE.nan:EE.number;case"boolean":return EE.boolean;case"function":return EE.function;case"bigint":return EE.bigint;case"symbol":return EE.symbol;case"object":if(Array.isArray(e))return EE.array;if(null===e)return EE.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return EE.promise;if("undefined"!=typeof Map&&e instanceof Map)return EE.map;if("undefined"!=typeof Set&&e instanceof Set)return EE.set;if("undefined"!=typeof Date&&e instanceof Date)return EE.date;return EE.object;default:return EE.unknown}};e.s(["ZodParsedType",0,EE,"getParsedType",0,EA,"objectUtil",()=>Cj,"util",()=>CD],904783);let ES=CD.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),EI=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Ek extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},i=e=>{for(let n of e.issues)if("invalid_union"===n.code)n.unionErrors.map(i);else if("invalid_return_type"===n.code)i(n.returnTypeError);else if("invalid_arguments"===n.code)i(n.argumentsError);else if(0===n.path.length)r._errors.push(t(n));else{let e=r,i=0;for(;i<n.path.length;){let r=n.path[i];i===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(n))):e[r]=e[r]||{_errors:[]},e=e[r],i++}}};return i(this),r}static assert(e){if(!(e instanceof Ek))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,CD.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let i of this.issues)if(i.path.length>0){let r=i.path[0];t[r]=t[r]||[],t[r].push(e(i))}else r.push(e(i));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Ek.create=e=>new Ek(e),e.s(["ZodError",()=>Ek,"ZodIssueCode",0,ES,"quotelessJson",0,EI],169790);let ET=(e,t)=>{let r;switch(e.code){case ES.invalid_type:r=e.received===EE.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case ES.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,CD.jsonStringifyReplacer)}`;break;case ES.unrecognized_keys:r=`Unrecognized key(s) in object: ${CD.joinValues(e.keys,", ")}`;break;case ES.invalid_union:r="Invalid input";break;case ES.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${CD.joinValues(e.options)}`;break;case ES.invalid_enum_value:r=`Invalid enum value. Expected ${CD.joinValues(e.options)}, received '${e.received}'`;break;case ES.invalid_arguments:r="Invalid function arguments";break;case ES.invalid_return_type:r="Invalid function return type";break;case ES.invalid_date:r="Invalid date";break;case ES.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:CD.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case ES.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case ES.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case ES.custom:r="Invalid input";break;case ES.invalid_intersection_types:r="Intersection results could not be merged";break;case ES.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case ES.not_finite:r="Number must be finite";break;default:r=t.defaultError,CD.assertNever(e)}return{message:r}},Ex=ET;function EC(e){Ex=e}function EP(){return Ex}e.s(["getErrorMap",()=>EP,"setErrorMap",()=>EC],937904),e.i(937904),e.s(["defaultErrorMap",0,ET,"getErrorMap",()=>EP,"setErrorMap",()=>EC],277290),e.i(277290);let EO=e=>{let{data:t,path:r,errorMaps:i,issueData:n}=e,s=[...r,...n.path||[]],a={...n,path:s};if(void 0!==n.message)return{...n,path:s,message:n.message};let o="";for(let e of i.filter(e=>!!e).slice().reverse())o=e(a,{data:t,defaultError:o}).message;return{...n,path:s,message:o}},ER=[];function EN(e,t){let r=Ex,i=EO({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===ET?void 0:ET].filter(e=>!!e)});e.common.issues.push(i)}class EM{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let i of t){if("aborted"===i.status)return EU;"dirty"===i.status&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,i=await e.value;r.push({key:t,value:i})}return EM.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let i of t){let{key:t,value:n}=i;if("aborted"===t.status||"aborted"===n.status)return EU;"dirty"===t.status&&e.dirty(),"dirty"===n.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==n.value||i.alwaysSet)&&(r[t.value]=n.value)}return{status:e.value,value:r}}}let EU=Object.freeze({status:"aborted"}),ED=e=>({status:"dirty",value:e}),Ej=e=>({status:"valid",value:e}),EL=e=>"aborted"===e.status,EB=e=>"dirty"===e.status,EW=e=>"valid"===e.status,EF=e=>"undefined"!=typeof Promise&&e instanceof Promise;e.s(["DIRTY",0,ED,"EMPTY_PATH",0,ER,"INVALID",0,EU,"OK",0,Ej,"ParseStatus",()=>EM,"addIssueToContext",()=>EN,"isAborted",0,EL,"isAsync",0,EF,"isDirty",0,EB,"isValid",0,EW,"makeIssue",0,EO],665354),e.i(665354),e.s([],527404),e.i(527404),e.i(904783),(CE=CL||(CL={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},CE.toString=e=>"string"==typeof e?e:e?.message;class EH{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let Eq=(e,t)=>{if(EW(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new Ek(e.common.issues);return this._error=t,this._error}}};function Ez(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:i,description:n}=e;if(t&&(r||i))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:n}:{errorMap:(t,n)=>{let{message:s}=e;return"invalid_enum_value"===t.code?{message:s??n.defaultError}:void 0===n.data?{message:s??i??n.defaultError}:"invalid_type"!==t.code?{message:n.defaultError}:{message:s??r??n.defaultError}},description:n}}class E${get description(){return this._def.description}_getType(e){return EA(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:EA(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new EM,ctx:{common:e.parent.common,data:e.data,parsedType:EA(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(EF(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:EA(e)},i=this._parseSync({data:e,path:r.path,parent:r});return Eq(r,i)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:EA(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return EW(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>EW(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:EA(e)},i=this._parse({data:e,path:r.path,parent:r});return Eq(r,await (EF(i)?i:Promise.resolve(i)))}refine(e,t){return this._refinement((r,i)=>{let n=e(r),s=()=>i.addIssue({code:ES.custom,..."string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(r):t});return"undefined"!=typeof Promise&&n instanceof Promise?n.then(e=>!!e||(s(),!1)):!!n||(s(),!1)})}refinement(e,t){return this._refinement((r,i)=>!!e(r)||(i.addIssue("function"==typeof t?t(r,i):t),!1))}_refinement(e){return new AC({schema:this,typeName:CB.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return AP.create(this,this._def)}nullable(){return AO.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ah.create(this)}promise(){return Ax.create(this,this._def)}or(e){return Af.create([this,e],this._def)}and(e){return Am.create(this,e,this._def)}transform(e){return new AC({...Ez(this._def),schema:this,typeName:CB.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new AR({...Ez(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:CB.ZodDefault})}brand(){return new AD({typeName:CB.ZodBranded,type:this,...Ez(this._def)})}catch(e){return new AN({...Ez(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:CB.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return Aj.create(this,e)}readonly(){return AL.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let EK=/^c[^\s-]{8,}$/i,EV=/^[0-9a-z]+$/,EJ=/^[0-9A-HJKMNP-TV-Z]{26}$/i,EZ=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,EG=/^[a-z0-9_-]{21}$/i,EY=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,EQ=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,EX=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,E0=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,E1=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,E2=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,E3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,E5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,E8=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,E6="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",E4=RegExp(`^${E6}$`);function E7(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function E9(e){let t=`${E6}T${E7(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)}class Ae extends E${_parse(e){var t,r,n,s;let a;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==EE.string){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.string,received:t.parsedType}),EU}let o=new EM;for(let l of this._def.checks)if("min"===l.kind)e.data.length<l.value&&(EN(a=this._getOrReturnCtx(e,a),{code:ES.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("max"===l.kind)e.data.length>l.value&&(EN(a=this._getOrReturnCtx(e,a),{code:ES.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("length"===l.kind){let t=e.data.length>l.value,r=e.data.length<l.value;(t||r)&&(a=this._getOrReturnCtx(e,a),t?EN(a,{code:ES.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):r&&EN(a,{code:ES.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),o.dirty())}else if("email"===l.kind)EX.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{validation:"email",code:ES.invalid_string,message:l.message}),o.dirty());else if("emoji"===l.kind)i||(i=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),i.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{validation:"emoji",code:ES.invalid_string,message:l.message}),o.dirty());else if("uuid"===l.kind)EZ.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{validation:"uuid",code:ES.invalid_string,message:l.message}),o.dirty());else if("nanoid"===l.kind)EG.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{validation:"nanoid",code:ES.invalid_string,message:l.message}),o.dirty());else if("cuid"===l.kind)EK.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{validation:"cuid",code:ES.invalid_string,message:l.message}),o.dirty());else if("cuid2"===l.kind)EV.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{validation:"cuid2",code:ES.invalid_string,message:l.message}),o.dirty());else if("ulid"===l.kind)EJ.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{validation:"ulid",code:ES.invalid_string,message:l.message}),o.dirty());else if("url"===l.kind)try{new URL(e.data)}catch{EN(a=this._getOrReturnCtx(e,a),{validation:"url",code:ES.invalid_string,message:l.message}),o.dirty()}else"regex"===l.kind?(l.regex.lastIndex=0,l.regex.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{validation:"regex",code:ES.invalid_string,message:l.message}),o.dirty())):"trim"===l.kind?e.data=e.data.trim():"includes"===l.kind?e.data.includes(l.value,l.position)||(EN(a=this._getOrReturnCtx(e,a),{code:ES.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),o.dirty()):"toLowerCase"===l.kind?e.data=e.data.toLowerCase():"toUpperCase"===l.kind?e.data=e.data.toUpperCase():"startsWith"===l.kind?e.data.startsWith(l.value)||(EN(a=this._getOrReturnCtx(e,a),{code:ES.invalid_string,validation:{startsWith:l.value},message:l.message}),o.dirty()):"endsWith"===l.kind?e.data.endsWith(l.value)||(EN(a=this._getOrReturnCtx(e,a),{code:ES.invalid_string,validation:{endsWith:l.value},message:l.message}),o.dirty()):"datetime"===l.kind?E9(l).test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{code:ES.invalid_string,validation:"datetime",message:l.message}),o.dirty()):"date"===l.kind?E4.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{code:ES.invalid_string,validation:"date",message:l.message}),o.dirty()):"time"===l.kind?RegExp(`^${E7(l)}$`).test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{code:ES.invalid_string,validation:"time",message:l.message}),o.dirty()):"duration"===l.kind?EQ.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{validation:"duration",code:ES.invalid_string,message:l.message}),o.dirty()):"ip"===l.kind?(t=e.data,!(("v4"===(r=l.version)||!r)&&E0.test(t)||("v6"===r||!r)&&E2.test(t))&&1&&(EN(a=this._getOrReturnCtx(e,a),{validation:"ip",code:ES.invalid_string,message:l.message}),o.dirty())):"jwt"===l.kind?!function(e,t){if(!EY.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));if("object"!=typeof n||null===n||"typ"in n&&n?.typ!=="JWT"||!n.alg||t&&n.alg!==t)return!1;return!0}catch{return!1}}(e.data,l.alg)&&(EN(a=this._getOrReturnCtx(e,a),{validation:"jwt",code:ES.invalid_string,message:l.message}),o.dirty()):"cidr"===l.kind?(n=e.data,!(("v4"===(s=l.version)||!s)&&E1.test(n)||("v6"===s||!s)&&E3.test(n))&&1&&(EN(a=this._getOrReturnCtx(e,a),{validation:"cidr",code:ES.invalid_string,message:l.message}),o.dirty())):"base64"===l.kind?E5.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{validation:"base64",code:ES.invalid_string,message:l.message}),o.dirty()):"base64url"===l.kind?E8.test(e.data)||(EN(a=this._getOrReturnCtx(e,a),{validation:"base64url",code:ES.invalid_string,message:l.message}),o.dirty()):CD.assertNever(l);return{status:o.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:ES.invalid_string,...CL.errToObj(r)})}_addCheck(e){return new Ae({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...CL.errToObj(e)})}url(e){return this._addCheck({kind:"url",...CL.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...CL.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...CL.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...CL.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...CL.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...CL.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...CL.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...CL.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...CL.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...CL.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...CL.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...CL.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...CL.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...CL.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...CL.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...CL.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...CL.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...CL.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...CL.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...CL.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...CL.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...CL.errToObj(t)})}nonempty(e){return this.min(1,CL.errToObj(e))}trim(){return new Ae({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ae({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ae({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Ae.create=e=>new Ae({checks:[],typeName:CB.ZodString,coerce:e?.coerce??!1,...Ez(e)});class At extends E${constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==EE.number){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.number,received:t.parsedType}),EU}let r=new EM;for(let i of this._def.checks)"int"===i.kind?CD.isInteger(e.data)||(EN(t=this._getOrReturnCtx(e,t),{code:ES.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(EN(t=this._getOrReturnCtx(e,t),{code:ES.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(EN(t=this._getOrReturnCtx(e,t),{code:ES.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):"multipleOf"===i.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,n=r>i?r:i;return Number.parseInt(e.toFixed(n).replace(".",""))%Number.parseInt(t.toFixed(n).replace(".",""))/10**n}(e.data,i.value)&&(EN(t=this._getOrReturnCtx(e,t),{code:ES.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(EN(t=this._getOrReturnCtx(e,t),{code:ES.not_finite,message:i.message}),r.dirty()):CD.assertNever(i);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,CL.toString(t))}gt(e,t){return this.setLimit("min",e,!1,CL.toString(t))}lte(e,t){return this.setLimit("max",e,!0,CL.toString(t))}lt(e,t){return this.setLimit("max",e,!1,CL.toString(t))}setLimit(e,t,r,i){return new At({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:CL.toString(i)}]})}_addCheck(e){return new At({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:CL.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:CL.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:CL.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:CL.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:CL.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:CL.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:CL.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:CL.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:CL.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&CD.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks)if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;else"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value);return Number.isFinite(t)&&Number.isFinite(e)}}At.create=e=>new At({checks:[],typeName:CB.ZodNumber,coerce:e?.coerce||!1,...Ez(e)});class Ar extends E${constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==EE.bigint)return this._getInvalidInput(e);let r=new EM;for(let i of this._def.checks)"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(EN(t=this._getOrReturnCtx(e,t),{code:ES.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(EN(t=this._getOrReturnCtx(e,t),{code:ES.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(EN(t=this._getOrReturnCtx(e,t),{code:ES.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):CD.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.bigint,received:t.parsedType}),EU}gte(e,t){return this.setLimit("min",e,!0,CL.toString(t))}gt(e,t){return this.setLimit("min",e,!1,CL.toString(t))}lte(e,t){return this.setLimit("max",e,!0,CL.toString(t))}lt(e,t){return this.setLimit("max",e,!1,CL.toString(t))}setLimit(e,t,r,i){return new Ar({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:CL.toString(i)}]})}_addCheck(e){return new Ar({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:CL.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:CL.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:CL.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:CL.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:CL.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Ar.create=e=>new Ar({checks:[],typeName:CB.ZodBigInt,coerce:e?.coerce??!1,...Ez(e)});class Ai extends E${_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==EE.boolean){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.boolean,received:t.parsedType}),EU}return Ej(e.data)}}Ai.create=e=>new Ai({typeName:CB.ZodBoolean,coerce:e?.coerce||!1,...Ez(e)});class An extends E${_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==EE.date){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.date,received:t.parsedType}),EU}if(Number.isNaN(e.data.getTime()))return EN(this._getOrReturnCtx(e),{code:ES.invalid_date}),EU;let r=new EM;for(let i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(EN(t=this._getOrReturnCtx(e,t),{code:ES.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(EN(t=this._getOrReturnCtx(e,t),{code:ES.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):CD.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new An({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:CL.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:CL.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}An.create=e=>new An({checks:[],coerce:e?.coerce||!1,typeName:CB.ZodDate,...Ez(e)});class As extends E${_parse(e){if(this._getType(e)!==EE.symbol){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.symbol,received:t.parsedType}),EU}return Ej(e.data)}}As.create=e=>new As({typeName:CB.ZodSymbol,...Ez(e)});class Aa extends E${_parse(e){if(this._getType(e)!==EE.undefined){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.undefined,received:t.parsedType}),EU}return Ej(e.data)}}Aa.create=e=>new Aa({typeName:CB.ZodUndefined,...Ez(e)});class Ao extends E${_parse(e){if(this._getType(e)!==EE.null){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.null,received:t.parsedType}),EU}return Ej(e.data)}}Ao.create=e=>new Ao({typeName:CB.ZodNull,...Ez(e)});class Al extends E${constructor(){super(...arguments),this._any=!0}_parse(e){return Ej(e.data)}}Al.create=e=>new Al({typeName:CB.ZodAny,...Ez(e)});class Ac extends E${constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ej(e.data)}}Ac.create=e=>new Ac({typeName:CB.ZodUnknown,...Ez(e)});class Ad extends E${_parse(e){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.never,received:t.parsedType}),EU}}Ad.create=e=>new Ad({typeName:CB.ZodNever,...Ez(e)});class Au extends E${_parse(e){if(this._getType(e)!==EE.undefined){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.void,received:t.parsedType}),EU}return Ej(e.data)}}Au.create=e=>new Au({typeName:CB.ZodVoid,...Ez(e)});class Ah extends E${_parse(e){let{ctx:t,status:r}=this._processInputParams(e),i=this._def;if(t.parsedType!==EE.array)return EN(t,{code:ES.invalid_type,expected:EE.array,received:t.parsedType}),EU;if(null!==i.exactLength){let e=t.data.length>i.exactLength.value,n=t.data.length<i.exactLength.value;(e||n)&&(EN(t,{code:e?ES.too_big:ES.too_small,minimum:n?i.exactLength.value:void 0,maximum:e?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(null!==i.minLength&&t.data.length<i.minLength.value&&(EN(t,{code:ES.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),null!==i.maxLength&&t.data.length>i.maxLength.value&&(EN(t,{code:ES.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>i.type._parseAsync(new EH(t,e,t.path,r)))).then(e=>EM.mergeArray(r,e));let n=[...t.data].map((e,r)=>i.type._parseSync(new EH(t,e,t.path,r)));return EM.mergeArray(r,n)}get element(){return this._def.type}min(e,t){return new Ah({...this._def,minLength:{value:e,message:CL.toString(t)}})}max(e,t){return new Ah({...this._def,maxLength:{value:e,message:CL.toString(t)}})}length(e,t){return new Ah({...this._def,exactLength:{value:e,message:CL.toString(t)}})}nonempty(e){return this.min(1,e)}}Ah.create=(e,t)=>new Ah({type:e,minLength:null,maxLength:null,exactLength:null,typeName:CB.ZodArray,...Ez(t)});class Ap extends E${constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=CD.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==EE.object){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.object,received:t.parsedType}),EU}let{status:t,ctx:r}=this._processInputParams(e),{shape:i,keys:n}=this._getCached(),s=[];if(!(this._def.catchall instanceof Ad&&"strip"===this._def.unknownKeys))for(let e in r.data)n.includes(e)||s.push(e);let a=[];for(let e of n){let t=i[e],n=r.data[e];a.push({key:{status:"valid",value:e},value:t._parse(new EH(r,n,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof Ad){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of s)a.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)s.length>0&&(EN(r,{code:ES.unrecognized_keys,keys:s}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of s){let i=r.data[t];a.push({key:{status:"valid",value:t},value:e._parse(new EH(r,i,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of a){let r=await t.key,i=await t.value;e.push({key:r,value:i,alwaysSet:t.alwaysSet})}return e}).then(e=>EM.mergeObjectSync(t,e)):EM.mergeObjectSync(t,a)}get shape(){return this._def.shape()}strict(e){return CL.errToObj,new Ap({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{let i=this._def.errorMap?.(t,r).message??r.defaultError;return"unrecognized_keys"===t.code?{message:CL.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new Ap({...this._def,unknownKeys:"strip"})}passthrough(){return new Ap({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ap({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ap({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:CB.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Ap({...this._def,catchall:e})}pick(e){let t={};for(let r of CD.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new Ap({...this._def,shape:()=>t})}omit(e){let t={};for(let r of CD.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new Ap({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof Ap){let r={};for(let i in t.shape){let n=t.shape[i];r[i]=AP.create(e(n))}return new Ap({...t._def,shape:()=>r})}if(t instanceof Ah)return new Ah({...t._def,type:e(t.element)});if(t instanceof AP)return AP.create(e(t.unwrap()));if(t instanceof AO)return AO.create(e(t.unwrap()));if(t instanceof Aw)return Aw.create(t.items.map(t=>e(t)));else return t}(this)}partial(e){let t={};for(let r of CD.objectKeys(this.shape)){let i=this.shape[r];e&&!e[r]?t[r]=i:t[r]=i.optional()}return new Ap({...this._def,shape:()=>t})}required(e){let t={};for(let r of CD.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof AP;)e=e._def.innerType;t[r]=e}return new Ap({...this._def,shape:()=>t})}keyof(){return AI(CD.objectKeys(this.shape))}}Ap.create=(e,t)=>new Ap({shape:()=>e,unknownKeys:"strip",catchall:Ad.create(),typeName:CB.ZodObject,...Ez(t)}),Ap.strictCreate=(e,t)=>new Ap({shape:()=>e,unknownKeys:"strict",catchall:Ad.create(),typeName:CB.ZodObject,...Ez(t)}),Ap.lazycreate=(e,t)=>new Ap({shape:e,unknownKeys:"strip",catchall:Ad.create(),typeName:CB.ZodObject,...Ez(t)});class Af extends E${_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new Ek(e.ctx.common.issues));return EN(t,{code:ES.invalid_union,unionErrors:r}),EU});{let e,i=[];for(let n of r){let r={...t,common:{...t.common,issues:[]},parent:null},s=n._parseSync({data:t.data,path:t.path,parent:r});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:r}),r.common.issues.length&&i.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let n=i.map(e=>new Ek(e));return EN(t,{code:ES.invalid_union,unionErrors:n}),EU}}get options(){return this._def.options}}Af.create=(e,t)=>new Af({options:e,typeName:CB.ZodUnion,...Ez(t)});let Ay=e=>{if(e instanceof AA)return Ay(e.schema);if(e instanceof AC)return Ay(e.innerType());if(e instanceof AS)return[e.value];if(e instanceof Ak)return e.options;if(e instanceof AT)return CD.objectValues(e.enum);else if(e instanceof AR)return Ay(e._def.innerType);else if(e instanceof Aa)return[void 0];else if(e instanceof Ao)return[null];else if(e instanceof AP)return[void 0,...Ay(e.unwrap())];else if(e instanceof AO)return[null,...Ay(e.unwrap())];else if(e instanceof AD)return Ay(e.unwrap());else if(e instanceof AL)return Ay(e.unwrap());else if(e instanceof AN)return Ay(e._def.innerType);else return[]};class Ag extends E${_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==EE.object)return EN(t,{code:ES.invalid_type,expected:EE.object,received:t.parsedType}),EU;let r=this.discriminator,i=t.data[r],n=this.optionsMap.get(i);return n?t.common.async?n._parseAsync({data:t.data,path:t.path,parent:t}):n._parseSync({data:t.data,path:t.path,parent:t}):(EN(t,{code:ES.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),EU)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let i=new Map;for(let r of t){let t=Ay(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let n of t){if(i.has(n))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(n)}`);i.set(n,r)}}return new Ag({typeName:CB.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...Ez(r)})}}class Am extends E${_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=(e,i)=>{if(EL(e)||EL(i))return EU;let n=function e(t,r){let i=EA(t),n=EA(r);if(t===r)return{valid:!0,data:t};if(i===EE.object&&n===EE.object){let i=CD.objectKeys(r),n=CD.objectKeys(t).filter(e=>-1!==i.indexOf(e)),s={...t,...r};for(let i of n){let n=e(t[i],r[i]);if(!n.valid)return{valid:!1};s[i]=n.data}return{valid:!0,data:s}}if(i===EE.array&&n===EE.array){if(t.length!==r.length)return{valid:!1};let i=[];for(let n=0;n<t.length;n++){let s=e(t[n],r[n]);if(!s.valid)return{valid:!1};i.push(s.data)}return{valid:!0,data:i}}if(i===EE.date&&n===EE.date&&+t==+r)return{valid:!0,data:t};return{valid:!1}}(e.value,i.value);return n.valid?((EB(e)||EB(i))&&t.dirty(),{status:t.value,value:n.data}):(EN(r,{code:ES.invalid_intersection_types}),EU)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>i(e,t)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Am.create=(e,t,r)=>new Am({left:e,right:t,typeName:CB.ZodIntersection,...Ez(r)});class Aw extends E${_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==EE.array)return EN(r,{code:ES.invalid_type,expected:EE.array,received:r.parsedType}),EU;if(r.data.length<this._def.items.length)return EN(r,{code:ES.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),EU;!this._def.rest&&r.data.length>this._def.items.length&&(EN(r,{code:ES.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let i=[...r.data].map((e,t)=>{let i=this._def.items[t]||this._def.rest;return i?i._parse(new EH(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(i).then(e=>EM.mergeArray(t,e)):EM.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new Aw({...this._def,rest:e})}}Aw.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new Aw({items:e,typeName:CB.ZodTuple,rest:null,...Ez(t)})};class Ab extends E${get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==EE.object)return EN(r,{code:ES.invalid_type,expected:EE.object,received:r.parsedType}),EU;let i=[],n=this._def.keyType,s=this._def.valueType;for(let e in r.data)i.push({key:n._parse(new EH(r,e,r.path,e)),value:s._parse(new EH(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?EM.mergeObjectAsync(t,i):EM.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,r){return new Ab(t instanceof E$?{keyType:e,valueType:t,typeName:CB.ZodRecord,...Ez(r)}:{keyType:Ae.create(),valueType:e,typeName:CB.ZodRecord,...Ez(t)})}}class Av extends E${get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==EE.map)return EN(r,{code:ES.invalid_type,expected:EE.map,received:r.parsedType}),EU;let i=this._def.keyType,n=this._def.valueType,s=[...r.data.entries()].map(([e,t],s)=>({key:i._parse(new EH(r,e,r.path,[s,"key"])),value:n._parse(new EH(r,t,r.path,[s,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of s){let i=await r.key,n=await r.value;if("aborted"===i.status||"aborted"===n.status)return EU;("dirty"===i.status||"dirty"===n.status)&&t.dirty(),e.set(i.value,n.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of s){let i=r.key,n=r.value;if("aborted"===i.status||"aborted"===n.status)return EU;("dirty"===i.status||"dirty"===n.status)&&t.dirty(),e.set(i.value,n.value)}return{status:t.value,value:e}}}}Av.create=(e,t,r)=>new Av({valueType:t,keyType:e,typeName:CB.ZodMap,...Ez(r)});class A_ extends E${_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==EE.set)return EN(r,{code:ES.invalid_type,expected:EE.set,received:r.parsedType}),EU;let i=this._def;null!==i.minSize&&r.data.size<i.minSize.value&&(EN(r,{code:ES.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),null!==i.maxSize&&r.data.size>i.maxSize.value&&(EN(r,{code:ES.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());let n=this._def.valueType;function s(e){let r=new Set;for(let i of e){if("aborted"===i.status)return EU;"dirty"===i.status&&t.dirty(),r.add(i.value)}return{status:t.value,value:r}}let a=[...r.data.values()].map((e,t)=>n._parse(new EH(r,e,r.path,t)));return r.common.async?Promise.all(a).then(e=>s(e)):s(a)}min(e,t){return new A_({...this._def,minSize:{value:e,message:CL.toString(t)}})}max(e,t){return new A_({...this._def,maxSize:{value:e,message:CL.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}A_.create=(e,t)=>new A_({valueType:e,minSize:null,maxSize:null,typeName:CB.ZodSet,...Ez(t)});class AE extends E${constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==EE.function)return EN(t,{code:ES.invalid_type,expected:EE.function,received:t.parsedType}),EU;function r(e,r){return EO({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ex,ET].filter(e=>!!e),issueData:{code:ES.invalid_arguments,argumentsError:r}})}function i(e,r){return EO({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ex,ET].filter(e=>!!e),issueData:{code:ES.invalid_return_type,returnTypeError:r}})}let n={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof Ax){let e=this;return Ej(async function(...t){let a=new Ek([]),o=await e._def.args.parseAsync(t,n).catch(e=>{throw a.addIssue(r(t,e)),a}),l=await Reflect.apply(s,this,o);return await e._def.returns._def.type.parseAsync(l,n).catch(e=>{throw a.addIssue(i(l,e)),a})})}{let e=this;return Ej(function(...t){let a=e._def.args.safeParse(t,n);if(!a.success)throw new Ek([r(t,a.error)]);let o=Reflect.apply(s,this,a.data),l=e._def.returns.safeParse(o,n);if(!l.success)throw new Ek([i(o,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new AE({...this._def,args:Aw.create(e).rest(Ac.create())})}returns(e){return new AE({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new AE({args:e||Aw.create([]).rest(Ac.create()),returns:t||Ac.create(),typeName:CB.ZodFunction,...Ez(r)})}}class AA extends E${get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}AA.create=(e,t)=>new AA({getter:e,typeName:CB.ZodLazy,...Ez(t)});class AS extends E${_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return EN(t,{received:t.data,code:ES.invalid_literal,expected:this._def.value}),EU}return{status:"valid",value:e.data}}get value(){return this._def.value}}function AI(e,t){return new Ak({values:e,typeName:CB.ZodEnum,...Ez(t)})}AS.create=(e,t)=>new AS({value:e,typeName:CB.ZodLiteral,...Ez(t)});class Ak extends E${_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return EN(t,{expected:CD.joinValues(r),received:t.parsedType,code:ES.invalid_type}),EU}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return EN(t,{received:t.data,code:ES.invalid_enum_value,options:r}),EU}return Ej(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Ak.create(e,{...this._def,...t})}exclude(e,t=this._def){return Ak.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}Ak.create=AI;class AT extends E${_parse(e){let t=CD.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==EE.string&&r.parsedType!==EE.number){let e=CD.objectValues(t);return EN(r,{expected:CD.joinValues(e),received:r.parsedType,code:ES.invalid_type}),EU}if(this._cache||(this._cache=new Set(CD.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=CD.objectValues(t);return EN(r,{received:r.data,code:ES.invalid_enum_value,options:e}),EU}return Ej(e.data)}get enum(){return this._def.values}}AT.create=(e,t)=>new AT({values:e,typeName:CB.ZodNativeEnum,...Ez(t)});class Ax extends E${unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==EE.promise&&!1===t.common.async?(EN(t,{code:ES.invalid_type,expected:EE.promise,received:t.parsedType}),EU):Ej((t.parsedType===EE.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Ax.create=(e,t)=>new Ax({type:e,typeName:CB.ZodPromise,...Ez(t)});class AC extends E${innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===CB.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,n={addIssue:e=>{EN(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(n.addIssue=n.addIssue.bind(n),"preprocess"===i.type){let e=i.transform(r.data,n);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return EU;let i=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===i.status?EU:"dirty"===i.status||"dirty"===t.value?ED(i.value):i});{if("aborted"===t.value)return EU;let i=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===i.status?EU:"dirty"===i.status||"dirty"===t.value?ED(i.value):i}}if("refinement"===i.type){let e=e=>{let t=i.refinement(e,n);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?EU:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===i.status?EU:("dirty"===i.status&&t.dirty(),e(i.value),{status:t.value,value:i.value})}}if("transform"===i.type)if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>EW(e)?Promise.resolve(i.transform(e.value,n)).then(e=>({status:t.value,value:e})):EU);else{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!EW(e))return EU;let s=i.transform(e.value,n);if(s instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}CD.assertNever(i)}}AC.create=(e,t,r)=>new AC({schema:e,typeName:CB.ZodEffects,effect:t,...Ez(r)}),AC.createWithPreprocess=(e,t,r)=>new AC({schema:t,effect:{type:"preprocess",transform:e},typeName:CB.ZodEffects,...Ez(r)});class AP extends E${_parse(e){return this._getType(e)===EE.undefined?Ej(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}AP.create=(e,t)=>new AP({innerType:e,typeName:CB.ZodOptional,...Ez(t)});class AO extends E${_parse(e){return this._getType(e)===EE.null?Ej(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}AO.create=(e,t)=>new AO({innerType:e,typeName:CB.ZodNullable,...Ez(t)});class AR extends E${_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===EE.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}AR.create=(e,t)=>new AR({innerType:e,typeName:CB.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...Ez(t)});class AN extends E${_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return EF(i)?i.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new Ek(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===i.status?i.value:this._def.catchValue({get error(){return new Ek(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}AN.create=(e,t)=>new AN({innerType:e,typeName:CB.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...Ez(t)});class AM extends E${_parse(e){if(this._getType(e)!==EE.nan){let t=this._getOrReturnCtx(e);return EN(t,{code:ES.invalid_type,expected:EE.nan,received:t.parsedType}),EU}return{status:"valid",value:e.data}}}AM.create=e=>new AM({typeName:CB.ZodNaN,...Ez(e)});let AU=Symbol("zod_brand");class AD extends E${_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Aj extends E${_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?EU:"dirty"===e.status?(t.dirty(),ED(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?EU:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new Aj({in:e,out:t,typeName:CB.ZodPipeline})}}class AL extends E${_parse(e){let t=this._def.innerType._parse(e),r=e=>(EW(e)&&(e.value=Object.freeze(e.value)),e);return EF(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}function AB(e,t){let r="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof r?{message:r}:r}function AW(e,t={},r){return e?Al.create().superRefine((i,n)=>{let s=e(i);if(s instanceof Promise)return s.then(e=>{if(!e){let e=AB(t,i),s=e.fatal??r??!0;n.addIssue({code:"custom",...e,fatal:s})}});if(!s){let e=AB(t,i),s=e.fatal??r??!0;n.addIssue({code:"custom",...e,fatal:s})}}):Al.create()}AL.create=(e,t)=>new AL({innerType:e,typeName:CB.ZodReadonly,...Ez(t)});let AF={object:Ap.lazycreate};(CA=CB||(CB={})).ZodString="ZodString",CA.ZodNumber="ZodNumber",CA.ZodNaN="ZodNaN",CA.ZodBigInt="ZodBigInt",CA.ZodBoolean="ZodBoolean",CA.ZodDate="ZodDate",CA.ZodSymbol="ZodSymbol",CA.ZodUndefined="ZodUndefined",CA.ZodNull="ZodNull",CA.ZodAny="ZodAny",CA.ZodUnknown="ZodUnknown",CA.ZodNever="ZodNever",CA.ZodVoid="ZodVoid",CA.ZodArray="ZodArray",CA.ZodObject="ZodObject",CA.ZodUnion="ZodUnion",CA.ZodDiscriminatedUnion="ZodDiscriminatedUnion",CA.ZodIntersection="ZodIntersection",CA.ZodTuple="ZodTuple",CA.ZodRecord="ZodRecord",CA.ZodMap="ZodMap",CA.ZodSet="ZodSet",CA.ZodFunction="ZodFunction",CA.ZodLazy="ZodLazy",CA.ZodLiteral="ZodLiteral",CA.ZodEnum="ZodEnum",CA.ZodEffects="ZodEffects",CA.ZodNativeEnum="ZodNativeEnum",CA.ZodOptional="ZodOptional",CA.ZodNullable="ZodNullable",CA.ZodDefault="ZodDefault",CA.ZodCatch="ZodCatch",CA.ZodPromise="ZodPromise",CA.ZodBranded="ZodBranded",CA.ZodPipeline="ZodPipeline",CA.ZodReadonly="ZodReadonly";let AH=(e,t={message:`Input not instance of ${e.name}`})=>AW(t=>t instanceof e,t),Aq=Ae.create,Az=At.create,A$=AM.create,AK=Ar.create,AV=Ai.create,AJ=An.create,AZ=As.create,AG=Aa.create,AY=Ao.create,AQ=Al.create,AX=Ac.create,A0=Ad.create,A1=Au.create,A2=Ah.create,A3=Ap.create,A5=Ap.strictCreate,A8=Af.create,A6=Ag.create,A4=Am.create,A7=Aw.create,A9=Ab.create,Se=Av.create,St=A_.create,Sr=AE.create,Si=AA.create,Sn=AS.create,Ss=Ak.create,Sa=AT.create,So=Ax.create,Sl=AC.create,Sc=AP.create,Sd=AO.create,Su=AC.createWithPreprocess,Sh=Aj.create,Sp=()=>Aq().optional(),Sf=()=>Az().optional(),Sy=()=>AV().optional(),Sg={string:e=>Ae.create({...e,coerce:!0}),number:e=>At.create({...e,coerce:!0}),boolean:e=>Ai.create({...e,coerce:!0}),bigint:e=>Ar.create({...e,coerce:!0}),date:e=>An.create({...e,coerce:!0})};e.s(["BRAND",0,AU,"NEVER",0,EU,"Schema",()=>E$,"ZodAny",()=>Al,"ZodArray",()=>Ah,"ZodBigInt",()=>Ar,"ZodBoolean",()=>Ai,"ZodBranded",()=>AD,"ZodCatch",()=>AN,"ZodDate",()=>An,"ZodDefault",()=>AR,"ZodDiscriminatedUnion",()=>Ag,"ZodEffects",()=>AC,"ZodEnum",()=>Ak,"ZodFirstPartyTypeKind",()=>CB,"ZodFunction",()=>AE,"ZodIntersection",()=>Am,"ZodLazy",()=>AA,"ZodLiteral",()=>AS,"ZodMap",()=>Av,"ZodNaN",()=>AM,"ZodNativeEnum",()=>AT,"ZodNever",()=>Ad,"ZodNull",()=>Ao,"ZodNullable",()=>AO,"ZodNumber",()=>At,"ZodObject",()=>Ap,"ZodOptional",()=>AP,"ZodPipeline",()=>Aj,"ZodPromise",()=>Ax,"ZodReadonly",()=>AL,"ZodRecord",()=>Ab,"ZodSchema",()=>E$,"ZodSet",()=>A_,"ZodString",()=>Ae,"ZodSymbol",()=>As,"ZodTransformer",()=>AC,"ZodTuple",()=>Aw,"ZodType",()=>E$,"ZodUndefined",()=>Aa,"ZodUnion",()=>Af,"ZodUnknown",()=>Ac,"ZodVoid",()=>Au,"any",()=>AQ,"array",()=>A2,"bigint",()=>AK,"boolean",()=>AV,"coerce",0,Sg,"custom",()=>AW,"date",()=>AJ,"datetimeRegex",()=>E9,"discriminatedUnion",()=>A6,"effect",()=>Sl,"enum",()=>Ss,"function",()=>Sr,"instanceof",()=>AH,"intersection",()=>A4,"late",0,AF,"lazy",()=>Si,"literal",()=>Sn,"map",()=>Se,"nan",()=>A$,"nativeEnum",()=>Sa,"never",()=>A0,"null",()=>AY,"nullable",()=>Sd,"number",()=>Az,"object",()=>A3,"oboolean",()=>Sy,"onumber",()=>Sf,"optional",()=>Sc,"ostring",()=>Sp,"pipeline",()=>Sh,"preprocess",()=>Su,"promise",()=>So,"record",()=>A9,"set",()=>St,"strictObject",()=>A5,"string",()=>Aq,"symbol",()=>AZ,"transformer",()=>Sl,"tuple",()=>A7,"undefined",()=>AG,"union",()=>A8,"unknown",()=>AX,"void",()=>A1],965638),e.i(965638),e.i(169790),e.s(["BRAND",0,AU,"DIRTY",0,ED,"EMPTY_PATH",0,ER,"INVALID",0,EU,"NEVER",0,EU,"OK",0,Ej,"ParseStatus",()=>EM,"Schema",()=>E$,"ZodAny",()=>Al,"ZodArray",()=>Ah,"ZodBigInt",()=>Ar,"ZodBoolean",()=>Ai,"ZodBranded",()=>AD,"ZodCatch",()=>AN,"ZodDate",()=>An,"ZodDefault",()=>AR,"ZodDiscriminatedUnion",()=>Ag,"ZodEffects",()=>AC,"ZodEnum",()=>Ak,"ZodError",()=>Ek,"ZodFirstPartyTypeKind",()=>CB,"ZodFunction",()=>AE,"ZodIntersection",()=>Am,"ZodIssueCode",0,ES,"ZodLazy",()=>AA,"ZodLiteral",()=>AS,"ZodMap",()=>Av,"ZodNaN",()=>AM,"ZodNativeEnum",()=>AT,"ZodNever",()=>Ad,"ZodNull",()=>Ao,"ZodNullable",()=>AO,"ZodNumber",()=>At,"ZodObject",()=>Ap,"ZodOptional",()=>AP,"ZodParsedType",0,EE,"ZodPipeline",()=>Aj,"ZodPromise",()=>Ax,"ZodReadonly",()=>AL,"ZodRecord",()=>Ab,"ZodSchema",()=>E$,"ZodSet",()=>A_,"ZodString",()=>Ae,"ZodSymbol",()=>As,"ZodTransformer",()=>AC,"ZodTuple",()=>Aw,"ZodType",()=>E$,"ZodUndefined",()=>Aa,"ZodUnion",()=>Af,"ZodUnknown",()=>Ac,"ZodVoid",()=>Au,"addIssueToContext",()=>EN,"any",()=>AQ,"array",()=>A2,"bigint",()=>AK,"boolean",()=>AV,"coerce",0,Sg,"custom",()=>AW,"date",()=>AJ,"datetimeRegex",()=>E9,"defaultErrorMap",0,ET,"discriminatedUnion",()=>A6,"effect",()=>Sl,"enum",()=>Ss,"function",()=>Sr,"getErrorMap",()=>EP,"getParsedType",0,EA,"instanceof",()=>AH,"intersection",()=>A4,"isAborted",0,EL,"isAsync",0,EF,"isDirty",0,EB,"isValid",0,EW,"late",0,AF,"lazy",()=>Si,"literal",()=>Sn,"makeIssue",0,EO,"map",()=>Se,"nan",()=>A$,"nativeEnum",()=>Sa,"never",()=>A0,"null",()=>AY,"nullable",()=>Sd,"number",()=>Az,"object",()=>A3,"objectUtil",()=>Cj,"oboolean",()=>Sy,"onumber",()=>Sf,"optional",()=>Sc,"ostring",()=>Sp,"pipeline",()=>Sh,"preprocess",()=>Su,"promise",()=>So,"quotelessJson",0,EI,"record",()=>A9,"set",()=>St,"setErrorMap",()=>EC,"strictObject",()=>A5,"string",()=>Aq,"symbol",()=>AZ,"transformer",()=>Sl,"tuple",()=>A7,"undefined",()=>AG,"union",()=>A8,"unknown",()=>AX,"util",()=>CD,"void",()=>A1],788685);var Sm=e.i(788685),Sm=Sm,Sw=e.i(309682),Sb=e.i(24335),Sv=e.i(450323),S_=e.i(557874),SE=e.i(982191),SA=e.i(839080);let SS={block:(0,S_.defineBlock)({format:e=>({transactions:e.transactions?.map(e=>{if("string"==typeof e)return e;let t=(0,SE.formatTransaction)(e);return"0x7e"===t.typeHex&&(t.isSystemTx=e.isSystemTx,t.mint=e.mint?(0,Sv.hexToBigInt)(e.mint):void 0,t.sourceHash=e.sourceHash,t.type="deposit"),t}),stateRoot:e.stateRoot})}),transaction:(0,SE.defineTransaction)({format(e){let t={};return"0x7e"===e.type&&(t.isSystemTx=e.isSystemTx,t.mint=e.mint?(0,Sv.hexToBigInt)(e.mint):void 0,t.sourceHash=e.sourceHash,t.type="deposit"),t}}),transactionReceipt:(0,SA.defineTransactionReceipt)({format:e=>({l1GasPrice:e.l1GasPrice?(0,Sv.hexToBigInt)(e.l1GasPrice):null,l1GasUsed:e.l1GasUsed?(0,Sv.hexToBigInt)(e.l1GasUsed):null,l1Fee:e.l1Fee?(0,Sv.hexToBigInt)(e.l1Fee):null,l1FeeScalar:e.l1FeeScalar?Number(e.l1FeeScalar):null})})};var SI=e.i(608861),Sk=e.i(147526),ST=e.i(70326),Sx=e.i(766816);let SC={blockTime:2e3,contracts:{gasPriceOracle:{address:"0x420000000000000000000000000000000000000F"},l1Block:{address:"0x4200000000000000000000000000000000000015"},l2CrossDomainMessenger:{address:"0x4200000000000000000000000000000000000007"},l2Erc721Bridge:{address:"0x4200000000000000000000000000000000000014"},l2StandardBridge:{address:"0x4200000000000000000000000000000000000010"},l2ToL1MessagePasser:{address:"0x4200000000000000000000000000000000000016"}},formatters:SS,serializers:{transaction:function(e,t){var r;return"deposit"===(r=e).type||void 0!==r.sourceHash?function(e){!function(e){let{from:t,to:r}=e;if(t&&!(0,nF.isAddress)(t))throw new SI.InvalidAddressError({address:t});if(r&&!(0,nF.isAddress)(r))throw new SI.InvalidAddressError({address:r})}(e);let{sourceHash:t,data:r,from:i,gas:n,isSystemTx:s,mint:a,to:o,value:l}=e,c=[t,i,o??"0x",a?(0,nW.toHex)(a):"0x",l?(0,nW.toHex)(l):"0x",n?(0,nW.toHex)(n):"0x",s?"0x1":"0x",r??"0x"];return(0,Sk.concatHex)(["0x7e",(0,ST.toRlp)(c)])}(e):(0,Sx.serializeTransaction)(e,t)}}};var SP=e.i(538463);let SO=(0,SP.defineChain)({...SC,id:84532,network:"base-sepolia",name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://sepolia.basescan.org",apiUrl:"https://api-sepolia.basescan.org/api"}},contracts:{...SC.contracts,disputeGameFactory:{0xaa36a7:{address:"0xd6E6dBf4F7EA0ac412fD8b65ED297e64BB7a06E1"}},l2OutputOracle:{0xaa36a7:{address:"0x84457ca9D0163FbC4bbfe4Dfbb20ba46e48DF254"}},portal:{0xaa36a7:{address:"0x49f53e41452c74589e85ca1677426ba426459e85",blockCreated:4446677}},l1StandardBridge:{0xaa36a7:{address:"0xfd0Bf71F60660E2f608ed56e1659C450eB113120",blockCreated:4446677}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1059647}},testnet:!0,sourceId:0xaa36a7});({...SO,experimental_preconfirmationTime:200,rpcUrls:{default:{http:["https://sepolia-preconf.base.org"]}}});let SR=(0,SP.defineChain)({id:43113,name:"Avalanche Fuji",nativeCurrency:{decimals:18,name:"Avalanche Fuji",symbol:"AVAX"},rpcUrls:{default:{http:["https://api.avax-test.network/ext/bc/C/rpc"]}},blockExplorers:{default:{name:"SnowTrace",url:"https://testnet.snowtrace.io",apiUrl:"https://api-testnet.snowtrace.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7096959}},testnet:!0}),SN=(0,SP.defineChain)({...SC,id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}},contracts:{...SC.contracts,disputeGameFactory:{1:{address:"0x43edB88C4B80fDD2AdFF2412A7BebF9dF42cB40e"}},l2OutputOracle:{1:{address:"0x56315b90c40730925ec5485cf004d835058518A0"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:5022},portal:{1:{address:"0x49048044D57e1C92A77f79988d21Fa8fAF74E97e",blockCreated:0x10ac19f}},l1StandardBridge:{1:{address:"0x3154Cf16ccdb4C6d922629664174b904d80F2C35",blockCreated:0x10ac19f}}},sourceId:1});({...SN,experimental_preconfirmationTime:200,rpcUrls:{default:{http:["https://mainnet-preconf.base.org"]}}});let SM=(0,SP.defineChain)({id:1329,name:"Sei Network",nativeCurrency:{name:"Sei",symbol:"SEI",decimals:18},rpcUrls:{default:{http:["https://evm-rpc.sei-apis.com/"],webSocket:["wss://evm-ws.sei-apis.com/"]}},blockExplorers:{default:{name:"Seitrace",url:"https://seitrace.com",apiUrl:"https://seitrace.com/pacific-1/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11"}}}),SU=(0,SP.defineChain)({id:1328,name:"Sei Testnet",nativeCurrency:{name:"Sei",symbol:"SEI",decimals:18},rpcUrls:{default:{http:["https://evm-rpc-testnet.sei-apis.com"],webSocket:["wss://evm-ws-testnet.sei-apis.com"]}},blockExplorers:{default:{name:"Seitrace",url:"https://seitrace.com"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:0x5e201b3}},testnet:!0}),SD=(0,SP.defineChain)({id:137,name:"Polygon",blockTime:2e3,nativeCurrency:{name:"POL",symbol:"POL",decimals:18},rpcUrls:{default:{http:["https://polygon-rpc.com"]}},blockExplorers:{default:{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.etherscan.io/v2/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:0x18938b0}}}),Sj=(0,SP.defineChain)({id:80002,name:"Polygon Amoy",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},rpcUrls:{default:{http:["https://rpc-amoy.polygon.technology"]}},blockExplorers:{default:{name:"PolygonScan",url:"https://amoy.polygonscan.com",apiUrl:"https://api.etherscan.io/v2/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:3127388}},testnet:!0}),SL=(0,SP.defineChain)({id:3338,name:"Peaq",nativeCurrency:{decimals:18,name:"peaq",symbol:"PEAQ"},rpcUrls:{default:{http:["https://quicknode1.peaq.xyz","https://quicknode2.peaq.xyz","https://quicknode3.peaq.xyz"],webSocket:["wss://quicknode1.peaq.xyz","wss://quicknode2.peaq.xyz","wss://quicknode3.peaq.xyz"]}},blockExplorers:{default:{name:"Subscan",url:"https://peaq.subscan.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:3566354}}}),SB=(0,SP.defineChain)({id:43114,name:"Avalanche",blockTime:1700,nativeCurrency:{decimals:18,name:"Avalanche",symbol:"AVAX"},rpcUrls:{default:{http:["https://api.avax.network/ext/bc/C/rpc"]}},blockExplorers:{default:{name:"SnowTrace",url:"https://snowtrace.io",apiUrl:"https://api.snowtrace.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:0xb5b35e}}}),SW=(0,SP.defineChain)({id:4690,name:"IoTeX Testnet",nativeCurrency:{decimals:18,name:"IoTeX",symbol:"IOTX"},rpcUrls:{default:{http:["https://babel-api.testnet.iotex.io"],webSocket:["wss://babel-api.testnet.iotex.io"]}},blockExplorers:{default:{name:"IoTeXScan",url:"https://testnet.iotexscan.io"}},contracts:{multicall3:{address:"0xb5cecD6894c6f473Ec726A176f1512399A2e355d",blockCreated:0x17383c8}},testnet:!0}),SF=(0,SP.defineChain)({id:4689,name:"IoTeX",nativeCurrency:{decimals:18,name:"IoTeX",symbol:"IOTX"},rpcUrls:{default:{http:["https://babel-api.mainnet.iotex.io"],webSocket:["wss://babel-api.mainnet.iotex.io"]}},blockExplorers:{default:{name:"IoTeXScan",url:"https://iotexscan.io"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:0x15230d6}}});var SH=e.i(769936),Sq=e.i(856324),Sz=e.i(190521);let S$=32n*e.i(674768).maxUint16,SK={block:(0,S_.defineBlock)({format(e){let t=e.transactions?.map(e=>{if("string"==typeof e)return e;let t=SK.transaction?.format(e);return"0x71"===t.typeHex?t.type="eip712":"0xff"===t.typeHex&&(t.type="priority"),t});return{l1BatchNumber:e.l1BatchNumber?(0,Sv.hexToBigInt)(e.l1BatchNumber):null,l1BatchTimestamp:e.l1BatchTimestamp?(0,Sv.hexToBigInt)(e.l1BatchTimestamp):null,transactions:t}}}),transaction:(0,SE.defineTransaction)({format(e){let t={};return"0x71"===e.type?t.type="eip712":"0xff"===e.type&&(t.type="priority"),{...t,l1BatchNumber:e.l1BatchNumber?(0,Sv.hexToBigInt)(e.l1BatchNumber):null,l1BatchTxIndex:e.l1BatchTxIndex?(0,Sv.hexToBigInt)(e.l1BatchTxIndex):null}}}),transactionReceipt:(0,SA.defineTransactionReceipt)({format:e=>({l1BatchNumber:e.l1BatchNumber?(0,Sv.hexToBigInt)(e.l1BatchNumber):null,l1BatchTxIndex:e.l1BatchTxIndex?(0,Sv.hexToBigInt)(e.l1BatchTxIndex):null,logs:e.logs.map(e=>({...(0,Sq.formatLog)(e),l1BatchNumber:e.l1BatchNumber?(0,Sv.hexToBigInt)(e.l1BatchNumber):null,transactionLogIndex:(0,Sv.hexToNumber)(e.transactionLogIndex),logType:e.logType})),l2ToL1Logs:e.l2ToL1Logs.map(e=>({blockNumber:(0,Sv.hexToBigInt)(e.blockHash),blockHash:e.blockHash,l1BatchNumber:e.l1BatchNumber?(0,Sv.hexToBigInt)(e.l1BatchNumber):null,transactionIndex:(0,Sv.hexToBigInt)(e.transactionIndex),shardId:(0,Sv.hexToBigInt)(e.shardId),isService:e.isService,sender:e.sender,key:e.key,value:e.value,transactionHash:e.transactionHash,logIndex:(0,Sv.hexToBigInt)(e.logIndex)}))})}),transactionRequest:(0,Sz.defineTransactionRequest)({exclude:["customSignature","factoryDeps","gasPerPubdata","paymaster","paymasterInput"],format:e=>e.gasPerPubdata||e.paymaster&&e.paymasterInput||e.factoryDeps||e.customSignature?{eip712Meta:{...e.gasPerPubdata?{gasPerPubdata:(0,nW.toHex)(e.gasPerPubdata)}:{gasPerPubdata:(0,nW.toHex)(50000n)},...e.paymaster&&e.paymasterInput?{paymasterParams:{paymaster:e.paymaster,paymasterInput:Array.from((0,SH.hexToBytes)(e.paymasterInput))}}:{},...e.factoryDeps?{factoryDeps:e.factoryDeps.map(e=>Array.from((0,SH.hexToBytes)(e)))}:{},...e.customSignature?{customSignature:Array.from((0,SH.hexToBytes)(e.customSignature))}:{}},type:"0x71"}:{}})};var SV=e.i(569934),SJ=e.i(505880),SZ=SV;class SG extends SZ.BaseError{constructor(){super('Transaction is not an EIP712 transaction.\n\nTransaction must:\n  - include `type: "eip712"`\n  - include one of the following: `customSignature`, `paymaster`, `paymasterInput`, `gasPerPubdata`, `factoryDeps`',{name:"InvalidEip712TransactionError"})}}function SY(e){return"eip712"===e.type||"customSignature"in e&&!!e.customSignature||"paymaster"in e&&!!e.paymaster||"paymasterInput"in e&&!!e.paymasterInput||"gasPerPubdata"in e&&"bigint"==typeof e.gasPerPubdata||"factoryDeps"in e&&!!e.factoryDeps||!1}function SQ(e){let{chainId:t,to:r,from:i,paymaster:n,paymasterInput:s}=e;if(!SY(e))throw new SG;if(!t||t<=0)throw new SJ.InvalidChainIdError({chainId:t});if(r&&!(0,nF.isAddress)(r))throw new SI.InvalidAddressError({address:r});if(i&&!(0,nF.isAddress)(i))throw new SI.InvalidAddressError({address:i});if(n&&!(0,nF.isAddress)(n))throw new SI.InvalidAddressError({address:n});if(n&&!s)throw new SV.BaseError("`paymasterInput` must be provided when `paymaster` is defined");if(!n&&s)throw new SV.BaseError("`paymaster` must be provided when `paymasterInput` is defined")}var SX=e.i(22411),S0=e.i(862243),S1=SV;class S2 extends S1.BaseError{constructor({givenLength:e,maxBytecodeSize:t}){super(`Bytecode cannot be longer than ${t} bytes. Given length: ${e}`,{name:"BytecodeLengthExceedsMaxSizeError"})}}class S3 extends S1.BaseError{constructor({givenLengthInWords:e}){super(`Bytecode length in 32-byte words must be odd. Given length in words: ${e}`,{name:"BytecodeLengthInWordsMustBeOddError"})}}class S5 extends S1.BaseError{constructor({givenLength:e}){super(`The bytecode length in bytes must be divisible by 32. Given length: ${e}`,{name:"BytecodeLengthMustBeDivisibleBy32Error"})}}function S8(e){let t=(0,SH.toBytes)(e);if(t.length%32!=0)throw new S5({givenLength:t.length});if(t.length>S$)throw new S2({givenLength:t.length,maxBytecodeSize:S$});let r=(0,S0.sha256)(t),i=(0,SH.toBytes)(r),n=t.length/32;if(n%2==0)throw new S3({givenLengthInWords:n});let s=(0,SH.toBytes)(n),a=(0,SX.pad)(s,{size:2}),o=new Uint8Array([1,0]);return i.set(o,0),i.set(a,2),i}let S6={blockTime:1e3,formatters:SK,serializers:{transaction:function(e,t){return SY(e)?function(e){let{chainId:t,gas:r,nonce:i,to:n,from:s,value:a,maxFeePerGas:o,maxPriorityFeePerGas:l,customSignature:c,factoryDeps:d,paymaster:u,paymasterInput:h,gasPerPubdata:p,data:f}=e;SQ(e);let y=[i?(0,nW.toHex)(i):"0x",l?(0,nW.toHex)(l):"0x",o?(0,nW.toHex)(o):"0x",r?(0,nW.toHex)(r):"0x",n??"0x",a?(0,nW.toHex)(a):"0x",f??"0x",(0,nW.toHex)(t),(0,nW.toHex)(""),(0,nW.toHex)(""),(0,nW.toHex)(t),s??"0x",p?(0,nW.toHex)(p):(0,nW.toHex)(50000n),d??[],c??"0x",u&&h?[u,h]:[]];return(0,Sk.concatHex)(["0x71",(0,ST.toRlp)(y)])}(e):(0,Sx.serializeTransaction)(e,t)}},custom:{getEip712Domain:e=>{SQ(e);let t=function(e){let{gas:t,nonce:r,to:i,from:n,value:s,maxFeePerGas:a,maxPriorityFeePerGas:o,factoryDeps:l,paymaster:c,paymasterInput:d,gasPerPubdata:u,data:h}=e;return{txType:113n,from:BigInt(n),to:i?BigInt(i):0n,gasLimit:t??0n,gasPerPubdataByteLimit:u??50000n,maxFeePerGas:a??0n,maxPriorityFeePerGas:o??0n,paymaster:c?BigInt(c):0n,nonce:r?BigInt(r):0n,value:s??0n,data:h??"0x",factoryDeps:l?.map(e=>(0,nW.toHex)(S8(e)))??[],paymasterInput:d||"0x"}}(e);return{domain:{name:"zkSync",version:"2",chainId:e.chainId},types:{Transaction:[{name:"txType",type:"uint256"},{name:"from",type:"uint256"},{name:"to",type:"uint256"},{name:"gasLimit",type:"uint256"},{name:"gasPerPubdataByteLimit",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymaster",type:"uint256"},{name:"nonce",type:"uint256"},{name:"value",type:"uint256"},{name:"data",type:"bytes"},{name:"factoryDeps",type:"bytes32[]"},{name:"paymasterInput",type:"bytes"}]},primaryType:"Transaction",message:t}}}},S4=(0,SP.defineChain)({...S6,blockTime:200,id:2741,name:"Abstract",nativeCurrency:{decimals:18,name:"ETH",symbol:"ETH"},rpcUrls:{default:{http:["https://api.mainnet.abs.xyz"],webSocket:["wss://api.mainnet.abs.xyz/ws"]}},blockExplorers:{default:{name:"Etherscan",url:"https://abscan.org"},native:{name:"Abstract Explorer",url:"https://explorer.mainnet.abs.xyz"}},contracts:{multicall3:{address:"0xAa4De41dba0Ca5dCBb288b7cC6b708F3aaC759E7",blockCreated:5288},erc6492Verifier:{address:"0xfB688330379976DA81eB64Fe4BF50d7401763B9C",blockCreated:5263}}}),S7=(0,SP.defineChain)({...S6,blockTime:200,id:11124,name:"Abstract Testnet",nativeCurrency:{decimals:18,name:"ETH",symbol:"ETH"},rpcUrls:{default:{http:["https://api.testnet.abs.xyz"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.abscan.org"},native:{name:"Abstract Explorer",url:"https://explorer.testnet.abs.xyz"}},testnet:!0,contracts:{multicall3:{address:"0xF9cda624FBC7e059355ce98a31693d299FACd963",blockCreated:358349},erc6492Verifier:{address:"0xfB688330379976DA81eB64Fe4BF50d7401763B9C",blockCreated:431682}}}),S9=(0,SP.defineChain)({id:1514,name:"Story",nativeCurrency:{decimals:18,name:"IP Token",symbol:"IP"},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:340998},ensRegistry:{address:"0x5dc881dda4e4a8d312be3544ad13118d1a04cb17",blockCreated:648924},ensUniversalResolver:{address:"0xddfb18888a9466688235887dec2a10c4f5effee9",blockCreated:649114}},rpcUrls:{default:{http:["https://mainnet.storyrpc.io"]}},blockExplorers:{default:{name:"Story explorer",url:"https://storyscan.io",apiUrl:"https://storyscan.io/api/v2"}},ensTlds:[".ip"],testnet:!1}),Ie=(0,SP.defineChain)({id:41923,name:"EDU Chain",nativeCurrency:{decimals:18,name:"EDU",symbol:"EDU"},rpcUrls:{default:{http:["https://rpc.edu-chain.raas.gelato.cloud"]}},blockExplorers:{default:{name:"EDU Chain Explorer",url:"https://educhain.blockscout.com/"}},testnet:!1});var It=e.i(337575),Ir=e.i(704433),Ii=e.i(913091);async function In({hash:e,privateKey:t,to:r="object"}){let{r:i,s:n,recovery:s}=It.secp256k1.sign(e.slice(2),t.slice(2),{lowS:!0,extraEntropy:!!(0,nq.isHex)(!1,{strict:!1})&&(0,SH.hexToBytes)(!1)}),a={r:(0,nW.numberToHex)(i,{size:32}),s:(0,nW.numberToHex)(n,{size:32}),v:s?28n:27n,yParity:s};return"bytes"===r||"hex"===r?(0,Ii.serializeSignature)({...a,to:r}):a}async function Is(e){let{chainId:t,nonce:r,privateKey:i,to:n="object"}=e,s=e.contractAddress??e.address,a=await In({hash:(0,nz.hashAuthorization)({address:s,chainId:t,nonce:r}),privateKey:i,to:n});return"object"===n?{address:s,chainId:t,nonce:r,...a}:a}var Ia=e.i(658765);async function Io({message:e,privateKey:t}){return await In({hash:(0,Ia.hashMessage)(e),privateKey:t,to:"hex"})}var Il=e.i(831095);async function Ic(e){let{privateKey:t,transaction:r,serializer:i=Sx.serializeTransaction}=e,n="eip4844"===r.type?{...r,sidecars:!1}:r,s=await In({hash:(0,Il.keccak256)(await i(n)),privateKey:t});return await i(r,s)}var Id=e.i(995062);async function Iu(e){let{privateKey:t,...r}=e;return await In({hash:(0,Id.hashTypedData)(r),privateKey:t,to:"hex"})}var Ih=e.i(938630),Ip=e.i(785904),If=e.i(70204),Iy=e.i(704434),Ig=e.i(656679);let Im=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"accountAddress",type:"address"},{indexed:!1,internalType:"enum IContractDeployer.AccountNonceOrdering",name:"nonceOrdering",type:"uint8"}],name:"AccountNonceOrderingUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"accountAddress",type:"address"},{indexed:!1,internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"aaVersion",type:"uint8"}],name:"AccountVersionUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"deployerAddress",type:"address"},{indexed:!0,internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{indexed:!0,internalType:"address",name:"contractAddress",type:"address"}],name:"ContractDeployed",type:"event"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"create",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"create2",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"},{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_aaVersion",type:"uint8"}],name:"create2Account",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"},{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_aaVersion",type:"uint8"}],name:"createAccount",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"extendedAccountVersion",outputs:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"_keccak256BytecodeHash",type:"bytes32"}],name:"forceDeployKeccak256",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{internalType:"address",name:"newAddress",type:"address"},{internalType:"bool",name:"callConstructor",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"input",type:"bytes"}],internalType:"struct ContractDeployer.ForceDeployment",name:"_deployment",type:"tuple"},{internalType:"address",name:"_sender",type:"address"}],name:"forceDeployOnAddress",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{internalType:"address",name:"newAddress",type:"address"},{internalType:"bool",name:"callConstructor",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"input",type:"bytes"}],internalType:"struct ContractDeployer.ForceDeployment[]",name:"_deployments",type:"tuple[]"}],name:"forceDeployOnAddresses",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"getAccountInfo",outputs:[{components:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"supportedAAVersion",type:"uint8"},{internalType:"enum IContractDeployer.AccountNonceOrdering",name:"nonceOrdering",type:"uint8"}],internalType:"struct IContractDeployer.AccountInfo",name:"info",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_sender",type:"address"},{internalType:"uint256",name:"_senderNonce",type:"uint256"}],name:"getNewAddressCreate",outputs:[{internalType:"address",name:"newAddress",type:"address"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"_sender",type:"address"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"getNewAddressCreate2",outputs:[{internalType:"address",name:"newAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_version",type:"uint8"}],name:"updateAccountVersion",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"enum IContractDeployer.AccountNonceOrdering",name:"_nonceOrdering",type:"uint8"}],name:"updateNonceOrdering",outputs:[],stateMutability:"nonpayable",type:"function"}],Iw="/docs/contract/encodeDeployData";function Ib(e,t,r,i){let n=[t,r,i];return({create:{functionName:"create",argsContractDeployer:n},create2:{functionName:"create2",argsContractDeployer:n},createAccount:{functionName:"createAccount",argsContractDeployer:[...n,1]},create2Account:{functionName:"create2Account",argsContractDeployer:[...n,1]}})[e||"create"]}var Iv=e.i(189991),I_=e.i(975948),IE=e.i(368941),IA=e.i(638291),IS=e.i(611573),II=e.i(942305),Ik=e.i(10725),IT=e.i(467125),Ix=e.i(353464);function IC(e){if(!SY(e))throw new SG;(0,Ix.assertRequest)(e)}var IP=e.i(866797),IO=e.i(431254);async function IR(e,t){let{account:r=e.account,chain:i=e.chain,...n}=t,s=r?(0,Iv.parseAccount)(r):e.account;if(!s)throw new IS.AccountNotFoundError({docsPath:"/docs/actions/wallet/signTransaction"});if(IC({account:s,chain:i,...t}),!i?.custom?.getEip712Domain)throw new SV.BaseError("`getEip712Domain` not found on chain.");if(!i?.serializers?.transaction)throw new SV.BaseError("transaction serializer not found on chain.");let a=await (0,IT.getAction)(e,I_.getChainId,"getChainId")({});null!==i&&(0,II.assertCurrentChain)({currentChainId:a,chain:i});let o=i?.custom.getEip712Domain({...n,chainId:a,from:s.address,type:"eip712"}),l=await (0,IO.signTypedData)(e,{...o,account:s});return i?.serializers?.transaction({chainId:a,...n,customSignature:l,type:"eip712"},{r:"0x0",s:"0x0",v:0n})}async function IN(e,t){return SY(t)?IR(e,t):await (0,IP.signTransaction)(e,t)}async function IM(e,t){let{account:r=e.account,chain:i=e.chain}=t,n=r?(0,Iv.parseAccount)(r):e.account;if(!n)throw new IS.AccountNotFoundError({docsPath:"/docs/actions/wallet/sendTransaction"});try{let r;IC(t);let s=await (0,IE.prepareTransactionRequest)(e,{...t,nonceManager:n.nonceManager,parameters:["gas","nonce","fees"]});null!==i&&(r=await (0,IT.getAction)(e,I_.getChainId,"getChainId")({}),(0,II.assertCurrentChain)({currentChainId:r,chain:i}));let a=await IN(e,{...s,chainId:r});return await (0,IT.getAction)(e,IA.sendRawTransaction,"sendRawTransaction")({serializedTransaction:a})}catch(e){throw(0,Ik.getTransactionError)(e,{...t,account:n,chain:i})}}var IU=e.i(888794);async function ID(e,t){return SY(t)?IM(e,t):(0,IU.sendTransaction)(e,t)}var Ij=e.i(654312),IL=e.i(642108);function IB(e){return JSON.parse(function(e){let t=[],r=!1;for(let n=0;n<e.length;n++){let s=!1;if("\\"===e[n]&&(t.push(e[n++]),s=!s),'"'===e[n]){t.push(e[n]),s||(r=!r);continue}if(!r){let r=function(e,t){if(!e[t]?.match(/[-\d]/))return null;let r=e.slice(t).match(/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?/);return r?r[0]:null}(e,n);if(r?.length){var i;n+=r.length-1,r.match(/\.|[eE]-/)?t.push(r):t.push((i=r,`{"$n":"${i}"}`));continue}}t.push(e[n])}return t.join("")}(e),(e,t)=>{var r;return(r=t)&&"object"==typeof r&&"$n"in r&&"string"==typeof r.$n?function({$n:e}){if(e.match(/[eE]/)){let[t,r]=e.split(/[eE]/);return BigInt(t)*BigInt(10)**BigInt(r)}return BigInt(e)}(t):t})}var IW=0n;function IF(e){let t;return{id:(t=IW,IW++,t.toString()),jsonrpc:"2.0",method:e.methodName,params:e.params}}function IH(e,t){return JSON.stringify(e,(e,t)=>{var r;return"bigint"==typeof t?(r=t,{$n:`${r}`}):t},t).replace(/\{\s*"\$n"\s*:\s*"(-?\d+)"\s*\}/g,"$1")}function Iq(e){return!(null==e||"object"!=typeof e||Array.isArray(e))&&"jsonrpc"in e&&"2.0"===e.jsonrpc&&"method"in e&&"string"==typeof e.method&&"params"in e}var Iz=e.i(631985);function I$(e){return"bigint"==typeof e?Number(e):e}var IK={};function IV(e){return function t(r,i){if(Array.isArray(r))return r.map((e,r)=>t(e,{...i,keyPath:[...i.keyPath,r]}));if("object"!=typeof r||null===r)return e.reduce((e,t)=>t(e,i),r);{let e={};for(let n in r){if(!Object.prototype.hasOwnProperty.call(r,n))continue;let s={...i,keyPath:[...i.keyPath,n]};e[n]=t(r[n],s)}return e}}}function IJ(e,t){return r=>{let i=IV(e);return Object.freeze({...r,params:i(r.params,t)})}}var IZ={accountNotifications:1,blockNotifications:1,getAccountInfo:1,getBalance:1,getBlock:1,getBlockHeight:0,getBlockProduction:0,getBlocks:2,getBlocksWithLimit:2,getEpochInfo:0,getFeeForMessage:1,getInflationGovernor:0,getInflationReward:1,getLargestAccounts:0,getLatestBlockhash:0,getLeaderSchedule:1,getMinimumBalanceForRentExemption:1,getMultipleAccounts:1,getProgramAccounts:1,getSignaturesForAddress:1,getSlot:0,getSlotLeader:0,getStakeMinimumDelegation:0,getSupply:0,getTokenAccountBalance:1,getTokenAccountsByDelegate:2,getTokenAccountsByOwner:2,getTokenLargestAccounts:1,getTokenSupply:1,getTransaction:1,getTransactionCount:0,getVoteAccounts:0,isBlockhashValid:1,logsNotifications:1,programNotifications:1,requestAirdrop:2,sendTransaction:1,signatureNotifications:1,simulateTransaction:1};function IG(e){let t=e?.onIntegerOverflow;return r=>(0,Iz.pipe)(r,t?e=>{var r;return IJ([(r=(...r)=>t(e,...r),(e,{keyPath:t})=>("bigint"==typeof e&&r&&(e>Number.MAX_SAFE_INTEGER||e<-Number.MAX_SAFE_INTEGER)&&r(t,e),e))],{keyPath:[]})(e)}:e=>e,IJ([I$],{keyPath:[]}),function({defaultCommitment:e,optionsObjectPositionByMethod:t}){return r=>{let{params:i,methodName:n}=r;if(!Array.isArray(i))return r;let s=t[n];return null==s?r:Object.freeze({methodName:n,params:function({commitmentPropertyName:e,params:t,optionsObjectPositionInParams:r,overrideCommitment:i}){let n=t[r];if(void 0===n||n&&"object"==typeof n&&!Array.isArray(n)){if(n&&e in n){if(!n[e]||"finalized"===n[e]){let i=[...t],{[e]:s,...a}=n;return Object.keys(a).length>0?i[r]=a:r===i.length-1?i.length--:i[r]=void 0,i}}else if("finalized"!==i){let s=[...t];return s[r]={...n,[e]:i},s}}return t}({commitmentPropertyName:"sendTransaction"===n?"preflightCommitment":"commitment",optionsObjectPositionInParams:s,overrideCommitment:e,params:i})})}}({defaultCommitment:e?.defaultCommitment,optionsObjectPositionByMethod:IZ}))}function IY(e){var t,r;return t=[function(t,{keyPath:r}){var i;return"number"==typeof t&&Number.isInteger(t)||"bigint"==typeof t?(i=r,e.some(e=>{if(e.length!==i.length)return!1;for(let t=i.length-1;t>=0;t--){let r=i[t],n=e[t];if(n!==r&&(n!==IK||"number"!=typeof r))return!1}return!0}))?Number(t):BigInt(t):t}],r={keyPath:[]},e=>IV(t)(e,r)}var IQ=[["data","parsed","info","tokenAmount","decimals"],["data","parsed","info","tokenAmount","uiAmount"],["data","parsed","info","rentExemptReserve","decimals"],["data","parsed","info","rentExemptReserve","uiAmount"],["data","parsed","info","delegatedAmount","decimals"],["data","parsed","info","delegatedAmount","uiAmount"],["data","parsed","info","extensions",IK,"state","olderTransferFee","transferFeeBasisPoints"],["data","parsed","info","extensions",IK,"state","newerTransferFee","transferFeeBasisPoints"],["data","parsed","info","extensions",IK,"state","preUpdateAverageRate"],["data","parsed","info","extensions",IK,"state","currentRate"]],IX=[...IQ,["data","parsed","info","lastExtendedSlotStartIndex"],["data","parsed","info","slashPenalty"],["data","parsed","info","warmupCooldownRate"],["data","parsed","info","decimals"],["data","parsed","info","numRequiredSigners"],["data","parsed","info","numValidSigners"],["data","parsed","info","stake","delegation","warmupCooldownRate"],["data","parsed","info","exemptionThreshold"],["data","parsed","info","burnPercent"],["data","parsed","info","commission"],["data","parsed","info","votes",IK,"confirmationCount"]],I0=[["index"],["instructions",IK,"accounts",IK],["instructions",IK,"programIdIndex"],["instructions",IK,"stackHeight"]],I1=[["addressTableLookups",IK,"writableIndexes",IK],["addressTableLookups",IK,"readonlyIndexes",IK],["header","numReadonlySignedAccounts"],["header","numReadonlyUnsignedAccounts"],["header","numRequiredSignatures"],["instructions",IK,"accounts",IK],["instructions",IK,"programIdIndex"],["instructions",IK,"stackHeight"]],I2=["getAccountInfo","getBalance","getBlock","getBlockCommitment","getBlockHeight","getBlockProduction","getBlocks","getBlocksWithLimit","getBlockTime","getClusterNodes","getEpochInfo","getEpochSchedule","getFeeForMessage","getFirstAvailableBlock","getGenesisHash","getHealth","getHighestSnapshotSlot","getIdentity","getInflationGovernor","getInflationRate","getInflationReward","getLargestAccounts","getLatestBlockhash","getLeaderSchedule","getMaxRetransmitSlot","getMaxShredInsertSlot","getMinimumBalanceForRentExemption","getMultipleAccounts","getProgramAccounts","getRecentPerformanceSamples","getRecentPrioritizationFees","getSignaturesForAddress","getSignatureStatuses","getSlot","getSlotLeader","getSlotLeaders","getStakeMinimumDelegation","getSupply","getTokenAccountBalance","getTokenAccountsByDelegate","getTokenAccountsByOwner","getTokenLargestAccounts","getTokenSupply","getTransaction","getTransactionCount","getVersion","getVoteAccounts","index","isBlockhashValid","minimumLedgerSlot","requestAirdrop","sendTransaction","simulateTransaction"];function I3(e){return Iq(e)&&I2.includes(e.method)}var I5=Object.prototype.toString,I8=Object.keys||function(e){let t=[];for(let r in e)t.push(r);return t};function I6(e){let t=function e(t,r){let i,n,s,a,o,l,c;if(!0===t)return"true";if(!1===t)return"false";switch(typeof t){case"object":if(null===t)return null;if("toJSON"in t&&"function"==typeof t.toJSON)return e(t.toJSON(),r);if("[object Array]"===(c=I5.call(t))){for(i=0,s="[",n=t.length-1;i<n;i++)s+=e(t[i],!0)+",";return n>-1&&(s+=e(t[i],!0)),s+"]"}if("[object Object]"!==c)return JSON.stringify(t);for(n=(a=I8(t).sort()).length,s="",i=0;i<n;)void 0!==(l=e(t[o=a[i]],!1))&&(s&&(s+=","),s+=JSON.stringify(o)+":"+l),i++;return"{"+s+"}";case"function":case"undefined":return r?null:void 0;case"bigint":return`${t.toString()}n`;case"string":return JSON.stringify(t);default:return isFinite(t)?t:null}}(e,!1);if(void 0!==t)return""+t}var I4={defaultCommitment:"confirmed",onIntegerOverflow(e,t,r){throw function e(t,r,i){let n="";if("number"==typeof r[0]){let e=r[0]+1,t=e%10,i=e%100;n=1==t&&11!=i?e+"st":2==t&&12!=i?e+"nd":3==t&&13!=i?e+"rd":e+"th"}else n=`\`${r[0].toString()}\``;let s=r.length>1?r.slice(1).map(e=>"number"==typeof e?`[${e}]`:e).join("."):void 0,a=new IL.SolanaError(IL.SOLANA_ERROR__RPC__INTEGER_OVERFLOW,{argumentLabel:n,keyPath:r,methodName:t,optionalPathLabel:s?` at path \`${s}\``:"",value:i,...void 0!==s?{path:s}:void 0});return(0,IL.safeCaptureStackTrace)(a,e),a}(e.methodName,t,r)}},I7=globalThis.AbortController;function I9(e){return Iq(e)?I6([e.method,e.params]):void 0}function ke(e,t){var r,i,n,s,a;return i=(r={url:e,...t},(0,Iz.pipe)(function(e){let t,{fromJson:r,headers:i,toJson:n,url:s}=e,a=i&&function(e){let t={};for(let r in e)t[r.toLowerCase()]=e[r];return t}(i);return async function({payload:e,signal:i}){let o=n?n(e):JSON.stringify(e),l={...t,body:o,headers:{...a,accept:"application/json","content-length":o.length.toString(),"content-type":"application/json; charset=utf-8"},method:"POST",signal:i},c=await fetch(s,l);if(!c.ok)throw new IL.SolanaError(IL.SOLANA_ERROR__RPC__TRANSPORT_HTTP_ERROR,{headers:c.headers,message:c.statusText,statusCode:c.status});return r?r(await c.text(),e):await c.json()}}({...{...r,headers:{...!1,...r.headers?function(e){let t={};for(let r in e)t[r.toLowerCase()]=e[r];return t}(r.headers):void 0,"solana-client":"js/5.1.0"}},fromJson:(e,t)=>I3(t)?IB(e):JSON.parse(e),toJson:e=>I3(e)?IH(e):JSON.stringify(e)}),e=>{let t;return async function(r){let{payload:i,signal:n}=r,s=I9(i);if(void 0===s)return await e(r);if(t||(queueMicrotask(()=>{t=void 0}),t={}),null==t[s]){let i=new I7,n=(async()=>{try{return await e({...r,signal:i.signal})}catch(e){if(e===(CF||={}))return;throw e}})();t[s]={abortController:i,numConsumers:0,responsePromise:n}}let a=t[s];if(a.numConsumers++,!n)return await a.responsePromise;{let e=a.responsePromise;return await new Promise((t,r)=>{let i=e=>{n.removeEventListener("abort",i),a.numConsumers-=1,queueMicrotask(()=>{0===a.numConsumers&&a.abortController.abort(CF||={})}),r(e.target.reason)};n.addEventListener("abort",i),e.then(t).catch(r).finally(()=>{n.removeEventListener("abort",i)})})}}})),a={api:(s={requestTransformer:IG(I4),responseTransformer:(n={allowedNumericKeyPaths:(CW||(CW={getAccountInfo:IX.map(e=>["value",...e]),getBlock:[["transactions",IK,"meta","preTokenBalances",IK,"accountIndex"],["transactions",IK,"meta","preTokenBalances",IK,"uiTokenAmount","decimals"],["transactions",IK,"meta","postTokenBalances",IK,"accountIndex"],["transactions",IK,"meta","postTokenBalances",IK,"uiTokenAmount","decimals"],["transactions",IK,"meta","rewards",IK,"commission"],...I0.map(e=>["transactions",IK,"meta","innerInstructions",IK,...e]),...I1.map(e=>["transactions",IK,"transaction","message",...e]),["rewards",IK,"commission"]],getClusterNodes:[[IK,"featureSet"],[IK,"shredVersion"]],getInflationGovernor:[["initial"],["foundation"],["foundationTerm"],["taper"],["terminal"]],getInflationRate:[["foundation"],["total"],["validator"]],getInflationReward:[[IK,"commission"]],getMultipleAccounts:IX.map(e=>["value",IK,...e]),getProgramAccounts:IX.flatMap(e=>[["value",IK,"account",...e],[IK,"account",...e]]),getRecentPerformanceSamples:[[IK,"samplePeriodSecs"]],getTokenAccountBalance:[["value","decimals"],["value","uiAmount"]],getTokenAccountsByDelegate:IQ.map(e=>["value",IK,"account",...e]),getTokenAccountsByOwner:IQ.map(e=>["value",IK,"account",...e]),getTokenLargestAccounts:[["value",IK,"decimals"],["value",IK,"uiAmount"]],getTokenSupply:[["value","decimals"],["value","uiAmount"]],getTransaction:[["meta","preTokenBalances",IK,"accountIndex"],["meta","preTokenBalances",IK,"uiTokenAmount","decimals"],["meta","postTokenBalances",IK,"accountIndex"],["meta","postTokenBalances",IK,"uiTokenAmount","decimals"],["meta","rewards",IK,"commission"],...I0.map(e=>["meta","innerInstructions",IK,...e]),...I1.map(e=>["transaction","message",...e])],getVersion:[["feature-set"]],getVoteAccounts:[["current",IK,"commission"],["delinquent",IK,"commission"]],simulateTransaction:[["value","loadedAccountsDataSize"],...IX.map(e=>["value","accounts",IK,...e]),...I0.map(e=>["value","innerInstructions",IK,...e])]}),CW)},(e,t)=>{let r=t.methodName,i=n?.allowedNumericKeyPaths&&r?n.allowedNumericKeyPaths[r]:void 0;return(0,Iz.pipe)(e,e=>(e=>{if("error"in e)throw(0,IL.getSolanaErrorFromJsonRpcError)(e.error);return e})(e,t),e=>e.result,e=>IY(i??[])(e,t))})},new Proxy({},{defineProperty:()=>!1,deleteProperty:()=>!1,get(...e){let[t,r]=e,i=r.toString();return function(...e){let t=Object.freeze({methodName:i,params:e}),r=s?.requestTransformer?s?.requestTransformer(t):t;return Object.freeze({execute:async({signal:e,transport:t})=>{let i=IF(r),n=await t({payload:i,signal:e});return s?.responseTransformer?s.responseTransformer(n,r):n}})}}})),transport:i},new Proxy(a.api,{defineProperty:()=>!1,deleteProperty:()=>!1,get(e,t,r){if("then"!==t)return function(...i){let n=t.toString(),s=Reflect.get(e,n,r);if(!s)throw new IL.SolanaError(IL.SOLANA_ERROR__RPC__API_PLAN_MISSING_FOR_RPC_METHOD,{method:n,params:i});return function({transport:e},t){return{send:async r=>await t.execute({signal:r?.abortSignal,transport:e})}}(a,s(...i))}}})}var kt=e.i(850631),kr=globalThis.AbortController,ki=globalThis.EventTarget;function kn(){return Symbol(void 0)}var ks=Symbol();function ka(e){return{on(t,r,i){function n(e){e instanceof CustomEvent?r(e.detail):r()}return e.addEventListener(t,n,i),()=>{e.removeEventListener(t,n)}}}}var ko=e.i(391791),kl=globalThis.AbortController,kc=new WeakMap;function kd(e,t,r){let i;if(void 0===r)return;let n=((i=kc.get(t))||kc.set(t,i={}),i);!n[r]&&e>0&&(n[r]=0);let s=e+n[r];return s<=0?delete n[r]:n[r]=s,s}var ku=new WeakMap;async function kh({channel:e,responseTransformer:t,signal:r,subscribeRequest:i,unsubscribeMethodName:n}){var s;let a,o,l,c,d,u,h;e.on("error",()=>{a=void 0,kc.delete(e)},{signal:r});let p=new Promise((t,i)=>{function s(){if(0===kd(-1,e,a)){let t=IF({methodName:n,params:[a]});a=void 0,e.send(t).catch(()=>{})}i(this.reason)}r.aborted?s.call(r):r.addEventListener("abort",s)}),f=IF(i);await e.send(f);let y=new Promise((t,i)=>{let n=new kl;r.addEventListener("abort",n.abort.bind(n));let s={signal:n.signal};e.on("error",e=>{n.abort(),i(e)},s),e.on("message",e=>{e&&"object"==typeof e&&"id"in e&&e.id===f.id&&(n.abort(),"error"in e?i((0,IL.getSolanaErrorFromJsonRpcError)(e.error)):t(e.result))},s)});if(null==(a=await (0,ko.safeRace)([p,y])))throw new IL.SolanaError(IL.SOLANA_ERROR__RPC_SUBSCRIPTIONS__EXPECTED_SERVER_SUBSCRIPTION_ID);kd(1,e,a);let g=((o=ku.get(e))||ku.set(e,o=new WeakMap),l=t??e,(c=o.get(l))||o.set(l,(s=e=>{if(!("method"in e))return;let r=t?t(e.params.result,i):e.params.result;return[`notification:${e.params.subscription}`,r]},c={...h=ka(u=new ki),on(t,r,i){d||(d={dispose:e.on("message",e=>{let t=s(e);if(!t)return;let[r,i]=t;u.dispatchEvent(new CustomEvent(r,{detail:i}))}),numSubscribers:0}),d.numSubscribers++;let n=h.on(t,r,i),a=!0;function o(){a&&(a=!1,i?.signal.removeEventListener("abort",o),d.numSubscribers--,0===d.numSubscribers&&(d.dispose(),d=void 0),n())}return i?.signal.addEventListener("abort",o),o}})),c),m=`notification:${a}`;return{on(t,r,i){switch(t){case"notification":return g.on(m,r,i);case"error":return e.on("error",r,i);default:throw new IL.SolanaError(IL.SOLANA_ERROR__INVARIANT_VIOLATION__DATA_PUBLISHER_CHANNEL_UNIMPLEMENTED,{channelName:t,supportedChannelNames:["notification","error"]})}}}}var kp=globalThis.EventTarget,kf=globalThis.WebSocket,ky={defaultCommitment:"confirmed",onIntegerOverflow(e,t,r){throw function e(t,r,i){let n="";if("number"==typeof r[0]){let e=r[0]+1,t=e%10,i=e%100;n=1==t&&11!=i?e+"st":2==t&&12!=i?e+"nd":3==t&&13!=i?e+"rd":e+"th"}else n=`\`${r[0].toString()}\``;let s=r.length>1?r.slice(1).map(e=>"number"==typeof e?`[${e}]`:e).join("."):void 0,a=new IL.SolanaError(IL.SOLANA_ERROR__RPC__INTEGER_OVERFLOW,{argumentLabel:n,keyPath:r,methodName:t,optionalPathLabel:s?` at path \`${s}\``:"",value:i,...void 0!==s?{path:s}:void 0});return(0,IL.safeCaptureStackTrace)(a,e),a}(e.methodName,t,r)}},kg=globalThis.AbortController,km={jsonrpc:"2.0",method:"ping"};function kw(e){return(0,Iz.pipe)(e,e=>Object.freeze({...e,on:(t,r,i)=>"message"!==t?e.on(t,r,i):e.on("message",e=>r(IB(e)),i)}),e=>Object.freeze({...e,send:t=>e.send(IH(t))}))}function kb(e,t){var r,i,n,s;let a,o;return r=function({createChannel:e}){var t;return(0,Iz.pipe)((t=e,async({execute:e,signal:r})=>{let i=await t({abortSignal:r});return await e({channel:i,signal:r})}),e=>{let t;return t=new Map,function(r){let{request:i,signal:n}=r,s=I6([i.methodName,i.params]),a=t.get(s);if(!a){let i=new kg,n=e({...r,signal:i.signal});n.then(e=>{e.on("error",()=>{t.delete(s),i.abort()},{signal:i.signal})}).catch(()=>{}),t.set(s,a={abortController:i,dataPublisherPromise:n,numSubscribers:0})}return a.numSubscribers++,n.addEventListener("abort",()=>{a.numSubscribers--,0===a.numSubscribers&&queueMicrotask(()=>{0===a.numSubscribers&&(t.delete(s),a.abortController.abort())})},{signal:a.abortController.signal}),a.dataPublisherPromise}})}({createChannel:function(e){if(!1===/^wss?:/i.test(e.url)){let t=e.url.match(/^([^:]+):/);throw new DOMException(t?`Failed to construct 'WebSocket': The URL's scheme must be either 'ws' or 'wss'. '${t[1]}:' is not allowed.`:`Failed to construct 'WebSocket': The URL '${e.url}' is invalid.`)}let{intervalMs:t,...r}=e;return function(e,{maxSubscriptionsPerChannel:t,minChannels:r}){let i={entries:[],freeChannelIndex:-1};function n(){let e;if(i.entries.length<r){i.freeChannelIndex=-1;return}for(let r=0;r<i.entries.length;r++){let n=(i.freeChannelIndex+r+2)%i.entries.length,s=i.entries[n];s.subscriptionCount<t&&(!e||e.subscriptionCount>=s.subscriptionCount)&&(e={poolIndex:n,subscriptionCount:s.subscriptionCount})}i.freeChannelIndex=e?.poolIndex??-1}return function({abortSignal:t}){let r;function s(){let e=i.entries.findIndex(e=>e===r);i.entries.splice(e,1),r.dispose(),n()}if(-1===i.freeChannelIndex){let t=new kg,n=e({abortSignal:t.signal});n.then(e=>{e.on("error",s,{signal:t.signal})}).catch(s),r={channel:n,dispose(){t.abort()},subscriptionCount:0},i.entries.push(r)}else r=i.entries[i.freeChannelIndex];return r.subscriptionCount++,t.addEventListener("abort",function(){r.subscriptionCount--,0===r.subscriptionCount?s():-1!==i.freeChannelIndex&&(i.freeChannelIndex--,n())}),n(),r.channel}}(({abortSignal:i})=>(function({sendBufferHighWatermark:e,signal:t,url:r}){let i,n,s;if(t.aborted)return Promise.reject(t.reason);let a=!1,o=new Set;function l(){o.forEach(e=>{e()}),o.clear()}function c(){l(),a||n(t.reason),y.readyState!==kf.CLOSED&&y.readyState!==kf.CLOSING&&y.close(1e3)}function d(e){if(!t.aborted&&!a){let t=new IL.SolanaError(IL.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_FAILED_TO_CONNECT,{errorEvent:e});n(t),h.dispatchEvent(new CustomEvent("error",{detail:t}))}}function u(e){t.aborted||h.dispatchEvent(new CustomEvent("message",{detail:e.data}))}let h=new kp,p=ka(h);function f(){a=!0,s({...p,async send(t){if(y.readyState!==kf.OPEN)throw new IL.SolanaError(IL.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CONNECTION_CLOSED);if(!i&&y.bufferedAmount>e){let t,r=new Promise((r,n)=>{let s=setInterval(()=>{y.readyState===kf.OPEN&&y.bufferedAmount>e||(clearInterval(s),i=void 0,r())},16);t=()=>{i=void 0,clearInterval(s),n(new IL.SolanaError(IL.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CLOSED_BEFORE_MESSAGE_BUFFERED))}});i={onCancel:t,promise:r}}i&&(!ArrayBuffer.isView(t)||t instanceof DataView||(t=new t.constructor(t)),await i.promise),y.send(t)}})}let y=new kf(r);return t.addEventListener("abort",c),y.addEventListener("close",function e(r){l(),i?.onCancel(),t.removeEventListener("abort",c),y.removeEventListener("close",e),y.removeEventListener("error",d),y.removeEventListener("message",u),y.removeEventListener("open",f),t.aborted||r.wasClean&&1e3===r.code||h.dispatchEvent(new CustomEvent("error",{detail:new IL.SolanaError(IL.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CONNECTION_CLOSED,{cause:r})}))}),y.addEventListener("error",d),y.addEventListener("message",u),y.addEventListener("open",f),new Promise((e,t)=>{n=t,s=e})})({...r,sendBufferHighWatermark:e.sendBufferHighWatermark??131072,signal:i}).then(e.jsonSerializer).then(e=>(function({abortSignal:e,channel:t,intervalMs:r}){let i;function n(){t.send(km).catch(e=>{(0,IL.isSolanaError)(e,IL.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CONNECTION_CLOSED)&&a.abort()})}function s(){clearInterval(i),i=setInterval(n,r)}let a=new kg;return a.signal.addEventListener("abort",()=>{clearInterval(i)}),e.addEventListener("abort",()=>{a.abort()}),t.on("error",()=>{a.abort()},{signal:a.signal}),t.on("message",s,{signal:a.signal}),globalThis.navigator.onLine&&s(),globalThis.addEventListener("offline",function(){clearInterval(i)},{signal:a.signal}),globalThis.addEventListener("online",function(){n(),s()},{signal:a.signal}),{...t,send:(...e)=>(a.signal.aborted||s(),t.send(...e))}})({abortSignal:i,channel:e,intervalMs:t??5e3})),{maxSubscriptionsPerChannel:e.maxSubscriptionsPerChannel??100,minChannels:e.minChannels??1})}({...t,url:e,jsonSerializer:kw})}),i={api:(a=IG(ky),n={allowedNumericKeyPaths:(Cq||(Cq={accountNotifications:IX.map(e=>["value",...e]),blockNotifications:[["value","block","transactions",IK,"meta","preTokenBalances",IK,"accountIndex"],["value","block","transactions",IK,"meta","preTokenBalances",IK,"uiTokenAmount","decimals"],["value","block","transactions",IK,"meta","postTokenBalances",IK,"accountIndex"],["value","block","transactions",IK,"meta","postTokenBalances",IK,"uiTokenAmount","decimals"],["value","block","transactions",IK,"meta","rewards",IK,"commission"],["value","block","transactions",IK,"meta","innerInstructions",IK,"index"],["value","block","transactions",IK,"meta","innerInstructions",IK,"instructions",IK,"programIdIndex"],["value","block","transactions",IK,"meta","innerInstructions",IK,"instructions",IK,"accounts",IK],["value","block","transactions",IK,"transaction","message","addressTableLookups",IK,"writableIndexes",IK],["value","block","transactions",IK,"transaction","message","addressTableLookups",IK,"readonlyIndexes",IK],["value","block","transactions",IK,"transaction","message","instructions",IK,"programIdIndex"],["value","block","transactions",IK,"transaction","message","instructions",IK,"accounts",IK],["value","block","transactions",IK,"transaction","message","header","numReadonlySignedAccounts"],["value","block","transactions",IK,"transaction","message","header","numReadonlyUnsignedAccounts"],["value","block","transactions",IK,"transaction","message","header","numRequiredSignatures"],["value","block","rewards",IK,"commission"]],programNotifications:IX.flatMap(e=>[["value",IK,"account",...e],[IK,"account",...e]])}),Cq)},o=(e,t)=>{let r=t.methodName,i=n?.allowedNumericKeyPaths&&r?n.allowedNumericKeyPaths[r]:void 0;return(0,Iz.pipe)(e,e=>IY(i??[])(e,t))},s={planExecutor:({request:e,...t})=>kh({...t,responseTransformer:o,subscribeRequest:{...e,methodName:e.methodName.replace(/Notifications$/,"Subscribe")},unsubscribeMethodName:e.methodName.replace(/Notifications$/,"Unsubscribe")}),requestTransformer:a},new Proxy({},{defineProperty:()=>!1,deleteProperty:()=>!1,get(...e){let[t,r]=e,i=r.toString();return function(...e){let t={methodName:i,params:e},r=s.requestTransformer?s.requestTransformer(t):t;return{execute:e=>s.planExecutor({...e,request:r}),request:r}}}})),transport:r},new Proxy(i.api,{defineProperty:()=>!1,deleteProperty:()=>!1,get(e,t,r){if("then"!==t)return function(...n){var s,a;let o=t.toString(),l=Reflect.get(e,o,r);if(!l)throw new IL.SolanaError(IL.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CANNOT_CREATE_SUBSCRIPTION_PLAN,{notificationName:o});let c=l(...n);return s=i.transport,a=c,{async subscribe({abortSignal:e}){let t=await s({signal:e,...a});return function({abortSignal:e,dataChannelName:t,dataPublisher:r,errorChannelName:i}){let n=new Map;function s(e){for(let[t,r]of n.entries())r.__hasPolled?(n.delete(t),r.onError(e)):r.publishQueue.push({__type:1,err:e})}let a=new kr;e.addEventListener("abort",()=>{a.abort(),s(CH||=kn())});let o={signal:a.signal},l=ks;return r.on(i,e=>{l===ks&&(l=e,a.abort(),s(e))},o),r.on(t,e=>{n.forEach((t,r)=>{if(t.__hasPolled){let{onData:i}=t;n.set(r,{__hasPolled:!1,publishQueue:[]}),i(e)}else t.publishQueue.push({__type:0,data:e})})},o),{async *[Symbol.asyncIterator](){if(e.aborted)return;if(l!==ks)throw l;let t=Symbol();n.set(t,{__hasPolled:!1,publishQueue:[]});try{for(;;){let e=n.get(t);if(!e)throw new IL.SolanaError(IL.SOLANA_ERROR__INVARIANT_VIOLATION__SUBSCRIPTION_ITERATOR_STATE_MISSING);if(e.__hasPolled)throw new IL.SolanaError(IL.SOLANA_ERROR__INVARIANT_VIOLATION__SUBSCRIPTION_ITERATOR_MUST_NOT_POLL_BEFORE_RESOLVING_EXISTING_MESSAGE_PROMISE);let r=e.publishQueue;try{if(r.length)for(let t of(e.publishQueue=[],r))if(0===t.__type)yield t.data;else throw t.err;else yield await new Promise((e,r)=>{n.set(t,{__hasPolled:!0,onData:e,onError:r})})}catch(e){if(e===(CH||=kn()))return;throw e}}}finally{n.delete(t)}}}}({abortSignal:e,dataChannelName:"notification",dataPublisher:t,errorChannelName:"error"})}}}}})}var kv=e.i(648328),k_=e.i(994999),kE=e.i(421720),kA=e.i(104076);e.i(631157),e.i(587896),e.i(912440),e.i(38340),e.i(27408),e.i(696319),e.i(634583),e.i(441960);var kS=((CS=kS||{})[CS.Uninitialized=0]="Uninitialized",CS[CS.Initialized=1]="Initialized",CS[CS.Frozen=2]="Frozen",CS),kI=((CI=kI||{})[CI.MintTokens=0]="MintTokens",CI[CI.FreezeAccount=1]="FreezeAccount",CI[CI.AccountOwner=2]="AccountOwner",CI[CI.CloseAccount=3]="CloseAccount",CI[CI.TransferFeeConfig=4]="TransferFeeConfig",CI[CI.WithheldWithdraw=5]="WithheldWithdraw",CI[CI.CloseMint=6]="CloseMint",CI[CI.InterestRate=7]="InterestRate",CI[CI.PermanentDelegate=8]="PermanentDelegate",CI[CI.ConfidentialTransferMint=9]="ConfidentialTransferMint",CI[CI.TransferHookProgramId=10]="TransferHookProgramId",CI[CI.ConfidentialTransferFeeConfig=11]="ConfidentialTransferFeeConfig",CI[CI.MetadataPointer=12]="MetadataPointer",CI[CI.GroupPointer=13]="GroupPointer",CI[CI.GroupMemberPointer=14]="GroupMemberPointer",CI[CI.ScaledUiAmount=15]="ScaledUiAmount",CI[CI.Pause=16]="Pause",CI),kk=((Ck=kk||{})[Ck.Uninitialized=0]="Uninitialized",Ck[Ck.TransferFeeConfig=1]="TransferFeeConfig",Ck[Ck.TransferFeeAmount=2]="TransferFeeAmount",Ck[Ck.MintCloseAuthority=3]="MintCloseAuthority",Ck[Ck.ConfidentialTransferMint=4]="ConfidentialTransferMint",Ck[Ck.ConfidentialTransferAccount=5]="ConfidentialTransferAccount",Ck[Ck.DefaultAccountState=6]="DefaultAccountState",Ck[Ck.ImmutableOwner=7]="ImmutableOwner",Ck[Ck.MemoTransfer=8]="MemoTransfer",Ck[Ck.NonTransferable=9]="NonTransferable",Ck[Ck.InterestBearingConfig=10]="InterestBearingConfig",Ck[Ck.CpiGuard=11]="CpiGuard",Ck[Ck.PermanentDelegate=12]="PermanentDelegate",Ck[Ck.NonTransferableAccount=13]="NonTransferableAccount",Ck[Ck.TransferHook=14]="TransferHook",Ck[Ck.TransferHookAccount=15]="TransferHookAccount",Ck[Ck.ConfidentialTransferFee=16]="ConfidentialTransferFee",Ck[Ck.ConfidentialTransferFeeAmount=17]="ConfidentialTransferFeeAmount",Ck[Ck.ScaledUiAmountConfig=18]="ScaledUiAmountConfig",Ck[Ck.PausableConfig=19]="PausableConfig",Ck[Ck.PausableAccount=20]="PausableAccount",Ck[Ck.MetadataPointer=21]="MetadataPointer",Ck[Ck.TokenMetadata=22]="TokenMetadata",Ck[Ck.GroupPointer=23]="GroupPointer",Ck[Ck.TokenGroup=24]="TokenGroup",Ck[Ck.GroupMemberPointer=25]="GroupMemberPointer",Ck[Ck.TokenGroupMember=26]="TokenGroupMember",Ck),kT=((CT=kT||{})[CT.CreateAssociatedToken=0]="CreateAssociatedToken",CT[CT.CreateAssociatedTokenIdempotent=1]="CreateAssociatedTokenIdempotent",CT[CT.RecoverNestedAssociatedToken=2]="RecoverNestedAssociatedToken",CT),kx=((Cx=kx||{})[Cx.Mint=0]="Mint",Cx[Cx.Token=1]="Token",Cx[Cx.Multisig=2]="Multisig",Cx),kC=((CC=kC||{})[CC.InitializeMint=0]="InitializeMint",CC[CC.InitializeAccount=1]="InitializeAccount",CC[CC.InitializeMultisig=2]="InitializeMultisig",CC[CC.Transfer=3]="Transfer",CC[CC.Approve=4]="Approve",CC[CC.Revoke=5]="Revoke",CC[CC.SetAuthority=6]="SetAuthority",CC[CC.MintTo=7]="MintTo",CC[CC.Burn=8]="Burn",CC[CC.CloseAccount=9]="CloseAccount",CC[CC.FreezeAccount=10]="FreezeAccount",CC[CC.ThawAccount=11]="ThawAccount",CC[CC.TransferChecked=12]="TransferChecked",CC[CC.ApproveChecked=13]="ApproveChecked",CC[CC.MintToChecked=14]="MintToChecked",CC[CC.BurnChecked=15]="BurnChecked",CC[CC.InitializeAccount2=16]="InitializeAccount2",CC[CC.SyncNative=17]="SyncNative",CC[CC.InitializeAccount3=18]="InitializeAccount3",CC[CC.InitializeMultisig2=19]="InitializeMultisig2",CC[CC.InitializeMint2=20]="InitializeMint2",CC[CC.GetAccountDataSize=21]="GetAccountDataSize",CC[CC.InitializeImmutableOwner=22]="InitializeImmutableOwner",CC[CC.AmountToUiAmount=23]="AmountToUiAmount",CC[CC.UiAmountToAmount=24]="UiAmountToAmount",CC[CC.InitializeMintCloseAuthority=25]="InitializeMintCloseAuthority",CC[CC.InitializeTransferFeeConfig=26]="InitializeTransferFeeConfig",CC[CC.TransferCheckedWithFee=27]="TransferCheckedWithFee",CC[CC.WithdrawWithheldTokensFromMint=28]="WithdrawWithheldTokensFromMint",CC[CC.WithdrawWithheldTokensFromAccounts=29]="WithdrawWithheldTokensFromAccounts",CC[CC.HarvestWithheldTokensToMint=30]="HarvestWithheldTokensToMint",CC[CC.SetTransferFee=31]="SetTransferFee",CC[CC.InitializeConfidentialTransferMint=32]="InitializeConfidentialTransferMint",CC[CC.UpdateConfidentialTransferMint=33]="UpdateConfidentialTransferMint",CC[CC.ConfigureConfidentialTransferAccount=34]="ConfigureConfidentialTransferAccount",CC[CC.ApproveConfidentialTransferAccount=35]="ApproveConfidentialTransferAccount",CC[CC.EmptyConfidentialTransferAccount=36]="EmptyConfidentialTransferAccount",CC[CC.ConfidentialDeposit=37]="ConfidentialDeposit",CC[CC.ConfidentialWithdraw=38]="ConfidentialWithdraw",CC[CC.ConfidentialTransfer=39]="ConfidentialTransfer",CC[CC.ApplyConfidentialPendingBalance=40]="ApplyConfidentialPendingBalance",CC[CC.EnableConfidentialCredits=41]="EnableConfidentialCredits",CC[CC.DisableConfidentialCredits=42]="DisableConfidentialCredits",CC[CC.EnableNonConfidentialCredits=43]="EnableNonConfidentialCredits",CC[CC.DisableNonConfidentialCredits=44]="DisableNonConfidentialCredits",CC[CC.ConfidentialTransferWithFee=45]="ConfidentialTransferWithFee",CC[CC.InitializeDefaultAccountState=46]="InitializeDefaultAccountState",CC[CC.UpdateDefaultAccountState=47]="UpdateDefaultAccountState",CC[CC.Reallocate=48]="Reallocate",CC[CC.EnableMemoTransfers=49]="EnableMemoTransfers",CC[CC.DisableMemoTransfers=50]="DisableMemoTransfers",CC[CC.CreateNativeMint=51]="CreateNativeMint",CC[CC.InitializeNonTransferableMint=52]="InitializeNonTransferableMint",CC[CC.InitializeInterestBearingMint=53]="InitializeInterestBearingMint",CC[CC.UpdateRateInterestBearingMint=54]="UpdateRateInterestBearingMint",CC[CC.EnableCpiGuard=55]="EnableCpiGuard",CC[CC.DisableCpiGuard=56]="DisableCpiGuard",CC[CC.InitializePermanentDelegate=57]="InitializePermanentDelegate",CC[CC.InitializeTransferHook=58]="InitializeTransferHook",CC[CC.UpdateTransferHook=59]="UpdateTransferHook",CC[CC.InitializeConfidentialTransferFee=60]="InitializeConfidentialTransferFee",CC[CC.WithdrawWithheldTokensFromMintForConfidentialTransferFee=61]="WithdrawWithheldTokensFromMintForConfidentialTransferFee",CC[CC.WithdrawWithheldTokensFromAccountsForConfidentialTransferFee=62]="WithdrawWithheldTokensFromAccountsForConfidentialTransferFee",CC[CC.HarvestWithheldTokensToMintForConfidentialTransferFee=63]="HarvestWithheldTokensToMintForConfidentialTransferFee",CC[CC.EnableHarvestToMint=64]="EnableHarvestToMint",CC[CC.DisableHarvestToMint=65]="DisableHarvestToMint",CC[CC.WithdrawExcessLamports=66]="WithdrawExcessLamports",CC[CC.InitializeMetadataPointer=67]="InitializeMetadataPointer",CC[CC.UpdateMetadataPointer=68]="UpdateMetadataPointer",CC[CC.InitializeGroupPointer=69]="InitializeGroupPointer",CC[CC.UpdateGroupPointer=70]="UpdateGroupPointer",CC[CC.InitializeGroupMemberPointer=71]="InitializeGroupMemberPointer",CC[CC.UpdateGroupMemberPointer=72]="UpdateGroupMemberPointer",CC[CC.InitializeScaledUiAmountMint=73]="InitializeScaledUiAmountMint",CC[CC.UpdateMultiplierScaledUiMint=74]="UpdateMultiplierScaledUiMint",CC[CC.InitializePausableConfig=75]="InitializePausableConfig",CC[CC.Pause=76]="Pause",CC[CC.Resume=77]="Resume",CC[CC.InitializeTokenMetadata=78]="InitializeTokenMetadata",CC[CC.UpdateTokenMetadataField=79]="UpdateTokenMetadataField",CC[CC.RemoveTokenMetadataKey=80]="RemoveTokenMetadataKey",CC[CC.UpdateTokenMetadataUpdateAuthority=81]="UpdateTokenMetadataUpdateAuthority",CC[CC.EmitTokenMetadata=82]="EmitTokenMetadata",CC[CC.InitializeTokenGroup=83]="InitializeTokenGroup",CC[CC.UpdateTokenGroupMaxSize=84]="UpdateTokenGroupMaxSize",CC[CC.UpdateTokenGroupUpdateAuthority=85]="UpdateTokenGroupUpdateAuthority",CC[CC.InitializeTokenGroupMember=86]="InitializeTokenGroupMember",CC);new Uint8Array([250,166,180,250,13,12,184,70]),new Uint8Array([121,113,108,39,54,51,0,4]),new Uint8Array([152,32,222,176,223,237,116,134]),new Uint8Array([210,225,30,162,88,184,77,141]),new Uint8Array([234,18,32,56,89,141,37,181]),new Uint8Array([108,37,171,143,248,30,18,110]),new Uint8Array([161,105,88,1,237,221,216,203]),new Uint8Array([221,233,49,45,181,202,220,200]),new Uint8Array([215,228,166,228,84,100,86,123]),Sm.union([Sm.string().transform(e=>e.replace(/[^0-9.-]+/g,"")),Sm.number()]).pipe(Sm.coerce.number().min(1e-4).max(0x3b9ac9ff));var kP=Sm.enum(["abstract","abstract-testnet","base-sepolia","base","avalanche-fuji","avalanche","iotex","solana-devnet","solana","sei","sei-testnet","polygon","polygon-amoy","peaq","story","educhain","skale-base-sepolia"]),kO=new Map([["abstract",2741],["abstract-testnet",11124],["base-sepolia",84532],["base",8453],["avalanche-fuji",43113],["avalanche",43114],["iotex",4689],["sei",1329],["sei-testnet",1328],["polygon",137],["polygon-amoy",80002],["peaq",3338],["story",1514],["educhain",41923],["skale-base-sepolia",0x135a9d92]]),kR=["solana-devnet","solana"];Object.fromEntries(["abstract","abstract-testnet","base-sepolia","base","avalanche-fuji","avalanche","iotex","sei","sei-testnet","polygon","polygon-amoy","peaq","story","educhain","skale-base-sepolia",...kR].map(e=>[kO.get(e),e]));var kN={id:0x135a9d92,name:"SKALE Base Sepolia",nativeCurrency:{name:"Credits",symbol:"CREDITS",decimals:18},rpcUrls:{default:{http:["https://base-sepolia-testnet.skalenodes.com/v1/jubilant-horrible-ancha"]}},blockExplorers:{default:{name:"Blockscout",url:"https://base-sepolia-testnet-explorer.skalenodes.com",apiUrl:"https://base-sepolia-testnet-explorer.skalenodes.com/api"}}};function kM(e){let t=kH(e);return(0,Sw.createPublicClient)({chain:t,transport:(0,Ef.http)()}).extend(Sb.publicActions)}function kU(){return kM("base-sepolia")}function kD(){return kM("avalanche-fuji")}function kj(e,t){let r=kH(e),i=(0,Ep.createWalletClient)({chain:r,transport:(0,Ef.http)(),account:function(e,t={}){let{nonceManager:r}=t,i=(0,nW.toHex)(It.secp256k1.getPublicKey(e.slice(2),!1));return{...function(e){if("string"==typeof e){if(!(0,nF.isAddress)(e,{strict:!1}))throw new SI.InvalidAddressError({address:e});return{address:e,type:"json-rpc"}}if(!(0,nF.isAddress)(e.address,{strict:!1}))throw new SI.InvalidAddressError({address:e.address});return{address:e.address,nonceManager:e.nonceManager,sign:e.sign,signAuthorization:e.signAuthorization,signMessage:e.signMessage,signTransaction:e.signTransaction,signTypedData:e.signTypedData,source:"custom",type:"local"}}({address:(0,Ir.publicKeyToAddress)(i),nonceManager:r,sign:async({hash:t})=>In({hash:t,privateKey:e,to:"hex"}),signAuthorization:async t=>Is({...t,privateKey:e}),signMessage:async({message:t})=>Io({message:t,privateKey:e}),signTransaction:async(t,{serializer:r}={})=>Ic({privateKey:e,transaction:t,serializer:r}),signTypedData:async t=>Iu({...t,privateKey:e})}),publicKey:i,source:"privateKey"}}(t)});return kz(r)?i.extend(Sb.publicActions).extend(e=>({sendTransaction:t=>ID(e,t),signTransaction:t=>IN(e,t),deployContract:t=>(function(e,t){let{abi:r,args:i,bytecode:n,deploymentType:s,salt:a,...o}=t,l=function(e){let{abi:t,args:r,bytecode:i,deploymentType:n,salt:s}=e;if(!r||0===r.length){let{functionName:e,argsContractDeployer:t}=Ib(n,s??Ip.zeroHash,(0,nW.toHex)(S8(i)),"0x");return(0,Ig.encodeFunctionData)({abi:Im,functionName:e,args:t})}let a=t.find(e=>"type"in e&&"constructor"===e.type);if(!a)throw new If.AbiConstructorNotFoundError({docsPath:Iw});if(!("inputs"in a)||!a.inputs||0===a.inputs.length)throw new If.AbiConstructorParamsNotFoundError({docsPath:Iw});let o=(0,Iy.encodeAbiParameters)(a.inputs,r),{functionName:l,argsContractDeployer:c}=Ib(n,s??Ip.zeroHash,(0,nW.toHex)(S8(i)),o);return(0,Ig.encodeFunctionData)({abi:Im,functionName:l,args:c})}({abi:r,args:i,bytecode:n,deploymentType:s,salt:a});return o.factoryDeps=o.factoryDeps||[],o.factoryDeps.includes(n)||o.factoryDeps.push(n),IM(e,{...o,data:l,to:"create2"===s||"create2Account"===s?"0x0000000000000000000000000000000000010000":"0x0000000000000000000000000000000000008006"})})(e,t),writeContract:t=>(0,Ih.writeContract)(Object.assign(e,{sendTransaction:t=>ID(e,t)}),t)})):i.extend(Sb.publicActions)}function kL(e){return kj("base-sepolia",e)}function kB(e){return kj("avalanche-fuji",e)}function kW(e){return"object"==typeof e&&null!==e&&"chain"in e&&"transport"in e}function kF(e){return"object"==typeof e&&null!==e&&"string"==typeof e.address&&"string"==typeof e.type&&"function"==typeof e.sign&&"function"==typeof e.signMessage&&"function"==typeof e.signTypedData&&"function"==typeof e.signTransaction}function kH(e){if(!e)throw Error("NETWORK environment variable is not set");switch(e){case"abstract":return S4;case"abstract-testnet":return S7;case"base":return SN;case"base-sepolia":return SO;case"avalanche":return SB;case"avalanche-fuji":return SR;case"sei":return SM;case"sei-testnet":return SU;case"polygon":return SD;case"polygon-amoy":return Sj;case"peaq":return SL;case"story":return S9;case"educhain":return Ie;case"iotex":return SF;case"iotex-testnet":return SW;case"skale-base-sepolia":return kN;default:throw Error(`Unsupported network: ${e}`)}}var kq=new Set([2741,11124]);function kz(e){return kq.has(e.id)}function k$(e){return ke(e?(0,kt.devnet)(e):(0,kt.devnet)("https://api.devnet.solana.com"))}function kK(e){return ke(e?(0,kt.mainnet)(e):(0,kt.mainnet)("https://api.mainnet-beta.solana.com"))}function kV(e,t){if("solana-devnet"===e)return k$(t);if("solana"===e)return kK(t);throw Error("Invalid network")}function kJ(e,t){if("solana-devnet"===e)return kb((0,kt.devnet)(t?kZ(t):"wss://api.devnet.solana.com"));if("solana"===e)return kb((0,kt.mainnet)(t?kZ(t):"wss://api.mainnet-beta.solana.com"));throw Error("Invalid network")}function kZ(e){return e.startsWith("http")?e.replace("http","ws"):e}function kG(e){if(!kR.find(t=>t===e))throw Error(`Unsupported SVM network: ${e}`);return kV(e)}async function kY(e){let t=sH.base58.decode(e);if(64===t.length)return await (0,Ij.createKeyPairSignerFromBytes)(t);if(32===t.length)return await (0,Ij.createKeyPairSignerFromPrivateKeyBytes)(t);throw Error(`Unexpected key length: ${t.length}. Expected 32 or 64 bytes.`)}function kQ(e){return"object"==typeof e&&null!==e&&(0,Ij.isTransactionSigner)(e)}Eb({},{authorizationPrimaryType:()=>k0,authorizationTypes:()=>kX,config:()=>Ev,createClientAvalancheFuji:()=>kD,createClientSepolia:()=>kU,createConnectedClient:()=>kM,createSigner:()=>kj,createSignerAvalancheFuji:()=>kB,createSignerSepolia:()=>kL,getChainFromNetwork:()=>kH,isAccount:()=>kF,isSignerWallet:()=>kW,isZkStackChain:()=>kz,usdcABI:()=>E_});var kX={TransferWithAuthorization:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"},{name:"validAfter",type:"uint256"},{name:"validBefore",type:"uint256"},{name:"nonce",type:"bytes32"}]},k0="TransferWithAuthorization";Eb({},{SvmAddressRegex:()=>k1});var k1=/^[1-9A-HJ-NP-Za-km-z]{32,44}$/,k2=/^0x[0-9a-fA-F]{40}$/,k3=/^0x[a-fA-F0-9]{40}|[A-Za-z0-9][A-Za-z0-9-]{0,34}[A-Za-z0-9]$/,k5=["exact"],k8=[1],k6=["insufficient_funds","invalid_exact_evm_payload_authorization_valid_after","invalid_exact_evm_payload_authorization_valid_before","invalid_exact_evm_payload_authorization_value","invalid_exact_evm_payload_signature","invalid_exact_evm_payload_undeployed_smart_wallet","invalid_exact_evm_payload_recipient_mismatch","invalid_exact_svm_payload_transaction","invalid_exact_svm_payload_transaction_amount_mismatch","invalid_exact_svm_payload_transaction_create_ata_instruction","invalid_exact_svm_payload_transaction_create_ata_instruction_incorrect_payee","invalid_exact_svm_payload_transaction_create_ata_instruction_incorrect_asset","invalid_exact_svm_payload_transaction_instructions","invalid_exact_svm_payload_transaction_instructions_length","invalid_exact_svm_payload_transaction_instructions_compute_limit_instruction","invalid_exact_svm_payload_transaction_instructions_compute_price_instruction","invalid_exact_svm_payload_transaction_instructions_compute_price_instruction_too_high","invalid_exact_svm_payload_transaction_instruction_not_spl_token_transfer_checked","invalid_exact_svm_payload_transaction_instruction_not_token_2022_transfer_checked","invalid_exact_svm_payload_transaction_fee_payer_included_in_instruction_accounts","invalid_exact_svm_payload_transaction_fee_payer_transferring_funds","invalid_exact_svm_payload_transaction_not_a_transfer_instruction","invalid_exact_svm_payload_transaction_receiver_ata_not_found","invalid_exact_svm_payload_transaction_sender_ata_not_found","invalid_exact_svm_payload_transaction_simulation_failed","invalid_exact_svm_payload_transaction_transfer_to_incorrect_ata","invalid_network","invalid_payload","invalid_payment_requirements","invalid_scheme","invalid_payment","payment_expired","unsupported_scheme","invalid_x402_version","invalid_transaction_state","invalid_x402_version","settle_exact_svm_block_height_exceeded","settle_exact_svm_transaction_confirmation_timed_out","unsupported_scheme","unexpected_settle_error","unexpected_verify_error"],k4=e=>Number.isInteger(Number(e))&&Number(e)>=0,k7=Sm.string().regex(k2).or(Sm.string().regex(k1)),k9=Sm.string().regex(k3).or(Sm.string().regex(k1)),Te=Sm.object({scheme:Sm.enum(k5),network:kP,maxAmountRequired:Sm.string().refine(k4),resource:Sm.string().url(),description:Sm.string(),mimeType:Sm.string(),outputSchema:Sm.record(Sm.any()).optional(),payTo:k7,maxTimeoutSeconds:Sm.number().int(),asset:k9,extra:Sm.record(Sm.any()).optional()}),Tt=Sm.object({from:Sm.string().regex(k2),to:Sm.string().regex(k2),value:Sm.string().refine(k4).refine(e=>e.length<=18),validAfter:Sm.string().refine(k4),validBefore:Sm.string().refine(k4),nonce:Sm.string().regex(/^0x[0-9a-fA-F]{64}$/)}),Tr=Sm.object({signature:Sm.string().regex(/^0x[0-9a-fA-F]+$/),authorization:Tt}),Ti=Sm.object({transaction:Sm.string().regex(/^[A-Za-z0-9+/]*={0,2}$/)}),Tn=Sm.object({x402Version:Sm.number().refine(e=>k8.includes(e)),scheme:Sm.enum(k5),network:kP,payload:Sm.union([Tr,Ti])});Sm.object({x402Version:Sm.number().refine(e=>k8.includes(e)),error:Sm.enum(k6).optional(),accepts:Sm.array(Te).optional(),payer:Sm.string().regex(k3).optional()});var Ts=Sm.enum(["GET","POST","PUT","DELETE","PATCH","OPTIONS","HEAD"]),Ta=Sm.object({type:Sm.literal("http"),method:Ts,queryParams:Sm.record(Sm.string(),Sm.string()).optional(),bodyType:Sm.enum(["json","form-data","multipart-form-data","text","binary"]).optional(),bodyFields:Sm.record(Sm.string(),Sm.any()).optional(),headerFields:Sm.record(Sm.string(),Sm.any()).optional()});Sm.discriminatedUnion("type",[Ta]);var To=Sm.object({resource:Sm.string(),type:Sm.enum(["http"]),x402Version:Sm.number().refine(e=>k8.includes(e)),accepts:Sm.array(Te),lastUpdated:Sm.date(),metadata:Sm.record(Sm.any()).optional()});Sm.object({paymentPayload:Tn,paymentRequirements:Te}),Sm.object({paymentPayload:Tn,paymentRequirements:Te}),Sm.object({isValid:Sm.boolean(),invalidReason:Sm.enum(k6).optional(),payer:k7.optional()}),Sm.object({success:Sm.boolean(),errorReason:Sm.enum(k6).optional(),payer:k7.optional(),transaction:Sm.string().regex(k3),network:kP}),Sm.object({type:Sm.string().optional(),limit:Sm.number().optional(),offset:Sm.number().optional()}),Sm.object({x402Version:Sm.number().refine(e=>k8.includes(e)),items:Sm.array(To),pagination:Sm.object({limit:Sm.number(),offset:Sm.number(),total:Sm.number()})});var Tl=Sm.object({x402Version:Sm.number().refine(e=>k8.includes(e)),scheme:Sm.enum(k5),network:kP,extra:Sm.record(Sm.any()).optional()});function Tc(e){try{let t=(0,k_.getBase64Encoder)().encode(e.transaction);return(0,kv.getTransactionDecoder)().decode(t)}catch(e){throw console.error("error",e),Error("invalid_exact_svm_payload_transaction")}}function Td(e){let t=(0,kE.getCompiledTransactionMessageDecoder)().decode(e.messageBytes),r=t.staticAccounts??[];for(let e of t.instructions??[]){let t=r[e.programAddressIndex].toString();if(t===kA.TOKEN_PROGRAM_ADDRESS.toString()||t==="TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb".toString()){let t=e.accountIndices??[];if(t.length>=4){let e=r[t[3]].toString();if(e)return e}}}return""}async function Tu(e,t,r){let i=await Th(e,t),n=(0,kv.getBase64EncodedWireTransaction)(i);return await r.simulateTransaction(n,{sigVerify:!0,replaceRecentBlockhash:!1,commitment:"confirmed",encoding:"base64",accounts:void 0,innerInstructions:void 0,minContextSlot:void 0}).send()}async function Th(e,t){if((0,Ij.isTransactionModifyingSigner)(e)){let[r]=await e.modifyAndSignTransactions([t]);if(!r)throw Error("transaction_signer_failed_to_return_transaction");return r}if((0,Ij.isTransactionPartialSigner)(e)){var r,i;let[n]=await e.signTransactions([t]);if(!n)throw Error("transaction_signer_failed_to_return_signatures");return r=t,i=n,Object.freeze({...r,signatures:Object.freeze({...r.signatures,...i})})}throw Error("transaction_signer_must_support_offline_signing")}Sm.object({kinds:Sm.array(Tl)}),Eb({},{createDevnetRpcClient:()=>k$,createMainnetRpcClient:()=>kK,createSignerFromBase58:()=>kY,createSvmConnectedClient:()=>kG,decodeTransactionFromPayload:()=>Tc,getRpcClient:()=>kV,getRpcSubscriptions:()=>kJ,getTokenPayerFromTransaction:()=>Td,isSignerWallet:()=>kQ,signAndSimulateTransaction:()=>Tu,signTransactionWithSigner:()=>Th}),Sm.object({paymentHeader:Sm.string(),paymentRequirements:Te});var Tp=((CP=Tp||{})[CP.RequestUnits=0]="RequestUnits",CP[CP.RequestHeapFrame=1]="RequestHeapFrame",CP[CP.SetComputeUnitLimit=2]="SetComputeUnitLimit",CP[CP.SetComputeUnitPrice=3]="SetComputeUnitPrice",CP[CP.SetLoadedAccountsDataSizeLimit=4]="SetLoadedAccountsDataSizeLimit",CP);e.s([],610760),e.i(382743),e.i(110043);class Tf{static parse(e){try{return new Tf(e)}catch(e){return null}}static throwIfNotWellFormedJwt(e){return tK.decodeJwt(e),e}get subject(){return this._decoded.sub}get expiration(){return this._decoded.exp}get issuer(){return this._decoded.iss}get audience(){return this._decoded.aud}isExpired(e=0){return Date.now()>=1e3*(this.expiration-e)}constructor(e){this.value=e,this._decoded=tK.decodeJwt(e)}}class Ty extends Tf{static parse(e){try{return new Ty(e)}catch(e){return null}}get appId(){return this._decoded.aid?this._decoded.aid:this.audience}}let Tg=({style:e,...t})=>(0,W.jsxs)("svg",{viewBox:"0 0 1024 1024",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{height:"28px",width:"28px",...e},...t,children:[(0,W.jsx)("rect",{width:"1024",height:"1024",fill:"#0052FF",rx:100,ry:100}),(0,W.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M152 512C152 710.823 313.177 872 512 872C710.823 872 872 710.823 872 512C872 313.177 710.823 152 512 152C313.177 152 152 313.177 152 512ZM420 396C406.745 396 396 406.745 396 420V604C396 617.255 406.745 628 420 628H604C617.255 628 628 617.255 628 604V420C628 406.745 617.255 396 604 396H420Z",fill:"white"})]}),Tm="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PScwIDAgMTAyNCAxMDI0JyBmaWxsPSdub25lJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHN0eWxlPSdoZWlnaHQ6MjhweDt3aWR0aDoyOHB4Jz48cmVjdCB3aWR0aD0nMTAyNCcgaGVpZ2h0PScxMDI0JyBmaWxsPScjMDA1MkZGJyByeD0nMTAwJyByeT0nMTAwJz48L3JlY3Q+PHBhdGggZmlsbC1ydWxlPSdldmVub2RkJyBjbGlwLXJ1bGU9J2V2ZW5vZGQnIGQ9J00xNTIgNTEyQzE1MiA3MTAuODIzIDMxMy4xNzcgODcyIDUxMiA4NzJDNzEwLjgyMyA4NzIgODcyIDcxMC44MjMgODcyIDUxMkM4NzIgMzEzLjE3NyA3MTAuODIzIDE1MiA1MTIgMTUyQzMxMy4xNzcgMTUyIDE1MiAzMTMuMTc3IDE1MiA1MTJaTTQyMCAzOTZDNDA2Ljc0NSAzOTYgMzk2IDQwNi43NDUgMzk2IDQyMFY2MDRDMzk2IDYxNy4yNTUgNDA2Ljc0NSA2MjggNDIwIDYyOEg2MDRDNjE3LjI1NSA2MjggNjI4IDYxNy4yNTUgNjI4IDYwNFY0MjBDNjI4IDQwNi43NDUgNjE3LjI1NSAzOTYgNjA0IDM5Nkg0MjBaJyBmaWxsPSd3aGl0ZSc+PC9wYXRoPjwvc3ZnPg==",Tw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAALZJREFUaEPtmjEOhDAMBNc/O14GvOzys3CAKK6eAlmaVGl2Zc+kTOU685vkc9/bnD2prZK5/TZY24z9P+g4F5hNh7/GdoG37WlAA5CATwgCxHENYISwQAMQII5rACOEBRqAAHFcAxghLNAABIjjGsAIYYEGIEAc1wBGCAs0AAHiuAYwQligAQgQxzWAEcICDUCAOK4BjBAWaAACxHENYISwQAMQII6fBjr+VHkW3+u+tfyxMpJaDgYzYxb/ALZVAAAAAElFTkSuQmCC";class Tb extends t1.E{async initialize(){await this.importPromise,await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(e){return e.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}disconnect(){this.proxyProvider.walletProvider.disconnect(),this.onDisconnect()}get walletBranding(){return{name:this.displayName,icon:Tw,id:"com.coinbase.wallet"}}async promptConnection(){try{await this.importPromise;let e=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!e||0===e.length||!e[0])throw new t3.P("Unable to retrieve accounts");this.connected=!0,await this.syncAccounts([e[0]])}catch(e){throw(0,t5.f)(e)}}constructor(t,r,i,s,a){super("base_account",t,r,i),this.connectorType="base_account",this.walletClientType="base_account",this.displayName="Base",this.setBaseAccountSdk=a,this.proxyProvider=new t1.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.baseAccountConfig={...s,appChainIds:[r.id].concat(t.map(e=>e.id))},n?(this.proxyProvider.setWalletProvider(n.getProvider()),this.setBaseAccountSdk(n)):this.importPromise=e.A(224814).then(({createBaseAccountSDK:e})=>{n=e(this.baseAccountConfig),this.proxyProvider.setWalletProvider(n.getProvider()),this.setBaseAccountSdk(n)}).catch(console.error)}}let Tv=[1,0xaa36a7,137,10,8453,84532,42161,7777777,43114,56];class T_ extends t1.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(e){return e.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}disconnect(){this.proxyProvider.walletProvider.disconnect(),this.onDisconnect()}get walletBranding(){return{name:this.displayName,icon:Tm,id:"com.coinbase.wallet"}}async promptConnection(){try{let e=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!e||0===e.length||!e[0])throw new t3.P("Unable to retrieve accounts");this.connected=!0,await this.syncAccounts([e[0]])}catch(e){throw(0,t5.f)(e)}}updateConnectionPreference(e){this.coinbaseWalletConfig={...this.coinbaseWalletConfig,preference:{...this.coinbaseWalletConfig.preference,options:e}},this.walletClientType="smartWalletOnly"===e?"coinbase_smart_wallet":"coinbase_wallet",s=nD({...this.coinbaseWalletConfig}),this.proxyProvider.setWalletProvider(s.getProvider())}constructor(e,t,r,i){if(super("coinbase_wallet",e,t,r),this.connectorType="coinbase_wallet",this.displayName="Coinbase Wallet",this.proxyProvider=new t1.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.coinbaseWalletConfig={...i,appChainIds:[t.id].concat(e.map(e=>e.id))},this.walletClientType="smartWalletOnly"===this.coinbaseWalletConfig.preference?.options?"coinbase_smart_wallet":"coinbase_wallet","coinbase_smart_wallet"===this.walletClientType&&(this.displayName="Coinbase Smart Wallet"),!s){let e="eoaOnly"!==this.coinbaseWalletConfig.preference?.options?(this.coinbaseWalletConfig.appChainIds??[]).filter(e=>!Tv.includes(e)):[];e.length>0&&!e.every(e=>q.DEFAULT_SUPPORTED_CHAIN_IDS.has(e))&&console.info(`The configured chains are not supported by Coinbase Smart Wallet: ${e.join(", ")}`),s=nD(this.coinbaseWalletConfig)}this.proxyProvider.setWalletProvider(s.getProvider())}}let TE=({...e})=>(0,W.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,W.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.37126 11.0323C2.37126 12.696 3.90598 13.4421 5.40654 13.4468C8.91753 13.4468 12.8021 11.2897 12.7819 7.67984C12.7673 5.07728 10.3748 2.86167 7.54357 2.88296C4.8495 2.88296 2.21821 4.6411 2.21803 7.03628C2.21803 7.67951 2.58722 8.30178 3.55231 8.37184C2.74763 9.16826 2.37126 10.1225 2.37126 11.0323ZM7.55283 8.68012C8.11562 8.68012 8.57186 8.13217 8.57186 7.45624C8.57186 6.78032 8.11562 6.23237 7.55283 6.23237C6.99003 6.23237 6.53379 6.78032 6.53379 7.45624C6.53379 8.13217 6.99003 8.68012 7.55283 8.68012ZM10.4747 8.68012C11.0375 8.68012 11.4937 8.13217 11.4937 7.45625C11.4937 6.78032 11.0375 6.23237 10.4747 6.23237C9.91186 6.23237 9.45562 6.78032 9.45562 7.45625C9.45562 8.13217 9.91186 8.68012 10.4747 8.68012Z",fill:e.color||"var(--privy-color-foreground-3)"})});class TA extends t1.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(e){return await this.isConnected()?(await this.proxyProvider.request({method:"wallet_switchEthereumChain",params:[(0,t1.t)(e?.chainId||"0x1")]}),this.getConnectedWallet()):null}get walletBranding(){return{name:"Privy Wallet",icon:TE,id:"io.privy.wallet"}}disconnect(){this.connected=!1}async promptConnection(){}constructor({provider:e,chains:t,defaultChain:r,rpcConfig:i,imported:n,walletIndex:s}){super("privy",t,r,i),this.connectorType="embedded",this.proxyProvider=e,this.walletIndex=s,n&&(this.connectorType="embedded_imported"),this.subscribeListeners()}}async function TS(){let e=CQ();return e?e.getAccessToken():Promise.resolve(t5.u.get(nL.P)||t5.u.get(nL.C)||null)}let TI=["eth_sign","eth_populateTransactionRequest","eth_signTransaction","personal_sign","eth_signTypedData_v4","csw_signUserOperation","secp256k1_sign"];function Tk(e){return e?{"privy-ui":"t"}:void 0}class TT{async authenticate(){if(!this.api)throw new t3.a("Auth flow has no API instance");if(!this.meta.email||!this.meta.emailCode)throw new t3.a("Email and email code must be set prior to calling authenticate.");try{return await this.api.post(sr,{email:this.meta.email,code:this.meta.emailCode,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(e){throw(0,t3.f)(e)}}async link(){if(!this.api)throw new t3.a("Auth flow has no API instance");if(!this.meta.email||!this.meta.emailCode)throw new t3.a("Email and email code must be set prior to calling authenticate.");try{return await this.api.post(si,{email:this.meta.email,code:this.meta.emailCode})}catch(e){throw(0,t3.f)(e)}}async sendCodeEmail({email:e,captchaToken:t,withPrivyUi:r}){if(!this.api)throw new t3.a("Auth flow has no API instance");if(e&&(this.meta.email=e),t&&(this.meta.captchaToken=t),!this.meta.email)throw new t3.a("Email must be set when initialzing authentication.");let i=Tk(r);try{return await this.api.post(st,{email:this.meta.email,token:this.meta.captchaToken},{headers:{...i}})}catch(e){throw(0,t3.f)(e)}}constructor({email:e,captchaToken:t,disableSignup:r}){this.meta={email:e,captchaToken:t,disableSignup:r??!1}}}class Tx extends TT{async link(){if(!this.api)throw new t3.a("Auth flow has no API instance");if(!this.meta.email||!this.meta.emailCode||!this.meta.oldAddress)throw new t3.a("Email, email code, and an old email address must be set prior to calling update.");try{return await this.api.post(ss,{oldAddress:this.meta.oldAddress,newAddress:this.meta.email,code:this.meta.emailCode})}catch(e){throw(0,t3.f)(e)}}constructor(e,t,r){super({email:t,captchaToken:r}),this.meta={email:t,captchaToken:r,oldAddress:e,disableSignup:!1}}}class TC{execute(e){return null===this.promise&&(this.promise=(async()=>{try{return await this.fn(e)}finally{this.promise=null}})()),this.promise}constructor(e){this.promise=null,this.fn=e}}class TP{get meta(){return this._meta}async authenticate(){if(!this.api)throw new t3.a("Auth flow has no API instance");if(!this.meta.channelToken)throw new t3.a("Auth flow must be initialized first");try{let e=await this.api.post(n6,{channel_token:this.meta.channelToken,message:this.message,signature:this.signature,fid:this.fid,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"});if(!e)throw new t3.a("No response from authentication");return e}catch(e){throw(0,t3.f)(e)}}async link(){if(!this.api)throw new t3.a("Auth flow has no API instance");try{return await this.api.post(n4,{channel_token:this.meta.channelToken,message:this.message,signature:this.signature,fid:this.fid})}catch(e){throw(0,t3.f)(e)}}async _startChannelOnce(){if(!this.api)throw new t3.a("Auth flow has no API instance");let e=await this.api.post(n8,{token:this.captchaToken});nB.isMobile&&!nB.isIOS&&e.connect_uri&&(0,sF.o)(e.connect_uri,"_blank"),this._meta={...this._meta,connectUri:e.connect_uri,channelToken:e.channel_token}}async initializeFarcasterConnect(){if(!this.api)throw new t3.a("Auth flow has no API instance");await this.startChannelOnce.execute()}async _pollForReady(){if(!this.api)throw new t3.a("Auth flow has no API instance");if(!this.meta.channelToken)throw new t3.a("Auth flow must be initialized first");let e=await this.api.get(n7,{headers:{"farcaster-channel-token":this.meta.channelToken}});return"completed"===e.state&&(this.message=e.message,this.signature=e.signature,this.fid=e.fid,!0)}constructor(e,t=!1){this._meta={disableSignup:!1},this.captchaToken=e,this.startChannelOnce=new TC(this._startChannelOnce.bind(this)),this.pollForReady=new TC(this._pollForReady.bind(this)),this._meta.disableSignup=t}}function TO(){return"chrome-extension:"===window.location.protocol&&"chrome"in window}function TR(){if(!TO())return;let e=window.chrome;return e?.runtime?.id}function TN(){if(!TO())return!1;let e=window.chrome;return"function"==typeof e?.identity?.launchWebAuthFlow}async function TM(e){return new Promise((t,r)=>{TN()?window.chrome.identity.launchWebAuthFlow({url:e,interactive:!0},async e=>{try{let r=function(){if(!TO())return;let e=window.chrome;return e?.runtime?.lastError?.message}();if(r||!e){let e=`WebAuthFlow failed: ${r||"Response URI missing"}`;throw Error(e)}let i=new URL(e),n=TR();if(!n)throw Error("Invalid extension context");if("chrome-extension:"===i.protocol){if(i.hostname!==n)throw Error("Invalid responseUri origin")}else{if("https:"!==i.protocol)throw Error("Invalid responseUri protocol");{let e=i.hostname.split(".");if(3!==e.length||"chromiumapp"!==e[1]||"org"!==e[2]||e[0]!==n)throw Error("Invalid responseUri origin")}}let s=i.searchParams.get("privy_oauth_state"),a=i.searchParams.get("privy_oauth_code");if(!s||!a)throw Error("Invalid responseUri - missing required parameters");t({privyOAuthState:s,privyOAuthCode:a})}catch(e){r(e)}}):r(Error("Chrome identity API not available"))})}function TU(e){return crypto.getRandomValues(new Uint8Array(e))}function TD(){return tQ.base64url.encode(TU(36))}function Tj(){return TD()}async function TL(e,t="S256"){if("S256"!=t)return e;{let t=await async function(e){let t=(new TextEncoder).encode(e);return new Uint8Array(await crypto.subtle.digest("SHA-256",t))}(e);return tQ.base64url.encode(t)}}class TB{addCaptchaToken(e){this.meta.captchaToken=e}isActive(){return!!(this.meta.authorizationCode&&this.meta.stateCode&&this.meta.provider)}async authenticate(){if(!this.api)throw new t3.a("Auth flow has no API instance");if(!this.meta.authorizationCode||!this.meta.stateCode)throw new t3.a("[OAuth AuthFlow] Authorization and state codes code must be set prior to calling authenticate.");if("undefined"===this.meta.authorizationCode)throw new t3.a("User denied confirmation during OAuth flow");let e=function(){let e=t5.u.get(nL.a);if(!e)throw new t3.a("Authentication error.");return e}();try{let t=await this.api.post(sf,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:e,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"});return t5.u.del(nL.a),t5.u.del(nL.H),t5.u.del(nL.O),t}catch(t){let e=(0,t3.f)(t);if(e.privyErrorCode)throw new t3.a(e.message||"Invalid code during OAuth flow.",void 0,e.privyErrorCode);if("User denied confirmation during OAuth flow"===e.message)throw new t3.a("Invalid code during oauth flow.",void 0,t3.b.OAUTH_USER_DENIED);throw new t3.a("Invalid code during OAuth flow.",void 0,t3.b.UNKNOWN_AUTH_ERROR)}}async link(){if(!this.api)throw new t3.a("Auth flow has no API instance");if(!this.meta.authorizationCode||!this.meta.stateCode)throw new t3.a("[OAuth AuthFlow] Authorization and state codes code must be set prior to calling link.");if("undefined"===this.meta.authorizationCode)throw new t3.a("User denied confirmation during OAuth flow");let e=t5.u.get(nL.a);if(!e)throw new t3.a("Authentication error.");try{let t=await this.api.post(sy,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:e});return t5.u.del(nL.a),t}catch(e){throw(0,t3.f)(e)}}async getAuthorizationUrl(){if(!this.api)throw new t3.a("Auth flow has no API instance");if(!this.meta.provider)throw new t3.a("Provider must be set when initializing OAuth authentication.");let e=TD();t5.u.put(nL.a,e);let t=Tj();t5.u.put(nL.S,t);let r=await TL(e);this.meta.withPrivyUi||t5.u.put(nL.H,!0),this.meta.disableSignup?t5.u.put(nL.O,!0):t5.u.del(nL.O);let i=Tk(this.meta.withPrivyUi),n=window.location.href,s=function(){let e=TR();if(e)return`https://${e}.chromiumapp.org`}();s&&(n=s);try{return await this.api.post(sp,{provider:this.meta.provider,redirect_to:this.meta.customOAuthRedirectUrl||n,token:this.meta.captchaToken,code_challenge:r,state_code:t},{headers:{...i}})}catch(e){throw(0,t3.f)(e)}}constructor(e){this.meta=e}}function TW(){let e=new URL(window.location.href);e.searchParams.delete("privy_oauth_code"),e.searchParams.delete("privy_oauth_provider"),e.searchParams.delete("privy_oauth_state"),t5.u.del(nL.S),window.history.replaceState({},"",e)}class TF{async initRegisterFlow(e){if(!this.api)throw new t3.a("Auth flow has no API instance");this.authenticateForRegistration=!0,this.meta.initRegisterResponse=await this.initRegisterOnce.execute(e)}async initAuthenticationFlow(e){if(!this.api)throw new t3.a("Auth flow has no API instance");this.authenticateForRegistration=!1,this.meta.initAuthenticateResponse=await this.initAuthenticateOnce.execute(e)}async initLinkFlow(){if(!this.api)throw new t3.a("Auth flow has no API instance");this.meta.initLinkResponse=await this.initLinkOnce.execute()}async register(){let t=await e.A(20190);if(!this.api)throw new t3.a("Auth flow has no API instance");if(!t.browserSupportsWebAuthn())throw new t3.a("WebAuthn is not supported in this browser");this.meta.initRegisterResponse||(this.meta.initRegisterResponse=await this.initRegisterOnce.execute());try{let e=this.meta.initRegisterResponse.options,r=await t.startRegistration({optionsJSON:this._transformInitLinkOptionsToCamelCase(e)});return this.meta.setPasskeyAuthState?.({status:"submitting-response"}),await this.api.post(sA,{relying_party:this.meta.initRegisterResponse.relying_party,authenticator_response:this._transformRegistrationResponseToSnakeCase(r)})}catch(e){if("NotAllowedError"===e.name)throw new t3.a("Passkey request timed out or rejected by user.",void 0,t3.b.PASSKEY_NOT_ALLOWED);throw(0,t3.f)(e)}}async authenticate(){if(this.authenticateForRegistration)return this.register();let t=await e.A(20190);if(!this.api)throw new t3.a("Auth flow has no API instance");if(!t.browserSupportsWebAuthn())throw new t3.a("WebAuthn is not supported in this browser");this.meta.initAuthenticateResponse||(this.meta.initAuthenticateResponse=await this.initAuthenticateOnce.execute());let r=this.meta.allowedCredentialsIds?.map(e=>({type:"public-key",id:e}))??this.meta.initAuthenticateResponse.options.allow_credentials;try{let e=await t.startAuthentication({optionsJSON:this._transformInitAuthenticateOptionsToCamelCase({...this.meta.initAuthenticateResponse.options,allow_credentials:r})});return this.meta.setPasskeyAuthState?.({status:"submitting-response"}),await this.api.post(sE,{relying_party:this.meta.initAuthenticateResponse.relying_party,challenge:this.meta.initAuthenticateResponse.options.challenge,authenticator_response:this._transformAuthenticationResponseToSnakeCase(e)})}catch(e){if("NotAllowedError"===e.name)throw new t3.a("Passkey request timed out or rejected by user.",void 0,t3.b.PASSKEY_NOT_ALLOWED);throw(0,t3.f)(e)}}async link(){let t=await e.A(20190);if(!this.api)throw new t3.a("Auth flow has no API instance");if(!t.browserSupportsWebAuthn())throw new t3.a("WebAuthn is not supported in this browser");this.meta.initLinkResponse||(this.meta.initLinkResponse=await this.initLinkOnce.execute());try{let e=this.meta.initLinkResponse.options,r=await t.startRegistration({optionsJSON:this._transformInitLinkOptionsToCamelCase(e)});return this.meta.setPasskeyAuthState?.({status:"submitting-response"}),await this.api.post(s_,{relying_party:this.meta.initLinkResponse.relying_party,authenticator_response:this._transformRegistrationResponseToSnakeCase(r)})}catch(e){if("NotAllowedError"===e.name)throw new t3.a("Passkey request timed out or rejected by user.",void 0,t3.b.PASSKEY_NOT_ALLOWED);throw(0,t3.f)(e)}}async _initRegisterOnce(e){if(!this.api)throw new t3.a("Auth flow has no API instance");let t=Tk(e);return await this.api.post(sv,{token:this.meta.captchaToken},{headers:{...t}})}async _initAuthenticateOnce(e){if(!this.api)throw new t3.a("Auth flow has no API instance");let t=Tk(e);return await this.api.post(sb,{token:this.meta.captchaToken},{headers:{...t}})}async _initLinkOnce(){if(!this.api)throw new t3.a("Auth flow has no API instance");return await this.api.post(sw,{})}_transformInitLinkOptionsToCamelCase(e){return{rp:e.rp,user:{id:e.user.id,name:e.user.name,displayName:e.user.display_name},challenge:e.challenge,pubKeyCredParams:e.pub_key_cred_params.map(e=>({type:e.type,alg:e.alg})),timeout:e.timeout,excludeCredentials:e.exclude_credentials?.map(e=>({id:e.id,type:e.type,transports:e.transports})),authenticatorSelection:{authenticatorAttachment:e.authenticator_selection?.authenticator_attachment,requireResidentKey:e.authenticator_selection?.require_resident_key,residentKey:e.authenticator_selection?.resident_key,userVerification:e.authenticator_selection?.user_verification},attestation:e.attestation,extensions:{appid:e.extensions?.app_id,credProps:e.extensions?.cred_props?.rk,hmacCreateSecret:e.extensions?.hmac_create_secret},hints:this.meta.hints}}_transformRegistrationResponseToSnakeCase(e){return{id:e.id,raw_id:e.rawId,response:{client_data_json:e.response.clientDataJSON,attestation_object:e.response.attestationObject,authenticator_data:e.response.authenticatorData},authenticator_attachment:e.authenticatorAttachment,client_extension_results:{app_id:e.clientExtensionResults.appid,cred_props:e.clientExtensionResults.credProps,hmac_create_secret:e.clientExtensionResults.hmacCreateSecret},type:e.type}}_transformInitAuthenticateOptionsToCamelCase(e){return{rpId:e.rp_id,challenge:e.challenge,allowCredentials:e.allow_credentials?.map(e=>({id:e.id,type:e.type,transports:e.transports}))||[],timeout:e.timeout,extensions:{appid:e.extensions?.app_id,credProps:e.extensions?.cred_props,hmacCreateSecret:e.extensions?.hmac_create_secret},userVerification:e.user_verification}}_transformAuthenticationResponseToSnakeCase(e){return{id:e.id,raw_id:e.rawId,response:{client_data_json:e.response.clientDataJSON,authenticator_data:e.response.authenticatorData,signature:e.response.signature,user_handle:e.response.userHandle},authenticator_attachment:e.authenticatorAttachment,client_extension_results:{app_id:e.clientExtensionResults.appid,cred_props:e.clientExtensionResults.credProps,hmac_create_secret:e.clientExtensionResults.hmacCreateSecret},type:e.type}}constructor({captchaToken:e,setPasskeyAuthState:t,hints:r}){this.authenticateForRegistration=!1,this.initRegisterOnce=new TC(this._initRegisterOnce.bind(this)),this.initAuthenticateOnce=new TC(this._initAuthenticateOnce.bind(this)),this.initLinkOnce=new TC(this._initLinkOnce.bind(this)),this.meta={captchaToken:e,setPasskeyAuthState:t,hints:r}}}let TH=({address:e,chainId:t,nonce:r})=>`${window.location.host} wants you to sign in with your Ethereum account:
${e}

By signing, you are proving you own this wallet and logging in. This does not initiate a transaction or cost any fees.

URI: ${window.location.origin}
Version: 1
Chain ID: ${t}
Nonce: ${r}
Issued At: ${(new Date).toISOString()}
Resources:
- https://privy.io`;class Tq{get meta(){return{connectorType:this.wallet?.connectorType,walletClientType:this.wallet?.walletClientType,chainId:this.wallet?.chainId,address:this.wallet?.address,disableSignup:this._meta.disableSignup}}async authenticate(){if(!this.client)throw new t3.a("SiweFlow has no client instance");try{if(this.preparedMessage&&this.signature)return await this.client.authenticateWithSiweInternal({message:this.preparedMessage,signature:this.signature,chainId:this.wallet?.chainId,walletClientType:this.walletClientType??this.wallet?.walletClientType,connectorType:this.connectorType??this.wallet?.connectorType,mode:this._meta.disableSignup?"no-signup":"login-or-sign-up"});if(!this.wallet)throw new t3.a("SiweFlow has no wallet instance");let{message:e,signature:t}=await this.sign();return await this.client.authenticateWithSiweInternal({message:e,signature:t,chainId:this.wallet.chainId,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(e){throw(0,t3.f)(e)}}async link(){if(!this.client)throw new t3.a("SiweFlow has no client instance");try{if(!this.wallet)throw new t3.a("SiweFlow has no wallet instance");let{message:e,signature:t}=await this.sign();return await this.client.linkWithSiweInternal({message:e,signature:t,chainId:this.wallet.chainId,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType})}catch(e){throw(0,t3.f)(e)}}async sign(){if(!this.client)throw new t3.a("SiweFlow has no client instance");if(await this.buildMessage(),!this.preparedMessage)throw new t3.a("Could not prepare SIWE message");if(!this.wallet)throw new t3.a("SiweFlow has no wallet instance");let e=await this.wallet.sign(this.preparedMessage);return{message:this.preparedMessage,signature:e}}async _getNonceOnce(){if(!this.client)throw new t3.a("SiweFlow has no client instance");if(!this.wallet)throw new t3.a("UI SiweFlow has no wallet instance");return await this.client.generateSiweNonce({address:this.wallet.address,captchaToken:this.captchaToken})}async buildMessage(){if(!this.client)throw new t3.a("SiweFlow has no client instance");if(!this.wallet)throw new t3.a("SiweFlow has no wallet instance");let e=this.wallet.address,t=this.wallet.chainId.replace("eip155:","");return this.nonce||(this.nonce=await this.getNonceOnce.execute()),this.preparedMessage=TH({address:e,chainId:t,nonce:this.nonce}),this.preparedMessage}constructor(e,t,r,i=!1,n){this._meta={disableSignup:!1},this.getNonceOnce=new TC(this._getNonceOnce.bind(this)),this.wallet=t,this.captchaToken=r,this.client=e,this._meta.disableSignup=i,this.preparedMessage=n?.message,this.signature=n?.signature,this.walletClientType=n?.walletClientType,this.connectorType=n?.connectorType}}class Tz{get meta(){return{connectorType:this.wallet.connectorType,walletClientType:this.wallet.walletClientType,disableSignup:this._meta.disableSignup,messageType:this._meta.messageType,address:this.wallet?.address}}set messageType(e){this._meta.messageType=e}async authenticate(){if(!this.client)throw new t3.a("SiwsFlow has no client instance");try{let{message:e,signature:t}=await this.sign();return await this.client.authenticateWithSiwsInternal({message:e,signature:t,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up",messageType:this.meta.messageType})}catch(e){throw(0,t3.f)(e)}}async link(){if(!this.client)throw new t3.a("SiwsFlow has no client instance");try{let{message:e,signature:t}=await this.sign();return await this.client.linkWithSiwsInternal({message:e,signature:t,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType,messageType:this.meta.messageType})}catch(e){throw(0,t3.f)(e)}}async sign(){let e,t;if(!this.client)throw new t3.a("SiwsFlow has no client instance");await this.buildMessage();let r="transaction"===this.meta.messageType;if(!this.preparedMessage)throw new t3.a("Could not prepare SIWS message");if(!r&&!this.wallet.provider.signMessage||r&&!this.wallet.provider.signTransaction)throw new t3.a("Wallet does not support the necessary signing methods");if(r&&this._plugin){let r=await this.wallet.provider.signTransaction({transaction:sH.base64.decode(this.preparedMessage)});e=sH.base64.encode(r.signedTransaction),t=this._plugin.getSignatureFromTransaction(r.signedTransaction,this.wallet.address)}else{e=this.preparedMessage;let r=await this.wallet.provider.signMessage({message:(new TextEncoder).encode(this.preparedMessage)});t=sH.base64.encode(r.signature)}return{message:e,signature:t}}async _getNonceOnce(){if(!this.client)throw new t3.a("SiwsFlow has no client instance");return await this.client.generateSiwsNonce({address:this.wallet.address,captchaToken:this.captchaToken})}async buildMessage(){if(!this.client)throw new t3.a("SiwsFlow has no client instance");let e=this.wallet.address;return this.nonce||(this.nonce=await this.getNonceOnce.execute()),"transaction"===this.meta.messageType&&this._plugin?this.preparedMessage=this._plugin.createSiwsMemoTransaction({address:e,nonce:this.nonce}):this.preparedMessage=(0,sF.p)({address:e,nonce:this.nonce}),this.preparedMessage}constructor(e,t,r,i=!1,n="plain",s){this._meta={disableSignup:!1,messageType:"plain"},this.getNonceOnce=new TC(this._getNonceOnce.bind(this)),this.wallet=e,this.captchaToken=r,this.client=t,this._meta.disableSignup=i,this._meta.messageType=n,this._plugin=s}}class T${async authenticate(){if(!this.api)throw new t3.a("Auth flow has no API instance");if(!this.meta.phoneNumber||!this.meta.smsCode)throw new t3.a("phone number and sms code must be set prior to calling authenticate.");try{return await this.api.post(sd,{phoneNumber:this.meta.phoneNumber,code:this.meta.smsCode,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(e){throw(0,t3.f)(e)}}async link(){if(!this.api)throw new t3.a("Auth flow has no API instance");if(!this.meta.phoneNumber||!this.meta.smsCode)throw new t3.a("phone number and sms code must be set prior to calling authenticate.");try{return await this.api.post(sl,{phoneNumber:this.meta.phoneNumber,code:this.meta.smsCode})}catch(e){throw(0,t3.f)(e)}}async sendSmsCode({phoneNumber:e,captchaToken:t,withPrivyUi:r}){if(!this.api)throw new t3.a("Auth flow has no API instance");if(e&&(this.meta.phoneNumber=e),t&&(this.meta.captchaToken=t),!this.meta.phoneNumber)throw new t3.a("phone nNumber must be set when initialzing authentication.");let i=Tk(r);try{return await this.api.post(so,{phoneNumber:this.meta.phoneNumber,token:this.meta.captchaToken},{headers:{...i}})}catch(e){throw(0,t3.f)(e)}}constructor({phoneNumber:e,captchaToken:t,disableSignup:r}){this.meta={phoneNumber:e,captchaToken:t,disableSignup:r??!1}}}class TK extends T${async link(){if(!this.api)throw new t3.a("Auth flow has no API instance");if(!this.meta.phoneNumber||!this.meta.smsCode||!this.meta.oldPhoneNumber)throw new t3.a("Phone number, sms code, and an old phone number must be set prior to calling update.");try{return await this.api.post(su,{old_phone_number:this.meta.oldPhoneNumber,new_phone_number:this.meta.phoneNumber,code:this.meta.smsCode})}catch(e){throw(0,t3.f)(e)}}constructor(e,t,r){super({phoneNumber:t,captchaToken:r}),this.meta={phoneNumber:t,captchaToken:r,oldPhoneNumber:e,disableSignup:!1}}}let TV=(0,F.createContext)({enabled:!1,siteKey:"",provider:void 0,appId:void 0,token:void 0,error:void 0,status:"disabled",setToken:t3.n,setError:t3.n,setExecuting:t3.n,waitForResult:()=>Promise.resolve(""),ref:{current:null},remove:t3.d,reset:t3.n,execute:t3.n});class TJ extends t3.c{constructor(e,t,r){super(e||"Captcha failed"),this.type="Captcha",t instanceof Error&&(this.cause=t),this.privyErrorCode=r}}let TZ=({children:e,appId:t,captchaSiteKey:r,enabledCaptchaProvider:i})=>{let n=(0,F.useRef)(null),s=(0,F.useRef)(null),[a,o]=(0,F.useState)(),[l,c]=(0,F.useState)(),[d,u]=(0,F.useState)(!1),h=(0,F.useMemo)(()=>i?d||a||l?!d||a||l?a&&!l?{status:"success",token:a}:l?{status:"error",error:l}:{status:"ready"}:{status:"loading"}:{status:"ready"}:{status:"disabled"},[i,a,l,d]),p=(0,F.useMemo)(()=>i?"turnstile"===i?{remove:()=>{n.current?.remove(),u(!1),c(void 0),o(void 0)},reset:()=>{n.current?.reset(),u(!1),c(void 0),o(void 0)},execute:()=>{u(!0),n.current?.execute()},waitForResult:async()=>{try{return await (0,t1.p)(()=>n.current?.getResponse(),{interval:200,timeout:2e4})}catch(e){throw new TJ("Captcha failed",null,t3.b.CAPTCHA_TIMEOUT)}}}:{remove:()=>{s.current?.removeCaptcha(),u(!1),c(void 0),o(void 0)},reset:()=>{s.current?.resetCaptcha(),u(!1),c(void 0),o(void 0)},execute:()=>{u(!0),s.current?.execute()},waitForResult:async()=>{try{return await (0,t1.p)(()=>s.current?.getResponse(),{interval:200,timeout:2e4})}catch(e){throw new TJ("Captcha failed",null,t3.b.CAPTCHA_TIMEOUT)}}}:null,[i]),f=(0,F.useMemo)(()=>{if(!i||!p)return{...h,enabled:!1,siteKey:"",appId:t,setToken:t3.n,setError:t3.n,setExecuting:t3.n,waitForResult:()=>Promise.resolve(void 0),remove:t3.d,reset:t3.n,execute:t3.n,provider:void 0,ref:{current:null}};let e={...h,enabled:!0,appId:t,setToken:o,setError:c,setExecuting:u};return"turnstile"===i?{...e,provider:"turnstile",ref:n,siteKey:r.split("t:")[1]??"",...p}:{...e,provider:"hcaptcha",ref:s,siteKey:r.split("h:")[1]??"",...p}},[h,i,p,t,r]);return(0,W.jsx)(TV.Provider,{value:f,children:e})},TG=()=>(0,F.useContext)(TV);class TY{async authenticate(){if(!this.api)throw new t3.a("Auth flow has no API instance");try{return await this.api.post(sS,{captcha_token:this.meta.captchaToken,telegram_auth_result:this.meta.telegramAuthResult,telegram_web_app_data:this.meta.telegramWebAppData,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(e){throw(0,t3.f)(e)}}async link(){if(!this.api)throw new t3.a("Auth flow has no API instance");try{return await this.api.post(sI,{telegram_auth_result:this.meta.telegramAuthResult,telegram_web_app_data:this.meta.telegramWebAppData})}catch(e){throw(0,t3.f)(e)}}constructor(e,t=!1){this.meta={disableSignup:!1},this.meta={captchaToken:e,disableSignup:!1},this.meta.disableSignup=t}}function TQ(e){let t={detail:"",retryable:!1};return e?.privyErrorCode===t3.b.LINKED_TO_ANOTHER_USER&&(t.detail="This account has already been linked to another user."),e?.privyErrorCode===t3.b.DISALLOWED_LOGIN_METHOD&&(t.detail="Login with Telegram not allowed."),e?.privyErrorCode===t3.b.INVALID_DATA&&(t.retryable=!0,t.detail="Something went wrong. Try again."),e?.privyErrorCode===t3.b.CANNOT_LINK_MORE_OF_TYPE&&(t.retryable=!0,t.detail="Something went wrong. Try again."),e?.privyErrorCode===t3.b.INVALID_CREDENTIALS&&(t.retryable=!0,t.detail="Something went wrong. Try again."),e?.privyErrorCode===t3.b.TOO_MANY_REQUESTS&&(t.detail="Too many requests. Please wait before trying again."),e?.privyErrorCode===t3.b.TOO_MANY_REQUESTS&&e.message.includes("rate limit")&&(t.detail="Request limit reached for Telegram. Please wait a moment and try again."),e instanceof TJ&&(t.retryable=!0,t.detail="Something went wrong. Try again."),t}function TX(e){return Object.fromEntries(decodeURIComponent(e).split("&").map(e=>e.split("=").map(decodeURIComponent)))}function T0(){let e=new URL(window.location.href);e.searchParams.delete("id"),e.searchParams.delete("hash"),e.searchParams.delete("auth_date"),e.searchParams.delete("first_name"),e.searchParams.delete("last_name"),e.searchParams.delete("username"),e.searchParams.delete("photo_url"),e.hash="",window.history.replaceState({},"",e)}let T1=(0,F.lazy)(()=>e.A(953156)),T2=(0,F.lazy)(()=>e.A(724041)),T3=e=>{let t=TG();return(0,F.useEffect)(()=>t.remove,[t.remove]),t.enabled&&t.provider?(0,W.jsx)(F.Suspense,{fallback:null,children:(0,W.jsxs)("div",{className:"hidden h-0 w-0",children:["turnstile"===t.provider&&(0,W.jsx)(T1,{...e,captchaContext:t}),"hcaptcha"===t.provider&&(0,W.jsx)(T2,{...e,captchaContext:t})]})}):null};var T5=Object.freeze({__proto__:null,AccountNotFoundScreen:()=>e.A(950414),AffirmativeConsentScreen:()=>e.A(714653),AllowlistRejectionScreen:()=>e.A(725569),AuthenticateWithWalletScreen:()=>e.A(937141),AwaitingEvmToSolBridgingScreen:()=>e.A(978020),AwaitingExternalEthereumTransferScreen:()=>e.A(884850),AwaitingPasswordlessCodeScreen:()=>e.A(493849),AwaitingSolToEvmBridgingScreen:()=>e.A(131498),CaptchaScreen:()=>e.A(555745),CoinbaseOnrampStatusScreen:()=>e.A(697083),ConnectLedgerScreen:()=>e.A(706586),ConnectOnlyLandingScreen:()=>e.A(668815),ConnectOnlyStatusScreen:()=>e.A(798079),ConnectOrCreateScreen:()=>e.A(188798),ConnectionStatusScreen:()=>e.A(476792),CrossAppAuthScreen:()=>e.A(784250),DelegatedActionsConsentScreen:()=>e.A(500187),DelegatedActionsRevokeScreen:()=>e.A(825201),EmbeddedWalletConnectingScreen:()=>e.A(207472),EmbeddedWalletCreatedScreen:()=>e.A(813947),EmbeddedWalletKeyExportScreen:()=>e.A(200502),EmbeddedWalletOnAccountCreateScreen:()=>e.A(675142),EmbeddedWalletPasswordCreateScreen:()=>e.A(491036),EmbeddedWalletPasswordUpdateScreen:()=>e.A(112849),EmbeddedWalletPasswordUpdateSplashScreen:()=>e.A(260358),ErrorScreen:()=>e.A(613870),FarcasterConnectStatusScreen:()=>e.A(768615),FarcasterSignerStatusScreen:()=>e.A(938805),FundSolWalletWithExternalSolanaWallet:()=>e.A(829006),FundingAmountEditScreen:()=>e.A(580272),FundingMethodSelectionScreen:()=>e.A(6951),InAppBrowserLoginNotPossible:()=>e.A(273903),InstallWalletScreen:()=>e.A(291882),LandingScreen:()=>e.A(775876),LinkConflictScreen:()=>e.A(487758),LinkEmailScreen:()=>e.A(903032),LinkPasskeyScreen:()=>e.A(962643),LinkPhoneScreen:()=>e.A(451958),LoginFailedScreen:()=>e.A(54791),ManualTransferScreen:()=>e.A(65369),MfaAuthEnrollmentFlowScreen:()=>e.A(319908),MfaAuthVerifyFlowScreen:()=>e.A(414748),MfaEnrollmentFlowScreen:()=>e.A(103869),MoonpayStatusScreen:()=>e.A(164991),OAuthStatusScreen:()=>e.A(713529),PasskeySelectSignupOrLogin:()=>e.A(768529),PasskeyStatusScreen:()=>e.A(574693),PasswordRecoveryScreen:()=>e.A(938570),RecoveryOAuthScreen:()=>e.A(589610),RecoverySelectionScreen:()=>e.A(601515),SendTransactionScreen:()=>e.A(524262),SetAutomaticRecoveryScreen:()=>e.A(434453),SignRequestScreen:()=>e.A(212844),StandardSignAndSendTransactionScreen:()=>e.A(497711),TelegramAuthScreen:()=>e.A(646406),TransferFromWalletScreen:()=>e.A(643595),UpdateEmailScreen:()=>e.A(337293),UpdatePhoneScreen:()=>e.A(614461),UserLimitReachedScreen:()=>e.A(940246),WalletInterstitialScreen:()=>e.A(938072)});let T8=(0,s$.create)(()=>({inProgressMfaFlow:void 0})),T6=(0,sq.createGlobalStyle)([":root{","};"],e=>T4(e.palette)),T4=e=>(0,sq.css)(["",""],Object.entries({"--privy-color-background":e.background,"--privy-color-background-2":e.background2,"--privy-color-background-3":e.background3,"--privy-color-foreground":e.foreground,"--privy-color-foreground-2":e.foreground2,"--privy-color-foreground-3":e.foreground3,"--privy-color-foreground-4":e.foreground4,"--privy-color-foreground-accent":e.foregroundAccent,"--privy-color-accent":e.accent,"--privy-color-accent-light":e.accentLight,"--privy-color-accent-hover":e.accentHover,"--privy-color-accent-dark":e.accentDark,"--privy-color-accent-darkest":e.accentDarkest,"--privy-color-success":e.success,"--privy-color-success-dark":e.successDark,"--privy-color-success-light":e.successLight,"--privy-color-success-bg":e.successBg,"--privy-color-error":e.error,"--privy-color-error-light":e.errorLight,"--privy-color-error-bg":e.errorBg,"--privy-color-error-bg-hover":e.errorBgHover,"--privy-color-warn":e.warn,"--privy-color-warn-light":e.warnLight,"--privy-color-warn-bg":e.warnBg,"--privy-color-warning-dark":e.warningDark,"--privy-color-error-dark":e.errorDark,"--privy-color-info-bg":e.infoBg,"--privy-color-info-bg-hover":e.infoBgHover,"--privy-color-border-default":e.borderDefault,"--privy-color-border-hover":e.borderHover,"--privy-color-border-focus":e.borderFocus,"--privy-color-border-error":e.borderError,"--privy-color-border-success":e.borderSuccess,"--privy-color-border-warning":e.borderWarning,"--privy-color-border-info":e.borderInfo,"--privy-color-border-interactive":e.borderInteractive,"--privy-color-border-interactive-hover":e.borderInteractiveHover,"--privy-color-background-hover":e.backgroundHover,"--privy-color-background-clicked":e.backgroundClicked,"--privy-color-background-disabled":e.backgroundDisabled,"--privy-color-background-interactive":e.backgroundInteractive,"--privy-color-background-interactive-hover":e.backgroundInteractiveHover,"--privy-color-background-interactive-clicked":e.backgroundInteractiveClicked,"--privy-color-background-interactive-disabled":e.backgroundInteractiveDisabled,"--privy-color-foreground-hover":e.foregroundHover,"--privy-color-foreground-clicked":e.foregroundClicked,"--privy-color-foreground-disabled":e.foregroundDisabled,"--privy-color-foreground-interactive":e.foregroundInteractive,"--privy-color-foreground-interactive-hover":e.foregroundInteractiveHover,"--privy-link-navigation-color":e.linkNavigationColor,"--privy-link-navigation-decoration":e.linkNavigationDecoration,"--privy-accent-has-good-contrast":e.accentHasGoodContrast,"--privy-color-icon-default":e.iconDefault,"--privy-color-icon-muted":e.iconMuted,"--privy-color-icon-subtle":e.iconSubtle,"--privy-color-icon-inverse":e.iconInverse,"--privy-color-icon-success":e.iconSuccess,"--privy-color-icon-warning":e.iconWarning,"--privy-color-icon-error":e.iconError,"--privy-color-icon-interactive":e.iconInteractive,"--privy-color-icon-default-hover":e.iconDefaultHover,"--privy-color-icon-muted-hover":e.iconMutedHover,"--privy-color-icon-subtle-hover":e.iconSubtleHover,"--privy-color-icon-default-clicked":e.iconDefaultClicked,"--privy-color-icon-muted-clicked":e.iconMutedClicked,"--privy-color-icon-subtle-clicked":e.iconSubtleClicked,"--privy-color-icon-default-disabled":e.iconDefaultDisabled,"--privy-color-icon-muted-disabled":e.iconMutedDisabled,"--privy-color-icon-subtle-disabled":e.iconSubtleDisabled,"--privy-color-icon-error-hover":e.iconErrorHover,"--privy-color-icon-interactive-hover":e.iconInteractiveHover,"--privy-color-icon-error-clicked":e.iconErrorClicked,"--privy-color-icon-interactive-clicked":e.iconInteractiveClicked,"--privy-color-icon-muted-disabled-alt":e.iconMutedDisabledAlt,"--privy-color-icon-subtle-disabled-alt":e.iconSubtleDisabledAlt,"--privy-border-radius-xs":"6px","--privy-border-radius-sm":"8px","--privy-border-radius-md":"12px","--privy-border-radius-mdlg":"16px","--privy-border-radius-lg":"24px","--privy-border-radius-full":"9999px","--privy-height-modal-full":"620px","--privy-height-modal-compact":"480px"}).map(([e,t])=>`${e}: ${t};`).join("\n")),T7=sq.styled.div.withConfig({displayName:"StylesWrapper",componentId:"sc-188229e4-0"})([""," color:var(--privy-color-foreground-2);h3{font-size:16px;line-height:24px;font-weight:500;color:var(--privy-color-foreground-2);}h4{font-size:14px;line-height:20px;font-weight:500;color:var(--privy-color-foreground);}p{font-size:13px;line-height:20px;color:var(--privy-color-foreground-2);}button:focus,input:focus,optgroup:focus,select:focus,textarea:focus{outline:none;border-color:var(--privy-color-accent-light);box-shadow:0 0 0 3px var(--privy-color-border-focus);}.mobile-only{@media (min-width:441px){display:none;}}@keyframes fadein{0%{opacity:0;}100%{opacity:1;}}"],"\n  *,\n  ::before,\n  ::after {\n    box-sizing: border-box;\n    border-width: 0;\n    border-style: solid;\n  }\n\n  line-height: 1.15;\n  -webkit-text-size-adjust: 100%;\n  -moz-tab-size: 4;\n  tab-size: 4;\n  font-feature-settings: normal;\n\n  margin: 0;\n  font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif,\n    'Apple Color Emoji', 'Segoe UI Emoji';\n\n  hr {\n    height: 0;\n    color: inherit;\n    border-top-width: 1px;\n  }\n\n  abbr:where([title]) {\n    text-decoration: underline dotted;\n  }\n\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6 {\n    font-size: inherit;\n    font-weight: inherit;\n    font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif,\n    'Apple Color Emoji', 'Segoe UI Emoji';\n    display: inline;\n  }\n\n  a {\n    color: inherit;\n    text-decoration: inherit;\n  }\n\n  b,\n  strong {\n    font-weight: bolder;\n  }\n\n  code,\n  kbd,\n  samp,\n  pre {\n    font-family: ui-monospace, SFMono-Regular, Consolas, 'Liberation Mono', Menlo, monospace;\n    font-size: 1em;\n  }\n\n  small {\n    font-size: 80%;\n  }\n\n  sub,\n  sup {\n    font-size: 75%;\n    line-height: 0;\n    position: relative;\n    vertical-align: baseline;\n  }\n\n  sub {\n    bottom: -0.25em;\n  }\n\n  sup {\n    top: -0.5em;\n  }\n\n  table {\n    text-indent: 0;\n    border-color: inherit;\n    border-collapse: collapse;\n  }\n\n  button,\n  input,\n  optgroup,\n  select,\n  textarea {\n    font-family: inherit;\n    font-size: 100%;\n    font-weight: inherit;\n    line-height: inherit;\n    color: inherit;\n    margin: 0;\n    padding: 0;\n  }\n\n  button,\n  select {\n    text-transform: none;\n  }\n\n  button,\n  [type='button'],\n  [type='reset'],\n  [type='submit'] {\n    -webkit-appearance: button;\n    background-color: transparent;\n    background-image: none;\n  }\n\n  ::-moz-focus-inner {\n    border-style: none;\n    padding: 0;\n  }\n\n  :-moz-focusring {\n    outline: 1px dotted ButtonText;\n  }\n\n  :-moz-ui-invalid {\n    box-shadow: none;\n  }\n\n  legend {\n    padding: 0;\n  }\n\n  progress {\n    vertical-align: baseline;\n  }\n\n  ::-webkit-inner-spin-button,\n  ::-webkit-outer-spin-button {\n    height: auto;\n  }\n\n  [type='search'] {\n    -webkit-appearance: textfield;\n    outline-offset: -2px;\n  }\n\n  ::-webkit-search-decoration {\n    -webkit-appearance: none;\n  }\n\n  ::-webkit-file-upload-button {\n    -webkit-appearance: button;\n    font: inherit;\n  }\n\n  summary {\n    display: list-item;\n  }\n\n  blockquote,\n  dl,\n  dd,\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6,\n  hr,\n  figure,\n  p,\n  pre {\n    margin: 0;\n  }\n\n  fieldset {\n    margin: 0;\n    padding: 0;\n  }\n\n  legend {\n    padding: 0;\n  }\n\n  ol,\n  ul,\n  menu {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n\n  textarea {\n    resize: vertical;\n  }\n\n  input::placeholder,\n  textarea::placeholder {\n    opacity: 1;\n    color: #9ca3af;\n  }\n\n  button,\n  [role='button'] {\n    cursor: pointer;\n  }\n\n  :disabled {\n    cursor: default;\n  }\n\n  img,\n  svg,\n  video,\n  canvas,\n  audio,\n  iframe,\n  embed,\n  object {\n    display: block;\n  }\n\n  img,\n  video {\n    max-width: 100%;\n    height: auto;\n  }\n\n  [hidden] {\n    display: none;\n  }\n"),T9=({children:e,open:t,onClick:r,...i})=>(0,W.jsx)(aC,{show:t,as:F.default.Fragment,children:(0,W.jsxs)(lp,{onClose:r,...i,as:xt,children:[(0,W.jsx)(ax,{as:F.default.Fragment,enterFrom:"entering",leaveTo:"leaving",children:(0,W.jsx)(xe,{id:"privy-dialog-backdrop","aria-hidden":"true"})}),(0,W.jsx)(xr,{children:(0,W.jsx)(ax,{as:F.default.Fragment,enterFrom:"entering",leaveTo:"leaving",children:(0,W.jsx)(lh,{as:xi,children:e})})})]})}),xe=sq.styled.div.withConfig({displayName:"Backdrop",componentId:"sc-3cfde0b5-0"})(["position:fixed;inset:0;transition:backdrop-filter 100ms ease;backdrop-filter:blur(3px);-webkit-backdrop-filter:blur(3px);&.entering,&.leaving{backdrop-filter:unset;-webkit-backdrop-filter:unset;}"]),xt=sq.styled.div.withConfig({displayName:"DialogWrapper",componentId:"sc-3cfde0b5-1"})(["position:relative;z-index:999999;"]),xr=sq.styled.div.withConfig({displayName:"DialogContainer",componentId:"sc-3cfde0b5-2"})(["position:fixed;inset:0;display:flex;align-items:center;justify-content:center;width:100vw;min-height:100vh;"]),xi=sq.styled.div.withConfig({displayName:"Panel",componentId:"sc-3cfde0b5-3"})(["padding:0;background:transparent;border:none;width:100%;pointer-events:auto;outline:none;display:block;@media (max-width:440px){opacity:1;transform:translate3d(0,0,0);transition:transform 200ms ease-in;position:fixed;bottom:0;&.entering,&.leaving{opacity:0;transform:translate3d(0,100%,0);transition:transform 150ms ease-in 0ms,opacity 0ms ease 150ms;}}@media (min-width:441px){opacity:1;transition:opacity 100ms ease-in;&.entering,&.leaving{opacity:0;transition-delay:5ms;}margin:auto;width:360px;box-shadow:0px 8px 36px rgba(55,65,81,0.15);border-radius:var(--privy-border-radius-lg);}"]),xn=(0,F.lazy)(()=>e.A(594836)),xs=(0,F.lazy)(()=>T5.MfaAuthVerifyFlowScreen().then(e=>({default:e.default.component}))),xa=()=>(0,W.jsx)(xh,{children:(0,W.jsx)(t1.L,{})}),xo=()=>{let{currentScreen:e}=(0,tX.a)(),t=T8(e=>e.inProgressMfaFlow),r=()=>T8.setState({inProgressMfaFlow:void 0}),{component:i,isLoading:n}=(()=>{let{ready:e}=(0,tX.u)(),{currentScreen:t}=(0,tX.a)(),[r,i]=(0,F.useState)(null),[n,s]=(0,F.useState)(!1),a=function(e){let[t,r]=(0,F.useState)(!1),i=(0,F.useRef)(null),n=(0,F.useRef)(null),s=(0,F.useRef)(null);return(0,F.useEffect)(()=>{if(i.current&&(clearTimeout(i.current),i.current=null),n.current&&(clearTimeout(n.current),n.current=null),e)s.current=Date.now(),i.current=setTimeout(()=>{r(!0)},150);else if(null!==s.current){let e=Date.now()-s.current;e>=150?n.current=setTimeout(()=>{r(!1),s.current=null},Math.max(0,400-(e-150))):(i.current&&(clearTimeout(i.current),i.current=null),r(!1),s.current=null)}return()=>{i.current&&clearTimeout(i.current),n.current&&clearTimeout(n.current)}},[e]),t}(n);return(0,F.useEffect)(()=>{t?(s(!0),T5[t]().then(r=>{(!t||e||r.default.isShownBeforeReady)&&(i(()=>r.default.component),s(!1))}).catch(()=>{i(null),s(!1)})):(i(null),s(!1))},[t,e]),{component:r,isLoading:a}})();return function(){let{isModalOpen:e}=(0,tX.u)(),{headless:t}=(0,nL.u)(),{currentScreen:r}=(0,tX.a)(),{status:i,execute:n,reset:s,enabled:a}=TG(),[o,l]=(0,F.useState)(!1);(0,F.useEffect)(()=>{!e&&a&&s()},[e,a,s]),(0,F.useEffect)(()=>{r?T5[r]().then(e=>{l(!!e.default.isCaptchaRequired)}).catch(()=>{l(!1)}):l(!1)},[r]),(0,F.useEffect)(()=>{e&&o&&!t&&"ready"===i&&a&&n()},[e,o,t,i,a,n])}(),e||"txn"!==t?n?(0,W.jsx)(xa,{}):i?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(t1.H,{$if:!!t,children:(0,W.jsx)(F.Suspense,{children:(0,W.jsx)(i,{})})}),(0,W.jsxs)(F.Suspense,{children:["txn"===t&&(0,W.jsx)(xn,{onClose:r}),"auth"===t&&(0,W.jsx)(xs,{})]})]}):null:(0,W.jsxs)(F.Suspense,{children:[(0,W.jsx)(xn,{onClose:r}),";"]})},xl=()=>{let e=(0,F.useRef)(null);return(0,W.jsx)(xu,{style:{height:(0,t1.u)(e)},id:"privy-modal-content",children:(0,W.jsx)("div",{ref:e,children:(0,W.jsx)(xo,{})})})},xc=({open:e})=>{var t;let r=(0,nL.u)(),{gracefulClosePrivyModal:i}=(()=>{let{closePrivyModal:e}=(0,t3.u)(),{onUserCloseViaDialogOrKeybindRef:t}=(0,tX.a)();return{gracefulClosePrivyModal:(0,F.useCallback)(()=>{if(!t?.current)return e({shouldCallAuthOnSuccess:!1});t.current()},[e])}})(),n=T8(e=>e.inProgressMfaFlow);return t={onMfaRequired:()=>{r.mfa.noPromptOnMfaRequired||T8.setState({inProgressMfaFlow:"txn"})}},(0,sz.u)("configureMfa",t),r.render.standalone?(0,W.jsx)(T7,{children:(0,W.jsx)(xd,{id:"privy-modal-content",children:(0,W.jsx)(xo,{})})}):(0,W.jsx)(T9,{open:!(!e&&!n),id:"privy-dialog","aria-label":"log in or sign up","aria-labelledby":"privy-dialog-title",onClick:()=>i(),children:(0,W.jsx)(T7,{children:(0,W.jsx)(xl,{})})})},xd=sq.styled.div.withConfig({displayName:"ContentWrapper",componentId:"sc-9b080f09-0"})(["display:flex;flex-direction:column;text-align:center;font-size:14px;line-height:20px;width:100%;background:var(--privy-color-background);padding:0 16px;"]),xu=(0,sq.styled)(xd).withConfig({displayName:"BaseModal",componentId:"sc-9b080f09-1"})(["transition:height 150ms ease-out;overflow-x:hidden;overflow-y:auto;scrollbar-width:none;max-height:calc(100svh - 32px);border-radius:var(--privy-border-radius-lg) var(--privy-border-radius-lg) 0 0;box-shadow:0px 0px 36px rgba(55,65,81,0.15);@media (min-width:441px){box-shadow:0px 8px 36px rgba(55,65,81,0.15);border-radius:var(--privy-border-radius-lg);}"]),xh=sq.styled.div.withConfig({displayName:"LoadingScreenContainer",componentId:"sc-9b080f09-2"})(["display:flex;align-items:center;justify-content:center;min-height:300px;padding:2rem;"]);function xp(e){let t=(0,F.useRef)(null),r=(0,F.useRef)();return(0,F.useEffect)(()=>{r.current?.remove(),r.current=function({botUsername:e,scriptHost:t}){let r=document.createElement("script"),{origin:i}=new URL(t);return r.async=!0,r.src=`${i}/js/telegram-login.js`,r.setAttribute("data-telegram-login",e),r.setAttribute("data-request-access","write"),r.setAttribute("data-lang","en"),r}(e),t.current?.after(r.current)},[e]),(0,W.jsx)("div",{ref:t,hidden:!0})}let xf=()=>{let{ready:e}=(0,t2.u)(),{client:t}=(0,t3.u)();return(0,F.useEffect)(()=>{let r=()=>{if(!t.connectors||!e)return;let r=t.connectors.wallets.map(e=>({address:e.address,connectorType:e.connectorType,walletClientType:e.walletClientType,connectedAt:e.connectedAt,id:e.meta.id}));t5.u.put(nL.b,r)};return t.connectors?.on("walletsUpdated",r),()=>{t.connectors?.off("walletsUpdated",r)}},[e,t.connectors]),null};class xy extends t1.E{async initialize(){let e=await this.createProvider();this.provider=e,this.proxyProvider.setWalletProvider(e),this.subscribeListeners(),e.session&&(this.walletProvider?.session?.peer.metadata.url&&(this.walletEntry=(0,t1.g)(this.walletProvider?.session?.peer.metadata.url),this.walletClientType=this.walletEntry?.slug||"unknown"),this.connected=!0,await this.syncAccounts()),this.initialized=!0,this.emit("initialized")}async connect(e){return e.showPrompt&&await this.promptConnection(),this.getConnectedWallet()}async isConnected(){return!!this.walletProvider?.connected}get walletBranding(){let e=this.walletProvider?.session?.peer.metadata.icons?.[0];return{name:(0,t1.s)(this.walletProvider?.session?.peer.metadata.name||"")||"WalletConnect",icon:"string"==typeof e?e:t5.W,id:this.walletProvider?.session?.peer.metadata.name.toLowerCase()||"wallet_connect_v2"}}async resetConnection(e){this.walletProvider&&this.walletProvider.connected&&(await this.walletProvider.disconnect(),this.walletProvider.signer.session=void 0,this.walletClientType=e,this.redirectUri=void 0,this.fallbackUniversalRedirectUri=void 0,(0,sF.d)(),this.onDisconnect())}async promptConnection(){if(this.provider)return new Promise((e,t)=>{(async()=>{let t="",r=await Promise.race([this.walletProvider?.enable(),this.proxyProvider.walletTimeout()]);if(r?.length&&(t=r[0]),!t||""===t)throw new t3.P("Unable to retrieve address");this.walletProvider?.session?.peer.metadata.url&&(this.walletEntry=(0,t1.g)(this.walletProvider?.session?.peer.metadata.url),this.walletClientType=this.walletEntry?.slug||"unknown",this.proxyProvider.rpcTimeoutDuration=(0,t1.c)(this.rpcConfig,this.walletClientType)),this.connected=!0,await this.syncAccounts(r),e()})().catch(e=>{t(e?(0,t5.f)(e):new t3.P("Unknown error during connection"))})})}disconnect(){this.walletProvider?.disconnect().then(()=>this.onDisconnect()).catch(()=>console.warn("Unable to disconnect WalletConnect provider"))}get walletProvider(){return this.proxyProvider.walletProvider}setWalletProvider(e){this.proxyProvider.setWalletProvider(e)}async createProvider(){let e={};for(let t of this.chains){let r=(0,t1.a)(t.id,this.chains,this.rpcConfig,this.privyAppId);r&&(e[t.id]=r)}let t=this.shouldEnforceDefaultChainOnConnect?[this.defaultChain.id]:[],r=this.chains.map(e=>e.id),i=await Ee.init({projectId:this.walletConnectCloudProjectId,chains:t,optionalChains:r,optionalEvents:_Y,optionalMethods:_Z,rpcMap:e,showQrModal:!1,metadata:{description:this.privyAppName,name:this.privyAppName,url:window.location.origin,icons:[]}});return i.on("display_uri",e=>{if(i.signer.abortPairingAttempt(),(0,sF.r)(),!this.showPrivyQrModal)throw new t3.P("WalletConnect modal not available - Privy handles wallet connections through its own UI");if(nB.isMobile&&this.walletEntry){let{redirect:t,href:r}=(0,sF.b)(e,this.walletEntry);(0,sF.o)(t,"_self"),(0,sF.s)({href:r,name:this.walletEntry.metadata?.shortName||this.walletEntry.name});let i=(0,sF.a)(e,this.walletEntry);return this.redirectUri=t,this.fallbackUniversalRedirectUri=i?.redirect,this.showPrivyQrModal({native:t,universal:t})}if(this.redirectUri=void 0,this.walletEntry){let t=(0,sF.a)(e,this.walletEntry);this.fallbackUniversalRedirectUri=t?.redirect}this.showPrivyQrModal({native:e,universal:void 0})}),i.on("connect",()=>{i.session?.peer.metadata.url&&(this.walletEntry=(0,t1.g)(i.session?.peer.metadata.url),this.walletClientType=this.walletEntry?.slug||"unknown")}),i}async enableProvider(){return this.walletProvider?.connected?Promise.resolve(this.walletProvider.accounts):await this.walletProvider?.enable()}setWalletEntry(e,t){this.walletEntry=e,this.showPrivyQrModal=t}constructor({walletConnectCloudProjectId:e,rpcConfig:t,chains:r,defaultChain:i,shouldEnforceDefaultChainOnConnect:n,privyAppId:s,privyAppName:a,walletClientType:o}){super(o||"unknown",r,i,t),this.connectorType="wallet_connect_v2",this.privyAppId=s,this.privyAppName=a,this.walletConnectCloudProjectId=e,this.rpcConfig=t,this.shouldEnforceDefaultChainOnConnect=n,this.proxyProvider=new t1.P(void 0,this.rpcTimeoutDuration),o&&(this.walletEntry=(0,t1.b)(o),this.walletClientType=o)}}let xg=["error","invalid_request_arguments","wallet_not_on_device","invalid_recovery_pin","insufficient_funds","missing_or_invalid_mfa","mfa_verification_max_attempts_reached","mfa_timeout","twilio_verification_failed"];class xm extends Error{constructor(e,t){super(t),this.type=e}}function xw(e){let t=e.type;return"string"==typeof t&&xg.includes(t)}function xb(e){return xw(e)&&"wallet_not_on_device"===e.type}function xv(e){return xw(e)&&("invalid_recovery_pin"===e.type||"invalid_request_arguments"===e.type)}function x_(e){return!!xw(e)&&"mfa_timeout"===e.type}function xE(e){return!!xw(e)&&"missing_or_invalid_mfa"===e.type}function xA(e){return!!xw(e)&&"mfa_verification_max_attempts_reached"===e.type}function xS(e){return!(!xw(e)||!e.message.includes("code 429"))}function xI(e){let t;return"string"==typeof(t=e.type)&&"client_error"===t&&"MFA canceled"===e.message}async function xk(e,t,r,i,n,s=!1){let a=s,o=async o=>{if(a&&t&&t.length>0){o===+!s?n("configureMfa","onMfaRequired",{mfaMethods:t}):i.current?.reject(new xm("missing_or_invalid_mfa","MFA verification failed, retry."));let a=await new Promise((e,t)=>{r.current={resolve:e,reject:t},setTimeout(()=>{let e=new xm("mfa_timeout","Timed out waiting for MFA code");i.current?.reject(e),t(e)},3e5)});return await e(a)}return await e()},l=null;for(let e=0;e<4;e++)try{l=await o(e),i.current?.resolve(void 0);break}catch(e){if("missing_or_invalid_mfa"!==e.type)throw i.current?.resolve(void 0),e;a=!0}if(null===l){let e=new xm("mfa_verification_max_attempts_reached","Max MFA verification attempts reached");throw i.current?.reject(e),e}return l}let xT=(Cz=0,()=>"id-"+Cz++);function xx(e){return void 0!==e.error}let xC=new class{enqueue(e,t){this.callbacks[e]=t}dequeue(e,t){let r=this.callbacks[t];if(!r)throw Error(`cannot dequeue ${e} event: no event found for id ${t}`);switch(delete this.callbacks[t],e){case"privy:iframe:ready":case"privy:user-signer:sign":case"privy:wallets:add":case"privy:wallets:import":case"privy:wallets:set-recovery":case"privy:wallets:connect":case"privy:wallets:recover":case"privy:wallets:rpc":case"privy:wallet:create":case"privy:mfa:verify":case"privy:mfa:init-enrollment":case"privy:mfa:submit-enrollment":case"privy:mfa:unenroll":case"privy:mfa:clear":case"privy:auth:unlink-passkey":case"privy:farcaster:init-signer":case"privy:farcaster:sign":case"privy:solana-wallet:create":case"privy:delegated-actions:consent":return r;default:throw Error(`invalid wallet event type ${e}`)}}constructor(){this.callbacks={}}},xP=new Map,xO=(e,t)=>"bigint"==typeof t?t.toString():t;function xR(e,t,r,i){let n=r.contentWindow;if(!n)throw Error("iframe not initialized");let s=`${e}${JSON.stringify(t,xO)}`;if("privy:wallet:create"===e){let e=xP.get(s);if(e)return e}let a=new Promise((r,s)=>{let a=xT();xC.enqueue(a,{resolve:r,reject:s}),n.postMessage({id:a,event:e,data:t},i)}).finally(()=>{xP.delete(s)});return xP.set(s,a),a}function xN(e){let t=(0,nL.c)(),r=(0,F.useRef)(null),i=(0,F.useRef)(e.mfaMethods),n=(0,sz.a)(),[s,a]=(0,F.useState)(!1);return(0,F.useEffect)(()=>{i.current=e.mfaMethods},[e.mfaMethods]),(0,F.useEffect)(()=>{if(!s)return;let t=r.current;if(!t)return;function a(t){var r;t&&t.origin===e.origin&&"string"==typeof(r=t.data).event&&/^privy:.+/.test(r.event)&&function(e){switch(e.event){case"privy:iframe:ready":let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data);case"privy:user-signer:sign":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:wallets:add":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:wallets:set-recovery":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:wallets:connect":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:wallets:recover":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:wallets:rpc":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:wallet:create":let r=xC.dequeue(e.event,e.id);return xx(e)?r.reject(new xm(e.error.type,e.error.message)):r.resolve(e.data);case"privy:wallets:import":let i=xC.dequeue(e.event,e.id);return xx(e)?i.reject(new xm(e.error.type,e.error.message)):i.resolve(e.data);case"privy:mfa:verify":let n=xC.dequeue(e.event,e.id);return xx(e)?n.reject(new xm(e.error.type,e.error.message)):n.resolve(e.data);case"privy:mfa:init-enrollment":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:mfa:submit-enrollment":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:mfa:unenroll":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:mfa:clear":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:auth:unlink-passkey":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:solana-wallet:create":let s=xC.dequeue(e.event,e.id);return xx(e)?s.reject(new xm(e.error.type,e.error.message)):s.resolve(e.data);case"privy:farcaster:init-signer":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:farcaster:sign":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}case"privy:delegated-actions:consent":{let t=xC.dequeue(e.event,e.id);return xx(e)?t.reject(new xm(e.error.type,e.error.message)):t.resolve(e.data)}default:console.warn("Unsupported wallet proxy method:",e)}}(t.data)}let o={signWithUserSigner:r=>xk(i=>xR("privy:user-signer:sign",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n),addWallet:r=>xk(i=>xR("privy:wallets:add",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n),setRecovery:r=>xk(i=>xR("privy:wallets:set-recovery",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n),connect:r=>xk(i=>xR("privy:wallets:connect",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n),recover:r=>xk(i=>xR("privy:wallets:recover",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n,!r.recoveryAccessToken&&!r.recoveryPassword&&!r.recoverySecretOverride),rpc:r=>xk(i=>xR("privy:wallets:rpc",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n),create:r=>xR("privy:wallet:create",r,t,e.origin),importWallet:r=>xR("privy:wallets:import",r,t,e.origin),createSolana:r=>xk(i=>xR("privy:solana-wallet:create",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n),createDelegatedAction:r=>xR("privy:delegated-actions:consent",r,t,e.origin),verifyMfa:r=>xk(i=>xR("privy:mfa:verify",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n,!0),initEnrollMfa:r=>xk(i=>xR("privy:mfa:init-enrollment",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n),submitEnrollMfa:r=>xk(i=>xR("privy:mfa:submit-enrollment",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n),unenrollMfa:r=>xk(i=>xR("privy:mfa:unenroll",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n),clearMfa:r=>xR("privy:mfa:clear",r,t,e.origin),unlinkPasskeyAccount:r=>xk(i=>xR("privy:auth:unlink-passkey",{...r,...i},t,e.origin),i.current,e.mfaPromise,e.mfaSubmitPromise,n),initFarcasterSigner:r=>xR("privy:farcaster:init-signer",r,t,e.origin),signFarcasterMessage:r=>xR("privy:farcaster:sign",r,t,e.origin)};window.addEventListener("message",a);let l=new AbortController;return(0,t1.i)(()=>xR("privy:iframe:ready",{},t,e.origin),{abortSignal:l.signal}).then(()=>e.onLoad(o),(...t)=>{console.warn("Privy iframe failed to load: ",...t),e.onLoadFailed()}),()=>{window.removeEventListener("message",a),l.abort()}},[s]),t?(0,W.jsx)("iframe",{ref:r,width:"0",height:"0",style:{display:"none",height:"0px",width:"0px"},onLoad:()=>a(!0),src:(0,Eh.constructURL)({origin:e.origin,path:`/apps/${e.appId}/embedded-wallets`,query:{caid:e.clientAnalyticsId,client_id:e.appClientId}})}):null}let xM=e=>e.linkedAccounts.filter(e=>"wallet"===e.type&&"privy"===e.walletClientType&&e.delegated),xU="popup-privy-oauth",xD="PRIVY_OAUTH_USE_BROADCAST_CHANNEL";class xj{async authenticate(){if(!this.api)throw new t3.a("Auth flow has no API instance");try{return await this.api.post(sf,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:this.meta.codeVerifier,provider:this.meta.provider})}catch(e){throw(0,t3.f)(e)}}async link(){if(!this.api)throw new t3.a("Auth flow has no API instance");try{return await this.api.post(sy,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:this.meta.codeVerifier,provider:this.meta.provider})}catch(e){throw(0,t3.f)(e)}}constructor({authorizationCode:e,stateCode:t,codeVerifier:r,provider:i}){this.meta={authorizationCode:e,stateCode:t,codeVerifier:r,provider:i}}}async function xL({api:e,requesterAppId:t,providerAppId:r}){let i=(await e.get(`/api/v1/apps/${t}/cross-app/connections`)).connections.find(e=>e.provider_app_id===r);if(!i)throw new t3.a("Invalid connected app");return{name:i.provider_app_name,logoUrl:i.provider_app_icon_url||void 0,apiUrl:i.provider_app_custom_api_url,readOnly:i.read_only,customAuthAuthorizeUrl:i.provider_app_custom_auth_authorize_url,customAuthTransactUrl:i.provider_app_custom_auth_transact_url}}let xB=async({user:e,address:t,client:r,request:i,requesterAppId:n,reconnect:s})=>{r.createAnalyticsEvent({eventName:"cross_app_request_started",payload:{address:t,method:i.method}});let a=e?.linkedAccounts.find(e=>"cross_app"===e.type&&(e.embeddedWallets.some(e=>e.address===t)||e.smartWallets.some(e=>e.address===t)));if(!e||!a)throw r.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Cannot request a signature with this wallet address",address:t}}),new t3.a("Cannot request a signature with this wallet address");let o=r.getProviderAccessToken(a.providerApp.id),l=await xL({api:r.api,requesterAppId:n,providerAppId:a.providerApp.id});if(!o){if(l.readOnly)throw console.error("cannot transact against a read-only provider app"),new t3.a("Cannot transact against a read-only provider app");await s({appId:a.providerApp.id,action:"link"})&&(o=r.getProviderAccessToken(a.providerApp.id))}if(!o)throw r.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Transactions require a valid token",address:t}}),new t3.a("Transactions require a valid token");let c=new URL(l.customAuthTransactUrl||`${l.apiUrl}/oauth/transact`);c.searchParams.set("token",o||""),c.searchParams.set("request",xW(i));let d=(0,n$.trigger)({location:c.href});if(!d)throw r.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Missing token",address:t}}),new t3.a("Failed to initialize signature request");return new Promise((e,n)=>{let s=setTimeout(()=>{c(),n(new t3.a("Request timeout")),r.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Request timeout",address:t}})},12e4),o=setInterval(()=>{d.closed&&(c(),n(new t3.a("User rejected request")),r.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"User rejected request",address:t}}))},300),l=s=>{s.data&&("set"===s.data.token?.action&&void 0!==s.data.token?.value?r.storeProviderAccessToken(a.providerApp.id,s.data.token.value):"clear"===s.data.token?.action&&r.storeProviderAccessToken(a.providerApp.id,null),"PRIVY_CROSS_APP_ACTION_RESPONSE"===s.data.type&&s.data.result&&(c(),e(s.data.result),r.createAnalyticsEvent({eventName:"cross_app_request_success",payload:{address:t,method:i.method}})),"PRIVY_CROSS_APP_ACTION_ERROR"===s.data.type&&s.data.error&&(c(),n(s.data.error),r.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:s.data.error,address:t}})))};window.addEventListener("message",l);let c=()=>{d.close(),clearInterval(o),clearTimeout(s),window.removeEventListener("message",l)}})},xW=e=>JSON.stringify({content:{request:{request:xF(e,nW.toHex)}},timestamp:Date.now(),callbackUrl:window.origin}),xF=(e,t)=>"bigint"==typeof e?t(e):Array.isArray(e)?e.map(e=>xF(e,t)):e&&"object"==typeof e?Object.fromEntries(Object.entries(e).map(([e,r])=>[e,xF(r,t)])):e;function xH({isCreatingWallet:e,skipSplashScreen:t}){return e?"EmbeddedWalletPasswordCreateScreen":t?"EmbeddedWalletPasswordUpdateScreen":"EmbeddedWalletPasswordUpdateSplashScreen"}function xq({walletAction:e,availableRecoveryMethods:t,legacySetWalletPasswordFlow:r,isResettingPassword:i,showAutomaticRecovery:n}){return n?"SetAutomaticRecoveryScreen":r||1===t.length?xH({isCreatingWallet:"create"===e,skipSplashScreen:i}):"RecoverySelectionScreen"}function xz(e){switch(e){case"user-passcode":return"PasswordRecoveryScreen";case"google-drive":case"icloud":return"RecoveryOAuthScreen";default:throw Error("Recovery method not supported")}}function x$(e,t,r,i,n,s,a){return{...e,funding:e?.funding?{...e.funding,fundingResult:{status:t,address:e.funding.address,fundingMethod:void 0,transactionHash:r,amount:e.funding.amount,assetType:n?s?.symbol||"ETH":a.nativeCurrency.symbol||"ETH",metadata:{walletClientType:i}}}:void 0,solanaFundingData:e?.solanaFundingData,sendTransaction:e?.sendTransaction}}let xK=new Map([["FundingMethodSelectionScreen",null],["TransferFromWalletScreen","external"],["FundingAmountEditScreen","external"],["ConnectOnlyLandingScreen","external"],["ConnectOnlyStatusScreen","external"],["AwaitingExternalEthereumTransferScreen","external"],["AwaitingEvmToSolBridgingScreen","external"],["AwaitingSolToEvmBridgingScreen","external"],["ManualTransferScreen","manual"],["MoonpayStatusScreen","moonpay"]]);function xV(e){let t=e.toLowerCase();return!!window?.webkit?.messageHandlers?.ReactNativeWebView||!!window?.ReactNativeWebView||["fbav","fban","instagram","snapchat","linkedinapp"].some(e=>t.includes(e))}async function xJ({rpc:e,address:t}){return(await e.getBalance(t,{commitment:"confirmed"}).send()).value??0n}let xZ={apple_oauth:"apple",custom_auth:"custom",discord_oauth:"discord",email:"email",farcaster:"farcaster",github_oauth:"github",google_oauth:"google",instagram_oauth:"instagram",linkedin_oauth:"linkedin",passkey:"passkey",phone:"sms",spotify_oauth:"spotify",telegram:"telegram",tiktok_oauth:"tiktok",line_oauth:"line",twitch_oauth:"twitch",twitter_oauth:"twitter",wallet:"siwe",smart_wallet:"siwe",cross_app:"privy:"},xG=e=>{if((0,tX.i)(e))return{displayName:e.replace("custom:",""),loginMethod:"custom"};let t=xZ[e];return"wallet"===e||"phone"===e?{displayName:e,loginMethod:t}:{displayName:t,loginMethod:t}},xY=(e,t)=>!(0,tX.b)(e)&&("all-users"===t||"users-without-wallets"===t&&!xQ(e).length),xQ=e=>e.linkedAccounts.filter(e=>"wallet"===e.type&&"ethereum"===e.chainType),xX=(e,t)=>!(0,tX.c)(e)&&("all-users"===t||"users-without-wallets"===t&&!x0(e).length),x0=e=>e.linkedAccounts.filter(e=>"wallet"===e.type&&"solana"===e.chainType);async function x1(e,t,r,i){let n=(0,nj.toViemTransactionSerializable)(e),{chain:s,...a}=await (async()=>i?await i():await t.prepareTransactionRequest({...n,account:{address:r,type:"json-rpc"}}))();return{...a,type:nj.STRING_TO_NUMBER_TXN_TYPE[a.type]}}let x2=({disabled:e})=>{let{migrate:t}=(()=>{let e=(0,nL.u)(),{user:t}=(0,tX.u)(),{client:r,refreshSessionAndUser:i,walletProxy:n}=(0,t3.u)();return{migrate:(0,F.useCallback)(async()=>{if("legacy-embedded-wallets-only"===e.embeddedWallets.mode)return{success:!0};if(!t)throw new t3.a("User must be authenticated before migrating wallets",t3.b.MUST_BE_AUTHENTICATED);if(!n)throw new t3.a("Cannot connect to wallet proxy");let s=await r.getAccessToken();if(!s)throw new t3.a("User must be authenticated before migrating wallets",t3.b.MUST_BE_AUTHENTICATED);let a=t.linkedAccounts.filter(e=>"wallet"===e.type&&"privy"===e.walletClientType&&(0,t5.i)(e)&&!(0,tX.d)(e));if(0===a.length)return{success:!0};let o=a.filter(e=>e.imported),l=a.filter(e=>!e.imported);if(l.length>0){let e=l.find(e=>"ethereum"===e.chainType&&0===e.walletIndex)??l.find(e=>"solana"===e.chainType&&0===e.walletIndex)??null;if(!e)throw new t3.a("Primary wallet not found");let{entropyId:t,entropyIdVerifier:r}=(0,t2.t)(e);try{await n.connect({accessToken:s,entropyId:t,entropyIdVerifier:r})}catch(i){if(!xb(i)||"privy"!==e.recoveryMethod)throw i;await n.recover({accessToken:s,entropyId:t,entropyIdVerifier:r})}await n.createDelegatedAction({accessToken:s,rootWallet:{address:e.address,chainType:e.chainType,imported:!1},delegatedWallets:l.map(e=>({address:e.address,chainType:e.chainType,walletIndex:e.walletIndex??0}))})}for(let e of o){let{entropyId:t,entropyIdVerifier:r}=(0,t2.t)(e);try{await n.connect({accessToken:s,entropyId:t,entropyIdVerifier:r})}catch(i){if(!xb(i)||"privy"!==e.recoveryMethod)throw i;await n.recover({accessToken:s,entropyId:t,entropyIdVerifier:r})}await n.createDelegatedAction({accessToken:s,rootWallet:{address:e.address,chainType:e.chainType,imported:!0},delegatedWallets:[{address:e.address,chainType:e.chainType,walletIndex:e.walletIndex??0}]})}return await i(),{success:!0}},[e.embeddedWallets.mode,t,n,r,i])}})(),{user:r}=(0,tX.u)(),{walletProxy:i}=(0,t3.u)(),n=(0,F.useRef)(!1);return(0,F.useEffect)(()=>{!e&&!n.current&&r&&i&&(n.current=!0,t().catch(e=>{console.debug("Unable to migrate wallets: ",e)}).finally(()=>{n.current=!1}))},[r,i,e,t]),null},x3=(0,s$.create)(()=>({ethereum:[]}));class x5{async authenticate(){if(!this.api)throw new t3.a("Auth flow has no API instance");try{return await this.api.post(sR,{token:this.meta.token})}catch(e){throw(0,t3.f)(e)}}async link(){if(!this.api)throw new t3.a("Auth flow has no API instance");try{return await this.api.post(sN,{token:this.meta.token})}catch(e){throw(0,t3.f)(e)}}constructor(e){this.meta={token:e}}}let x8=(0,s$.create)(()=>({jwtAuthFlowState:{status:"not-enabled"}}));function x6({customAuth:e}){let{jwtAuthFlowState:t}=function({customAuth:e}){let t=(0,sz.a)(),r=(0,F.useRef)(),i=(0,F.useCallback)(e=>(r.current=e,()=>{r.current=void 0}),[]),n=e?.getCustomAccessToken??(()=>Promise.resolve(void 0)),{state:s}=function({subscribe:e,getExternalJwt:t,enabled:r=!0,onAuthenticated:i,onUnauthenticated:n,onError:s}){let{client:a,onCustomAuthAuthenticated:o}=(0,t3.u)(),{logout:l,authenticated:c,ready:d}=(0,sF.u)();if(!a)throw new t3.a("`useSyncJwtBasedAuthState` must be used within a `PrivyProvider`");let[u,h]=(0,F.useState)({status:"initial"}),p=(0,F.useRef)(),f=(0,F.useRef)(!1),y=(0,F.useRef)(t);(0,F.useEffect)(()=>{y.current=t},[t]);let g=(0,F.useRef)(i);(0,F.useEffect)(()=>{g.current=i},[i]);let m=(0,F.useRef)(n);(0,F.useEffect)(()=>{m.current=n},[n]);let w=(0,F.useRef)(s);return(0,F.useEffect)(()=>{w.current=s},[s]),(0,F.useEffect)(()=>{if(!r||!d)return;let t=async()=>{if(!f.current){f.current=!0;try{h({status:"loading"});let e=await y.current();if(void 0!==p.current&&p.current===e)return void h({status:"done"});if(!e)return c&&(await l(),m.current?.()),p.current=e,void h({status:"done"});a.startAuthFlow(new x5(e));let{user:t,isNewUser:r=!1}=await a.authenticate();if(!t)throw new t3.a("Failed to sync with custom auth provider");g.current?.({user:t,isNewUser:r}),o(t,r),p.current=e,h({status:"done"})}catch(e){if(console.warn(e),await l().catch(()=>{}),m.current?.(),e instanceof t3.e&&e.privyErrorCode===t3.b.LINKED_TO_ANOTHER_USER)return h({status:"initial"}),void setTimeout(()=>{t()},0);w.current?.(e),h({status:"error",error:e})}finally{f.current=!1}}};return t(),e(t)},[e,a,o,c,l,r,d]),r?{state:u}:{state:{status:"not-enabled"}}}({enabled:!0===e?.enabled,subscribe:i,getExternalJwt:n,onAuthenticated:({user:e,isNewUser:r})=>{t("login","onComplete",{user:e,isNewUser:r,wasAlreadyAuthenticated:!1,loginMethod:"custom",loginAccount:null}),t("customAuth","onAuthenticated",{user:e})},onUnauthenticated:()=>{t("customAuth","onUnauthenticated")},onError:e=>{t("login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR)}});return(0,F.useEffect)(()=>{(async()=>{e&&!e.isLoading&&r.current?.()})()},[e?.enabled,e?.getCustomAccessToken,e?.isLoading]),{jwtAuthFlowState:s}}({customAuth:e});return(0,F.useEffect)(()=>{x8.setState({jwtAuthFlowState:t})},[t]),null}let x4=(0,F.createContext)(!1),x7=t=>{let r=t.client,i=t.privy,n=(0,sF.c)(),s=(0,nL.u)();(0,t1.d)((0,t1.e)(s?.appearance.walletList??[]));let[u,h]=(0,F.useState)(!1),p=T8(e=>e.inProgressMfaFlow),[f,y]=(0,F.useState)(!1),[g,m]=(0,F.useState)(null),w=x3(e=>e.ethereum),[b,v]=(0,F.useState)(void 0),[_,E]=(0,F.useState)(!1),[A,S]=(0,F.useState)(null),[I,k]=(0,F.useState)(!1),[T,x]=(0,F.useState)({status:"disconnected",connectedWallet:null,connectError:null,connector:null,connectRetry:t3.n}),[C,P]=(0,F.useState)({status:"initial"}),[O,R]=(0,F.useState)({status:"initial"}),[N,M]=(0,F.useState)({status:"initial"}),[U,D]=(0,F.useState)({status:"initial"}),[j,L]=(0,F.useState)({status:"initial"}),[B,H]=(0,F.useState)({status:"initial"}),[q,$]=(0,F.useState)(null),K=(0,nL.c)(),[V,J]=(0,F.useState)({}),[Z,G]=(0,F.useState)(null),Y=(0,F.useRef)(null),[Q,X]=(0,F.useState)(!1),[ee,et]=(0,F.useState)(!1),er=(0,F.useRef)(null),ei=(0,F.useRef)(null),en=(0,F.useRef)(sz.p),[es,ea]=(0,F.useState)(!1),[eo,el]=(0,F.useState)(!1),ec=(0,F.useCallback)(e=>{el(e),!e&&A&&T5[A]().then(e=>{e.default.isUnauthenticatedScreem&&S(null)})},[A]);r.onStoreCustomerAccessToken=e=>{e&&(0,sz.e)(en,"accessToken","onAccessTokenGranted",{accessToken:e})},r.onDeleteCustomerAccessToken=()=>{m(null),ec(!1),(0,sz.e)(en,"accessToken","onAccessTokenRemoved")};let ed=(0,F.useRef)(null),eu=(0,F.useRef)(null),eh=(0,F.useRef)(!1),ep=({showWalletUIs:e})=>eh.current?eh.current:void 0!==e?!e:!s.embeddedWallets.showWalletUIs,ef=e=>{S(e),setTimeout(()=>{h(!0)},15)};(0,F.useEffect)(()=>{if(!g)return void r.connectors?.removeEmbeddedWalletConnectors();let e=(0,tX.b)(g),n=(0,tX.e)(g),a=(0,tX.f)(g);e&&n.length||r.connectors?.removeEmbeddedWalletConnectors(),a.length||r.connectors?.removeImportedWalletConnectors(),r.connectors?q?(e&&r.connectors.addEmbeddedWalletConnectors({walletProxy:q,user:g,embeddedWallets:n,defaultChain:s.defaultChain,appId:t.appId,privyClient:i}),a.forEach(e=>r.connectors?.addImportedWalletConnector(q,e.address,s.defaultChain,t.appId))):console.debug("Failed to add embedded wallet connector: Wallet proxy not initialized"):console.debug("Failed to add embedded wallet connector: Client connectors not initialized")},[q,g]),(0,F.useEffect)(()=>{q&&Y.current?.(q)},[q]);let ey=(0,F.useCallback)((e,t)=>{m(e),E(t),ec(!0),et(!0)},[]);(0,F.useEffect)(()=>{ee&&q&&g&&(async()=>{let e=xY(g,s.embeddedWallets.ethereum.createOnLogin),t=xX(g,s.embeddedWallets.solana.createOnLogin),r=await TS();if(r){if(e&&t){let e=await q.create({accessToken:r});return await q.createSolana({accessToken:r,ethereumAddress:e?.address}),void et(!1)}if(t)return await q.createSolana({accessToken:r,ethereumAddress:(0,tX.b)(g)?.address}),await eR.refreshSessionAndUser(),void et(!1);if(e)return await q.create({accessToken:r}),void et(!1)}})().catch(console.error)},[ee&&q&&g]),(0,F.useEffect)(()=>{if(s.externalWallets.solana.connectors)return s.externalWallets.solana.connectors.onMount(),()=>s.externalWallets.solana.connectors?.onUnmount()},[s.externalWallets.solana.connectors]),(0,F.useEffect)(()=>{!f&&K&&async function(){let e,t,i,n,a,o=eg(),l=em(),c=(e=new Set,t=[],n=(i=()=>(function(e){if("undefined"==typeof window)return;let t=t=>e(t.detail);return window.addEventListener("eip6963:announceProvider",t),window.dispatchEvent(new CustomEvent("eip6963:requestProvider")),()=>window.removeEventListener("eip6963:announceProvider",t)})(r=>{t.some(({info:e})=>e.uuid===r.info.uuid)||(t=[...t,r],e.forEach(e=>e(t,{added:[r]})))}))(),{_listeners:()=>e,clear(){e.forEach(e=>e([],{removed:[...t]})),t=[]},destroy(){this.clear(),e.clear(),n?.()},findProvider:({rdns:e})=>t.find(t=>t.info.rdns===e),getProviders:()=>t,reset(){this.clear(),n?.(),n=i()},subscribe:(r,{emitImmediately:i}={})=>(e.add(r),i&&r(t,{added:t}),()=>e.delete(r))});r.initializeConnectorManager({walletConnectCloudProjectId:s.walletConnectCloudProjectId,rpcConfig:s.rpcConfig,chains:s.chains,defaultChain:s.defaultChain,store:c,walletList:s.appearance.walletList,shouldEnforceDefaultChainOnConnect:s.shouldEnforceDefaultChainOnConnect,externalWalletConfig:s.externalWallets,appName:s.name??"Privy",walletChainType:s.appearance.walletChainType,setBaseAccountSdk:v}),r.connectors?.on("connectorInitialized",()=>{a&&clearTimeout(a);let e=r.connectors.walletConnectors.length,t=r.connectors.walletConnectors.reduce((e,t)=>e+ +!!t.initialized,0);t===e?ea(!0):a=setTimeout(()=>{console.debug({message:"Unable to initialize all expected connectors before timeout",initialized:t,expected:e}),ea(!0)},1500)}),r.connectors?.initialize().then(()=>{eE()});let d=await r.getAuthenticatedUser(),u=!!d;s.legal.requireUsersAcceptTerms&&d&&!d.hasAcceptedTerms?(await r.logout(),eR.setReadyToTrue(!0),(0,sz.e)(en,"logout","onSuccess")):(s.customAuth?.enabled||(ec(!!d),d&&(0,sz.e)(en,"login","onComplete",{user:d,isNewUser:!1,wasAlreadyAuthenticated:!0,loginMethod:null,loginAccount:null}),m(d)),o?eu.current=u?"link":"login":l&&!u?(eu.current="login",J({telegramAuthModalData:{seamlessAuth:!0}}),ef("TelegramAuthScreen")):eR.setReadyToTrue(!!d))}()},[r,Z,f,K]),(0,F.useEffect)(()=>{if(f){if(!g||!g.linkedAccounts.find(e=>"wallet"===e.type&&"privy"===e.walletClientType))return void X(!!q);if([...w].some(e=>"privy"===e.walletClientType))return void X(!0);X(!!q)}},[f,g,w,q]),(0,F.useEffect)(()=>{r.connectors?.setWalletList(s.appearance.walletList)},[s.appearance.walletList.join()]);let eg=()=>{let e=function(){let e=new URLSearchParams(window.location.search),t=e.get("privy_oauth_code"),r=e.get("privy_oauth_state"),i=e.get("privy_oauth_provider");if(!t||!r||!i)return{inProgress:!1};let n=!1;try{n=!!window.opener.location.origin}catch{}return{inProgress:!0,authorizationCode:t,stateCode:r,provider:i,withPrivyUi:!t5.u.get(nL.H),popupFlow:null!==window.opener&&n,disableSignup:!!t5.u.get(nL.O)}}();return e.inProgress&&e.popupFlow?window.opener.location.origin!==window.location.origin?void window.opener.postMessage({type:"PRIVY_OAUTH_ERROR",error:"Origins between parent and child windows do not match."}):"error"===e.authorizationCode?void window.opener.postMessage({type:"PRIVY_OAUTH_ERROR",error:"Something went wrong. Try again."}):void window.opener.postMessage({type:"PRIVY_OAUTH_RESPONSE",stateCode:e.stateCode,authorizationCode:e.authorizationCode}):(e.inProgress&&e.provider.startsWith("privy:")&&!e.popupFlow&&(new BroadcastChannel(xU).postMessage({type:"PRIVY_OAUTH_RESPONSE",stateCode:e.stateCode,authorizationCode:e.authorizationCode}),window.close()),!!e.inProgress&&!!e.withPrivyUi&&(r.startAuthFlow(new TB({...e,customOAuthRedirectUrl:s.customOAuthRedirectUrl})),ef("OAuthStatusScreen"),!0))},em=()=>{let e,t=(e=function(){let e=new URLSearchParams(window.location.search),t=Number(e.get("id")||""),r=e.get("hash"),i=Number(e.get("auth_date")||""),n=e.get("first_name");if(t&&n&&i&&r)return Object.fromEntries(e.entries())}())?(T0(),{flowType:"login-url",authData:e}):(e=function(){let e=window.location.hash;if(!e||!e.startsWith("#tgWebAppData"))return;let t=TX(e.replace("#tgWebAppData=","")),{user:r,auth_date:i,hash:n}=t;return r&&i&&n?t:void 0}())?(T0(),{flowType:"web-app",authData:e}):void 0;if(!t||!s.loginMethods.telegram||!s.loginConfig.telegramAuthConfiguration?.seamlessAuthEnabled)return;let i=new TY;return r.startAuthFlow(i),"login-url"===t.flowType&&(i.meta.telegramWebAppData=void 0,i.meta.telegramAuthResult=t.authData),"web-app"===t.flowType&&(i.meta.telegramAuthResult=void 0,i.meta.telegramWebAppData=t.authData),!0},ew=async(e,t,i,n)=>{if("solana_adapter"!==e)eb(await r.connectors?.createEthereumWalletConnector({connectorType:e,walletClientType:t})||null,t,i,n);else{let e=r.connectors?.findSolanaWalletConnector(t);if(!e)return;eb(e,t,i,n)}};async function eb(e,t,r,i){if(!e)return x({status:"disconnected",connectedWallet:null,connectError:new t3.P("Unable to connect to wallet."),connector:null,connectRetry:t3.n}),i?.(null,r);x({status:"disconnected",connectedWallet:null,connectError:null,connector:e,connectRetry:t3.n}),e instanceof xy&&t&&await e.resetConnection(t),x({connector:e,status:"connecting",connectedWallet:null,connectError:null,connectRetry:()=>eb(e,t,r,i)});try{let t=await e.connect({showPrompt:!0});if((!t||(0,t1.f)(t))&&s.shouldEnforceDefaultChainOnConnect&&!s.chains.find(e=>e.id===Number(t?.chainId.replace("eip155:","")))&&("wallet_connect_v2"!==t?.connectorType||"metamask"!==t?.walletClientType)){x(t=>({...t,connector:e,status:"switching_to_supported_chain",connectedWallet:null,connectError:null,connectRetry:t3.n}));try{await t?.switchChain(s.defaultChain.id),t&&(t.chainId=(0,t1.h)((0,nW.toHex)(s.defaultChain.id)))}catch{console.warn(`Unable to switch to default chain: ${s.defaultChain.id}`)}}return x(e=>({...e,status:"connected",connectedWallet:t,connectError:null,connectRetry:t3.n})),t&&(0,sz.e)(en,"connectWallet","onSuccess",{wallet:t}),i?.(t,r)}catch(e){return e instanceof t3.c?(console.warn(e.cause?e.cause:e.message),(0,sz.e)(en,"connectWallet","onError",e.privyErrorCode||t3.b.GENERIC_CONNECT_WALLET_ERROR)):(console.warn(e),(0,sz.e)(en,"connectWallet","onError",t3.b.UNKNOWN_CONNECT_WALLET_ERROR)),x(t=>({...t,status:"disconnected",connectedWallet:null,connectError:e})),i?.(null,r)}}let ev=async(e,t,i)=>{if(null===e||!(0,t1.f)(e))return;let n=new Tq(r,e,t,i);r.startAuthFlow(n)},e_=async(e,t,i,s="plain")=>{let a=n(sF.e);if("transaction"===s&&!a)throw new t3.a("useSolanaLedger plugin hook must be mounted");if(null===e||!(0,t1.l)(e))return;let o=new Tz(e,r,t,i,s,a);r.startAuthFlow(o)},eE=async()=>{let e=new URLSearchParams(window.location.search),t=e.get("privy_connector"),i=e.get("privy_wallet_client"),n="true"===e.get("privy_connect_only");if(!t||!i)return;let s=(0,t1.n)({connectorType:t,walletClientType:i});if(!s||!s.isInstalled)return ef("LoginFailedScreen");if(!r.connectors)throw new t3.a("Connector not initialized");await ef(n?"ConnectOnlyStatusScreen":"ConnectionStatusScreen");let a=new URL(window.location.href);a.searchParams.delete("privy_connector"),a.searchParams.delete("privy_wallet_client"),a.searchParams.delete("privy_connect_only"),window.history.pushState({},"",a),ew(t,i,void 0,n?void 0:"solana_adapter"===t?e_:ev)};(0,F.useEffect)(()=>{f&&eo&&null===g&&r.getAuthenticatedUser().then(m)},[f,eo,g,r]);let eA=e=>{if(!eo)throw(0,sz.e)(en,"linkAccount","onError",t3.b.MUST_BE_AUTHENTICATED,{linkMethod:e}),new t3.a("User must be authenticated before linking an account.")},eS=()=>{x3.setState(e=>{let t=r.connectors?.wallets.filter(t1.f).map(e=>({...e,linked:(e=>{if(!eo||!g)return!1;if("privy"===e.walletClientType)return!0;for(let t of g.linkedAccounts)if("wallet"===t.type&&t.address===e.address&&"privy"!==t.walletClientType)return!0;return!1})(e),loginOrLink:async()=>{if(!await e.isConnected())throw new t3.a("Wallet is not connected");if("embedded"===e.connectorType&&"privy"===e.walletClientType)throw new t3.a("Cannot link or login with embedded wallet");(async e=>{let t;if(!r.connectors)throw new t3.a("Connector not initialized");t="ethereum"===e.type?r.connectors.findWalletConnector(e.connectorType,e.walletClientType)||null:r.connectors.findSolanaWalletConnector(e.walletClientType)||null,x(r=>({...r,connector:t,status:"connected",connectedWallet:e,connectError:null,connectRetry:t3.n})),s.captcha.enabledProvider&&!eo?(J({captchaModalData:{callback:t=>(0,t1.f)(e)?ev(e,t):e_(e,t),userIntentRequired:!1,onSuccessNavigateTo:"ConnectionStatusScreen",onErrorNavigateTo:"ErrorScreen"}}),await ef("CaptchaScreen")):((0,t1.f)(e)?await ev(e):await e_(e),await ef("ConnectionStatusScreen"))})(e)},fund:async t=>{await eR.fundWallet(e.address,t)},unlink:async()=>{if(!eo)throw new t3.a("User is not authenticated.");if("embedded"===e.connectorType&&"privy"===e.walletClientType)throw new t3.a("Cannot unlink an embedded wallet");m(await r.unlinkEthereumWallet(e.address))}}))||[];return(0,t1.j)(e.ethereum,t)?{}:{ethereum:t}})};(0,F.useEffect)(()=>{eS()},[g?.linkedAccounts,eo,f]),(0,F.useEffect)(()=>{if(f){if(!r.connectors)throw new t3.a("Connector not initialized");eS(),r.connectors.on("walletsUpdated",eS)}},[f]),(0,F.useEffect)(()=>{[...s.loginMethodsAndOrder?.primary??[],...s.loginMethodsAndOrder?.overflow??[]].filter(e=>e.startsWith("privy:")).forEach(e=>r.getCrossAppProviderDetails(e.replace("privy:","")))},[!!r]);let eI=({transaction:e,sponsor:n,uiOptions:a,fundWalletConfig:o,address:l,signOnly:c})=>new Promise(async(d,u)=>{let{requesterAppId:h}=a||{},p=c?"signTransaction":"sendTransaction",f=l?(0,tX.h)(g,l):(0,tX.b)(g);if(!f&&l){let t=(0,tX.k)(x3.getState().ethereum,l);if(t){if(n)throw new t3.a("Cannot sponsor transactions for externally connected wallet.");try{let r=await t.getEthereumProvider(),i={...e,from:l,chainId:e.chainId||Number(t.chainId.replace("eip155:","")),value:void 0!==e.value?(0,nW.toHex)(e.value):void 0},n=await r.request({method:"sendTransaction"===p?"eth_sendTransaction":"eth_signTransaction",params:[i]});return(0,sz.e)(en,p,"onSuccess",{hash:n}),void d({hash:n})}catch(e){return(0,sz.e)(en,p,"onError",t3.b.TRANSACTION_FAILURE),void u(e??new t5.P("Unable to "+p+e))}}}if(!f)return(0,sz.e)(en,p,"onError",t3.b.EMBEDDED_WALLET_NOT_FOUND),void u(new t3.a("No embedded or connected wallet found for address."));if(!eo||!g)return(0,sz.e)(en,p,"onError",t3.b.MUST_BE_AUTHENTICATED),void u(Error("User must be authenticated before signing with a Privy wallet"));let y=f.address,m=f.walletIndex??0,{entropyId:w,entropyIdVerifier:b}=(0,t2.g)(g,f),v=eN.wallets.find(e=>"privy"===e.walletClientType&&(0,nH.getAddress)(e.address)===(0,nH.getAddress)(y));if(!v)return(0,sz.e)(en,p,"onError",t3.b.EMBEDDED_WALLET_NOT_FOUND),void u(Error("Must have a Privy wallet before signing"));let _=await v.getEthereumProvider(),E=await _.request({method:"eth_chainId"}),A=e.chainId?Number(e.chainId):(0,t5.b)(E);if(!s.chains.map(e=>e.id).includes(A))throw new t3.P(`Chain ID ${A} is not supported. It must be added to the config.supportedChains property of the PrivyProvider.`,t3.b.UNSUPPORTED_CHAIN_ID);let S={...e,from:e.from??y,chainId:A},I=await TS();if(!I||!q)return(0,sz.e)(en,p,"onError",t3.b.EMBEDDED_WALLET_NOT_FOUND),void u(Error("Must have valid access token and Privy wallet to send transaction"));let k=(0,Ey.g)(S.chainId,s.chains,s.rpcConfig,{appId:t.appId}),T=(0,tX.d)(f),x=async({transactionRequest:e})=>{try{let t;if(!await eR.recoverEmbeddedWallet({address:y}))throw(0,sz.e)(en,p,"onError",t3.b.UNKNOWN_CONNECT_WALLET_ERROR),u(Error("Unable to connect to wallet")),Error("Unable to connect to wallet");if(n){let t=await (async({transactionRequest:e})=>{if(!T)throw new t3.a("Sponsoring is only supported for wallets on the TEE stack");if(c)throw new t3.a("Cannot sponsor a sign transaction request");let t=e=>null==e?void 0:(0,nW.toHex)(e),r=await (0,z.rpc)(i,async({message:e})=>await q.signWithUserSigner({accessToken:I,requesterAppId:h,message:e}),{chain_type:"ethereum",method:"eth_sendTransaction",caip2:(0,t1.h)((0,nW.toHex)(e.chainId)),sponsor:!0,params:{transaction:{from:e.from,to:e.to,chain_id:t(e.chainId),data:(0,nq.isHex)(e.data)?e.data?e.data:(0,nW.toHex)(Uint8Array.from(e.data)):void 0,value:t(e.value)}},wallet_id:f.id});if(r.data&&"hash"in r.data)return r.data.hash;throw new t5.P("Unable to sign transaction")})({transactionRequest:e});return(0,sz.e)(en,"sendTransaction","onSuccess",{hash:t}),t}if(T){let r=e=>null==e?void 0:(0,nW.toHex)(e),n=await (0,z.rpc)(i,async({message:e})=>await q.signWithUserSigner({accessToken:I,requesterAppId:h,message:e}),{chain_type:"ethereum",method:"eth_signTransaction",params:{transaction:{from:e.from,to:e.to,nonce:r(e.nonce),chain_id:r(e.chainId),data:(0,nq.isHex)(e.data)?e.data?e.data:(0,nW.toHex)(Uint8Array.from(e.data)):void 0,value:r(e.value),type:e.type,gas_limit:r(e.gasLimit??e.gas),gas_price:r(e.gasPrice??e.gas),max_fee_per_gas:r(e.maxFeePerGas),max_priority_fee_per_gas:r(e.maxPriorityFeePerGas)}},wallet_id:f.id});if(!n.data||!("signed_transaction"in n.data))throw new t5.P("Unable to sign transaction");t=n.data.signed_transaction}else t=await async function({accessToken:e,entropyId:t,entropyIdVerifier:r,transactingWalletIndex:i,walletProxy:n,transactionRequest:s,requesterAppId:a}){return(await n.rpc({entropyId:t,entropyIdVerifier:r,hdWalletIndex:i??0,chainType:"ethereum",accessToken:e,requesterAppId:a,request:{method:"eth_signTransaction",params:[s]}})).response.data}({accessToken:I,entropyId:w,entropyIdVerifier:b,transactingWalletIndex:m,walletProxy:q,transactionRequest:e,requesterAppId:h});if(c)return(0,sz.e)(en,"signTransaction","onSuccess",{signature:t}),t;{let e=await k.sendRawTransaction({serializedTransaction:t});return(0,sz.e)(en,"sendTransaction","onSuccess",{hash:e}),e}}catch(e){throw(0,sz.e)(en,p,"onError",t3.b.TRANSACTION_FAILURE),e}};if(ep({showWalletUIs:a?.showWalletUIs})){let e=c||n?S:await x1(S,k,S.from);try{let t=await x({transactionRequest:e});c?(0,sz.e)(en,"signTransaction","onSuccess",{signature:t}):(0,sz.e)(en,"sendTransaction","onSuccess",{hash:t}),d({hash:t})}catch(e){(0,sz.e)(en,p,"onError",t3.b.TRANSACTION_FAILURE),u(e)}}else{let e={connectingWalletAddress:y,recoveryMethod:f.recoveryMethod,entropyId:w,entropyIdVerifier:b,onCompleteNavigateTo:"SendTransactionScreen",isUnifiedWallet:T,onFailure:e=>{(0,sz.e)(en,p,"onError",t3.b.UNKNOWN_CONNECT_WALLET_ERROR),u(e)}},t=s.fundingConfig&&(0,t5.a)(s.fundingConfig.options).length>=1?(0,t5.p)({address:y,appConfig:s,fundWalletConfig:o,methodScreen:"FundingMethodSelectionScreen",chainIdOverride:S.chainId,comingFromSendTransactionScreen:!0}):void 0;J({connectWallet:e,sendTransaction:{transactionRequest:S,transactingWalletIndex:m,transactingWalletAddress:y,entropyId:w,entropyIdVerifier:b,signOnly:c,scanTransaction:async()=>{let e=await x1(S,k,S.from);return await r.scanTransaction({metadata:{domain:s.embeddedWallets.transactionScanning.domain},chain_id:e.chainId.toString(),request:{method:"eth_sendTransaction",params:[{from:e.from,to:e.to,value:e.value?.toString(),gas:e.gas?.toString(),gasPrice:e.gasPrice?.toString(),nonce:e.nonce?.toString(),data:e.data}]}})},getIsSponsored:async()=>!!n,onConfirm:({transactionRequest:e})=>x({transactionRequest:e}),onSuccess:e=>{c?(0,sz.e)(en,"signTransaction","onSuccess",{signature:e.hash}):(0,sz.e)(en,"sendTransaction","onSuccess",{hash:e.hash}),d(e)},onFailure:e=>{(0,sz.e)(en,p,"onError",t3.b.TRANSACTION_FAILURE),u(e)},uiOptions:a||{},fundWalletConfig:o,requesterAppId:h},funding:t}),ef("EmbeddedWalletConnectingScreen")}});function ek(){return new Promise(async(e,t)=>{let r=await TS();if(!r||!q)throw Error("Must have valid access token to enroll in MFA");try{await q.verifyMfa({accessToken:r}),e()}catch(e){t(e)}})}let eT=e=>e?.linkedAccounts.filter(e=>null!==e.latestVerifiedAt&&("wallet"!==e.type||"privy"!==e.walletClientType)).sort((e,t)=>t.latestVerifiedAt.getTime()-e.latestVerifiedAt.getTime())[0],ex=e=>{let t=g?.linkedAccounts.filter(t=>t.type===e).length??0,{displayName:r,loginMethod:i}=xG(e);if("passkey"===e&&t>=5||"passkey"!==e&&t>=1)throw(0,sz.e)(en,"linkAccount","onError",t3.b.CANNOT_LINK_MORE_OF_TYPE,{linkMethod:i}),new t3.a(`User already has an account of type ${r} linked.`)};async function eC({showAutomaticRecovery:e=!1,legacySetWalletPasswordFlow:t=!1}){S(null);let r=t?"setWalletPassword":"setWalletRecovery";if(!eo||!g)throw(0,sz.e)(en,r,"onError",t3.b.MUST_BE_AUTHENTICATED),Error("User must be authenticated before adding recovery method to Privy wallet");let i=(0,tX.g)(g);if(!i||!q)throw(0,sz.e)(en,r,"onError",t3.b.EMBEDDED_WALLET_NOT_FOUND),Error("Must have a Privy wallet to add a recovery method");let n=(0,tX.d)(i);if(n)throw(0,sz.e)(en,r,"onError",t3.b.UNSUPPORTED_WALLET_TYPE),new t3.a("User owned wallet recovery is only supported for on-device execution and this app uses TEE execution. Learn more https://docs.privy.io/recipes/tee-wallet-migration-guide");try{await ek()}catch(e){throw(0,sz.e)(en,r,"onError",t3.b.MISSING_MFA_CREDENTIALS),e}return new Promise((a,o)=>{let l="user-passcode"===i.recoveryMethod,c=xq({walletAction:"update",availableRecoveryMethods:s.embeddedWallets.userOwnedRecoveryOptions,legacySetWalletPasswordFlow:t,isResettingPassword:l,showAutomaticRecovery:e}),{entropyId:d,entropyIdVerifier:u}=(0,t2.g)(g),h={recoveryMethod:i.recoveryMethod,connectingWalletAddress:i.address,onCompleteNavigateTo:c,shouldForceMFA:!1,entropyId:d,isUnifiedWallet:n,entropyIdVerifier:u,onFailure:e=>{(0,sz.e)(en,r,"onError",t3.b.UNKNOWN_CONNECT_WALLET_ERROR),o(e)}};J({setWalletPassword:{onSuccess:e=>{(0,sz.e)(en,r,"onSuccess",{method:"user-passcode",wallet:e}),a(e)},onFailure:e=>{(0,sz.e)(en,r,"onError",t3.b.USER_EXITED_SET_PASSWORD_FLOW),o(e)},callAuthOnSuccessOnClose:!1},recoverWallet:{entropyId:d,entropyIdVerifier:u,onFailure:o},connectWallet:h,recoverySelection:{isInAccountCreateFlow:!1,isResettingPassword:l,shouldCreateEth:!1,shouldCreateSol:!1}}),ef("EmbeddedWalletConnectingScreen")})}async function eP({appId:e,action:t}){let i=await TS();if("link"===t&&!i)throw(0,sz.e)(en,"linkAccount","onError",t3.b.MUST_BE_AUTHENTICATED,{linkMethod:`privy:${e}`}),new t3.a("User must be authenticated before linking an account.");if("login"===t&&i)throw(0,sz.e)(en,"login","onError",t3.b.UNKNOWN_AUTH_ERROR),new t3.a("Attempted to log in, but user is already logged in. Use a `link` helper instead.");ed.current=`privy:${e}`,eu.current=t;let n=(0,n$.trigger)();return r.createAnalyticsEvent({eventName:"cross_app_auth_started",payload:{providerAppId:e}}),new Promise(async(i,a)=>{let{name:o,logoUrl:l}=await xL({api:r.api,providerAppId:e,requesterAppId:s.id});J({crossAppAuth:{appId:e,name:o,logoUrl:l,action:t,popup:n,onSuccess:i,onError:a}}),ef("CrossAppAuthScreen")})}let eO={ready:f,authenticated:eo,user:g,walletConnectors:r.connectors||null,connectWallet:e=>{e&&"target"in e&&e&&(e=void 0),J({externalConnectWallet:{walletList:e?.walletList&&e?.walletList.length>0?e.walletList:void 0,walletChainType:e?.walletChainType,description:e?.description,hideHeader:e?.hideHeader}}),ef("ConnectOnlyLandingScreen")},linkWallet:e=>(e&&"target"in e&&e&&(e=void 0),eA("siwe"),ed.current="siwe",eu.current="link",J({...V,externalConnectWallet:{...V.externalConnectWallet,walletList:e?.walletList,walletChainType:e?.walletChainType,description:e?.description||`Link a wallet to your ${s?.name} account`}}),ef("AuthenticateWithWalletScreen")),startCrossAppAuthFlow:eP,linkEmail:()=>{eA("email"),ex("email"),ed.current="email",eu.current="link",ef("LinkEmailScreen")},linkPhone:()=>{eA("sms"),ex("phone"),ed.current="sms",eu.current="link",ef("LinkPhoneScreen")},linkGoogle:async()=>{eA("google"),ex("google_oauth"),eu.current="link",await eR.initLoginWithOAuth("google")},linkTwitter:async()=>{eA("twitter"),ex("twitter_oauth"),eu.current="link",await eR.initLoginWithOAuth("twitter")},linkTwitch:async()=>{eA("twitch"),ex("twitch_oauth"),eu.current="link",await eR.initLoginWithOAuth("twitch")},linkDiscord:async()=>{eA("discord"),ex("discord_oauth"),eu.current="link",await eR.initLoginWithOAuth("discord")},linkGithub:async()=>{eA("github"),ex("github_oauth"),eu.current="link",await eR.initLoginWithOAuth("github")},linkSpotify:async()=>{eA("spotify"),ex("spotify_oauth"),eu.current="link",await eR.initLoginWithOAuth("spotify")},linkInstagram:async()=>{eA("instagram"),ex("instagram_oauth"),eu.current="link",await eR.initLoginWithOAuth("instagram")},linkTiktok:async()=>{eA("tiktok"),ex("tiktok_oauth"),eu.current="link",await eR.initLoginWithOAuth("tiktok")},linkLine:async()=>{eA("line"),ex("line_oauth"),eu.current="link",await eR.initLoginWithOAuth("line")},linkLinkedIn:async()=>{eA("linkedin"),ex("linkedin_oauth"),eu.current="link",await eR.initLoginWithOAuth("linkedin")},linkApple:async()=>{eA("apple"),ex("apple_oauth"),eu.current="link",await eR.initLoginWithOAuth("apple")},linkPasskey:async()=>{eA("passkey"),ex("passkey"),await eR.initLinkWithPasskey(),ef("LinkPasskeyScreen")},linkTelegram:async e=>{if(eA("telegram"),ex("telegram"),eu.current="link",ed.current="telegram",e?.launchParams)if(e.launchParams.initDataRaw){let t=new TY;r.startAuthFlow(t),t.meta.telegramAuthResult=void 0,t.meta.telegramWebAppData=TX(e.launchParams.initDataRaw),J({telegramAuthModalData:{seamlessAuth:!0}}),ef("TelegramAuthScreen")}else(0,sz.e)(en,"linkAccount","onError",t3.b.INVALID_DATA,{linkMethod:"telegram"});else await eR.initLoginWithTelegram();ef("TelegramAuthScreen")},linkFarcaster:async()=>{eA("farcaster"),ex("farcaster"),await eR.initLoginWithFarcaster(),eu.current="link",ed.current="farcaster",ef("FarcasterConnectStatusScreen")},updateEmail:()=>{if(eA("email"),!g?.email)throw new t3.a("User does not have an email linked to their account.");eu.current="update",ed.current="email",ef("UpdateEmailScreen")},updatePhone:()=>{if(eA("sms"),!g?.phone)throw new t3.a("User does not have a phone number linked to their account.");eu.current="update",ed.current="sms",ef("UpdatePhoneScreen")},login:async e=>{e&&"target"in e&&e&&(e=void 0);let t="Attempted to log in, but user is already logged in. Use a `link` helper instead.";if(!f){let e=await new Promise(e=>{G(t=>e.bind(t))});if(G(null),e)return void console.warn(t)}!g||g.isGuest?(eu.current="login",J({login:e}),ef("LandingScreen")):console.warn(t)},connectOrCreateWallet:async()=>{f||(await new Promise(e=>{G(()=>e)}),G(null)),eo?console.warn("User must be unauthenticated to `connectOrCreateWallet`"):(eu.current="connect-or-create",ef("ConnectOrCreateScreen"))},logout:async()=>{if(eu.current=null,ed.current=null,g&&r.clearProviderAcccessTokens(g),S(null),await r.logout(),g&&q)try{await q.clearMfa({userId:g.id})}catch(e){}m(null),ec(!1),R({status:"initial"}),M({status:"initial"}),P({status:"initial"}),D({status:"initial"}),L({status:"initial"}),H({status:"initial"}),(0,sz.e)(en,"logout","onSuccess"),h(!1),t5.u.del(nL.d),t5.u.del((0,nL.g)(s.id))},getAccessToken:(0,F.useCallback)(async()=>{let e=await r.getCustomerAccessToken();return e&&!eo&&ec(!0),e},[r,eo]),unlinkWallet:async e=>{let t;return m(t=e.startsWith("0x")?await r.unlinkEthereumWallet(e):await r.unlinkSolanaWallet(e)),t},unlinkEmail:async e=>{let t=await r.unlinkEmail(e);return m(t),t},unlinkPhone:async e=>{let t=await r.unlinkPhone(e);return m(t),t},unlinkGoogle:async e=>{let t=await r.unlinkOAuth("google",e);return m(t),t},unlinkTwitter:async e=>{let t=await r.unlinkOAuth("twitter",e);return m(t),t},unlinkTwitch:async e=>{let t=await r.unlinkOAuth("twitch",e);return m(t),t},unlinkDiscord:async e=>{let t=await r.unlinkOAuth("discord",e);return m(t),t},unlinkGithub:async e=>{let t=await r.unlinkOAuth("github",e);return m(t),t},unlinkSpotify:async e=>{let t=await r.unlinkOAuth("spotify",e);return m(t),t},unlinkInstagram:async e=>{let t=await r.unlinkOAuth("instagram",e);return m(t),t},unlinkTiktok:async e=>{let t=await r.unlinkOAuth("tiktok",e);return m(t),t},unlinkLine:async e=>{let t=await r.unlinkOAuth("line",e);return m(t),t},unlinkLinkedIn:async e=>{let t=await r.unlinkOAuth("linkedin",e);return m(t),t},unlinkApple:async e=>{let t=await r.unlinkOAuth("apple",e);return m(t),t},unlinkFarcaster:async e=>{let t=await r.unlinkFarcaster(e);return m(t),t},unlinkTelegram:async e=>{let t=await r.unlinkTelegram(e);return m(t),t},unlinkPasskey:async e=>{let t=await TS();if(!t)throw Error("Must have valid access token to enroll in MFA");if(!q)throw Error("Wallet proxy not initialized.");let i=s.passkeys.shouldUnenrollMfaOnUnlink;await q.unlinkPasskeyAccount({credentialId:e,accessToken:t,removeAsMfa:i});let n=await r.getAuthenticatedUser();return m(n),n},unlinkCrossAppAccount:async({subject:e})=>{let t=g?.linkedAccounts.find(t=>"cross_app"===t.type&&t.subject===e)?.providerApp;if(!t)throw new t3.a("Invalid subject");r.storeProviderAccessToken(t.id,null);let i=await r.unlinkOAuth(`privy:${t.id}`,e);return m(i),i},setWalletRecovery:async e=>eC({legacySetWalletPasswordFlow:!1,showAutomaticRecovery:e?.showAutomaticRecovery??!1}),setWalletPassword:async()=>eC({legacySetWalletPasswordFlow:!0,showAutomaticRecovery:!1}),signMessage:(e,t)=>new Promise(async(n,s)=>{let{requesterAppId:a}=t?.uiOptions||{},o=e.message,l=t?.address?(0,tX.h)(g,t.address):(0,tX.b)(g);if(!l&&void 0!==t?.address){let e=(0,tX.k)(x3.getState().ethereum,t.address);if(e)try{let t=await e.getEthereumProvider(),r=await t.request({method:"personal_sign",params:[o,e.address]});return(0,sz.e)(en,"signMessage","onSuccess",{signature:r}),void n({signature:r})}catch(e){return(0,sz.e)(en,"signMessage","onError",t3.b.UNABLE_TO_SIGN),void s(e??new t5.P("Unable to sign message"))}}if(!l)throw new t3.a("No embedded or connected wallet found for address.");if(!eo||!g)return(0,sz.e)(en,"signMessage","onError",t3.b.MUST_BE_AUTHENTICATED),void s(Error("User must be authenticated before signing with a Privy wallet"));let c=l.address,d=l.walletIndex??0,{entropyId:u,entropyIdVerifier:h}=(0,t2.g)(g,l),p=(0,tX.d)(l);if("string"!=typeof o||o.length<1)return(0,sz.e)(en,"signMessage","onError",t3.b.INVALID_MESSAGE),void s(Error("Message must be a non-empty string"));let f=async()=>{let t;if(!eo)throw Error("User must be authenticated before signing with a Privy wallet");let n=await TS();if(!q||!n||!await eR.recoverEmbeddedWallet({address:c}))throw Error("Unable to connect to wallet");if(r.createAnalyticsEvent({eventName:"embedded_wallet_sign_message_started",payload:{walletAddress:c,requesterAppId:a}}),p){let r=(0,nq.isHex)(e.message,{strict:!0}),s=await (0,z.rpc)(i,async({message:e})=>await q.signWithUserSigner({accessToken:n,requesterAppId:a,message:e}),{chain_type:"ethereum",method:"personal_sign",params:r?{message:o.slice(2),encoding:"hex"}:{message:o,encoding:"utf-8"},wallet_id:l.id});if(!s.data||!("signature"in s.data))throw new t5.P("Unable to sign message");t=s.data.signature}else{let{response:e}=await q.rpc({accessToken:n,entropyId:u,entropyIdVerifier:h,chainType:"ethereum",hdWalletIndex:d,requesterAppId:a,request:{method:"personal_sign",params:[o,c]}});t=e.data}return r.createAnalyticsEvent({eventName:"embedded_wallet_sign_message_completed",payload:{walletAddress:c,requesterAppId:a}}),t};if(ep({showWalletUIs:t?.uiOptions?.showWalletUIs}))try{let e=await f();(0,sz.e)(en,"signMessage","onSuccess",{signature:e}),n({signature:e})}catch(e){(0,sz.e)(en,"signMessage","onError",t3.b.UNABLE_TO_SIGN),s(e??new t5.P("Unable to sign message"))}else J({signMessage:{method:"personal_sign",data:o,confirmAndSign:f,onSuccess:e=>{(0,sz.e)(en,"signMessage","onSuccess",{signature:e}),n({signature:e})},onFailure:e=>{(0,sz.e)(en,"signMessage","onError",t3.b.UNABLE_TO_SIGN),s(e)},uiOptions:t?.uiOptions||{}},connectWallet:{recoveryMethod:l.recoveryMethod,connectingWalletAddress:c,entropyId:u,entropyIdVerifier:h,onCompleteNavigateTo:"SignRequestScreen",isUnifiedWallet:p,onFailure:e=>{(0,sz.e)(en,"signMessage","onError",t3.b.UNKNOWN_CONNECT_WALLET_ERROR),s(e)}}}),ef("EmbeddedWalletConnectingScreen")}),signTypedData:(e,t)=>new Promise(async(n,s)=>{let{requesterAppId:a}=t?.uiOptions||{},o=t?.address?(0,tX.h)(g,t.address):(0,tX.b)(g);if(!o&&t?.address){let r=(0,tX.k)(x3.getState().ethereum,t.address);if(r)try{let t=await r.getEthereumProvider(),i=(0,t1.m)(e),s=await t.request({method:"eth_signTypedData_v4",params:[r.address,i]});return(0,sz.e)(en,"signTypedData","onSuccess",{signature:s}),void n({signature:s})}catch(e){return(0,sz.e)(en,"signTypedData","onError",t3.b.UNABLE_TO_SIGN),void s(e??new t5.P("Unable to sign typed data "+e))}}if(!o)throw new t3.a("No embedded or connected wallet found for address.");if(!eo||!g)return(0,sz.e)(en,"signTypedData","onError",t3.b.MUST_BE_AUTHENTICATED),void s(Error("User must be authenticated before signing with a Privy wallet"));let l=o.address,c=o.walletIndex??0,{entropyId:d,entropyIdVerifier:u}=(0,t2.g)(g,o),h=(0,tX.d)(o),p=(0,t1.m)(e),f=async()=>{let e;if(!eo)throw Error("User must be authenticated before signing with a Privy wallet");let t=await TS();if(!q||!t||!await eR.recoverEmbeddedWallet({address:l}))throw Error("Unable to connect to wallet");if(r.createAnalyticsEvent({eventName:"embedded_wallet_sign_typed_data_started",payload:{walletAddress:l,requesterAppId:a}}),h){let{domain:r,types:n,primaryType:s,message:l}=p,c=await (0,z.rpc)(i,async({message:e})=>await q.signWithUserSigner({accessToken:t,requesterAppId:a,message:e}),{chain_type:"ethereum",method:"eth_signTypedData_v4",params:{typed_data:{domain:r,types:n,primary_type:s,message:l}},wallet_id:o.id});if(!c.data||!("signature"in c.data))throw new t5.P("Unable to sign message");e=c.data.signature}else{let{response:r}=await q.rpc({accessToken:t,entropyId:d,entropyIdVerifier:u,chainType:"ethereum",hdWalletIndex:c,requesterAppId:a,request:{method:"eth_signTypedData_v4",params:[l,p]}});e=r.data}return r.createAnalyticsEvent({eventName:"embedded_wallet_sign_typed_data_completed",payload:{walletAddress:l,requesterAppId:a}}),e};if(ep({showWalletUIs:t?.uiOptions?.showWalletUIs}))try{let e=await f();(0,sz.e)(en,"signTypedData","onSuccess",{signature:e}),n({signature:e})}catch(e){(0,sz.e)(en,"signTypedData","onError",t3.b.UNABLE_TO_SIGN),s(e??new t5.P("Unable to sign message"))}else J({signMessage:{method:"eth_signTypedData_v4",data:p,confirmAndSign:f,onSuccess:e=>{(0,sz.e)(en,"signTypedData","onSuccess",{signature:e}),n({signature:e})},onFailure:e=>{(0,sz.e)(en,"signTypedData","onError",t3.b.UNABLE_TO_SIGN),s(e)},uiOptions:t?.uiOptions||{}},connectWallet:{recoveryMethod:o.recoveryMethod,connectingWalletAddress:o.address,entropyId:d,isUnifiedWallet:h,entropyIdVerifier:u,onCompleteNavigateTo:"SignRequestScreen",onFailure:e=>{(0,sz.e)(en,"signMessage","onError",t3.b.UNKNOWN_CONNECT_WALLET_ERROR),s(e)}}}),ef("EmbeddedWalletConnectingScreen")}),sendTransaction:async(e,t)=>await eI({transaction:e,sponsor:t?.sponsor,uiOptions:t?.uiOptions,fundWalletConfig:t?.fundWalletConfig,address:t?.address,signOnly:!1}),signTransaction:async(e,t)=>({signature:(await eI({transaction:e,uiOptions:t?.uiOptions,address:t?.address,signOnly:!0})).hash}),exportWallet:e=>new Promise(async(i,n)=>{if(!eo||!g)return void n(Error("User must be authenticated before exporting their Privy wallet"));e&&"target"in e&&e&&(e=void 0);let s=e?.address?(0,tX.h)(g,e.address):(0,tX.b)(g);if(!s)return void n(new t3.a("User must have an embedded wallet."));let a=s.address,{entropyId:o,entropyIdVerifier:l}=(0,t2.g)(g,s),c=(0,tX.d)(s);if(!a)return void n(Error("User does not have an HD Ethereum wallet. To export an imported wallet, pass the `address` of the wallet to `exportWallet`."));if(!(0,nF.isAddress)(a))return void n(Error("Must provide a valid Ethereum address."));let d={recoveryMethod:s.recoveryMethod,connectingWalletAddress:s.address,isUnifiedWallet:c,entropyId:o,entropyIdVerifier:l,onCompleteNavigateTo:"EmbeddedWalletKeyExportScreen",onFailure:n,shouldForceMFA:!0};J(V),await TS()&&q?q?(0,t5.i)(s)?(J({keyExport:{appId:t.appId,appClientId:t.clientId,origin:r.apiUrl,address:s.address,entropyId:o,entropyIdVerifier:l,hdWalletIndex:s.walletIndex,chainType:s.chainType,walletId:s.id,isUnifiedWallet:c,imported:s.imported,onSuccess:i,onFailure:n},connectWallet:d}),ef("EmbeddedWalletConnectingScreen")):n(Error(`Export is not supported for ${s.chainType} wallets`)):n(Error("Must have a Privy wallet before exporting")):n(Error("Must have valid access token to enroll in MFA"))}),promptMfa:ek,async init(e){switch(e){case"sms":return void await r.initMfaSmsVerification();case"passkey":return await r.initMfaPasskeyVerification();case"totp":return;default:throw Error(`Unsupported MFA method: ${e}`)}},async submit(t,r){switch(t){case"totp":case"sms":if("string"!=typeof r)throw new t3.a("Invalid MFA code");er.current?.resolve({mfaMethod:t,mfaCode:r,relyingParty:window.origin}),await new Promise((e,t)=>{ei.current={resolve:e,reject:t}});break;case"passkey":let i;if("string"==typeof r)throw new t3.a("Invalid authenticator response");let n=await e.A(20190),s={id:(i=await n.startAuthentication({optionsJSON:r})).id,raw_id:i.rawId,response:{client_data_json:i.response.clientDataJSON,authenticator_data:i.response.authenticatorData,signature:i.response.signature,user_handle:i.response.userHandle},authenticator_attachment:i.authenticatorAttachment,client_extension_results:{app_id:i.clientExtensionResults.appid,cred_props:i.clientExtensionResults.credProps,hmac_create_secret:i.clientExtensionResults.hmacCreateSecret},type:i.type};er.current?.resolve({mfaMethod:t,mfaCode:s,relyingParty:window.origin}),await new Promise((e,t)=>{ei.current={resolve:e,reject:t}});break;default:throw er.current?.reject(new t3.a("Unsupported MFA method")),new t3.a(`Unsupported MFA method: ${t}`)}},cancel(){er.current?.reject(new t3.a("MFA canceled"))},async initEnrollmentWithSms(e){let t=await TS();if(!t||!q)throw Error("Must have valid access token to enroll in MFA");await q.initEnrollMfa({method:"sms",accessToken:t,phoneNumber:e.phoneNumber})},enrollInMfa:e=>new Promise((t,r)=>{e?(s.mfa.noPromptOnMfaRequired&&console.warn("[Privy Warning] Triggering the 'showMfaEnrollmentModal' function when 'noPromptOnMfaRequired' is set to true is unexpected. If this is intentional, ensure that you are building custom UIs for MFA verification."),J({mfaEnrollmentFlow:{mfaMethods:s.mfa.methods,shouldUnlinkOnUnenrollMfa:s.passkeys.shouldUnlinkOnUnenrollMfa,onSuccess:t,onFailure:r}}),ef("MfaEnrollmentFlowScreen")):(eR.closePrivyModal(),t())}),async initEnrollmentWithTotp(){let e=await TS();if(!e||!q)throw Error("Must have valid access token to enroll in MFA");let t=await q.initEnrollMfa({method:"totp",accessToken:e});return{secret:t.secret,authUrl:t.authUrl}},async submitEnrollmentWithSms(e){let t=await TS();if(!t||!q)throw Error("Must have valid access token to enroll in MFA");await q.submitEnrollMfa({method:"sms",accessToken:t,phoneNumber:e.phoneNumber,code:e.mfaCode}),m(await r.getAuthenticatedUser())},async submitEnrollmentWithTotp(e){let t=await TS();if(!t||!q)throw Error("Must have valid access token to enroll in MFA");await q.submitEnrollMfa({method:"totp",accessToken:t,code:e.mfaCode}),m(await r.getAuthenticatedUser())},async initEnrollmentWithPasskey(){},async submitEnrollmentWithPasskey({credentialIds:e},t={}){let i=await TS();if(!i||!q)throw Error("Must have valid access token to enroll in MFA");await q.submitEnrollMfa({method:"passkey",accessToken:i,credentialIds:e,removeForLogin:t.removeForLogin}),m(await r.getAuthenticatedUser())},async unenroll(e,t={}){let i=await TS();if(!i||!q)throw Error("Must have valid access token to remove MFA");"passkey"===e?await q.submitEnrollMfa({method:"passkey",accessToken:i,credentialIds:[],removeForLogin:t.removeForLogin}):await q.unenrollMfa({method:e,accessToken:i}),m(await r.getAuthenticatedUser())},requestFarcasterSignerFromWarpcast:async()=>{let e=await TS(),t=g?.linkedAccounts.find(e=>"wallet"===e.type&&"privy"===e.walletClientType);if(!e)throw Error("Must have valid access token to connect with Farcaster");if(!q||!t)throw Error("Must have an embedded wallet to use Farcaster signers");if((0,tX.d)(t))throw new t3.a("Farcaster signers are only supported for on-device execution and this app uses TEE execution. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");if(!g?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");if(!await eR.recoverEmbeddedWallet({address:t.address}))throw Error("Unable to connect to wallet");let i=await q.initFarcasterSigner({address:t.address,hdWalletIndex:null,accessToken:e,mfaCode:null,mfaMethod:null,relyingParty:window.origin});"approved"===i.status&&m(await r.getAuthenticatedUser()||g||null),J({farcasterSigner:i}),ef("FarcasterSignerStatusScreen")},getFarcasterSignerPublicKey:async()=>{let e,t=await TS(),r=g?.linkedAccounts.find(e=>"wallet"===e.type&&"privy"===e.walletClientType);if(!t)throw Error("Must have valid access token to connect with Farcaster");if(!q||!r)throw Error("Must have an embedded wallet to use Farcaster signers");if((0,tX.d)(r))throw new t3.a("Farcaster signers are only supported for on-device execution and this app uses TEE execution. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");if(!g?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");if(!await eR.recoverEmbeddedWallet({address:r.address}))throw Error("Unable to connect to wallet");if(!g.farcaster?.signerPublicKey)throw Error("Must have a Farcaster signer public key to sign");return e=g.farcaster.signerPublicKey.slice(2),Uint8Array.from(e.match(/.{1,2}/g).map(e=>parseInt(e,16)))},signFarcasterMessage:async t=>{let r=await TS(),i=g?.linkedAccounts.find(e=>"wallet"===e.type&&"privy"===e.walletClientType);if(!r)throw Error("Must have valid access token to connect with Farcaster");if(!q||!i)throw Error("Must have an embedded wallet to use Farcaster signers");if((0,tX.d)(i))throw new t3.a("Farcaster signers are only supported for on-device execution and this app uses TEE execution. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");if(!g?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");if(!await eR.recoverEmbeddedWallet({address:i.address}))throw Error("Unable to connect to wallet");if(!g.farcaster?.signerPublicKey)throw Error("Must have a Farcaster signer public key to sign");let n=await e.A(20190),s=await q.signFarcasterMessage({address:i.address,hdWalletIndex:null,accessToken:r,mfaCode:null,mfaMethod:null,payload:{hash:n.bufferToBase64URLString(t)},fid:BigInt(g.farcaster.fid),relyingParty:window.origin});return new Uint8Array(n.base64URLStringToBuffer(s.signature))},signMessageWithCrossAppWallet(e,{address:t,chainId:i}){let n=g?.linkedAccounts.some(e=>"cross_app"===e.type&&e.smartWallets.some(e=>e.address===t));return xB({user:g,client:r,address:t,requesterAppId:s.id,request:{method:n?"privy_signSmartWalletMessage":"personal_sign",params:[e,t],chainId:i},reconnect:eP})},signTypedDataWithCrossAppWallet(e,{address:t,chainId:i}){let n=g?.linkedAccounts.some(e=>"cross_app"===e.type&&e.smartWallets.some(e=>e.address===t)),a=(0,t1.m)(e);return xB({user:g,client:r,address:t,requesterAppId:s.id,request:{method:n?"privy_signSmartWalletTypedData":"eth_signTypedData_v4",params:[t,a],chainId:i},reconnect:eP})},sendTransactionWithCrossAppWallet(e,{address:t}){let i=g?.linkedAccounts.some(e=>"cross_app"===e.type&&e.smartWallets.some(e=>e.address===t));return xB({user:g,client:r,address:t,requesterAppId:s.id,request:{method:i?"privy_sendSmartWalletTx":"eth_sendTransaction",params:[e],chainId:e.chainId},reconnect:eP})},signTransactionWithCrossAppWallet(e,{address:t}){let i=g?.linkedAccounts.some(e=>"cross_app"===e.type&&e.smartWallets.some(e=>e.address===t));return xB({user:g,client:r,address:t,requesterAppId:s.id,request:{method:i?"privy_signSmartWalletTx":"eth_signTransaction",params:[e],chainId:e.chainId},reconnect:eP})},isModalOpen:u||!!p,mfaMethods:s.mfa.methods};a=eO.signMessage,o=eO.signTypedData,c=async(e,t)=>await eI({transaction:e,...t,signOnly:!1}),l=async(e,t)=>({signature:(await eI({transaction:e,...t,signOnly:!0})).hash});let eR={privy:i,setAuthenticated:ec,setUser:m,setIsNewUser:E,isNewUserThisSession:_,pendingTransaction:null,walletConnectionStatus:T,setWalletConnectionStatus:x,connectors:r.connectors?.walletConnectors??[],rpcConfig:s.rpcConfig,chains:s.chains,appId:t.appId,showFiatPrices:"native-token"!==s.embeddedWallets.priceDisplay.primary,clientAnalyticsId:r.clientAnalyticsId,onCustomAuthAuthenticated:ey,hideWalletUIs:eh,isHeadlessSigning:(0,F.useCallback)(ep,[s.embeddedWallets.showWalletUIs]),emailOtpState:O,setEmailOtpState:R,smsOtpState:N,setSmsOtpState:M,oAuthState:j,setOAuthState:L,telegramAuthState:B,setTelegramAuthState:H,siweState:U,setSiweState:D,isHeadlessOAuthLoading:I,baseAccountSdk:b,setBaseAccountSdk:v,nativeTokenSymbolForChainId:e=>s.chains.find(t=>t.id===Number(e))?.nativeCurrency.symbol,initializeWalletProxy:async e=>{if(q)return q;let t=new Promise(e=>{Y.current=e}),r=new Promise(t=>setTimeout(()=>t(null),e)),i=await Promise.race([t,r]);return Y.current=null,i},getAuthFlow:()=>r.authFlow,getAuthMeta:()=>r.authFlow?.meta,client:r,closePrivyModal:async(e={shouldCallAuthOnSuccess:!0,isSuccess:!1})=>{let i,a=f&&eo&&g;if(a&&ed.current&&(i=eT(g)),"login"===eu.current)e.shouldCallAuthOnSuccess&&a&&ed.current?(0,sz.e)(en,"login","onComplete",{user:g,isNewUser:_,wasAlreadyAuthenticated:!1,loginMethod:ed.current,loginAccount:i??null}):(0,sz.e)(en,"login","onError",t3.b.USER_EXITED_AUTH_FLOW);else if("link"===eu.current&&i)e.isSuccess&&a&&ed.current?(0,sz.e)(en,"linkAccount","onSuccess",{user:g,linkMethod:ed.current,linkedAccount:i}):ed.current&&(0,sz.e)(en,"linkAccount","onError",t3.b.USER_EXITED_LINK_FLOW,{linkMethod:ed.current});else if("update"===eu.current&&i)e.isSuccess&&a&&ed.current?(0,sz.e)(en,"update","onSuccess",{user:g,updateMethod:ed.current,updatedAccount:i}):ed.current&&(0,sz.e)(en,"update","onError",t3.b.USER_EXITED_UPDATE_FLOW,{linkMethod:ed.current});else if("connect-or-create"===eu.current){let e=x3.getState().ethereum;e[0]?(0,sz.e)(en,"connectOrCreateWallet","onSuccess",{wallet:e[0]}):(0,sz.e)(en,"connectOrCreateWallet","onError",t3.b.USER_EXITED_AUTH_FLOW)}let o=A&&xK.has(A),l="ErrorScreen"===A&&V.errorModalData&&xK.has(V.errorModalData.previousScreen);if((o||l)&&V.funding){let e,r=xK.get(A)??null;if(l&&V.funding?.onError){let e=V.errorModalData?.error,t=e?.privyErrorCode||t3.b.UNKNOWN_FUNDING_ERROR,r=new t3.a(e?.message||"Funding failed",e,t);V.funding?.onError?.(r)}if("solana"===V.funding.chainType){let t=s.solanaRpcs[V.funding.chain];if(!t)return void console.warn("Unable to load solana rpc, skipping balance");if(n(sF.S))try{e=await xJ({rpc:t.rpc,address:V.funding.address})}catch{console.error("Unable to pull wallet balance")}else console.warn("Unable to load solana plugin, skipping balance");(0,sz.e)(en,"fundSolanaWallet","onUserExited",{address:V.funding.address,fundingMethod:r,chain:V.funding.chain,balance:e})}else{let i=(0,Ey.g)(V.funding.chain.id,s.chains,s.rpcConfig,{appId:t.appId});try{e=await i.getBalance({address:V.funding.address})}catch{console.error("Unable to pull wallet balance")}(0,sz.e)(en,"fundWallet","onUserExited",{address:V.funding.address,chain:V.funding.chain,fundingMethod:r,balance:e}),function(e,t){if(e.onComplete)switch(t){case"external":e.fundingResult?e.onComplete({...e.fundingResult,fundingMethod:t}):e.onComplete({status:"cancelled",address:e.address,fundingMethod:t,amount:e.amount});break;case null:e.onComplete({status:"cancelled",address:e.address,fundingMethod:void 0,amount:e.amount});break;default:e.onComplete({status:"completed",address:e.address,fundingMethod:t,amount:e.amount})}}(V.funding,r)}}J(e=>({...e,externalConnectWallet:{}})),eu.current=null,ed.current=null,E(!1),h(!1),x({status:"disconnected",connectedWallet:null,connector:null,connectError:null,connectRetry:()=>{}}),setTimeout(()=>{r.authFlow=void 0},200)},openPrivyModal:ef,connectWallet:eb,initLoginWithWallet:async(e,t,r,i)=>{(0,t1.f)(e)?(ed.current="siwe",ev(e,t,r)):(ed.current="siws",e_(e,t,r,i))},loginWithWallet:async()=>{let e,t,i;if(!f)throw new t3.g;if(r.authFlow instanceof Tq?e="siwe":r.authFlow instanceof Tz&&(e="siws"),!e)throw new t3.a("Must initialize SIWE/SIWS flow first.");if(null!==await r.getAccessToken())try{({user:t}=await r.link()),ed.current=e}catch(t){throw(0,sz.e)(en,"linkAccount","onError",t.privyErrorCode||t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:e}),t}else try{({user:t,isNewUser:i}=await r.authenticate()),ed.current=e}catch(e){throw(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.GENERIC_CONNECT_WALLET_ERROR),e}m(t||g||null),E(i||!1),ec(!0)},delegateWallet:async({address:e,chainType:t,showDelegationUIs:r})=>new Promise(async(i,n)=>{let s=await TS();if(!eo||!g||!s)throw new t3.a("User must be authenticated and have an embedded wallet to delegate actions.");if("solana"!==t&&"ethereum"!==t)throw new t3.a("Only Solana and Ethereum embedded wallets are supported for delegation and revocation.");let a=eR.walletProxy??await eR.initializeWalletProxy(15e3);if(!a)throw new t3.a("Wallet proxy not initialized.");if((({address:e,user:t})=>!!xM(t).find(t=>t.address===e))({address:e,user:g}))return i();let o=(0,tX.h)(g,e);if(!o)throw new t3.a("Address to delegate is not associated with current user.");if((0,tX.d)(o))throw new t3.a("useDelegatedActions is only supported for on-device execution and this app uses TEE execution. Use the useSessionSigners hook to provision server side access on behalf of your users. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");let l=(({address:e,user:t})=>{let r=t.linkedAccounts.find(t=>"wallet"===t.type&&"privy"===t.walletClientType&&t.address===e);if(!r)throw new t3.a("Address to delegate is not associated with current user.");if(!(0,t5.i)(r))throw new t3.a(`useDelegatedActions is not supported for ${r.chainType} wallets. Use the useSessionSigners hook to provision server side access on behalf of your users.`);return{address:r.address,chainType:r.chainType,walletIndex:r.walletIndex??0}})({address:e,user:g}),c=(({address:e,user:t})=>{let r=t.linkedAccounts.find(t=>"wallet"===t.type&&"privy"===t.walletClientType&&t.address===e);if(!r)throw new t3.a("Address to delegate is not associated with current user.");let i=r.imported?r:(0,tX.g)(t);if(!i)throw new t3.a("Unable to determine root address for delegated address.");if(!(0,t5.i)(i))throw new t3.a(`useDelegatedActions is not supported for ${i.chainType} wallets. Use the useSessionSigners hook to provision server side access on behalf of your users.`);return{address:i.address,chainType:i.chainType,imported:i.imported}})({address:e,user:g}),d=async()=>{await a.createDelegatedAction({accessToken:s,rootWallet:c,delegatedWallets:[l]}),await eR.refreshSessionAndUser()};if(await eR.recoverEmbeddedWallet({address:e}),r)J({delegatedActions:{consent:{address:e,onDelegate:d,onSuccess:async()=>{i()},onError:async e=>{n(e)}}}}),ef("DelegatedActionsConsentScreen");else try{await d(),i()}catch(e){n(e)}}),revokeDelegatedWallets:async({showDelegationUIs:e})=>new Promise(async(t,i)=>{if(!eo||!g)throw new t3.a("User must be authenticated and have an embedded wallet to revoke a delegated wallet.");let n=xM(g);if(0===n.length)throw new t3.a("User has no delegated wallets to revoke.");if(n.some(tX.d))throw new t3.a("useDelegatedActions is only supported for on-device execution and this app uses TEE execution. Use the useSessionSigners hook to provision server side access on behalf of your users. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");let s=async()=>{await r.revokeDelegatedWallet(),await eR.refreshSessionAndUser()};if(e)J({delegatedActions:{revoke:{onRevoke:s,onSuccess:async()=>{t()},onError:async e=>{i(e)}}}}),ef("DelegatedActionsRevokeScreen");else try{await s(),t()}catch(e){i(e)}}),initLoginWithFarcaster:async(e,t)=>{let i=new TP(e,t);r.startAuthFlow(i);try{ed.current="farcaster",await i.initializeFarcasterConnect()}catch(e){throw"login"===eu.current?(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR):"link"===eu.current&&(0,sz.e)(en,"linkAccount","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR,{linkMethod:"farcaster"}),e}},loginWithFarcaster:async()=>{let e,t;if(!f)throw new t3.g;if(!(r.authFlow instanceof TP))throw new t3.a("Must initialize Farcaster flow first.");if(null!==await r.getAccessToken())try{({user:e}=await r.link()),ed.current="farcaster"}catch(e){throw(0,sz.e)(en,"linkAccount","onError",e.privyErrorCode||t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"farcaster"}),e}else try{({user:e,isNewUser:t}=await r.authenticate()),ed.current="farcaster"}catch(e){throw(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR),e}m(e||null),E(t||!1),ec(!0)},async crossAppAuthFlow({appId:e,popup:t,action:i}){let n=`privy:${e}`;ed.current=n;let{url:s,stateCode:a,codeVerifier:o}=await async function({api:e,appId:t}){let r=TD(),i=Tj(),n=await TL(r);try{let{url:s}=await e.post(sp,{provider:`privy:${t}`,redirect_to:window.location.href,code_challenge:n,state_code:i});return{url:s,stateCode:i,codeVerifier:r}}catch(e){throw(0,t3.f)(e)}}({api:r.api,appId:e});if(!s)throw r.createAnalyticsEvent({eventName:"cross_app_auth_error",payload:{error:"Unable to open cross-app auth popup",appId:e}}),new t3.a("No authorization URL returned for cross-app auth.");try{let l=await async function({url:e,popup:t}){return t.location=e,new Promise((e,r)=>{let i,n=setTimeout(()=>{r(new t3.a("Authorization request timed out after 2 minutes.")),s()},12e4);function s(){t?.close(),window.removeEventListener("message",o)}let a=setInterval(()=>{t?.closed&&!i&&(s(),clearInterval(a),clearTimeout(n),r(new t3.a("User rejected request")))},300);function o(t){t.data&&("PRIVY_OAUTH_RESPONSE"===t.data.type&&t.data.stateCode&&t.data.authorizationCode&&(clearTimeout(n),e(t.data),s()),"PRIVY_OAUTH_ERROR"===t.data.type&&(clearTimeout(n),r(new t3.a(t.data.error)),s()),t.data.type===xD&&((i=new BroadcastChannel(xU)).onmessage=o))}window.addEventListener("message",o)})}({url:s,popup:t,provider:n}),c=l.stateCode,d=l.authorizationCode;if(c!==a)throw r.createAnalyticsEvent({eventName:"possible_phishing_attempt",payload:{provider:n,storedStateCode:a??"",returnedStateCode:c??""}}),new t3.a("Unexpected auth flow. This may be a phishing attempt.",void 0,t3.b.OAUTH_UNEXPECTED);let u=await async function({appId:e,stateCode:t,codeVerifier:r,authorizationCode:i,action:n,client:s}){if(!i||!t)throw new t3.a("[Cross-App AuthFlow] Authorization and state codes code must be set prior to calling authenicate.");if("undefined"===i)throw new t3.a("User denied confirmation during cross-app auth flow");try{let a=new xj({authorizationCode:i,stateCode:t,codeVerifier:r,provider:`privy:${e}`});s.startAuthFlow(a);let o="link"===n?await s.link():await s.authenticate(),l=o.oAuthTokens?.accessToken;return console.debug(),l}catch(t){let e=(0,t3.f)(t);if(e.privyErrorCode===t3.b.ACCOUNT_TRANSFER_REQUIRED)throw e;if(e.privyErrorCode)throw new t3.a(e.message||"Invalid code during cross-app auth flow.",void 0,e.privyErrorCode);if("User denied confirmation during cross-app auth flow"===e.message)throw new t3.a("Invalid code during cross-app auth flow.",void 0,t3.b.OAUTH_USER_DENIED);throw new t3.a("Invalid code during cross-app auth flow.",void 0,t3.b.UNKNOWN_AUTH_ERROR)}}({appId:e,codeVerifier:o,stateCode:c,authorizationCode:d,action:i,client:r});u&&r.storeProviderAccessToken(e,u);let h=await eR.refreshSessionAndUser();if(!h)throw new t3.a("Unable to update user");return r.createAnalyticsEvent({eventName:"cross_app_auth_completed",payload:{providerAppId:e}}),h}catch(e){throw r.createAnalyticsEvent({eventName:"cross_app_auth_error",payload:{error:e.toString(),provider:n}}),e}},async initLoginWithOAuth(e,t,i){if(ed.current=e,!(0,t5.e)()||"google"===e&&!s.allowOAuthInEmbeddedBrowsers&&xV(window.navigator.userAgent))return void ef("InAppBrowserLoginNotPossible");"twitter"===e&&window.opener&&window.opener.postMessage({type:xD},"*"),t5.u.del(nL.H),t5.u.del(nL.O);let n=new TB({provider:e,disableSignup:!!i,withPrivyUi:!0,customOAuthRedirectUrl:s.customOAuthRedirectUrl});t&&n.addCaptchaToken(t),r.startAuthFlow(n);let a=await r.authFlow.getAuthorizationUrl();if(a&&a.url)if("twitter"===e&&nB.isAndroid&&(a.url=a.url.replace("x.com","twitter.com")),"chrome-extension:"===window.location.protocol&&TN())try{let{privyOAuthCode:e,privyOAuthState:t}=await TM(a.url);ef("OAuthStatusScreen"),n.meta.stateCode=t,n.meta.authorizationCode=e}catch(e){throw console.error("OAuth in chrome extension flow failed:",e),e}else window.location.assign(a.url)},async initLoginWithTelegram(e,t){if(!f)throw new t3.g;ed.current="telegram";let i=new TY(e,t);r.startAuthFlow(i),H({status:"loading"}),i.meta.telegramWebAppData=void 0,i.meta.telegramAuthResult=await new Promise((e,t)=>s.loginConfig.telegramAuthConfiguration?window.Telegram?void window.Telegram.Login.auth({bot_id:s.loginConfig.telegramAuthConfiguration.botId,request_access:!0},r=>r?e(r):("link"===eu.current?(0,sz.e)(en,"linkAccount","onError",t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"telegram"}):"login"===eu.current?(0,sz.e)(en,"login","onError",t3.b.INVALID_CREDENTIALS):"update"===eu.current&&(0,sz.e)(en,"login","onError",t3.b.FAILED_TO_UPDATE_ACCOUNT),t(new t3.a("Telegram auth failed or was canceled by the client")))):t(new t3.a("Telegram was not initialized")):t(new t3.a("Telegram Auth configuration is not loaded")))},async loginWithTelegram(e){let t,i;if(!(r.authFlow instanceof TY))throw new t3.a("Must initialize Telegram flow before calling loginWithTelegram");r.authFlow.meta.captchaToken||=e?.captchaToken;let n=await TS(),s=e?.intent||eu.current;if("login"===s)try{let e=await r.authenticate();t=e.user,i=e.isNewUser,ed.current="telegram"}catch(e){throw(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR),e}else{if("link"!==s)throw new t3.a("Unknown auth intent");try{t=(await r.link()).user,ed.current="telegram"}catch(e){throw(0,sz.e)(en,"linkAccount","onError",e.privyErrorCode||t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"telegram"}),e}}m(t),E(i||!1),ec(!0),H({status:"done"});let a=t?.linkedAccounts.find(({type:e})=>"telegram"===e)||null;return{user:t,isNewUser:i||!1,wasAlreadyAuthenticated:!!n,loginAccount:a}},async loginWithOAuth(e){let t,i,n;if(!(r.authFlow instanceof TB))throw new t3.a("Must initialize OAuth flow before calling loginWithOAuth");let s=t5.u.get(nL.S),a=r.authFlow.meta.stateCode;if(s!==a)throw r.createAnalyticsEvent({eventName:"possible_phishing_attempt",payload:{provider:e,storedStateCode:s??"",returnedStateCode:a??""}}),new t3.a("Unexpected auth flow. This may be a phishing attempt.",void 0,t3.b.OAUTH_UNEXPECTED);if(null!==await r.getAccessToken())try{let i=await r.link();t=i.user,n=i.oAuthTokens,ed.current=e}catch(t){throw(0,sz.e)(en,"linkAccount","onError",t.privyErrorCode||t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:e}),t}else try{let s=await r.authenticate();t=s.user,i=s.isNewUser,n=s.oAuthTokens,ed.current=e}catch(t){throw"login"===eu.current?(0,sz.e)(en,"login","onError",t.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR):"link"===eu.current&&(0,sz.e)(en,"linkAccount","onError",t.privyErrorCode||t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:e}),t}return m(t),E(i||!1),ec(!0),n&&t&&(0,sz.e)(en,"oAuthAuthorization","onOAuthTokenGrant",{oAuthTokens:n,user:t}),n},passkeyAuthState:C,setPasskeyAuthState:P,async initSignupWithPasskey({captchaToken:e,withPrivyUi:t}){let i=new TF({captchaToken:e,setPasskeyAuthState:P,hints:s.passkeys.registration?.hints});r.startAuthFlow(i),eu.current="login";try{ed.current="passkey",P({status:"generating-challenge"}),await i.initRegisterFlow(t),P({status:"awaiting-passkey"})}catch(e){throw P({status:"error",error:e}),(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR),e}},async signupWithPasskey(){let e,t;if(!f)throw new t3.g;if(!(r.authFlow instanceof TF))throw new t3.a("Must initialize Passkey flow first.");if("passkey"!==ed.current){let e=new t3.a("Must init login with Passkey flow first.");throw P({status:"error",error:e}),e}let i=await TS();try{ed.current="passkey",P({status:"awaiting-passkey"}),{user:e,isNewUser:t}=await r.authenticate()}catch(e){throw P({status:"error",error:e}),(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR),e}m(e),E(t||!1),ec(!0),P({status:"done"});let n=e?.linkedAccounts.find(({type:e})=>"passkey"===e)||null;return{user:e,isNewUser:t||!1,wasAlreadyAuthenticated:!!i,loginAccount:n}},async initLoginWithPasskey({captchaToken:e,withPrivyUi:t}){let i=new TF({captchaToken:e,setPasskeyAuthState:P,hints:void 0});r.startAuthFlow(i),eu.current="login";try{ed.current="passkey",P({status:"generating-challenge"}),await i.initAuthenticationFlow(t),P({status:"awaiting-passkey"})}catch(e){throw P({status:"error",error:e}),(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR),e}},async loginWithPasskey(e){let t,i;if(!f)throw new t3.g;if(!(r.authFlow instanceof TF))throw new t3.a("Must initialize Passkey flow first.");if(e?.credentialIds&&(r.authFlow.meta.allowedCredentialsIds=e.credentialIds),"passkey"!==ed.current){let e=new t3.a("Must init login with Passkey flow first.");throw P({status:"error",error:e}),e}let n=await TS();try{ed.current="passkey",P({status:"awaiting-passkey"}),{user:t,isNewUser:i}=await r.authenticate()}catch(e){throw P({status:"error",error:e}),(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR),e}m(t),E(i||!1),ec(!0),P({status:"done"});let s=t?.linkedAccounts.find(({type:e})=>"passkey"===e)||null;return{user:t,isNewUser:i||!1,wasAlreadyAuthenticated:!!n,loginAccount:s}},async initLinkWithPasskey(e){let t=new TF({captchaToken:e,hints:s.passkeys.registration?.hints});r.startAuthFlow(t),eu.current="link",ed.current="passkey",P({status:"generating-challenge"});try{await t.initLinkFlow(),P({status:"awaiting-passkey"})}catch(e){throw(0,sz.e)(en,"linkAccount","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR,{linkMethod:"passkey"}),P({status:"error",error:e}),e}},async linkWithPasskey(){let e;if(!f)throw new t3.g;if(!(r.authFlow instanceof TF))throw new t3.a("Must initialize Passkey flow first.");if("passkey"!==ed.current)throw new t3.a("Must init login with Passkey flow first.");try{ed.current="passkey",{user:e}=await r.link()}catch(e){throw(0,sz.e)(en,"linkAccount","onError",e.privyErrorCode||t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"passkey"}),e}return m(e||g||null),P({status:"done"}),e},async initLoginWithHeadlessOAuth(e,t,i){if(!(0,t5.e)()||"google"===e&&!s.allowOAuthInEmbeddedBrowsers&&xV(window.navigator.userAgent))throw Error("It looks like you're using an in-app browser.  To log in, please try again using an external browser.");let n=new TB({provider:e,withPrivyUi:!1,disableSignup:i??!1,customOAuthRedirectUrl:s.customOAuthRedirectUrl});t&&n.addCaptchaToken(t),L({status:"loading"});let a=await r.startAuthFlow(n).getAuthorizationUrl();if(a?.url)if("chrome-extension:"===window.location.protocol&&TN())try{let{privyOAuthCode:e,privyOAuthState:t}=await TM(a.url);n.meta.stateCode=t,n.meta.authorizationCode=e,await this.loginWithHeadlessOAuth(n.meta)}catch(e){throw L({status:"error",error:e}),e}else window.location.assign(a.url)},async loginWithHeadlessOAuth(e){let t,i,n;k(!0),L({status:"loading"}),r.startAuthFlow(new TB({...e,customOAuthRedirectUrl:s.customOAuthRedirectUrl}));let a=t5.u.get(nL.S),o=e.stateCode;if(a!==o)throw r.createAnalyticsEvent({eventName:"possible_phishing_attempt",payload:{provider:e.provider,storedStateCode:a??"",returnedStateCode:o??""}}),k(!1),new t3.a("Unexpected auth flow. This may be a phishing attempt.",void 0,t3.b.OAUTH_UNEXPECTED);if(null!==await r.getAccessToken())try{({user:t,oAuthTokens:n}=await r.link()),ed.current=e.provider;let i=eT(t);t&&i&&(0,sz.e)(en,"linkAccount","onSuccess",{user:t,linkMethod:ed.current,linkedAccount:i})}catch(t){throw k(!1),(0,sz.e)(en,"linkAccount","onError",t.privyErrorCode||t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:e.provider}),t}else try{({user:t,isNewUser:i,oAuthTokens:n}=await r.authenticate()),ed.current=e.provider;let s=eT(t);t&&s&&void 0!==i&&(0,sz.e)(en,"login","onComplete",{user:t,isNewUser:i,wasAlreadyAuthenticated:!1,loginMethod:ed.current,loginAccount:s})}catch(e){throw k(!1),L({status:"error",error:e}),(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR),e}return m(t),E(i||!1),ec(!0),k(!1),L({status:"done"}),n&&t&&(0,sz.e)(en,"oAuthAuthorization","onOAuthTokenGrant",{oAuthTokens:n,user:t}),t??void 0},initLoginWithEmail:async({email:e,captchaToken:t,disableSignup:i,withPrivyUi:n})=>{let s=new TT({email:e,captchaToken:t,disableSignup:i});r.startAuthFlow(s);try{ed.current="email",R({status:"sending-code"});let e=await s.sendCodeEmail({withPrivyUi:n});if(e?.ssoRedirectUrl)return window.location.href=e.ssoRedirectUrl,void await (0,t1.k)(1e4);R({status:"awaiting-code-input"})}catch(e){throw R({status:"error",error:e}),"login"===eu.current?(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR):"link"===eu.current&&(0,sz.e)(en,"linkAccount","onError",e.privyErrorCode||t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"email"}),e}},initUpdateEmail:async({oldAddress:e,newAddress:t,captchaToken:i})=>{let n=new Tx(e,t,i);r.startAuthFlow(n);try{await n.sendCodeEmail({withPrivyUi:!0})}catch(e){throw(0,sz.e)(en,"update","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR,{linkMethod:ed.current}),e}},initUpdatePhone:async(e,t,i)=>{let n=new TK(e,t,i);r.startAuthFlow(n);try{await n.sendSmsCode({withPrivyUi:!0})}catch(e){(0,sz.e)(en,"update","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR,{linkMethod:ed.current})}},initLoginWithSms:async({phoneNumber:e,captchaToken:t,disableSignup:i,withPrivyUi:n})=>{M({status:"sending-code"});let s=new T$({phoneNumber:e,captchaToken:t,disableSignup:i});r.startAuthFlow(s);try{ed.current="sms",await s.sendSmsCode({withPrivyUi:n}),M({status:"awaiting-code-input"})}catch(e){throw M({status:"error",error:e}),"login"===eu.current?(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR):"link"===eu.current&&(0,sz.e)(en,"linkAccount","onError",e.privyErrorCode||t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"sms"}),e}},resendEmailCode:async()=>{await r.authFlow?.sendCodeEmail({withPrivyUi:!0})},resendSmsCode:async()=>{await r.authFlow?.sendSmsCode({withPrivyUi:!0})},loginWithCode:async e=>{let t,i;function n(e){r.authFlow instanceof TT?R(e):r.authFlow instanceof T$&&M(e)}if(n({status:"submitting-code"}),!f){let e=new t3.g;throw n({status:"error",error:e}),e}if(r.authFlow instanceof TT)r.authFlow.meta.emailCode=e.trim();else{if(!(r.authFlow instanceof T$)){let e=new t3.a("Must initialize a passwordless code flow first");throw n({status:"error",error:e}),e}r.authFlow.meta.smsCode=e.trim()}let s=await TS();if("link"===eu.current)try{({user:t}=await r.link())}catch(e){throw n({status:"error",error:e}),(0,sz.e)(en,"linkAccount","onError",e.privyErrorCode||t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:ed.current}),e}else if("update"===eu.current)try{({user:t}=await r.link())}catch(e){throw n({status:"error",error:e}),(0,sz.e)(en,"update","onError",e.privyErrorCode||t3.b.FAILED_TO_UPDATE_ACCOUNT,{linkMethod:ed.current}),e}else try{({user:t,isNewUser:i}=await r.authenticate())}catch(e){throw n({status:"error",error:e}),(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR),e}let a=t||g;m(a||null),E(i||!1),ec(!0),n({status:"done"});let o=null;return r.authFlow instanceof TT?o=a?.linkedAccounts.find(({type:e})=>"email"===e)||null:r.authFlow instanceof T$&&(o=a?.linkedAccounts.find(({type:e})=>"phone"===e)||null),{user:a,isNewUser:i||!1,wasAlreadyAuthenticated:!!s,linkedAccount:o}},generateSiweMessage:async({address:e,chainId:t,captchaToken:i})=>{eu.current=eo?"link":"login",ed.current="siwe",D({status:"generating-message"});let n=await r.generateSiweNonce({address:e,captchaToken:i});return D({status:"awaiting-signature"}),TH({address:e,chainId:t.replace("eip155:",""),nonce:n})},generateSiweMessageForSmartWallet:async({address:e,chainId:t})=>{let i=await r.generateSiweNonce({address:e});return TH({address:e,chainId:t.replace("eip155:",""),nonce:i})},linkSmartWallet:async({message:e,signature:t,smartWalletType:i,smartWalletVersion:n})=>{let s;s=await r.linkSmartWallet({message:e,signature:t,smartWalletType:i,smartWalletVersion:n}),m((s=await eR.refreshSessionAndUser()??s)||g||null)},loginWithSiwe:async({message:e,signature:t,captchaToken:i,disableSignup:n,walletClientType:s,connectorType:a})=>{let o,l=null;try{if(g)throw Error("User already authenticated");let c=new Tq(r,void 0,i,n,{message:e,signature:t,walletClientType:s,connectorType:a});r.startAuthFlow(c),ed.current="siwe",eu.current="login",D({status:"submitting-signature"});let d=await r.authenticate();if({user:l,isNewUser:o}=d,!l)throw Error("Authentication failed - no user returned")}catch(e){throw(0,sz.e)(en,"login","onError",e.privyErrorCode||t3.b.UNKNOWN_AUTH_ERROR),D({status:"error",error:e}),e}return m(l),E(o||!1),ec(!0),D({status:"done"}),eu.current=null,ed.current=null,{user:l,isNewUser:o||!1}},linkWithSiwe:async({message:e,signature:t,chainId:i,walletClientType:n,connectorType:s})=>{let a;eA("siwe");let o=null;try{D({status:"submitting-signature"}),a=await r.linkWithSiwe({message:e,signature:t,chainId:i,walletClientType:n,connectorType:s}),a=await eR.refreshSessionAndUser()??a,D({status:"done"}),(o=eT(a)||null)&&(0,sz.e)(en,"linkAccount","onSuccess",{user:a,linkMethod:"siwe",linkedAccount:o})}catch(e){throw(0,sz.e)(en,"linkAccount","onError",e.privyErrorCode||t3.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"siwe"}),eu.current=null,ed.current=null,D({status:"error",error:e}),e}let l=a||g;return m(l||null),eu.current=null,ed.current=null,{user:l,linkedAccount:o}},refreshSessionAndUser:async()=>{let e=await r.getAuthenticatedUser();return ec(!!e),m(e),e},walletProxy:q,createAnalyticsEvent:({eventName:e,payload:t,timestamp:i})=>r.createAnalyticsEvent({eventName:e,payload:t,timestamp:i}),acceptTerms:async()=>{let e=await r.acceptTerms();return m(e),e},getUsdTokenPrice:e=>r.getUsdTokenPrice(e),getUsdPriceForSol:()=>r.getUsdPriceForSol(),getSplTokenMetadata:e=>r.getSplTokenMetadata(e),recoverEmbeddedWallet:async e=>new Promise(async(t,i)=>{if(!g)return void t(!0);let n=e?.address?(0,tX.h)(g,e.address):(0,tX.g)(g)||(0,tX.f)(g).at(0)||(0,tX.j)(g).at(0);if(!n||(0,tX.d)(n))return void t(!0);let s=await TS();if(!s||!q||!n)return void i(Error("Must have valid access token and Privy wallet to recover wallet"));let{entropyId:a,entropyIdVerifier:o}=(0,t2.g)(g,n);try{await q.connect({accessToken:s,entropyId:a,entropyIdVerifier:o}),t(!0)}catch(e){if(xb(e)&&"privy"===n.recoveryMethod){let e;r.createAnalyticsEvent({eventName:"embedded_wallet_pinless_recovery_started",payload:{walletAddress:n.address}});try{e=await q.recover({entropyId:a,entropyIdVerifier:o,accessToken:s})}catch(e){return void i(e)}e.entropyId||i(Error("Unable to recover wallet")),r.createAnalyticsEvent({eventName:"embedded_wallet_recovery_completed",payload:{walletAddress:n.address}}),t(!0)}else xb(e)&&"privy"!==n.recoveryMethod&&"privy-v2"!==n.recoveryMethod?(J({recoverWallet:{entropyId:a,entropyIdVerifier:o,onFailure:i,onSuccess:()=>t(!0)},recoveryOAuthStatus:{provider:n.recoveryMethod,action:"recover",shouldCreateEth:!1,shouldCreateSol:!1}}),ef(xz(n.recoveryMethod))):i(e)}}),setReadyToTrue:e=>{y(!0),Z?.(e)},updateWallets:()=>eS(),fundWallet:async(e,t)=>{let r="FundingMethodSelectionScreen";return new Promise((i,n)=>{J({funding:{...(0,t5.p)({address:e,appConfig:s,fundWalletConfig:t,methodScreen:r,onComplete:i,onError:n})}}),ef(r)})},openModal:ef,requestFarcasterSignerStatus:async e=>{let t=await TS(),i=g?.linkedAccounts.find(e=>"wallet"===e.type&&"privy"===e.walletClientType);if(!t)throw Error("Must have valid access token to connect with Farcaster");if(!q||!i)throw Error("Must have an embedded wallet to use Farcaster signers");if(!g?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");let n=await r.requestFarcasterSignerStatus(e);return"approved"===n.status&&m(await r.getAuthenticatedUser()||g||null),n},connectCoinbaseSmartWallet:async()=>{s.externalWallets.coinbaseWallet.config.preference={...s.externalWallets.coinbaseWallet.config.preference,options:"smartWalletOnly"};let e=r.connectors?.findWalletConnector("coinbase_wallet","coinbase_smart_wallet")||r.connectors?.findWalletConnector("coinbase_wallet","coinbase_wallet");if(e)return e.updateConnectionPreference("smartWalletOnly"),eb(e);await ew("coinbase_wallet","coinbase_smart_wallet")},connectBaseAccount:async()=>{let e=r.connectors?.findWalletConnector("base_account","base_account");if(e)return eb(e);await ew("base_account","base_account")},initiateAccountTransfer:async({nonce:e,account:t,accountType:i,externalWalletMetadata:n,telegramAuthResult:s,telegramWebAppData:a,farcasterEmbeddedAddress:o,oAuthUserInfo:l})=>{let c=await r.sendAccountTransferRequest({nonce:e,account:t,accountType:i,externalWalletMetadata:n,telegramAuthResult:s,telegramWebAppData:a,farcasterEmbeddedAddress:o,oAuthUserInfo:l});return m(c),c},inProgressAuthFlowRef:eu,inProgressLoginOrLinkMethodRef:ed};d=eR.recoverEmbeddedWallet,eR.recoverEmbeddedWallet;let eN=(0,F.useMemo)(()=>({wallets:w,ready:Q&&es}),[w,Q,es]),eM=r.authFlow instanceof TY,{siteKey:eU,enabledProvider:eD}=s.captcha,ej=!s.headless&&eD&&!eo&&(f||eM);return(0,W.jsx)(x4.Provider,{value:!0,children:(0,W.jsx)(tX.P.Provider,{value:eO,children:(0,W.jsx)(sz.P.Provider,{value:en,children:(0,W.jsx)(t2.U.Provider,{value:eN,children:(0,W.jsx)(TZ,{appId:s.id,captchaSiteKey:eU,enabledCaptchaProvider:eD,children:(0,W.jsxs)(t3.I.Provider,{value:eR,children:[(0,W.jsx)(t1.R,{children:(0,W.jsxs)(tX.M,{data:V,setModalData:J,setInitialScreen:S,initialScreen:A,authenticated:eo,open:u,children:[t.children,(0,W.jsx)(x6,{customAuth:s.customAuth}),ej&&(0,W.jsx)(T3,{delayedExecution:!1}),(0,W.jsx)(xf,{}),(0,W.jsx)(x2,{disabled:s.embeddedWallets.disableAutomaticMigration}),(0,W.jsx)(T6,{palette:s.appearance.palette||{}}),!s.render.standalone&&(0,W.jsx)(xc,{open:u})]})}),(0,W.jsx)(xN,{appId:t.appId,appClientId:t.clientId,clientAnalyticsId:r.clientAnalyticsId,origin:r.apiUrl,mfaMethods:g?.mfaMethods,mfaPromise:er,mfaSubmitPromise:ei,onLoad:$,onLoadFailed:()=>null}),s.loginConfig.telegramAuthConfiguration&&(0,W.jsx)(t1.H,{$if:!0,children:(0,W.jsx)(xp,{scriptHost:t.apiUrl||nL.D,botUsername:s.loginConfig.telegramAuthConfiguration.botName})})]})})})})})})};class x9 extends Error{constructor(e,t,r){super(e),this.code=t,this.data=r}}class Ce extends t0.default{async handleSendTransaction(e){let t;if(!e.params||!Array.isArray(e.params))throw new x9(`Invalid params for ${e.method}`,4200);let r=e.params[0];if(!await TS()||!this.address)throw new x9("Disconnected",4900);let{hash:i}=await (t={address:this.address},c(r,t));return i}async handleSignTransaction(e){let t;if(!e.params||!Array.isArray(e.params))throw new x9(`Invalid params for ${e.method}`,4200);let r=e.params[0];if(!await TS()||!this.address)throw new x9("Disconnected",4900);let{signature:i}=await (t={address:this.address},l(r,t));return i}handleSwitchEthereumChain(e){let t;if(!e.params||!Array.isArray(e.params))throw new x9(`Invalid params for ${e.method}`,4200);if("string"==typeof e.params[0])t=e.params[0];else{if(!("chainId"in e.params[0])||"string"!=typeof e.params[0].chainId)throw new x9(`Invalid params for ${e.method}`,4200);t=e.params[0].chainId}this.chainId=Number(t),this.publicClient=(0,Ey.g)(this.chainId,this.chains,this.rpcConfig,{appId:this.appId}),this.emit("chainChanged",t)}async handlePersonalSign(e){if(!e.params||!Array.isArray(e.params))throw Error("Invalid params for personal_sign");let t=e.params[0],r=e.params[1],{signature:i}=await a({message:t},{address:r});return i}async handleSignedTypedData(e){let t;if(!e.params||!Array.isArray(e.params))throw Error("Invalid params for eth_signTypedData_v4");let r=e.params[0],i="string"==typeof e.params[1]?JSON.parse(e.params[1]):e.params[1],{signature:n}=await (t=(0,t1.m)(i),o(t,{address:r}));return n}async handleEstimateGas(e){if(!e.params||!Array.isArray(e.params))throw Error("Invalid params for eth_estimateGas");delete e.params[0].gasPrice,delete e.params[0].maxFeePerGas,delete e.params[0].maxPriorityFeePerGas;let t={...e.params[0],chainId:(0,t1.t)(this.chainId)};return await this.publicClient.estimateGas({account:t.from??this.address,...(0,nj.toViemTransactionSerializable)(t)})}async request(e){let t;switch(console.debug("Embedded1193Provider.request() called with args",e),e.method){case"eth_accounts":case"eth_requestAccounts":return this.address?[this.address]:[];case"eth_chainId":return(0,t1.t)(this.chainId);case"eth_estimateGas":return this.handleEstimateGas(e);case"eth_sendTransaction":return this.handleSendTransaction(e);case"eth_signTransaction":return this.handleSignTransaction(e);case"wallet_switchEthereumChain":return this.handleSwitchEthereumChain(e);case"personal_sign":return this.handlePersonalSign(e);case"eth_signTypedData_v4":return this.handleSignedTypedData(e)}if(t=e.method,!TI.includes(t))return this.publicClient.request({method:e.method,params:e.params});{let t,r=await TS();if(await (t={address:this.address},d(t)),!r||!this.address)throw new x9("Disconnected",4900);try{let t={method:e.method,params:e.params},i=this.walletAccount;return i&&(0,tX.d)(i)?this.handleWalletApiRequest(t,i,r):(await this.walletProxy.rpc({accessToken:r,entropyId:this.entropyId,entropyIdVerifier:this.entropyIdVerifier,chainType:"ethereum",hdWalletIndex:this.walletIndex,request:t})).response.data}catch(e){throw console.error(e),new x9("Disconnected",4900)}}}async handleWalletApiRequest(e,t,r){let i=this.privyClient;if(!i)throw new x9("Disconnected",4900);if("secp256k1_sign"===e.method){let n=await (0,z.rpc)(i,async({message:e})=>this.walletProxy.signWithUserSigner({accessToken:r,message:e}),{chain_type:"ethereum",method:"secp256k1_sign",wallet_id:t.id,params:{hash:e.params[0]}});if("secp256k1_sign"!==n.method)throw new x9(`Invalid params for ${e.method}`,4200);return n.data.signature}throw new x9(`Method not supported: ${e.method}`,4200)}constructor({walletProxy:e,address:t,entropyId:r,entropyIdVerifier:i,rpcConfig:n,chains:s,appId:a,chainId:o=1,walletIndex:l,privyClient:c,walletAccount:d}){super(),this.walletProxy=e,this.address=t,this.entropyId=r,this.entropyIdVerifier=i,this.chainId=o,this.rpcConfig=n,this.chains=s,this.publicClient=(0,Ey.g)(o,this.chains,n,{appId:a}),this.rpcTimeoutDuration=(0,t1.c)(n,"privy"),this.appId=a,this.walletIndex=l,this.privyClient=c,this.walletAccount=d}}let Ct=({style:e,...t})=>(0,W.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",style:{...e},...t,children:(0,W.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"})}),Cr=({style:e,...t})=>(0,W.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"108",height:"108",viewBox:"0 0 108 108",fill:"none",style:{height:"28px",width:"28px",...e},...t,children:[(0,W.jsx)("rect",{width:"108",height:"108",rx:"23",fill:"#AB9FF2"}),(0,W.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M46.5267 69.9229C42.0054 76.8509 34.4292 85.6182 24.348 85.6182C19.5824 85.6182 15 83.6563 15 75.1342C15 53.4305 44.6326 19.8327 72.1268 19.8327C87.768 19.8327 94 30.6846 94 43.0079C94 58.8258 83.7355 76.9122 73.5321 76.9122C70.2939 76.9122 68.7053 75.1342 68.7053 72.314C68.7053 71.5783 68.8275 70.7812 69.0719 69.9229C65.5893 75.8699 58.8685 81.3878 52.5754 81.3878C47.993 81.3878 45.6713 78.5063 45.6713 74.4598C45.6713 72.9884 45.9768 71.4556 46.5267 69.9229ZM83.6761 42.5794C83.6761 46.1704 81.5575 47.9658 79.1875 47.9658C76.7816 47.9658 74.6989 46.1704 74.6989 42.5794C74.6989 38.9885 76.7816 37.1931 79.1875 37.1931C81.5575 37.1931 83.6761 38.9885 83.6761 42.5794ZM70.2103 42.5795C70.2103 46.1704 68.0916 47.9658 65.7216 47.9658C63.3157 47.9658 61.233 46.1704 61.233 42.5795C61.233 38.9885 63.3157 37.1931 65.7216 37.1931C68.0916 37.1931 70.2103 38.9885 70.2103 42.5795Z",fill:"#FFFDF8"})]});function Ci(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw TypeError("attempted to use private field on non-instance");return e}var Cn=0;class Cs extends t1.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(e){return e.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}get walletBranding(){return{name:this.providerDetail.info.name,icon:this.providerDetail.info.icon,id:this.providerDetail.info.rdns}}disconnect(){console.warn(`Programmatic disconnect with ${this.providerDetail.info.name} is not yet supported.`)}async promptConnection(){try{let e=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!e||0===e.length||!e[0])throw new t3.P("Unable to retrieve accounts");await this.syncAccounts([e[0]])}catch(e){throw(0,t5.f)(e)}}constructor(e,t,r,i,n){super(n||"unknown",e,t,r),this.connectorType="injected",this.proxyProvider=new t1.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.providerDetail=i;let s=i.provider;this.proxyProvider.setWalletProvider(s)}}var Ca="__private_"+Cn+++"__walletBranding";class Co extends t1.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(e){return e.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}get walletBranding(){return Ci(this,Ca)[Ca]??{name:"Browser Extension",icon:Ct,id:"extension"}}disconnect(){console.warn("Programmatic disconnect with browser wallets is not yet supported.")}async promptConnection(){try{let e=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!e||0===e.length||!e[0])throw new t3.P("Unable to retrieve accounts");await this.syncAccounts([e[0]])}catch(e){throw(0,t5.f)(e)}}constructor(e,t,r,i,n){super(n??"unknown",e,t,r),Object.defineProperty(this,Ca,{writable:!0,value:void 0}),this.connectorType="injected",this.proxyProvider=new t1.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.proxyProvider.setWalletProvider(i),"metamask"===n?Ci(this,Ca)[Ca]={name:"MetaMask",icon:t1.M,id:"io.metamask"}:"phantom"===n&&(Ci(this,Ca)[Ca]={name:"Phantom",icon:Cr,id:"phantom"})}}class Cl extends Cs{disconnect(){console.warn("MetaMask does not support programmatic disconnect.")}async promptConnection(){try{nB.isMobile||await this.proxyProvider.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]});let e=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!e||0===e.length||!e[0])throw new t3.P("Unable to retrieve accounts");await this.syncAccounts([e[0]])}catch(e){throw(0,t5.f)(e)}}}class Cc extends t0.default{get wallets(){let e=new Set;return this.walletConnectors.flatMap(e=>e.wallets).sort((e,t)=>e.connectedAt&&t.connectedAt?t.connectedAt-e.connectedAt:0).filter(t=>{let r=`${t.address}${t.walletClientType}${t.connectorType}${t.meta.id}`;return!e.has(r)&&(e.add(r),!0)})}async initialize(e){if(this.initialized&&!e||(e&&this.removeAllConnectors(),this.externalWalletConfig.disableAllExternalWallets))return;let t=(0,t1.o)({store:this.store,walletList:this.walletList,externalWalletConfig:this.externalWalletConfig,walletChainType:this.walletChainType}).then(e=>{e.forEach(({type:e,eip6963InjectedProvider:t,legacyInjectedProvider:r})=>{this.createEthereumWalletConnector({connectorType:"injected",walletClientType:e,providers:{eip6963InjectedProvider:t,legacyInjectedProvider:r}})})});for(let e of(this.walletList.includes("coinbase_wallet")&&this.createEthereumWalletConnector({connectorType:"coinbase_wallet",walletClientType:"coinbase_wallet"}),this.walletList.includes("base_account")&&this.createEthereumWalletConnector({connectorType:"base_account",walletClientType:"base_account"}),Object.values(t1.q)))!e.isInstalled&&this.walletList.includes(e.client)&&(["ethereum-only","ethereum-and-solana"].includes(this.walletChainType)&&e.chainTypes.includes("ethereum")&&this.createEthereumWalletConnector({connectorType:"null",walletClientType:e.client,walletConfig:e}),["ethereum-and-solana","solana-only"].includes(this.walletChainType)&&e.chainTypes.includes("solana")&&this.addSolanaWalletConnector(new t1.S({id:e.client,name:e.name})));this.externalWalletConfig.walletConnect.enabled&&(this.walletList.includes("wallet_connect_qr")||(0,t1.e)(this.walletList))&&"solana-only"!==this.walletChainType&&this.createEthereumWalletConnector({connectorType:"wallet_connect_v2",walletClientType:"unknown"});let r=this.walletList.includes("wallet_connect_qr_solana")||(0,t1.e)(this.walletList)&&"ethereum-only"!==this.walletChainType,i=this.externalWalletConfig.solana.connectors?.get()||[],n=async e=>{if(!r)return;let t=e.find(e=>"walletconnect_solana"===e.walletBranding?.id);t&&t.wallet&&await t.wallet.initialize({walletConnectCloudProjectId:this.walletConnectCloudProjectId,privyAppName:this.privyAppName})};n(i),i.filter(e=>r||"walletconnect_solana"!==e.walletBranding?.id).forEach(this.addSolanaWalletConnector),this.externalWalletConfig.solana.connectors?._setOnConnectorsUpdated?.(e=>{n(e),e?.filter(e=>r||"walletconnect_solana"!==e.walletBranding?.id).forEach(this.addSolanaWalletConnector)}),await t,this.initialized=!0}findWalletConnector(e,t,r){return"wallet_connect_v2"===e?this.walletConnectors.filter(t1.r).find(t=>t.connectorType===e&&(!r||t.wallets.some(e=>e.address===r)))??null:this.walletConnectors.filter(t1.r).find(i=>i.connectorType===e&&i.walletClientType===t&&(!r||i.wallets.some(e=>e.address===r)))??null}findSolanaWalletConnector(e){return this.walletConnectors.filter(t1.v).find(t=>"unknown"===t.walletClientType?t.walletBranding.id===e:t.walletClientType===e)??null}findEmbeddedWalletConnectors(){return this.walletConnectors.filter(e=>"embedded"===e.connectorType)}findImportedWalletConnectors(){return this.walletConnectors.filter(e=>"embedded_imported"===e.connectorType)}onInitialized(e){e.wallets.forEach(e=>{let t=this.storedConnections.find(t=>t.address===e.address&&t.connectorType===e.connectorType&&("solana"===e.type&&"unknown"===t.walletClientType&&"unknown"===e.walletClientType?e.meta.id===t.id:t.walletClientType===e.walletClientType));t&&(e.connectedAt=t.connectedAt)}),this.emit("walletsUpdated"),this.emit("connectorInitialized")}onWalletsUpdated(e){e.initialized&&this.emit("walletsUpdated")}addEmbeddedWalletConnectors({walletProxy:e,user:t,embeddedWallets:r,defaultChain:i,appId:n,privyClient:s}){let{entropyId:a,entropyIdVerifier:o}=(0,t2.g)(t);for(let t of r){let r=this.findEmbeddedWalletConnectors().find(e=>e.walletIndex===t.walletIndex);if(r&&(0,t1.r)(r))r.proxyProvider.walletProxy=e;else{let r=new TA({provider:new Ce({walletProxy:e,address:t.address,entropyId:a,entropyIdVerifier:o,rpcConfig:this.rpcConfig,chains:this.chains,appId:n,chainId:i.id,walletIndex:t.walletIndex,privyClient:s,walletAccount:t}),chains:this.chains,defaultChain:i,rpcConfig:this.rpcConfig,imported:!1,walletIndex:t.walletIndex});this.addWalletConnector(r)}}}addImportedWalletConnector(e,t,r,i){let n=this.findWalletConnector("embedded_imported","privy",t);if(n&&(0,t1.r)(n))n.proxyProvider.walletProxy=e;else{let n=new TA({provider:new Ce({walletProxy:e,address:t,entropyId:t,entropyIdVerifier:"ethereum-address-verifier",walletIndex:0,rpcConfig:this.rpcConfig,chains:this.chains,appId:i,chainId:r.id}),chains:this.chains,walletIndex:0,defaultChain:r,rpcConfig:this.rpcConfig,imported:!0});this.addWalletConnector(n)}}removeEmbeddedWalletConnectors(){this.walletConnectors=this.walletConnectors.filter(e=>"embedded"!==e.connectorType),this.storedConnections=(0,t5.l)(),this.emit("walletsUpdated")}removeImportedWalletConnectors(){let e=this.findImportedWalletConnectors();e.length&&(e.forEach(e=>{let t=this.walletConnectors.indexOf(e);this.walletConnectors.splice(t,1)}),this.storedConnections=(0,t5.l)(),this.emit("walletsUpdated"))}async createEthereumWalletConnector({connectorType:e,walletClientType:t,providers:r,walletConfig:i}){let n=this.findWalletConnector(e,t);if(n&&(0,t1.r)(n))return n instanceof xy&&n.resetConnection(t),n;let s="injected"!==e?"coinbase_wallet"===e?new T_(this.chains,this.defaultChain,this.rpcConfig,this.externalWalletConfig.coinbaseWallet.config):"base_account"===e?new Tb(this.chains,this.defaultChain,this.rpcConfig,this.externalWalletConfig.baseAccount.config,this.setBaseAccountSdk):"null"!==e?new xy({walletConnectCloudProjectId:this.walletConnectCloudProjectId,rpcConfig:this.rpcConfig,chains:this.chains,defaultChain:this.defaultChain,shouldEnforceDefaultChainOnConnect:this.shouldEnforceDefaultChainOnConnect,privyAppId:this.privyAppId,privyAppName:this.privyAppName,walletClientType:t}):i?new t1.w({id:i.client,name:i.name,defaultChain:this.defaultChain,walletClientType:i.client}):null:"metamask"===t&&r?.eip6963InjectedProvider?new Cl(this.chains,this.defaultChain,this.rpcConfig,r?.eip6963InjectedProvider,"metamask"):"metamask"===t&&r?.legacyInjectedProvider?new Co(this.chains,this.defaultChain,this.rpcConfig,r?.legacyInjectedProvider,"metamask"):"phantom"===t&&r?.legacyInjectedProvider?new Co(this.chains,this.defaultChain,this.rpcConfig,r?.legacyInjectedProvider,"phantom"):r?.legacyInjectedProvider&&"unknown_browser_extension"===t?new Co(this.chains,this.defaultChain,this.rpcConfig,r?.legacyInjectedProvider):r?.eip6963InjectedProvider?new Cs(this.chains,this.defaultChain,this.rpcConfig,r?.eip6963InjectedProvider,t):void 0;return s&&this.addWalletConnector(s),s||null}addWalletConnector(e){this.walletConnectors.push(e),e.on("initialized",()=>this.onInitialized(e)),e.on("walletsUpdated",()=>this.onWalletsUpdated(e)),e.initialize().catch(e=>{console.debug("Failed to initialize connector",e)})}setWalletList(e){this.walletList=e,this.initialized&&this.initialize(!0).catch(console.error)}removeAllConnectors(){for(let e of this.walletConnectors)e.removeAllListeners();this.walletConnectors=[]}constructor(e,t,r,i,n,s,a,o,l,c,d,u){super(),this.addSolanaWalletConnector=async e=>{let t=this.findSolanaWalletConnector(e.walletClientType);if(!t||"null"===t.connectorType){if("null"===t?.connectorType){let e=this.walletConnectors.indexOf(t);this.walletConnectors.splice(e,1)}this.addWalletConnector(e)}},this.privyAppId=e,this.walletConnectCloudProjectId=t,this.rpcConfig=r,this.chains=i,this.defaultChain=n,this.walletConnectors=[],this.initialized=!1,this.store=s,this.walletList=a,this.shouldEnforceDefaultChainOnConnect=o,this.externalWalletConfig=l,this.privyAppName=c,this.walletChainType=u||"ethereum-only",this.setBaseAccountSdk=d,this.storedConnections=(0,t5.l)()}}let Cd=(0,s$.create)(()=>({identityToken:null})),Cu=[nK,nV,sO];class Ch{async get(e,t){try{return await this.baseFetch(e,t)}catch(e){throw(0,t3.f)(e)}}async post(e,t,r){try{return await this.baseFetch(e,{method:"POST",...t?{body:t}:{},...r})}catch(e){throw(0,t3.f)(e)}}async delete(e,t){try{return await this.baseFetch(e,{method:"DELETE",...t})}catch(e){throw(0,t3.f)(e)}}constructor({appId:e,appClientId:t,client:r,defaults:i}){this.appId=e,this.appClientId=t,this.clientAnalyticsId=r.clientAnalyticsId,this.sdkVersion=nL.V,this.client=r,this.defaults=i,this.fallbackApiUrl=r.fallbackApiUrl,this.baseFetch=Eg.ofetch.create({baseURL:this.defaults.baseURL,timeout:this.defaults.timeout,retry:3,retryDelay:500,retryStatusCodes:[408,409,425,500,502,503,504],credentials:"include",onRequest:async({request:e,options:t})=>{let r=new Headers(t.headers);r.set("privy-app-id",this.appId),this.appClientId&&r.set("privy-client-id",this.appClientId),r.set("privy-ca-id",this.clientAnalyticsId||""),r.set("privy-client",`react-auth:${this.sdkVersion}`);let i=Cu.includes(e.toString());if(!r.has("authorization")){let e=await this.client.getAccessToken({disableAutoRefresh:i});null!==e&&r.set("authorization",`Bearer ${e}`)}t.headers=r,t.retryDelay&&"number"==typeof t.retryDelay&&(t.retryDelay=3*t.retryDelay)},onRequestError:({error:e})=>{if(e instanceof DOMException&&"AbortError"===e.name)throw new t3.h}})}}class Cp{getOrCreateGuestCredential(e){let t=(0,nL.g)(e);if((0,t5.e)()){if(t5.u.get(t))return t5.u.get(t);{let e=tQ.base64url.encode(TU(32));return t5.u.put(t,e),e}}return tQ.base64url.encode(TU(32))}async authenticate(){if(!this.api)throw new t3.a("Auth flow has no API instance");try{return await this.api.post(sM,{guest_credential:this.meta.guestCredential})}catch(e){throw(0,t3.f)(e)}}async link(){throw Error("Linking is not supported for the guest flow")}constructor(e){this.meta={guestCredential:this.getOrCreateGuestCredential(e)}}}function Cf(){return!(nB.isSafari&&window.location.origin.startsWith("http://localhost"))}var Cy,Cg,Cm,Cw,Cb,Cv,C_,CE,CA,CS,CI,Ck,CT,Cx,CC,CP,CO,CR,CN,CM,CU,CD,Cj,CL,CB,CW,CF,CH,Cq,Cz,C$,CK=((C$={}).PRIVY="privy_access_token",C$.CUSTOMER="customer_access_token",C$);class CV{get token(){return this.privyAccessToken||this.customerAccessToken}getToken(e){return"privy_access_token"===e?this.privyAccessToken:this.customerAccessToken}get customerAccessToken(){return this._getToken(nL.C)}get privyAccessToken(){return this._getToken(nL.P)}_getToken(e){try{let t=t5.u.get(e);return"string"==typeof t?Tf.throwIfNotWellFormedJwt(t):null}catch(e){return console.error(e),this.destroyLocalState(),null}}get refreshToken(){try{let e=t5.u.get(nL.R);return"string"==typeof e?e:null}catch(e){return console.error(e),this.destroyLocalState(),null}}getProviderAccessToken(e){try{let t=t5.u.get((0,nL.e)(e));if("string"!=typeof t)return null;{let r=new Tf(t);return r.isExpired()?(t5.u.del((0,nL.e)(e)),null):r.value}}catch(e){return console.error(e),null}}get mightHaveServerCookies(){try{let e=Em.default.get(nL.f);return void 0!==e&&e.length>0}catch(e){console.error(e)}return!1}hasRefreshCredentials(e="privy_access_token"){let t="string"==typeof this.getToken(e),r="string"==typeof this.refreshToken&&this.refreshToken!==nL.h;return this.mightHaveServerCookies||t&&r}hasActiveAccessToken(e){let t=Tf.parse(this.getToken(e));return null!==t&&!t.isExpired(30)}authenticate(e){return this.authenticateOnce.execute(e)}link(e){return this.linkOnce.execute(e)}refresh(){return this.refreshOnce.execute()}destroy(){return this.destroyOnce.execute()}storeProviderAccessToken(e,t){"string"==typeof t?t5.u.put((0,nL.e)(e),t):t5.u.del((0,nL.e)(e))}updateIdentityToken(e){"string"==typeof e?this.storeIdentityToken(e):this.clearIdentityToken()}async _authenticate(e){try{let t=await e.authenticate(),{user:r,is_new_user:i,oauth_tokens:n}=t;this.handleTokenResponse(t);let s=n?{provider:n.provider,accessToken:n.access_token,accessTokenExpiresInSeconds:n.access_token_expires_in_seconds,refreshToken:n.refresh_token,refreshTokenExpiresInSeconds:n.refresh_token_expires_in_seconds,scopes:n.scopes}:void 0;return this._trackAuthenticateEvents(e,i),{user:(0,tX.l)(r),isNewUser:i,oAuthTokens:s}}catch(e){throw console.warn("Error authenticating session"),(0,t3.i)(e)}}_trackAuthenticateEvents(e,t){let r=e instanceof TT?"email":e instanceof T$?"sms":e instanceof Tq?"siwe":e instanceof Cp?"guest":e instanceof x5?"custom_auth":e instanceof TB?e.meta.provider:null;r&&this.client&&this.client.createAnalyticsEvent({eventName:"sdk_authenticate",payload:{method:r,isNewUser:t}}),"siwe"===r&&this.client&&this.client.createAnalyticsEvent({eventName:"sdk_authenticate_siwe",payload:{connectorType:e.meta.connectorType,walletClientType:e.meta.walletClientType}})}async _link(e){try{let t=await e.link(),r=t.oauth_tokens,i=r?{provider:r.provider,accessToken:r.access_token,accessTokenExpiresInSeconds:r.access_token_expires_in_seconds,refreshToken:r.refresh_token,refreshTokenExpiresInSeconds:r.refresh_token_expires_in_seconds,scopes:r.scopes}:void 0;return{user:(0,tX.l)(t),oAuthTokens:i}}catch(e){throw console.warn("Error linking account"),(0,t3.i)(e)}}async _refresh(){if(!this.api)throw new t3.a("Session has no API instance");if(!this.client)throw new t3.a("Session has no PrivyClient instance");await this.client.getAccessToken({disableAutoRefresh:!0});let e=this.token,t=this.refreshToken;if(this.client.useServerCookies&&!this.mightHaveServerCookies&&this.token&&window.location.origin===this.client.apiUrl)return this.destroyLocalState(),null;try{let r;if(!(e&&t||this.mightHaveServerCookies))return null;{let i={};e&&(i.authorization=`Bearer ${e}`),r=await this.api.post(nK,t?{refresh_token:t}:{},{headers:i})}return this.handleTokenResponse(r),(0,tX.l)(r.user)}catch(e){if(e instanceof t3.e&&e.privyErrorCode===t3.b.MISSING_OR_INVALID_TOKEN)return console.warn("Unable to refresh tokens - token is missing or no longer valid"),this.destroyLocalState(),null;throw(0,t3.i)(e)}}handleTokenResponse(e){e.session_update_action&&"set"!==e.session_update_action?"clear"===e.session_update_action?this.destroyLocalState():"ignore"===e.session_update_action&&(e.token&&(this.storeCustomerAccessToken(e.token),this.storePrivyAccessToken(e.privy_access_token)),e.identity_token&&this.storeIdentityToken(e.identity_token)):this._storeAllTokens(e)}_storeAllTokens(e){this.storeRefreshToken(e.refresh_token),this.storeCustomerAccessToken(e.token),this.storePrivyAccessToken(e.privy_access_token),e.identity_token&&this.storeIdentityToken(e.identity_token)}async _destroy(){try{await this.api?.post(nV,{refresh_token:this.refreshToken})}catch(e){console.warn("Error destroying session")}this.destroyLocalState()}destroyLocalState(){this.storeRefreshToken(null),this.storeCustomerAccessToken(null),this.storePrivyAccessToken(null),this.clearIdentityToken()}storeCustomerAccessToken(e){if("string"==typeof e){let t=t5.u.get(nL.C);if(t5.u.put(nL.C,e),!this.client?.useServerCookies){let t=Tf.parse(e)?.expiration;Em.default.set(nL.i,e,{sameSite:"Strict",secure:Cf(),expires:t?new Date(1e3*t):void 0})}t!==e&&this.client?.onStoreCustomerAccessToken?.(e)}else t5.u.del(nL.C),Em.default.remove(nL.i),this.client?.onDeleteCustomerAccessToken?.()}storeRefreshToken(e){"string"==typeof e?(t5.u.put(nL.R,e),this.client?.useServerCookies||Em.default.set(nL.f,"t",{sameSite:"Strict",secure:Cf(),expires:30})):(t5.u.del(nL.R),Em.default.remove(nL.j),Em.default.remove(nL.f))}storePrivyAccessToken(e){"string"==typeof e?t5.u.put(nL.P,e):t5.u.del(nL.P)}storeIdentityToken(e){if(Cd.setState({identityToken:e}),this.client?.useServerCookies)return;t5.u.put(nL.I,e);let t=Tf.parse(e)?.expiration;Em.default.set(nL.k,e,{sameSite:"Strict",secure:Cf(),expires:t?new Date(1e3*t):void 0})}clearIdentityToken(){t5.u.del(nL.I),Cd.setState({identityToken:null}),Em.default.remove(nL.k)}constructor(){this.authenticateOnce=new TC(async e=>this._authenticate(e)),this.linkOnce=new TC(async e=>this._link(e)),this.refreshOnce=new TC(this._refresh.bind(this)),this.destroyOnce=new TC(this._destroy.bind(this))}}var CJ=0,CZ="__private_"+CJ+++"__getOrGenerateClientAnalyticsId";class CG{getAppId(){return this.appId}initializeConnectorManager({walletConnectCloudProjectId:e,rpcConfig:t,chains:r,defaultChain:i,store:n,walletList:s,shouldEnforceDefaultChainOnConnect:a,externalWalletConfig:o,appName:l,walletChainType:c,setBaseAccountSdk:d}){this.connectors||(this.connectors=new Cc(this.appId,e,t,r,i,n,s,a,o,l,d,c))}generateApi(){let e=new Ch({appId:this.appId,appClientId:this.appClientId,client:this,defaults:{baseURL:this.apiUrl,timeout:this.timeout}});return this.session.api=e,e}updateApiUrl(e){this.apiUrl=e||this.fallbackApiUrl,this.api=this.generateApi(),e&&(this.useServerCookies=!0)}authenticate(){if(!this.authFlow)throw new t3.a("No auth flow in progress.");return this.session.authenticate(this.authFlow)}async link(){if(!this.authFlow)throw new t3.a("No auth flow in progress.");let{oAuthTokens:e}=await this.session.link(this.authFlow);return{user:await this.getAuthenticatedUser(),oAuthTokens:e}}storeProviderAccessToken(e,t){this.session.storeProviderAccessToken(e,t)}getProviderAccessToken(e){return this.session.getProviderAccessToken(e)}async logout(){await this.session.destroy(),this.authFlow=void 0}clearProviderAcccessTokens(e){e.linkedAccounts.filter(e=>"cross_app"===e.type).forEach(e=>{this.storeProviderAccessToken(e.providerApp.id,null)})}startAuthFlow(e){return e.api=this.api,this.authFlow=e,this.authFlow}async initMfaSmsVerification(){try{await this.api.post(sx,{action:"verify"})}catch(e){throw(0,t3.f)(e)}}async initMfaPasskeyVerification(){try{let e,t=await this.api.post(sC,{});return{rpId:(e=t.options).rp_id,challenge:e.challenge,allowCredentials:e.allow_credentials?.map(e=>({id:e.id,type:e.type,transports:e.transports}))||[],timeout:e.timeout,extensions:{appid:e.extensions?.app_id,credProps:e.extensions?.cred_props,hmacCreateSecret:e.extensions?.hmac_create_secret},userVerification:e.user_verification}}catch(e){throw(0,t3.f)(e)}}async getCrossAppProviderDetails(e){try{return this._cachedProviderAppDetails[e]||(this._cachedProviderAppDetails[e]=await this.api.get(`/api/v1/apps/${e}/cross-app/details`)),this._cachedProviderAppDetails[e]}catch(e){console.error("Error fetching cross app provider details",e)}}async acceptTerms(){try{let e=await this.api.post(sP,{});return(0,tX.l)(e)}catch(e){throw(0,t3.i)(e)}}async unlinkEmail(e){try{let t=await this.api.post(sn,{address:e});return await this.getAuthenticatedUser()??(0,tX.l)(t)}catch(e){throw(0,t3.i)(e)}}async unlinkPhone(e){try{let t=await this.api.post(sc,{phoneNumber:e});return await this.getAuthenticatedUser()??(0,tX.l)(t)}catch(e){throw(0,t3.i)(e)}}async unlinkEthereumWallet(e){try{let t=await this.api.post(nQ,{address:e});return await this.getAuthenticatedUser()??(0,tX.l)(t)}catch(e){throw(0,t3.i)(e)}}async unlinkSolanaWallet(e){try{let t=await this.api.post(n3,{address:e});return await this.getAuthenticatedUser()??(0,tX.l)(t)}catch(e){throw(0,t3.i)(e)}}async unlinkOAuth(e,t){try{let r=await this.api.post(sg,{provider:e,subject:t});return await this.getAuthenticatedUser()??(0,tX.l)(r)}catch(e){throw(0,t3.i)(e)}}async unlinkFarcaster(e){try{let t=await this.api.post(n9,{fid:e});return await this.getAuthenticatedUser()??(0,tX.l)(t)}catch(e){throw(0,t3.i)(e)}}async unlinkTelegram(e){try{let t=await this.api.post(sk,{telegram_user_id:e});return await this.getAuthenticatedUser()??(0,tX.l)(t)}catch(e){throw(0,t3.i)(e)}}async revokeDelegatedWallet(){try{await this.api.post(sL,{})}catch(e){throw(0,t3.i)(e)}}async createAnalyticsEvent({eventName:e,payload:t,timestamp:r,options:i}){try{this.clientAnalyticsId||console.warn("No client analytics id set, refusing to send analytics event"),await this.api.post(sO,{event_name:e,client_id:this.clientAnalyticsId,payload:{...t||{},clientTimestamp:r?r.toISOString():(new Date).toISOString()}},{retry:-1,keepalive:i?.keepAlive??!1})}catch(e){console.log("Unable to submit event. This is not an issue.")}}async signMoonpayOnRampUrl(e){try{return this.api.post(sU,e)}catch(e){throw(0,t3.i)(e)}}async initCoinbaseOnRamp(e){try{return this.api.post(sD,e)}catch(e){throw(0,t3.i)(e)}}async getCoinbaseOnRampStatus({partnerUserId:e}){try{return this.api.get(`${sj}?partnerUserId=${e}`)}catch(e){throw(0,t3.i)(e)}}async getAuthenticatedUser(){return this.session.hasRefreshCredentials()?this.session.refresh():null}async getAccessToken(e){return await this.getPrivyAccessToken(e)||await this.getCustomerAccessToken(e)}async getCustomerAccessToken(e){return await this._getToken(CK.CUSTOMER,e)}async getPrivyAccessToken(e){return await this._getToken(CK.PRIVY,e)}async _getToken(e,t){return this.session.getToken(e)?this.session.hasActiveAccessToken(e)?this.session.hasRefreshCredentials(e)?Ty.parse(this.session.getToken(e))?.appId!==this.appId?(await this.logout(),null):this.session.getToken(e):(this.session.destroyLocalState(),null):!t?.disableAutoRefresh&&this.session.hasRefreshCredentials(e)?(await this.session.refresh(),this.session.getToken(e)):null:null}async getUsdTokenPrice(e){try{return(await this.api.get(`/api/v1/token_price?chainId=${e.id}&tokenSymbol=${e.nativeCurrency.symbol}`)).usd}catch(t){return void console.error(`Unable to fetch token price for chain with id ${e.id}`)}}async getUsdPriceForSol(){try{return(await this.api.get("/api/v1/token_price?chainId=0&tokenSymbol=SOL")).usd}catch(e){return void console.error("Unable to fetch token price for SOL")}}async getSplTokenMetadata({mintAddress:e,cluster:t}){try{return await this.api.get(`/api/v1/spl_token_info?mint_address=${e}&cluster=${t}`)}catch(r){return void console.error(`Unable to fetch token metadata for ${t}:${e}`)}}async requestFarcasterSignerStatus(e){try{return await this.api.post("/api/v1/farcaster/signer/status",{ed25519_public_key:e})}catch(e){throw console.error("Unable to fetch Farcaster signer status"),e}}async generateSiweNonce({address:e,captchaToken:t}){try{return(await this.api.post(nJ,{address:e,token:t})).nonce}catch(e){throw(0,t3.i)(e)}}async authenticateWithSiweInternal({message:e,signature:t,chainId:r,walletClientType:i,connectorType:n,mode:s}){return await this.api.post(nZ,{message:e,signature:t,chainId:r,walletClientType:i,connectorType:n,mode:s})}async linkWithSiweInternal({message:e,signature:t,chainId:r,walletClientType:i,connectorType:n}){return await this.api.post(nG,{message:e,signature:t,chainId:r,walletClientType:i,connectorType:n})}async linkSmartWallet({message:e,signature:t,smartWalletType:r,smartWalletVersion:i}){try{let n=await this.api.post(nY,{message:e,signature:t,smart_wallet_type:r,smart_wallet_version:i});return(0,tX.l)(n)}catch(e){throw(0,t3.i)(e)}}async linkWithSiwe({message:e,signature:t,chainId:r,walletClientType:i,connectorType:n}){try{let s=await this.linkWithSiweInternal({message:e,signature:t,chainId:r,walletClientType:i,connectorType:n});return(0,tX.l)(s)}catch(e){throw(0,t3.i)(e)}}async generateSiwsNonce({address:e,captchaToken:t}){try{return(await this.api.post(n0,{address:e,token:t})).nonce}catch(e){throw(0,t3.i)(e)}}async authenticateWithSiwsInternal({message:e,signature:t,walletClientType:r,connectorType:i,mode:n,messageType:s="plain"}){return await this.api.post(n1,{message:e,signature:t,walletClientType:r,connectorType:i,mode:n,message_type:s})}async authenticateWithSiws({message:e,signature:t,walletClientType:r,connectorType:i,mode:n,messageType:s="plain"}){let a=await this.authenticateWithSiwsInternal({message:e,signature:t,walletClientType:r,connectorType:i,mode:n,messageType:s});this.session.handleTokenResponse(a);let o=(0,tX.l)(a.user);if(!o)throw Error("Authentication failed - no user returned");return{user:o,isNewUser:a.is_new_user||!1}}async sendAccountTransferRequest({nonce:e,account:t,accountType:r,externalWalletMetadata:i,telegramAuthResult:n,telegramWebAppData:s,farcasterEmbeddedAddress:a,oAuthUserInfo:o}){try{let l,c;switch(r){case"email":l=sa,c={nonce:e,email:t};break;case"sms":l=sh,c={nonce:e,phoneNumber:t};break;case"siwe":if(l=nX,!i)throw Error("Wallet parameters must be defined");c={nonce:e,address:t,...i};break;case"farcaster":l=se,c={nonce:e,farcaster_id:t,farcaster_embedded_address:a};break;case"telegram":l=sT,c={nonce:e,telegram_auth_result:n,telegram_web_app_data:s};break;case"siws":l=n5,c={nonce:e,address:t,...i};break;case"custom":case"guest":case"passkey":throw Error("Invalid transfer account type");default:l=sm,c={nonce:e,userInfo:o}}let d=await this.api.post(l,c);return await this.getAuthenticatedUser()??(0,tX.l)(d)}catch(e){throw(0,t3.i)(e)}}async linkWithSiwsInternal({message:e,signature:t,walletClientType:r,connectorType:i,messageType:n="plain"}){return await this.api.post(n2,{message:e,signature:t,walletClientType:r,connectorType:i,message_type:n})}async linkWithSiws({message:e,signature:t,walletClientType:r,connectorType:i,messageType:n="plain"}){try{let s=await this.linkWithSiwsInternal({message:e,signature:t,walletClientType:r,connectorType:i,messageType:n});return(0,tX.l)(s)}catch(e){throw(0,t3.i)(e)}}async updateUserAndIdToken(){try{let e=await this.api.get(sB);return this.session.updateIdentityToken(e.identity_token),(0,tX.l)(e.user)}catch(e){throw(0,t3.i)(e)}}async scanTransaction(e){try{return await this.api.post(sW,e)}catch(e){throw(0,t3.i)(e)}}constructor({apiUrl:e=nL.D,appId:t,appClientId:r,timeout:i=nL.l}){Object.defineProperty(this,CZ,{value:CY}),this._cachedProviderAppDetails={},this.apiUrl=e,this.fallbackApiUrl=this.apiUrl,this.useServerCookies=e!==nL.D&&e.startsWith("https://privy."),this.timeout=i,this.appId=t,this.appClientId=r,this.clientAnalyticsId=(function(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw TypeError("attempted to use private field on non-instance");return e})(this,CZ)[CZ](),u||(u=new CV),this.session=u,this.api=this.generateApi(),this.session.client=this}}function CY(){try{let e=t5.u.get(nL.d);if("string"==typeof e&&e.length>0)return e}catch(e){}let e=Z();try{return t5.u.put(nL.d,e),e}catch(t){return e}}function CQ(){if(!h)throw new t3.a("No global PrivyClient instance found. Please ensure you have initialized the PrivyProvider.");return h}let CX=({config:e,...t})=>{(()=>{if((0,F.useContext)(x4))throw new t3.a("Multiple PrivyProvider instances found","Found multiple instances of PrivyProvider, ensure there is only one mounted in your application tree.")})(),function(){let e=["localhost","127.0.0.1"].includes(window.location.hostname),t="https:"===window.location.protocol||"chrome-extension:"===window.location.protocol;if(!e&&!t)throw new t3.a("Embedded wallet is only available over HTTPS")}(),function(e){if("string"!=typeof e||25!==e.length)throw new t3.a("Cannot initialize the Privy provider with an invalid Privy app ID")}(t.appId),h||(h=new CG({appId:t.appId,appClientId:t.clientId,apiUrl:t.apiUrl}));let r=(0,F.useMemo)(()=>new H.default({appId:t.appId,clientId:t.clientId,storage:t5.u,baseUrl:t.apiUrl,sdkVersion:"react-auth:3.10.0"}),[]),i=CQ(),n=Object.assign({},e);return(0,W.jsx)(nL.m,{client:r,legacyClient:i,appClientId:t.clientId,clientConfig:n,children:(0,W.jsx)(sF.P,{children:(0,W.jsx)(x7,{...t,client:i,privy:r})})})};function C0(){let{promptMfa:e,init:t,submit:r,cancel:i,mfaMethods:n}=(0,F.useContext)(tX.P);return{promptMfa:e,init:t,submit:r,cancel:i,mfaMethods:n}}function C1(){let{initEnrollmentWithSms:e,initEnrollmentWithTotp:t,initEnrollmentWithPasskey:r,submitEnrollmentWithSms:i,submitEnrollmentWithTotp:n,submitEnrollmentWithPasskey:s,unenroll:a,enrollInMfa:o}=(0,F.useContext)(tX.P);return{initEnrollmentWithSms:e,initEnrollmentWithTotp:t,initEnrollmentWithPasskey:r,submitEnrollmentWithSms:i,submitEnrollmentWithTotp:n,submitEnrollmentWithPasskey:s,unenrollWithSms:()=>a("sms"),unenrollWithTotp:()=>a("totp"),unenrollWithPasskey:e=>a("passkey",e),showMfaEnrollmentModal:()=>o(!0),closeMfaEnrollmentModal:()=>o(!1)}}e.s(["A",()=>Tm,"B",()=>Ct,"C",()=>TJ,"D",()=>Tw,"E",()=>xq,"F",()=>Cr,"G",()=>Tg,"H",()=>CX,"P",()=>xm,"R",()=>TC,"S",()=>Tz,"W",()=>xy,"a",()=>TG,"b",()=>Tq,"c",()=>xz,"d",()=>C1,"e",()=>xb,"f",()=>xS,"g",()=>xE,"h",()=>x_,"i",()=>xI,"j",()=>xA,"k",()=>xX,"l",()=>TW,"m",()=>TQ,"n",()=>xv,"o",()=>TD,"p",()=>x1,"q",()=>Tj,"r",()=>TL,"s",()=>xY,"t",()=>xG,"u",()=>C0,"v",()=>xH,"w",()=>xJ,"x",()=>x$,"y",()=>TE,"z",()=>xV],313323)}]);