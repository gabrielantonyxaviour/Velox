module.exports=[226021,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.toBig=c.shrSL=c.shrSH=c.rotrSL=c.rotrSH=c.rotrBL=c.rotrBH=c.rotr32L=c.rotr32H=c.rotlSL=c.rotlSH=c.rotlBL=c.rotlBH=c.add5L=c.add5H=c.add4L=c.add4H=c.add3L=c.add3H=void 0,c.add=u,c.fromBig=f,c.split=g;let d=BigInt(0x100000000-1),e=BigInt(32);function f(a,b=!1){return b?{h:Number(a&d),l:Number(a>>e&d)}:{h:0|Number(a>>e&d),l:0|Number(a&d)}}function g(a,b=!1){let c=a.length,d=new Uint32Array(c),e=new Uint32Array(c);for(let g=0;g<c;g++){let{h:c,l:h}=f(a[g],b);[d[g],e[g]]=[c,h]}return[d,e]}let h=(a,b)=>BigInt(a>>>0)<<e|BigInt(b>>>0);c.toBig=h;let i=(a,b,c)=>a>>>c;c.shrSH=i;let j=(a,b,c)=>a<<32-c|b>>>c;c.shrSL=j;let k=(a,b,c)=>a>>>c|b<<32-c;c.rotrSH=k;let l=(a,b,c)=>a<<32-c|b>>>c;c.rotrSL=l;let m=(a,b,c)=>a<<64-c|b>>>c-32;c.rotrBH=m;let n=(a,b,c)=>a>>>c-32|b<<64-c;c.rotrBL=n;let o=(a,b)=>b;c.rotr32H=o;let p=(a,b)=>a;c.rotr32L=p;let q=(a,b,c)=>a<<c|b>>>32-c;c.rotlSH=q;let r=(a,b,c)=>b<<c|a>>>32-c;c.rotlSL=r;let s=(a,b,c)=>b<<c-32|a>>>64-c;c.rotlBH=s;let t=(a,b,c)=>a<<c-32|b>>>64-c;function u(a,b,c,d){let e=(b>>>0)+(d>>>0);return{h:a+c+(e/0x100000000|0)|0,l:0|e}}c.rotlBL=t;let v=(a,b,c)=>(a>>>0)+(b>>>0)+(c>>>0);c.add3L=v;let w=(a,b,c,d)=>b+c+d+(a/0x100000000|0)|0;c.add3H=w;let x=(a,b,c,d)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0);c.add4L=x;let y=(a,b,c,d,e)=>b+c+d+e+(a/0x100000000|0)|0;c.add4H=y;let z=(a,b,c,d,e)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0)+(e>>>0);c.add5L=z;let A=(a,b,c,d,e,f)=>b+c+d+e+f+(a/0x100000000|0)|0;c.add5H=A,c.default={fromBig:f,split:g,toBig:h,shrSH:i,shrSL:j,rotrSH:k,rotrSL:l,rotrBH:m,rotrBL:n,rotr32H:o,rotr32L:p,rotlSH:q,rotlSL:r,rotlBH:s,rotlBL:t,add:u,add3L:v,add3H:w,add4L:x,add4H:y,add5H:A,add5L:z}},903542,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.crypto=void 0;let d=a.r(666680);c.crypto=d&&"object"==typeof d&&"webcrypto"in d?d.webcrypto:d&&"object"==typeof d&&"randomBytes"in d?d:void 0},571420,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.wrapXOFConstructorWithOpts=c.wrapConstructorWithOpts=c.wrapConstructor=c.Hash=c.nextTick=c.swap32IfBE=c.byteSwapIfBE=c.swap8IfBE=c.isLE=void 0,c.isBytes=e,c.anumber=f,c.abytes=g,c.ahash=function(a){if("function"!=typeof a||"function"!=typeof a.create)throw Error("Hash should be wrapped by utils.createHasher");f(a.outputLen),f(a.blockLen)},c.aexists=function(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")},c.aoutput=function(a,b){g(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)},c.u8=function(a){return new Uint8Array(a.buffer,a.byteOffset,a.byteLength)},c.u32=function(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))},c.clean=function(...a){for(let b=0;b<a.length;b++)a[b].fill(0)},c.createView=function(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)},c.rotr=function(a,b){return a<<32-b|a>>>b},c.rotl=function(a,b){return a<<b|a>>>32-b>>>0},c.byteSwap=h,c.byteSwap32=i,c.bytesToHex=function(a){if(g(a),j)return a.toHex();let b="";for(let c=0;c<a.length;c++)b+=k[a[c]];return b},c.hexToBytes=function(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);if(j)return Uint8Array.fromHex(a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=l(a.charCodeAt(e)),f=l(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d},c.asyncLoop=m,c.utf8ToBytes=n,c.bytesToUtf8=function(a){return new TextDecoder().decode(a)},c.toBytes=o,c.kdfInputToBytes=function(a){return"string"==typeof a&&(a=n(a)),g(a),a},c.concatBytes=function(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];g(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c},c.checkOpts=function(a,b){if(void 0!==b&&"[object Object]"!==({}).toString.call(b))throw Error("options should be object or undefined");return Object.assign(a,b)},c.createHasher=p,c.createOptHasher=q,c.createXOFer=r,c.randomBytes=function(a=32){if(d.crypto&&"function"==typeof d.crypto.getRandomValues)return d.crypto.getRandomValues(new Uint8Array(a));if(d.crypto&&"function"==typeof d.crypto.randomBytes)return Uint8Array.from(d.crypto.randomBytes(a));throw Error("crypto.getRandomValues must be defined")};let d=a.r(903542);function e(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function f(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function g(a,...b){if(!e(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function h(a){return a<<24&0xff000000|a<<8&0xff0000|a>>>8&65280|a>>>24&255}function i(a){for(let b=0;b<a.length;b++)a[b]=h(a[b]);return a}c.isLE=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0],c.swap8IfBE=c.isLE?a=>a:a=>h(a),c.byteSwapIfBE=c.swap8IfBE,c.swap32IfBE=c.isLE?a=>a:i;let j="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,k=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function l(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:void 0}async function m(a,b,d){let e=Date.now();for(let f=0;f<a;f++){d(f);let a=Date.now()-e;a>=0&&a<b||(await (0,c.nextTick)(),e+=a)}}function n(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}function o(a){return"string"==typeof a&&(a=n(a)),g(a),a}function p(a){let b=b=>a().update(o(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b}function q(a){let b=(b,c)=>a(c).update(o(b)).digest(),c=a({});return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=b=>a(b),b}function r(a){let b=(b,c)=>a(c).update(o(b)).digest(),c=a({});return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=b=>a(b),b}c.nextTick=async()=>{},c.Hash=class{},c.wrapConstructor=p,c.wrapConstructorWithOpts=q,c.wrapXOFConstructorWithOpts=r},21968,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.shake256=c.shake128=c.keccak_512=c.keccak_384=c.keccak_256=c.keccak_224=c.sha3_512=c.sha3_384=c.sha3_256=c.sha3_224=c.Keccak=void 0,c.keccakP=t;let d=a.r(226021),e=a.r(571420),f=BigInt(0),g=BigInt(1),h=BigInt(2),i=BigInt(7),j=BigInt(256),k=BigInt(113),l=[],m=[],n=[];for(let a=0,b=g,c=1,d=0;a<24;a++){[c,d]=[d,(2*c+3*d)%5],l.push(2*(5*d+c)),m.push((a+1)*(a+2)/2%64);let e=f;for(let a=0;a<7;a++)(b=(b<<g^(b>>i)*k)%j)&h&&(e^=g<<(g<<BigInt(a))-g);n.push(e)}let o=(0,d.split)(n,!0),p=o[0],q=o[1],r=(a,b,c)=>c>32?(0,d.rotlBH)(a,b,c):(0,d.rotlSH)(a,b,c),s=(a,b,c)=>c>32?(0,d.rotlBL)(a,b,c):(0,d.rotlSL)(a,b,c);function t(a,b=24){let c=new Uint32Array(10);for(let d=24-b;d<24;d++){for(let b=0;b<10;b++)c[b]=a[b]^a[b+10]^a[b+20]^a[b+30]^a[b+40];for(let b=0;b<10;b+=2){let d=(b+8)%10,e=(b+2)%10,f=c[e],g=c[e+1],h=r(f,g,1)^c[d],i=s(f,g,1)^c[d+1];for(let c=0;c<50;c+=10)a[b+c]^=h,a[b+c+1]^=i}let b=a[2],e=a[3];for(let c=0;c<24;c++){let d=m[c],f=r(b,e,d),g=s(b,e,d),h=l[c];b=a[h],e=a[h+1],a[h]=f,a[h+1]=g}for(let b=0;b<50;b+=10){for(let d=0;d<10;d++)c[d]=a[b+d];for(let d=0;d<10;d++)a[b+d]^=~c[(d+2)%10]&c[(d+4)%10]}a[0]^=p[d],a[1]^=q[d]}(0,e.clean)(c)}class u extends e.Hash{constructor(a,b,c,d=!1,f=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=a,this.suffix=b,this.outputLen=c,this.enableXOF=d,this.rounds=f,(0,e.anumber)(c),!(0<a&&a<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,e.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,e.swap32IfBE)(this.state32),t(this.state32,this.rounds),(0,e.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(a){(0,e.aexists)(this),a=(0,e.toBytes)(a),(0,e.abytes)(a);let{blockLen:b,state:c}=this,d=a.length;for(let e=0;e<d;){let f=Math.min(b-this.pos,d-e);for(let b=0;b<f;b++)c[this.pos++]^=a[e++];this.pos===b&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:a,suffix:b,pos:c,blockLen:d}=this;a[c]^=b,(128&b)!=0&&c===d-1&&this.keccak(),a[d-1]^=128,this.keccak()}writeInto(a){(0,e.aexists)(this,!1),(0,e.abytes)(a),this.finish();let b=this.state,{blockLen:c}=this;for(let d=0,e=a.length;d<e;){this.posOut>=c&&this.keccak();let f=Math.min(c-this.posOut,e-d);a.set(b.subarray(this.posOut,this.posOut+f),d),this.posOut+=f,d+=f}return a}xofInto(a){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(a)}xof(a){return(0,e.anumber)(a),this.xofInto(new Uint8Array(a))}digestInto(a){if((0,e.aoutput)(a,this),this.finished)throw Error("digest() was already called");return this.writeInto(a),this.destroy(),a}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,e.clean)(this.state)}_cloneInto(a){let{blockLen:b,suffix:c,outputLen:d,rounds:e,enableXOF:f}=this;return a||(a=new u(b,c,d,f,e)),a.state32.set(this.state32),a.pos=this.pos,a.posOut=this.posOut,a.finished=this.finished,a.rounds=e,a.suffix=c,a.outputLen=d,a.enableXOF=f,a.destroyed=this.destroyed,a}}c.Keccak=u;let v=(a,b,c)=>(0,e.createHasher)(()=>new u(b,a,c));c.sha3_224=v(6,144,28),c.sha3_256=v(6,136,32),c.sha3_384=v(6,104,48),c.sha3_512=v(6,72,64),c.keccak_224=v(1,144,28),c.keccak_256=v(1,136,32),c.keccak_384=v(1,104,48),c.keccak_512=v(1,72,64);let w=(a,b,c)=>(0,e.createXOFer)((d={})=>new u(b,a,void 0===d.dkLen?c:d.dkLen,!0));c.shake128=w(31,168,16),c.shake256=w(31,136,32)},779220,(a,b,c)=>{let{keccak_256:d}=a.r(21968);function e(a){return Buffer.allocUnsafe(a).fill(0)}function f(a,b){let c=a.toString(16);c.length%2!=0&&(c="0"+c);let d=c.match(/.{1,2}/g).map(a=>parseInt(a,16));for(;d.length<b;)d.unshift(0);return Buffer.from(d)}function g(a,b,c){let d=e(b);return(a=h(a),c)?a.length<b?(a.copy(d),d):a.slice(0,b):a.length<b?(a.copy(d,b-a.length),d):a.slice(-b)}function h(a){if(!Buffer.isBuffer(a))if(Array.isArray(a))a=Buffer.from(a);else if("string"==typeof a){var b;a=i(a)?Buffer.from((b=j(a)).length%2?"0"+b:b,"hex"):Buffer.from(a)}else if("number"==typeof a)a=intToBuffer(a);else if(null==a)a=Buffer.allocUnsafe(0);else if("bigint"==typeof a)a=f(a);else if(a.toArray)a=Buffer.from(a.toArray());else throw Error("invalid type");return a}function i(a){return"string"==typeof a&&a.match(/^0x[0-9A-Fa-f]*$/)}function j(a){return"string"==typeof a&&a.startsWith("0x")?a.slice(2):a}b.exports={zeros:e,setLength:g,setLengthRight:function(a,b){return g(a,b,!0)},isHexString:i,stripHexPrefix:j,toBuffer:h,bufferToHex:function(a){return"0x"+(a=h(a)).toString("hex")},keccak:function(a,b){if(a=h(a),b||(b=256),256!==b)throw Error("unsupported");return Buffer.from(d(new Uint8Array(a)))},bitLengthFromBigInt:function(a){return a.toString(2).length},bufferBEFromBigInt:f,twosFromBigInt:function(a,b){return(a<0n?(~a&(1n<<BigInt(b))-1n)+1n:a)&(1n<<BigInt(b))-1n}}},525799,(a,b,c)=>{let d=a.r(779220);function e(a){if(a.startsWith("int["))return"int256"+a.slice(3);if("int"===a)return"int256";if(a.startsWith("uint["))return"uint256"+a.slice(4);if("uint"===a)return"uint256";if(a.startsWith("fixed["))return"fixed128x128"+a.slice(5);else if("fixed"===a)return"fixed128x128";else if(a.startsWith("ufixed["))return"ufixed128x128"+a.slice(6);else if("ufixed"===a)return"ufixed128x128";return a}function f(a){return Number.parseInt(/^\D+(\d+)$/.exec(a)[1],10)}function g(a){var b=/^\D+(\d+)x(\d+)$/.exec(a);return[Number.parseInt(b[1],10),Number.parseInt(b[2],10)]}function h(a){var b=a.match(/(.*)\[(.*?)\]$/);return b?""===b[2]?"dynamic":Number.parseInt(b[2],10):null}function i(a){var b=typeof a;if("string"===b||"number"===b)return BigInt(a);if("bigint"===b)return a;throw Error("Argument is not a number")}function j(a,b){if("address"===a)return j("uint160",i(b));if("bool"===a)return j("uint8",+!!b);if("string"===a)return j("bytes",new Buffer(b,"utf8"));if((m=a).lastIndexOf("]")===m.length-1){if(void 0===b.length)throw Error("Not an array?");if("dynamic"!==(c=h(a))&&0!==c&&b.length>c)throw Error("Elements exceed array size: "+c);for(l in k=[],a=a.slice(0,a.lastIndexOf("[")),"string"==typeof b&&(b=JSON.parse(b)),b)k.push(j(a,b[l]));if("dynamic"===c){var c,e,k,l,m,n=j("uint256",b.length);k.unshift(n)}return Buffer.concat(k)}else if("bytes"===a)return b=new Buffer(b),k=Buffer.concat([j("uint256",b.length),b]),b.length%32!=0&&(k=Buffer.concat([k,d.zeros(32-b.length%32)])),k;else if(a.startsWith("bytes")){if((c=f(a))<1||c>32)throw Error("Invalid bytes<N> width: "+c);return d.setLengthRight(b,32)}else if(a.startsWith("uint")){if((c=f(a))%8||c<8||c>256)throw Error("Invalid uint<N> width: "+c);e=i(b);let g=d.bitLengthFromBigInt(e);if(g>c)throw Error("Supplied uint exceeds width: "+c+" vs "+g);if(e<0)throw Error("Supplied uint is negative");return d.bufferBEFromBigInt(e,32)}else if(a.startsWith("int")){if((c=f(a))%8||c<8||c>256)throw Error("Invalid int<N> width: "+c);e=i(b);let g=d.bitLengthFromBigInt(e);if(g>c)throw Error("Supplied int exceeds width: "+c+" vs "+g);let h=d.twosFromBigInt(e,256);return d.bufferBEFromBigInt(h,32)}else if(a.startsWith("ufixed")){if(c=g(a),(e=i(b))<0)throw Error("Supplied ufixed is negative");return j("uint256",e*BigInt(2)**BigInt(c[1]))}else if(a.startsWith("fixed"))return c=g(a),j("int256",i(b)*BigInt(2)**BigInt(c[1]));throw Error("Unsupported or invalid type: "+a)}function k(a,b){if(a.length!==b.length)throw Error("Number of types are not matching the values");for(var c,g,h=[],j=0;j<a.length;j++){var k=e(a[j]),l=b[j];if("bytes"===k)h.push(l);else if("string"===k)h.push(new Buffer(l,"utf8"));else if("bool"===k)h.push(new Buffer(l?"01":"00","hex"));else if("address"===k)h.push(d.setLength(l,20));else if(k.startsWith("bytes")){if((c=f(k))<1||c>32)throw Error("Invalid bytes<N> width: "+c);h.push(d.setLengthRight(l,c))}else if(k.startsWith("uint")){if((c=f(k))%8||c<8||c>256)throw Error("Invalid uint<N> width: "+c);g=i(l);let a=d.bitLengthFromBigInt(g);if(a>c)throw Error("Supplied uint exceeds width: "+c+" vs "+a);h.push(d.bufferBEFromBigInt(g,c/8))}else if(k.startsWith("int")){if((c=f(k))%8||c<8||c>256)throw Error("Invalid int<N> width: "+c);g=i(l);let a=d.bitLengthFromBigInt(g);if(a>c)throw Error("Supplied int exceeds width: "+c+" vs "+a);let b=d.twosFromBigInt(g,c);h.push(d.bufferBEFromBigInt(b,c/8))}else throw Error("Unsupported or invalid type: "+k)}return Buffer.concat(h)}b.exports={rawEncode:function(a,b){var c=[],d=[],f=32*a.length;for(var g in a){var i=e(a[g]),k=j(i,b[g]);"string"===i||"bytes"===i||"dynamic"===h(i)?(c.push(j("uint256",f)),d.push(k),f+=k.length):c.push(k)}return Buffer.concat(c.concat(d))},solidityPack:k,soliditySHA3:function(a,b){return d.keccak(k(a,b))}}},449105,(a,b,c)=>{let d=a.r(779220),e=a.r(525799),f={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},g={encodeData(a,b,c,f=!0){let g=["bytes32"],h=[this.hashType(a,c)];if(f){let i=(a,b,g)=>{if(void 0!==c[b])return["bytes32",null==g?"0x0000000000000000000000000000000000000000000000000000000000000000":d.keccak(this.encodeData(b,g,c,f))];if(void 0===g)throw Error(`missing value for field ${a} of type ${b}`);if("bytes"===b)return["bytes32",d.keccak(g)];if("string"===b)return"string"==typeof g&&(g=Buffer.from(g,"utf8")),["bytes32",d.keccak(g)];if(b.lastIndexOf("]")===b.length-1){let c=b.slice(0,b.lastIndexOf("[")),f=g.map(b=>i(a,c,b));return["bytes32",d.keccak(e.rawEncode(f.map(([a])=>a),f.map(([,a])=>a)))]}return[b,g]};for(let d of c[a]){let[a,c]=i(d.name,d.type,b[d.name]);g.push(a),h.push(c)}}else for(let e of c[a]){let a=b[e.name];if(void 0!==a)if("bytes"===e.type)g.push("bytes32"),a=d.keccak(a),h.push(a);else if("string"===e.type)g.push("bytes32"),"string"==typeof a&&(a=Buffer.from(a,"utf8")),a=d.keccak(a),h.push(a);else if(void 0!==c[e.type])g.push("bytes32"),a=d.keccak(this.encodeData(e.type,a,c,f)),h.push(a);else if(e.type.lastIndexOf("]")===e.type.length-1)throw Error("Arrays currently unimplemented in encodeData");else g.push(e.type),h.push(a)}return e.rawEncode(g,h)},encodeType(a,b){let c="",d=this.findTypeDependencies(a,b).filter(b=>b!==a);for(let e of d=[a].concat(d.sort())){if(!b[e])throw Error("No type definition specified: "+e);c+=e+"("+b[e].map(({name:a,type:b})=>b+" "+a).join(",")+")"}return c},findTypeDependencies(a,b,c=[]){if(a=a.match(/^\w*/)[0],c.includes(a)||void 0===b[a])return c;for(let d of(c.push(a),b[a]))for(let a of this.findTypeDependencies(d.type,b,c))c.includes(a)||c.push(a);return c},hashStruct(a,b,c,e=!0){return d.keccak(this.encodeData(a,b,c,e))},hashType(a,b){return d.keccak(this.encodeType(a,b))},sanitizeData(a){let b={};for(let c in f.properties)a[c]&&(b[c]=a[c]);return b.types&&(b.types=Object.assign({EIP712Domain:[]},b.types)),b},hash(a,b=!0){let c=this.sanitizeData(a),e=[Buffer.from("1901","hex")];return e.push(this.hashStruct("EIP712Domain",c.domain,c.types,b)),"EIP712Domain"!==c.primaryType&&e.push(this.hashStruct(c.primaryType,c.message,c.types,b)),d.keccak(Buffer.concat(e))}};b.exports={TYPED_MESSAGE_SCHEMA:f,TypedDataUtils:g,hashForSignTypedDataLegacy:function(a){return function(a){let b=Error("Expect argument to be non-empty array");if("object"!=typeof a||!a.length)throw b;let c=a.map(function(a){return"bytes"===a.type?d.toBuffer(a.value):a.value}),f=a.map(function(a){return a.type}),g=a.map(function(a){if(!a.name)throw b;return a.type+" "+a.name});return e.soliditySHA3(["bytes32","bytes32"],[e.soliditySHA3(Array(a.length).fill("string"),g),e.soliditySHA3(f,c)])}(a.data)},hashForSignTypedData_v3:function(a){return g.hash(a.data,!1)},hashForSignTypedData_v4:function(a){return g.hash(a.data)}}},467658,(a,b,c)=>{"use strict";var d=a.r(572131),e="function"==typeof Object.is?Object.is:function(a,b){return a===b&&(0!==a||1/a==1/b)||a!=a&&b!=b},f=d.useSyncExternalStore,g=d.useRef,h=d.useEffect,i=d.useMemo,j=d.useDebugValue;c.useSyncExternalStoreWithSelector=function(a,b,c,d,k){var l=g(null);if(null===l.current){var m={hasValue:!1,value:null};l.current=m}else m=l.current;var n=f(a,(l=i(function(){function a(a){if(!h){if(h=!0,f=a,a=d(a),void 0!==k&&m.hasValue){var b=m.value;if(k(b,a))return g=b}return g=a}if(b=g,e(f,a))return b;var c=d(a);return void 0!==k&&k(b,c)?(f=a,b):(f=a,g=c)}var f,g,h=!1,i=void 0===c?null:c;return[function(){return a(b())},null===i?void 0:function(){return a(i())}]},[b,c,d,k]))[0],l[1]);return h(function(){m.hasValue=!0,m.value=n},[n]),j(n),n}},332473,(a,b,c)=>{"use strict";b.exports=a.r(467658)},247181,(a,b,c)=>{b.exports=a.x("pino-25c27988445b43cd",()=>require("pino-25c27988445b43cd"))},486249,(a,b,c)=>{b.exports=a.x("pino-46664cfbb90c6ab5",()=>require("pino-46664cfbb90c6ab5"))},226945,425041,925479,555282,916501,249765,710912,448808,532681,218524,322870,304053,55887,175707,18264,355944,256576,859041,678418,805841,760960,489658,877511,207712,705840,354187,308735,820026,445503,781034,a=>{"use strict";let b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;var Q=a.i(187924),R=a.i(572131),S=a.i(278223),T=a.i(691442),U=a.i(595549),V=(a.i(15670),a.i(582945));a.i(179246);a.i(34180);var W=a.i(254799);W.default.randomUUID,new Uint8Array(256).length;let X=[];for(let a=0;a<256;++a)X.push((a+256).toString(16).slice(1));a.s([],173406),a.i(173406);var Y=a.i(19013),Z=a.i(751092),$=W;function _(a){switch(a){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new Z.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}let aa=a=>(0,$.randomFillSync)(new Uint8Array(_(a)>>3)),ab=(a,b)=>{if(b.length<<3!==_(a))throw new Z.JWEInvalid("Invalid Initialization Vector length")};var ac=a.i(224361);let ad=ac.types.isKeyObject?a=>ac.types.isKeyObject(a):a=>null!=a&&a instanceof W.KeyObject,ae=(a,b)=>{let c;switch(a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(a.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(a.slice(1,4),10);break;default:throw new Z.JOSENotSupported(`Content Encryption Algorithm ${a} is not supported either by JOSE or your javascript runtime`)}if(b instanceof Uint8Array){let a=b.byteLength<<3;if(a!==c)throw new Z.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${a} bits`);return}if(ad(b)&&"secret"===b.type){let a=b.symmetricKeySize<<3;if(a!==c)throw new Z.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${a} bits`);return}throw TypeError("Invalid Content Encryption Key type")};var af=a.i(136349);let ag=W.timingSafeEqual;function ah(a,b,c,d,e,f){let g=(0,af.concat)(a,b,c,(0,af.uint64be)(a.length<<3)),h=(0,W.createHmac)(`sha${d}`,e);return h.update(g),h.digest().slice(0,f>>3)}let ai=W.webcrypto,aj=ac.types.isCryptoKey?a=>ac.types.isCryptoKey(a):a=>!1;function ak(a,b="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${b} must be ${a}`)}function al(a,b){return a.name===b}function am(a){return parseInt(a.name.slice(4),10)}function an(a,b){if(b.length&&!b.some(b=>a.usages.includes(b))){let a="CryptoKey does not support this operation, its usages must include ";if(b.length>2){let c=b.pop();a+=`one of ${b.join(", ")}, or ${c}.`}else 2===b.length?a+=`one of ${b[0]} or ${b[1]}.`:a+=`${b[0]}.`;throw TypeError(a)}}function ao(a,b,...c){switch(b){case"A128GCM":case"A192GCM":case"A256GCM":{if(!al(a.algorithm,"AES-GCM"))throw ak("AES-GCM");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw ak(c,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!al(a.algorithm,"AES-KW"))throw ak("AES-KW");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw ak(c,"algorithm.length");break}case"ECDH":switch(a.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw ak("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!al(a.algorithm,"PBKDF2"))throw ak("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!al(a.algorithm,"RSA-OAEP"))throw ak("RSA-OAEP");let c=parseInt(b.slice(9),10)||1;if(am(a.algorithm.hash)!==c)throw ak(`SHA-${c}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}an(a,c)}function ap(a,b,...c){if(c.length>2){let b=c.pop();a+=`one of type ${c.join(", ")}, or ${b}.`}else 2===c.length?a+=`one of type ${c[0]} or ${c[1]}.`:a+=`of type ${c[0]}.`;return null==b?a+=` Received ${b}`:"function"==typeof b&&b.name?a+=` Received function ${b.name}`:"object"==typeof b&&null!=b&&b.constructor&&b.constructor.name&&(a+=` Received an instance of ${b.constructor.name}`),a}let aq=(a,...b)=>ap("Key must be ",a,...b);function ar(a,b,...c){return ap(`Key for the ${a} algorithm must be `,b,...c)}let as=a=>(b||(b=new Set((0,W.getCiphers)())),b.has(a)),at=a=>ad(a)||aj(a),au=["KeyObject"];(globalThis.CryptoKey||(null==ai?void 0:ai.CryptoKey))&&au.push("CryptoKey");let av=(a,b,c,d,e,f)=>{let g;if(aj(b))ao(b,a,"decrypt"),g=W.KeyObject.from(b);else if(b instanceof Uint8Array||ad(b))g=b;else throw TypeError(aq(b,...au,"Uint8Array"));switch(ae(a,g),ab(a,d),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(a,b,c,d,e,f){let g,h,i=parseInt(a.slice(1,4),10);ad(b)&&(b=b.export());let j=b.subarray(i>>3),k=b.subarray(0,i>>3),l=parseInt(a.slice(-3),10),m=`aes-${i}-cbc`;if(!as(m))throw new Z.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let n=ah(f,d,c,l,k,i);try{g=ag(e,n)}catch{}if(!g)throw new Z.JWEDecryptionFailed;try{let a=(0,W.createDecipheriv)(m,j,d);h=(0,af.concat)(a.update(c),a.final())}catch{}if(!h)throw new Z.JWEDecryptionFailed;return h}(a,g,c,d,e,f);case"A128GCM":case"A192GCM":case"A256GCM":var h=g;let i=parseInt(a.slice(1,4),10),j=`aes-${i}-gcm`;if(!as(j))throw new Z.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);try{let a=(0,W.createDecipheriv)(j,h,d,{authTagLength:16});a.setAuthTag(e),f.byteLength&&a.setAAD(f,{plaintextLength:c.length});let b=a.update(c);return a.final(),b}catch{throw new Z.JWEDecryptionFailed}default:throw new Z.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}};var aw=a.i(406461);let ax=(0,ac.promisify)(aw.inflateRaw),ay=(0,ac.promisify)(aw.deflateRaw),az=(...a)=>{let b,c=a.filter(Boolean);if(0===c.length||1===c.length)return!0;for(let a of c){let c=Object.keys(a);if(!b||0===b.size){b=new Set(c);continue}for(let a of c){if(b.has(a))return!1;b.add(a)}}return!0};var aA=a.i(154051),aB=a.i(500874);function aC(a,b){if(a.symmetricKeySize<<3!==parseInt(b.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${b}`)}function aD(a,b,c){if(ad(a))return a;if(a instanceof Uint8Array)return(0,W.createSecretKey)(a);if(aj(a))return ao(a,b,c),W.KeyObject.from(a);throw TypeError(aq(a,...au,"Uint8Array"))}let aE=(a,b,c)=>{let d=parseInt(a.slice(1,4),10),e=`aes${d}-wrap`;if(!as(e))throw new Z.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`);let f=aD(b,a,"wrapKey");aC(f,a);let g=(0,W.createCipheriv)(e,f,aB.Buffer.alloc(8,166));return(0,af.concat)(g.update(c),g.final())},aF=(a,b,c)=>{let d=parseInt(a.slice(1,4),10),e=`aes${d}-wrap`;if(!as(e))throw new Z.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`);let f=aD(b,a,"unwrapKey");aC(f,a);let g=(0,W.createDecipheriv)(e,f,aB.Buffer.alloc(8,166));return(0,af.concat)(g.update(c),g.final())},aG=aB.Buffer.from([42,134,72,206,61,3,1,7]),aH=aB.Buffer.from([43,129,4,0,34]),aI=aB.Buffer.from([43,129,4,0,35]),aJ=aB.Buffer.from([43,129,4,0,10]),aK=new WeakMap,aL=(a,b)=>{var c;let d;if(aj(a))d=W.KeyObject.from(a);else if(ad(a))d=a;else throw TypeError(aq(a,...au));if("secret"===d.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(d.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${d.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${d.asymmetricKeyType.slice(1)}`;case"ec":{if(aK.has(d))return aK.get(d);let a=null==(c=d.asymmetricKeyDetails)?void 0:c.namedCurve;if(a||"private"!==d.type){if(!a){let b=d.export({format:"der",type:"spki"}),c=b[1]<128?14:15,e=b[c],f=b.slice(c+1,c+1+e);if(f.equals(aG))a="prime256v1";else if(f.equals(aH))a="secp384r1";else if(f.equals(aI))a="secp521r1";else if(f.equals(aJ))a="secp256k1";else throw new Z.JOSENotSupported("Unsupported key curve for this operation")}}else a=aL((0,W.createPublicKey)(d),!0);if(b)return a;let e=(a=>{switch(a){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new Z.JOSENotSupported("Unsupported key curve for this operation")}})(a);return aK.set(d,e),e}default:throw TypeError("Invalid asymmetric key type for this operation")}},aM=(0,ac.promisify)(W.generateKeyPair);async function aN(a,b,c,d,e=new Uint8Array(0),f=new Uint8Array(0)){let g,h;if(aj(a))ao(a,"ECDH"),g=W.KeyObject.from(a);else if(ad(a))g=a;else throw TypeError(aq(a,...au));if(aj(b))ao(b,"ECDH","deriveBits"),h=W.KeyObject.from(b);else if(ad(b))h=b;else throw TypeError(aq(b,...au));let i=(0,af.concat)((0,af.lengthAndInput)(af.encoder.encode(c)),(0,af.lengthAndInput)(e),(0,af.lengthAndInput)(f),(0,af.uint32be)(d)),j=(0,W.diffieHellman)({privateKey:h,publicKey:g});return(0,af.concatKdf)(j,d,i)}async function aO(a){let b;if(aj(a))b=W.KeyObject.from(a);else if(ad(a))b=a;else throw TypeError(aq(a,...au));switch(b.asymmetricKeyType){case"x25519":return aM("x25519");case"x448":return aM("x448");case"ec":return aM("ec",{namedCurve:aL(b)});default:throw new Z.JOSENotSupported("Invalid or unsupported EPK")}}let aP=a=>["P-256","P-384","P-521","X25519","X448"].includes(aL(a));var $=W;function aQ(a){if(!(a instanceof Uint8Array)||a.length<8)throw new Z.JWEInvalid("PBES2 Salt Input must be 8 or more octets")}let aR=(0,ac.promisify)(W.pbkdf2);function aS(a,b){if(ad(a))return a.export();if(a instanceof Uint8Array)return a;if(aj(a))return ao(a,b,"deriveBits","deriveKey"),W.KeyObject.from(a).export();throw TypeError(aq(a,...au,"Uint8Array"))}let aT=async(a,b,c,d=2048,e=(0,$.randomFillSync)(new Uint8Array(16)))=>{aQ(e);let f=(0,af.p2s)(a,e),g=parseInt(a.slice(13,16),10)>>3,h=aS(b,a),i=await aR(h,f,d,g,`sha${a.slice(8,11)}`);return{encryptedKey:await aE(a.slice(-6),i,c),p2c:d,p2s:(0,Y.encode)(e)}},aU=async(a,b,c,d,e)=>{aQ(e);let f=(0,af.p2s)(a,e),g=parseInt(a.slice(13,16),10)>>3,h=aS(b,a),i=await aR(h,f,d,g,`sha${a.slice(8,11)}`);return aF(a.slice(-6),i,c)},aV=new WeakMap,aW=(a,b)=>{let c=a.readUInt8(1);if((128&c)==0)return 0===b?c:aW(a.subarray(2+c),b-1);let d=127&c;c=0;for(let b=0;b<d;b++)c<<=8,c|=a.readUInt8(2+b);return 0===b?c:aW(a.subarray(2+c),b-1)},aX=(a,b)=>{aV.set(a,b)},aY=(a,b)=>{if(2048>(a=>{var b,c,d,e;let f;if(aV.has(a))return aV.get(a);let g=null!=(c=null==(b=a.asymmetricKeyDetails)?void 0:b.modulusLength)?c:(d=a.export({format:"der",type:"pkcs1"}),e=+("private"===a.type),((128&(f=d.readUInt8(1)))==0?aW(d.subarray(2),e):aW(d.subarray(2+(127&f)),e))-1<<3);return aV.set(a,g),g})(a))throw TypeError(`${b} requires key modulusLength to be 2048 bits or larger`)},aZ=(a,b)=>{if("rsa"!==a.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");aY(a,b)},a$=a=>{switch(a){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return W.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return W.constants.RSA_PKCS1_PADDING;default:return}},a_=a=>{switch(a){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function a0(a,b,...c){if(ad(a))return a;if(aj(a))return ao(a,b,...c),W.KeyObject.from(a);throw TypeError(aq(a,...au))}var $=W;function a1(a){switch(a){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new Z.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}let a2=a=>(0,$.randomFillSync)(new Uint8Array(a1(a)>>3)),a3=(a,b,c)=>{let d;if(aj(c)){if(!c.extractable)throw TypeError("CryptoKey is not extractable");d=W.KeyObject.from(c)}else if(ad(c))d=c;else throw TypeError(aq(c,...au));if(d.type!==a)throw TypeError(`key is not a ${a} key`);return d.export({format:"pem",type:b})},a4=aB.Buffer.from([0]),a5=aB.Buffer.from([2]),a6=aB.Buffer.from([3]),a7=aB.Buffer.from([48]),a8=aB.Buffer.from([4]),a9=a=>{if(a<128)return aB.Buffer.from([a]);let b=aB.Buffer.alloc(5);b.writeUInt32BE(a,1);let c=1;for(;0===b[c];)c++;return b[c-1]=128|5-c,b.slice(c-1)},ba=new Map([["P-256",aB.Buffer.from("06 08 2A 86 48 CE 3D 03 01 07".replace(/ /g,""),"hex")],["secp256k1",aB.Buffer.from("06 05 2B 81 04 00 0A".replace(/ /g,""),"hex")],["P-384",aB.Buffer.from("06 05 2B 81 04 00 22".replace(/ /g,""),"hex")],["P-521",aB.Buffer.from("06 05 2B 81 04 00 23".replace(/ /g,""),"hex")],["ecPublicKey",aB.Buffer.from("06 07 2A 86 48 CE 3D 02 01".replace(/ /g,""),"hex")],["X25519",aB.Buffer.from("06 03 2B 65 6E".replace(/ /g,""),"hex")],["X448",aB.Buffer.from("06 03 2B 65 6F".replace(/ /g,""),"hex")],["Ed25519",aB.Buffer.from("06 03 2B 65 70".replace(/ /g,""),"hex")],["Ed448",aB.Buffer.from("06 03 2B 65 71".replace(/ /g,""),"hex")]]);class bb{constructor(){this.length=0,this.elements=[]}oidFor(a){let b=ba.get(a);if(!b)throw new Z.JOSENotSupported("Invalid or unsupported OID");this.elements.push(b),this.length+=b.length}zero(){this.elements.push(a5,aB.Buffer.from([1]),a4),this.length+=3}one(){this.elements.push(a5,aB.Buffer.from([1]),aB.Buffer.from([1])),this.length+=3}unsignedInteger(a){if(128&a[0]){let b=a9(a.length+1);this.elements.push(a5,b,a4,a),this.length+=2+b.length+a.length}else{let b=0;for(;0===a[b]&&(128&a[b+1])==0;)b++;let c=a9(a.length-b);this.elements.push(a5,a9(a.length-b),a.slice(b)),this.length+=1+c.length+a.length-b}}octStr(a){let b=a9(a.length);this.elements.push(a8,a9(a.length),a),this.length+=1+b.length+a.length}bitStr(a){let b=a9(a.length+1);this.elements.push(a6,a9(a.length+1),a4,a),this.length+=1+b.length+a.length+1}add(a){this.elements.push(a),this.length+=a.length}end(a=a7){let b=a9(this.length);return aB.Buffer.concat([a,b,...this.elements],1+b.length+this.length)}}let[bc,bd]=process.versions.node.split(".").map(a=>parseInt(a,10)),be=!("electron"in process.versions)&&(bc>=17||16===bc&&bd>=9),bf=bc>=16||15===bc&&bd>=9,bg=bc>=16||15===bc&&bd>=12,bh=a=>{if(bg&&"oct"!==a.kty)return a.d?(0,W.createPrivateKey)({format:"jwk",key:a}):(0,W.createPublicKey)({format:"jwk",key:a});switch(a.kty){case"oct":return(0,W.createSecretKey)((0,Y.decode)(a.k));case"RSA":{let b=new bb,c=void 0!==a.d,d=aB.Buffer.from(a.n,"base64"),e=aB.Buffer.from(a.e,"base64");c?(b.zero(),b.unsignedInteger(d),b.unsignedInteger(e),b.unsignedInteger(aB.Buffer.from(a.d,"base64")),b.unsignedInteger(aB.Buffer.from(a.p,"base64")),b.unsignedInteger(aB.Buffer.from(a.q,"base64")),b.unsignedInteger(aB.Buffer.from(a.dp,"base64")),b.unsignedInteger(aB.Buffer.from(a.dq,"base64")),b.unsignedInteger(aB.Buffer.from(a.qi,"base64"))):(b.unsignedInteger(d),b.unsignedInteger(e));let f={key:b.end(),format:"der",type:"pkcs1"},g=c?(0,W.createPrivateKey)(f):(0,W.createPublicKey)(f);return aX(g,d.length<<3),g}case"EC":{var b,c;let d=new bb,e=void 0!==a.d,f=aB.Buffer.concat([aB.Buffer.alloc(1,4),aB.Buffer.from(a.x,"base64"),aB.Buffer.from(a.y,"base64")]);if(e){d.zero();let c=new bb;c.oidFor("ecPublicKey"),c.oidFor(a.crv),d.add(c.end());let e=new bb;e.one(),e.octStr(aB.Buffer.from(a.d,"base64"));let g=new bb;g.bitStr(f);let h=g.end(aB.Buffer.from([161]));e.add(h);let i=e.end(),j=new bb;j.add(i);let k=j.end(aB.Buffer.from([4]));d.add(k);let l=d.end(),m=(0,W.createPrivateKey)({key:l,format:"der",type:"pkcs8"});return b=a.crv,aK.set(m,b),m}let g=new bb;g.oidFor("ecPublicKey"),g.oidFor(a.crv),d.add(g.end()),d.bitStr(f);let h=d.end(),i=(0,W.createPublicKey)({key:h,format:"der",type:"spki"});return c=a.crv,aK.set(i,c),i}case"OKP":{let b=new bb;if(void 0!==a.d){b.zero();let c=new bb;c.oidFor(a.crv),b.add(c.end());let d=new bb;d.octStr(aB.Buffer.from(a.d,"base64"));let e=d.end(aB.Buffer.from([4]));b.add(e);let f=b.end();return(0,W.createPrivateKey)({key:f,format:"der",type:"pkcs8"})}let c=new bb;c.oidFor(a.crv),b.add(c.end()),b.bitStr(aB.Buffer.from(a.x,"base64"));let d=b.end();return(0,W.createPublicKey)({key:d,format:"der",type:"spki"})}default:throw new Z.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}};async function bi(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,W.createPublicKey)({key:aB.Buffer.from(a.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""),"base64"),type:"spki",format:"der"})}async function bj(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,W.createPublicKey)({key:a,type:"spki",format:"pem"})}async function bk(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,W.createPrivateKey)({key:aB.Buffer.from(a.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""),"base64"),type:"pkcs8",format:"der"})}async function bl(a,b,c){var d;if(!(0,aA.default)(a))throw TypeError("JWK must be an object");switch(b||(b=a.alg),a.kty){case"oct":if("string"!=typeof a.k||!a.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=c||(c=!0!==a.ext),c)return bh({...a,alg:b,ext:null!=(d=a.ext)&&d});return(0,Y.decode)(a.k);case"RSA":if(void 0!==a.oth)throw new Z.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return bh({...a,alg:b});default:throw new Z.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}let bm=(a,b,c)=>{if(a.startsWith("HS")||"dir"===a||a.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(a)){if(!(b instanceof Uint8Array)){if(!at(b))throw TypeError(ar(a,b,...au,"Uint8Array"));if("secret"!==b.type)throw TypeError(`${au.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}}else{if(!at(b))throw TypeError(ar(a,b,...au));if("secret"===b.type)throw TypeError(`${au.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===c&&"public"===b.type)throw TypeError(`${au.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===c&&"public"===b.type)throw TypeError(`${au.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(b.algorithm&&"verify"===c&&"private"===b.type)throw TypeError(`${au.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(b.algorithm&&"encrypt"===c&&"private"===b.type)throw TypeError(`${au.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)}},bn=(a,b,c,d,e)=>{let f;if(aj(c))ao(c,a,"encrypt"),f=W.KeyObject.from(c);else if(c instanceof Uint8Array||ad(c))f=c;else throw TypeError(aq(c,...au,"Uint8Array"));switch(ae(a,f),ab(a,d),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(a,b,c,d,e){let f=parseInt(a.slice(1,4),10);ad(c)&&(c=c.export());let g=c.subarray(f>>3),h=c.subarray(0,f>>3),i=`aes-${f}-cbc`;if(!as(i))throw new Z.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let j=(0,W.createCipheriv)(i,g,d),k=(0,af.concat)(j.update(b),j.final()),l=ah(e,d,k,parseInt(a.slice(-3),10),h,f);return{ciphertext:k,tag:l}}(a,b,f,d,e);case"A128GCM":case"A192GCM":case"A256GCM":var g=f;let h=parseInt(a.slice(1,4),10),i=`aes-${h}-gcm`;if(!as(i))throw new Z.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let j=(0,W.createCipheriv)(i,g,d,{authTagLength:16});e.byteLength&&j.setAAD(e,{plaintextLength:b.length});let k=j.update(b);return j.final(),{ciphertext:k,tag:j.getAuthTag()};default:throw new Z.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}};async function bo(a,b,c,d){let e=a.slice(0,7);d||(d=aa(e));let{ciphertext:f,tag:g}=await bn(e,c,b,d,new Uint8Array(0));return{encryptedKey:f,iv:(0,Y.encode)(d),tag:(0,Y.encode)(g)}}async function bp(a,b,c,d,e){return av(a.slice(0,7),b,c,d,e,new Uint8Array(0))}async function bq(a,b,c,d,e){switch(bm(a,b,"decrypt"),a){case"dir":if(void 0!==c)throw new Z.JWEInvalid("Encountered unexpected JWE Encrypted Key");return b;case"ECDH-ES":if(void 0!==c)throw new Z.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let e,f;if(!(0,aA.default)(d.epk))throw new Z.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!aP(b))throw new Z.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let g=await bl(d.epk,a);if(void 0!==d.apu){if("string"!=typeof d.apu)throw new Z.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{e=(0,Y.decode)(d.apu)}catch{throw new Z.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==d.apv){if("string"!=typeof d.apv)throw new Z.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{f=(0,Y.decode)(d.apv)}catch{throw new Z.JWEInvalid("Failed to base64url decode the apv")}}let h=await aN(g,b,"ECDH-ES"===a?d.enc:a,"ECDH-ES"===a?a1(d.enc):parseInt(a.slice(-5,-2),10),e,f);if("ECDH-ES"===a)return h;if(void 0===c)throw new Z.JWEInvalid("JWE Encrypted Key missing");return aF(a.slice(-6),h,c)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":let f,g,h;if(void 0===c)throw new Z.JWEInvalid("JWE Encrypted Key missing");return f=a$(a),g=a_(a),aZ(h=a0(b,a,"unwrapKey","decrypt"),a),(0,W.privateDecrypt)({key:h,oaepHash:g,padding:f},c);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let f;if(void 0===c)throw new Z.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof d.p2c)throw new Z.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let g=(null==e?void 0:e.maxPBES2Count)||1e4;if(d.p2c>g)throw new Z.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof d.p2s)throw new Z.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{f=(0,Y.decode)(d.p2s)}catch{throw new Z.JWEInvalid("Failed to base64url decode the p2s")}return aU(a,b,c,d.p2c,f)}case"A128KW":case"A192KW":case"A256KW":if(void 0===c)throw new Z.JWEInvalid("JWE Encrypted Key missing");return aF(a,b,c);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let e,f;if(void 0===c)throw new Z.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof d.iv)throw new Z.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof d.tag)throw new Z.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{e=(0,Y.decode)(d.iv)}catch{throw new Z.JWEInvalid("Failed to base64url decode the iv")}try{f=(0,Y.decode)(d.tag)}catch{throw new Z.JWEInvalid("Failed to base64url decode the tag")}return bp(a,b,c,e,f)}default:throw new Z.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}let br=function(a,b,c,d,e){let f;if(void 0!==e.crit&&void 0===d.crit)throw new a('"crit" (Critical) Header Parameter MUST be integrity protected');if(!d||void 0===d.crit)return new Set;if(!Array.isArray(d.crit)||0===d.crit.length||d.crit.some(a=>"string"!=typeof a||0===a.length))throw new a('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let g of(f=void 0!==c?new Map([...Object.entries(c),...b.entries()]):b,d.crit)){if(!f.has(g))throw new Z.JOSENotSupported(`Extension Header Parameter "${g}" is not recognized`);if(void 0===e[g])throw new a(`Extension Header Parameter "${g}" is missing`);if(f.get(g)&&void 0===d[g])throw new a(`Extension Header Parameter "${g}" MUST be integrity protected`)}return new Set(d.crit)},bs=(a,b)=>{if(void 0!==b&&(!Array.isArray(b)||b.some(a=>"string"!=typeof a)))throw TypeError(`"${a}" option must be an array of strings`);if(b)return new Set(b)};async function bt(a,b,c){var d;let e,f,g,h,i,j,k;if(!(0,aA.default)(a))throw new Z.JWEInvalid("Flattened JWE must be an object");if(void 0===a.protected&&void 0===a.header&&void 0===a.unprotected)throw new Z.JWEInvalid("JOSE Header missing");if("string"!=typeof a.iv)throw new Z.JWEInvalid("JWE Initialization Vector missing or incorrect type");if("string"!=typeof a.ciphertext)throw new Z.JWEInvalid("JWE Ciphertext missing or incorrect type");if("string"!=typeof a.tag)throw new Z.JWEInvalid("JWE Authentication Tag missing or incorrect type");if(void 0!==a.protected&&"string"!=typeof a.protected)throw new Z.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==a.encrypted_key&&"string"!=typeof a.encrypted_key)throw new Z.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==a.aad&&"string"!=typeof a.aad)throw new Z.JWEInvalid("JWE AAD incorrect type");if(void 0!==a.header&&!(0,aA.default)(a.header))throw new Z.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==a.unprotected&&!(0,aA.default)(a.unprotected))throw new Z.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(a.protected)try{let b=(0,Y.decode)(a.protected);e=JSON.parse(af.decoder.decode(b))}catch{throw new Z.JWEInvalid("JWE Protected Header is invalid")}if(!az(e,a.header,a.unprotected))throw new Z.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let l={...e,...a.header,...a.unprotected};if(br(Z.JWEInvalid,new Map,null==c?void 0:c.crit,e,l),void 0!==l.zip){if(!e||!e.zip)throw new Z.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==l.zip)throw new Z.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:m,enc:n}=l;if("string"!=typeof m||!m)throw new Z.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof n||!n)throw new Z.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let o=c&&bs("keyManagementAlgorithms",c.keyManagementAlgorithms),p=c&&bs("contentEncryptionAlgorithms",c.contentEncryptionAlgorithms);if(o&&!o.has(m))throw new Z.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(p&&!p.has(n))throw new Z.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==a.encrypted_key)try{f=(0,Y.decode)(a.encrypted_key)}catch{throw new Z.JWEInvalid("Failed to base64url decode the encrypted_key")}let q=!1;"function"==typeof b&&(b=await b(e,a),q=!0);try{g=await bq(m,b,f,l,c)}catch(a){if(a instanceof TypeError||a instanceof Z.JWEInvalid||a instanceof Z.JOSENotSupported)throw a;g=a2(n)}try{h=(0,Y.decode)(a.iv)}catch{throw new Z.JWEInvalid("Failed to base64url decode the iv")}try{i=(0,Y.decode)(a.tag)}catch{throw new Z.JWEInvalid("Failed to base64url decode the tag")}let r=af.encoder.encode(null!=(d=a.protected)?d:"");j=void 0!==a.aad?(0,af.concat)(r,af.encoder.encode("."),af.encoder.encode(a.aad)):r;try{k=(0,Y.decode)(a.ciphertext)}catch{throw new Z.JWEInvalid("Failed to base64url decode the ciphertext")}let s=await av(n,g,k,h,i,j);"DEF"===l.zip&&(s=await ((null==c?void 0:c.inflateRaw)||(a=>ax(a,{maxOutputLength:25e4}).catch(()=>{throw new Z.JWEDecompressionFailed})))(s));let t={plaintext:s};if(void 0!==a.protected&&(t.protectedHeader=e),void 0!==a.aad)try{t.additionalAuthenticatedData=(0,Y.decode)(a.aad)}catch{throw new Z.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==a.unprotected&&(t.sharedUnprotectedHeader=a.unprotected),void 0!==a.header&&(t.unprotectedHeader=a.header),q)?{...t,key:b}:t}async function bu(a,b,c){if(a instanceof Uint8Array&&(a=af.decoder.decode(a)),"string"!=typeof a)throw new Z.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:d,1:e,2:f,3:g,4:h,length:i}=a.split(".");if(5!==i)throw new Z.JWEInvalid("Invalid Compact JWE");let j=await bt({ciphertext:g,iv:f||void 0,protected:d||void 0,tag:h||void 0,encrypted_key:e||void 0},b,c),k={plaintext:j.plaintext,protectedHeader:j.protectedHeader};return"function"==typeof b?{...k,key:j.key}:k}async function bv(a,b,c){if(!(0,aA.default)(a))throw new Z.JWEInvalid("General JWE must be an object");if(!Array.isArray(a.recipients)||!a.recipients.every(aA.default))throw new Z.JWEInvalid("JWE Recipients missing or incorrect type");if(!a.recipients.length)throw new Z.JWEInvalid("JWE Recipients has no members");for(let d of a.recipients)try{return await bt({aad:a.aad,ciphertext:a.ciphertext,encrypted_key:d.encrypted_key,header:d.header,iv:a.iv,protected:a.protected,tag:a.tag,unprotected:a.unprotected},b,c)}catch{}throw new Z.JWEDecryptionFailed}class bw{constructor(a){if(48!==a[0]||(this.buffer=a,this.offset=1,this.decodeLength()!==a.length-this.offset))throw TypeError()}decodeLength(){let a=this.buffer[this.offset++];if(128&a){let b=-129&a;a=0;for(let c=0;c<b;c++)a=a<<8|this.buffer[this.offset+c];this.offset+=b}return a}unsignedInteger(){if(2!==this.buffer[this.offset++])throw TypeError();let a=this.decodeLength();0===this.buffer[this.offset]&&(this.offset++,a--);let b=this.buffer.slice(this.offset,this.offset+a);return this.offset+=a,b}end(){if(this.offset!==this.buffer.length)throw TypeError()}}let bx=a=>{let b;if(aj(a)){if(!a.extractable)throw TypeError("CryptoKey is not extractable");b=W.KeyObject.from(a)}else if(ad(a))b=a;else if(a instanceof Uint8Array)return{kty:"oct",k:(0,Y.encode)(a)};else throw TypeError(aq(a,...au,"Uint8Array"));if(bf){if("secret"!==b.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(b.asymmetricKeyType))throw new Z.JOSENotSupported("Unsupported key asymmetricKeyType");return b.export({format:"jwk"})}switch(b.type){case"secret":return{kty:"oct",k:(0,Y.encode)(b.export())};case"private":case"public":switch(b.asymmetricKeyType){case"rsa":{let a,c=new bw(b.export({format:"der",type:"pkcs1"}));"private"===b.type&&c.unsignedInteger();let d=(0,Y.encode)(c.unsignedInteger()),e=(0,Y.encode)(c.unsignedInteger());return"private"===b.type&&(a={d:(0,Y.encode)(c.unsignedInteger()),p:(0,Y.encode)(c.unsignedInteger()),q:(0,Y.encode)(c.unsignedInteger()),dp:(0,Y.encode)(c.unsignedInteger()),dq:(0,Y.encode)(c.unsignedInteger()),qi:(0,Y.encode)(c.unsignedInteger())}),c.end(),{kty:"RSA",n:d,e,...a}}case"ec":{let a,c,d,e=aL(b);switch(e){case"secp256k1":a=64,c=33,d=-1;break;case"P-256":a=64,c=36,d=-1;break;case"P-384":a=96,c=35,d=-3;break;case"P-521":a=132,c=35,d=-3;break;default:throw new Z.JOSENotSupported("Unsupported curve")}if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"EC",crv:e,x:(0,Y.encode)(c.subarray(-a,-a/2)),y:(0,Y.encode)(c.subarray(-a/2))}}let f=b.export({type:"pkcs8",format:"der"});return f.length<100&&(c+=d),{...bx((0,W.createPublicKey)(b)),d:(0,Y.encode)(f.subarray(c,c+a/2))}}case"ed25519":case"x25519":{let a=aL(b);if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"OKP",crv:a,x:(0,Y.encode)(c.subarray(-32))}}let c=b.export({type:"pkcs8",format:"der"});return{...bx((0,W.createPublicKey)(b)),d:(0,Y.encode)(c.subarray(-32))}}case"ed448":case"x448":{let a=aL(b);if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"OKP",crv:a,x:(0,Y.encode)(c.subarray("Ed448"===a?-57:-56))}}let c=b.export({type:"pkcs8",format:"der"});return{...bx((0,W.createPublicKey)(b)),d:(0,Y.encode)(c.subarray("Ed448"===a?-57:-56))}}default:throw new Z.JOSENotSupported("Unsupported key asymmetricKeyType")}default:throw new Z.JOSENotSupported("Unsupported key type")}};async function by(a){return a3("public","spki",a)}async function bz(a){return a3("private","pkcs8",a)}async function bA(a){return bx(a)}async function bB(a,b,c,d,e={}){let f,g,h;switch(bm(a,c,"encrypt"),a){case"dir":h=c;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!aP(c))throw new Z.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:i,apv:j}=e,{epk:k}=e;k||(k=(await aO(c)).privateKey);let{x:l,y:m,crv:n,kty:o}=await bA(k),p=await aN(c,k,"ECDH-ES"===a?b:a,"ECDH-ES"===a?a1(b):parseInt(a.slice(-5,-2),10),i,j);if(g={epk:{x:l,crv:n,kty:o}},"EC"===o&&(g.epk.y=m),i&&(g.apu=(0,Y.encode)(i)),j&&(g.apv=(0,Y.encode)(j)),"ECDH-ES"===a){h=p;break}h=d||a2(b);let q=a.slice(-6);f=await aE(q,p,h);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":var i;let j,k,l;h=d||a2(b),f=await (i=h,j=a$(a),k=a_(a),aZ(l=a0(c,a,"wrapKey","encrypt"),a),(0,W.publicEncrypt)({key:l,oaepHash:k,padding:j},i));break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{h=d||a2(b);let{p2c:i,p2s:j}=e;({encryptedKey:f,...g}=await aT(a,c,h,i,j));break}case"A128KW":case"A192KW":case"A256KW":h=d||a2(b),f=await aE(a,c,h);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{h=d||a2(b);let{iv:i}=e;({encryptedKey:f,...g}=await bo(a,c,h,i));break}default:throw new Z.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:h,encryptedKey:f,parameters:g}}let bC=Symbol();class bD{constructor(a){if(!(a instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=a}setKeyManagementParameters(a){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=a,this}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setSharedUnprotectedHeader(a){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=a,this}setUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}setAdditionalAuthenticatedData(a){return this._aad=a,this}setContentEncryptionKey(a){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=a,this}setInitializationVector(a){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=a,this}async encrypt(a,b){let c,d,e,f,g,h,i;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new Z.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!az(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new Z.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let j={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if(br(Z.JWEInvalid,new Map,null==b?void 0:b.crit,this._protectedHeader,j),void 0!==j.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new Z.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==j.zip)throw new Z.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:k,enc:l}=j;if("string"!=typeof k||!k)throw new Z.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof l||!l)throw new Z.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===k){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===k&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let e;({cek:d,encryptedKey:c,parameters:e}=await bB(k,l,a,this._cek,this._keyManagementParameters)),e&&(b&&bC in b?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...e}:this.setUnprotectedHeader(e):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...e}:this.setProtectedHeader(e))}if(this._iv||(this._iv=aa(l)),f=this._protectedHeader?af.encoder.encode((0,Y.encode)(JSON.stringify(this._protectedHeader))):af.encoder.encode(""),this._aad?(g=(0,Y.encode)(this._aad),e=(0,af.concat)(f,af.encoder.encode("."),af.encoder.encode(g))):e=f,"DEF"===j.zip){let a=await ((null==b?void 0:b.deflateRaw)||(a=>ay(a)))(this._plaintext);({ciphertext:h,tag:i}=await bn(l,a,d,this._iv,e))}else({ciphertext:h,tag:i}=await bn(l,this._plaintext,d,this._iv,e));let m={ciphertext:(0,Y.encode)(h),iv:(0,Y.encode)(this._iv),tag:(0,Y.encode)(i)};return c&&(m.encrypted_key=(0,Y.encode)(c)),g&&(m.aad=g),this._protectedHeader&&(m.protected=af.decoder.decode(f)),this._sharedUnprotectedHeader&&(m.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(m.header=this._unprotectedHeader),m}}class bE{constructor(a,b,c){this.parent=a,this.key=b,this.options=c}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}addRecipient(...a){return this.parent.addRecipient(...a)}encrypt(...a){return this.parent.encrypt(...a)}done(){return this.parent}}class bF{constructor(a){this._recipients=[],this._plaintext=a}addRecipient(a,b){let c=new bE(this,a,{crit:null==b?void 0:b.crit});return this._recipients.push(c),c}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setSharedUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}setAdditionalAuthenticatedData(a){return this._aad=a,this}async encrypt(a){var b,c,d;let e;if(!this._recipients.length)throw new Z.JWEInvalid("at least one recipient must be added");if(a={deflateRaw:null==a?void 0:a.deflateRaw},1===this._recipients.length){let[b]=this._recipients,c=await new bD(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(b.unprotectedHeader).encrypt(b.key,{...b.options,...a}),d={ciphertext:c.ciphertext,iv:c.iv,recipients:[{}],tag:c.tag};return c.aad&&(d.aad=c.aad),c.protected&&(d.protected=c.protected),c.unprotected&&(d.unprotected=c.unprotected),c.encrypted_key&&(d.recipients[0].encrypted_key=c.encrypted_key),c.header&&(d.recipients[0].header=c.header),d}for(let a=0;a<this._recipients.length;a++){let b=this._recipients[a];if(!az(this._protectedHeader,this._unprotectedHeader,b.unprotectedHeader))throw new Z.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let c={...this._protectedHeader,...this._unprotectedHeader,...b.unprotectedHeader},{alg:d}=c;if("string"!=typeof d||!d)throw new Z.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===d||"ECDH-ES"===d)throw new Z.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof c.enc||!c.enc)throw new Z.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(e){if(e!==c.enc)throw new Z.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else e=c.enc;if(br(Z.JWEInvalid,new Map,b.options.crit,this._protectedHeader,c),void 0!==c.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new Z.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let f=a2(e),g={ciphertext:"",iv:"",recipients:[],tag:""};for(let h=0;h<this._recipients.length;h++){let i=this._recipients[h],j={};g.recipients.push(j);let k=({...this._protectedHeader,...this._unprotectedHeader,...i.unprotectedHeader}).alg.startsWith("PBES2")?2048+h:void 0;if(0===h){let b=await new bD(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(f).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(i.unprotectedHeader).setKeyManagementParameters({p2c:k}).encrypt(i.key,{...i.options,...a,[bC]:!0});g.ciphertext=b.ciphertext,g.iv=b.iv,g.tag=b.tag,b.aad&&(g.aad=b.aad),b.protected&&(g.protected=b.protected),b.unprotected&&(g.unprotected=b.unprotected),j.encrypted_key=b.encrypted_key,b.header&&(j.header=b.header);continue}let{encryptedKey:l,parameters:m}=await bB((null==(b=i.unprotectedHeader)?void 0:b.alg)||(null==(c=this._protectedHeader)?void 0:c.alg)||(null==(d=this._unprotectedHeader)?void 0:d.alg),e,i.key,f,{p2c:k});j.encrypted_key=(0,Y.encode)(l),(i.unprotectedHeader||m)&&(j.header={...i.unprotectedHeader,...m})}return g}}function bG(a){switch(a){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"EdDSA":return;default:throw new Z.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}let bH={padding:W.constants.RSA_PKCS1_PSS_PADDING,saltLength:W.constants.RSA_PSS_SALTLEN_DIGEST},bI=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);function bJ(a,b){switch(a){case"EdDSA":if(!["ed25519","ed448"].includes(b.asymmetricKeyType))throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");return b;case"RS256":case"RS384":case"RS512":if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return aY(b,a),b;case be&&"PS256":case be&&"PS384":case be&&"PS512":if("rsa-pss"===b.asymmetricKeyType){let{hashAlgorithm:c,mgf1HashAlgorithm:d,saltLength:e}=b.asymmetricKeyDetails,f=parseInt(a.slice(-3),10);if(void 0!==c&&(c!==`sha${f}`||d!==c))throw TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${a}`);if(void 0!==e&&e>f>>3)throw TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${a}`)}else if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");return aY(b,a),{key:b,...bH};case!be&&"PS256":case!be&&"PS384":case!be&&"PS512":if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return aY(b,a),{key:b,...bH};case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let c=aL(b),d=bI.get(a);if(c!==d)throw TypeError(`Invalid key curve for the algorithm, its curve must be ${d}, got ${c}`);return{dsaEncoding:"ieee-p1363",key:b}}default:throw new Z.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}function bK(a,b,c){if(b instanceof Uint8Array){if(!a.startsWith("HS"))throw TypeError(aq(b,...au));return(0,W.createSecretKey)(b)}if(b instanceof W.KeyObject)return b;if(aj(b))return!function(a,b,...c){switch(b){case"HS256":case"HS384":case"HS512":{if(!al(a.algorithm,"HMAC"))throw ak("HMAC");let c=parseInt(b.slice(2),10);if(am(a.algorithm.hash)!==c)throw ak(`SHA-${c}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!al(a.algorithm,"RSASSA-PKCS1-v1_5"))throw ak("RSASSA-PKCS1-v1_5");let c=parseInt(b.slice(2),10);if(am(a.algorithm.hash)!==c)throw ak(`SHA-${c}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!al(a.algorithm,"RSA-PSS"))throw ak("RSA-PSS");let c=parseInt(b.slice(2),10);if(am(a.algorithm.hash)!==c)throw ak(`SHA-${c}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==a.algorithm.name&&"Ed448"!==a.algorithm.name)throw ak("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!al(a.algorithm,"ECDSA"))throw ak("ECDSA");let c=function(a){switch(a){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(b);if(a.algorithm.namedCurve!==c)throw ak(c,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}an(a,c)}(b,a,c),W.KeyObject.from(b);throw TypeError(aq(b,...au,"Uint8Array"))}c=W.sign.length>3?(0,ac.promisify)(W.sign):W.sign;let bL=async(a,b,d)=>{let e=bK(a,b,"sign");if(a.startsWith("HS")){let b=W.createHmac(function(a){switch(a){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new Z.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}(a),e);return b.update(d),b.digest()}return c(bG(a),d,bJ(a,e))};d=W.verify.length>4&&(bc>=16||15===bc&&bd>=13)?(0,ac.promisify)(W.verify):W.verify;let bM=async(a,b,c,e)=>{let f=bK(a,b,"verify");if(a.startsWith("HS")){let b=await bL(a,f,e);try{return W.timingSafeEqual(c,b)}catch{return!1}}let g=bG(a),h=bJ(a,f);try{return await d(g,e,h,c)}catch{return!1}};async function bN(a,b,c){var d;let e,f;if(!(0,aA.default)(a))throw new Z.JWSInvalid("Flattened JWS must be an object");if(void 0===a.protected&&void 0===a.header)throw new Z.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==a.protected&&"string"!=typeof a.protected)throw new Z.JWSInvalid("JWS Protected Header incorrect type");if(void 0===a.payload)throw new Z.JWSInvalid("JWS Payload missing");if("string"!=typeof a.signature)throw new Z.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==a.header&&!(0,aA.default)(a.header))throw new Z.JWSInvalid("JWS Unprotected Header incorrect type");let g={};if(a.protected)try{let b=(0,Y.decode)(a.protected);g=JSON.parse(af.decoder.decode(b))}catch{throw new Z.JWSInvalid("JWS Protected Header is invalid")}if(!az(g,a.header))throw new Z.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let h={...g,...a.header},i=br(Z.JWSInvalid,new Map([["b64",!0]]),null==c?void 0:c.crit,g,h),j=!0;if(i.has("b64")&&"boolean"!=typeof(j=g.b64))throw new Z.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:k}=h;if("string"!=typeof k||!k)throw new Z.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let l=c&&bs("algorithms",c.algorithms);if(l&&!l.has(k))throw new Z.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(j){if("string"!=typeof a.payload)throw new Z.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof a.payload&&!(a.payload instanceof Uint8Array))throw new Z.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let m=!1;"function"==typeof b&&(b=await b(g,a),m=!0),bm(k,b,"verify");let n=(0,af.concat)(af.encoder.encode(null!=(d=a.protected)?d:""),af.encoder.encode("."),"string"==typeof a.payload?af.encoder.encode(a.payload):a.payload);try{e=(0,Y.decode)(a.signature)}catch{throw new Z.JWSInvalid("Failed to base64url decode the signature")}if(!await bM(k,b,e,n))throw new Z.JWSSignatureVerificationFailed;if(j)try{f=(0,Y.decode)(a.payload)}catch{throw new Z.JWSInvalid("Failed to base64url decode the payload")}else f="string"==typeof a.payload?af.encoder.encode(a.payload):a.payload;let o={payload:f};return(void 0!==a.protected&&(o.protectedHeader=g),void 0!==a.header&&(o.unprotectedHeader=a.header),m)?{...o,key:b}:o}async function bO(a,b,c){if(a instanceof Uint8Array&&(a=af.decoder.decode(a)),"string"!=typeof a)throw new Z.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:d,1:e,2:f,length:g}=a.split(".");if(3!==g)throw new Z.JWSInvalid("Invalid Compact JWS");let h=await bN({payload:e,protected:d,signature:f},b,c),i={payload:h.payload,protectedHeader:h.protectedHeader};return"function"==typeof b?{...i,key:h.key}:i}async function bP(a,b,c){if(!(0,aA.default)(a))throw new Z.JWSInvalid("General JWS must be an object");if(!Array.isArray(a.signatures)||!a.signatures.every(aA.default))throw new Z.JWSInvalid("JWS Signatures missing or incorrect type");for(let d of a.signatures)try{return await bN({header:d.header,payload:a.payload,protected:d.protected,signature:d.signature},b,c)}catch{}throw new Z.JWSSignatureVerificationFailed}let bQ=a=>Math.floor(a.getTime()/1e3),bR=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,bS=a=>{let b=bR.exec(a);if(!b)throw TypeError("Invalid time period format");let c=parseFloat(b[1]);switch(b[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(c);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*c);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*c);case"day":case"days":case"d":return Math.round(86400*c);case"week":case"weeks":case"w":return Math.round(604800*c);default:return Math.round(0x1e187e0*c)}},bT=a=>a.toLowerCase().replace(/^application\//,""),bU=(a,b,c={})=>{var d,e;let f,g,{typ:h}=c;if(h&&("string"!=typeof a.typ||bT(a.typ)!==bT(h)))throw new Z.JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");try{f=JSON.parse(af.decoder.decode(b))}catch{}if(!(0,aA.default)(f))throw new Z.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims:i=[],issuer:j,subject:k,audience:l,maxTokenAge:m}=c;for(let a of(void 0!==m&&i.push("iat"),void 0!==l&&i.push("aud"),void 0!==k&&i.push("sub"),void 0!==j&&i.push("iss"),new Set(i.reverse())))if(!(a in f))throw new Z.JWTClaimValidationFailed(`missing required "${a}" claim`,a,"missing");if(j&&!(Array.isArray(j)?j:[j]).includes(f.iss))throw new Z.JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(k&&f.sub!==k)throw new Z.JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(l&&(d=f.aud,e="string"==typeof l?[l]:l,"string"==typeof d?!e.includes(d):!(Array.isArray(d)&&e.some(Set.prototype.has.bind(new Set(d))))))throw new Z.JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");switch(typeof c.clockTolerance){case"string":g=bS(c.clockTolerance);break;case"number":g=c.clockTolerance;break;case"undefined":g=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:n}=c,o=bQ(n||new Date);if((void 0!==f.iat||m)&&"number"!=typeof f.iat)throw new Z.JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(void 0!==f.nbf){if("number"!=typeof f.nbf)throw new Z.JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(f.nbf>o+g)throw new Z.JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==f.exp){if("number"!=typeof f.exp)throw new Z.JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(f.exp<=o-g)throw new Z.JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(m){let a=o-f.iat;if(a-g>("number"==typeof m?m:bS(m)))throw new Z.JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(a<0-g)throw new Z.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return f};async function bV(a,b,c){var d;let e=await bO(a,b,c);if((null==(d=e.protectedHeader.crit)?void 0:d.includes("b64"))&&!1===e.protectedHeader.b64)throw new Z.JWTInvalid("JWTs MUST NOT use unencoded payload");let f={payload:bU(e.protectedHeader,e.payload,c),protectedHeader:e.protectedHeader};return"function"==typeof b?{...f,key:e.key}:f}async function bW(a,b,c){let d=await bu(a,b,c),e=bU(d.protectedHeader,d.plaintext,c),{protectedHeader:f}=d;if(void 0!==f.iss&&f.iss!==e.iss)throw new Z.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==f.sub&&f.sub!==e.sub)throw new Z.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==f.aud&&JSON.stringify(f.aud)!==JSON.stringify(e.aud))throw new Z.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',"aud","mismatch");let g={payload:e,protectedHeader:f};return"function"==typeof b?{...g,key:d.key}:g}class bX{constructor(a){this._flattened=new bD(a)}setContentEncryptionKey(a){return this._flattened.setContentEncryptionKey(a),this}setInitializationVector(a){return this._flattened.setInitializationVector(a),this}setProtectedHeader(a){return this._flattened.setProtectedHeader(a),this}setKeyManagementParameters(a){return this._flattened.setKeyManagementParameters(a),this}async encrypt(a,b){let c=await this._flattened.encrypt(a,b);return[c.protected,c.encrypted_key,c.iv,c.ciphertext,c.tag].join(".")}}class bY{constructor(a){if(!(a instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=a}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}async sign(a,b){let c;if(!this._protectedHeader&&!this._unprotectedHeader)throw new Z.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!az(this._protectedHeader,this._unprotectedHeader))throw new Z.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let d={...this._protectedHeader,...this._unprotectedHeader},e=br(Z.JWSInvalid,new Map([["b64",!0]]),null==b?void 0:b.crit,this._protectedHeader,d),f=!0;if(e.has("b64")&&"boolean"!=typeof(f=this._protectedHeader.b64))throw new Z.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:g}=d;if("string"!=typeof g||!g)throw new Z.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');bm(g,a,"sign");let h=this._payload;f&&(h=af.encoder.encode((0,Y.encode)(h))),c=this._protectedHeader?af.encoder.encode((0,Y.encode)(JSON.stringify(this._protectedHeader))):af.encoder.encode("");let i=(0,af.concat)(c,af.encoder.encode("."),h),j=await bL(g,a,i),k={signature:(0,Y.encode)(j),payload:""};return f&&(k.payload=af.decoder.decode(h)),this._unprotectedHeader&&(k.header=this._unprotectedHeader),this._protectedHeader&&(k.protected=af.decoder.decode(c)),k}}class bZ{constructor(a){this._flattened=new bY(a)}setProtectedHeader(a){return this._flattened.setProtectedHeader(a),this}async sign(a,b){let c=await this._flattened.sign(a,b);if(void 0===c.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${c.protected}.${c.payload}.${c.signature}`}}class b${constructor(a,b,c){this.parent=a,this.key=b,this.options=c}setProtectedHeader(a){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=a,this}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}addSignature(...a){return this.parent.addSignature(...a)}sign(...a){return this.parent.sign(...a)}done(){return this.parent}}class b_{constructor(a){this._signatures=[],this._payload=a}addSignature(a,b){let c=new b$(this,a,b);return this._signatures.push(c),c}async sign(){if(!this._signatures.length)throw new Z.JWSInvalid("at least one signature must be added");let a={signatures:[],payload:""};for(let b=0;b<this._signatures.length;b++){let c=this._signatures[b],d=new bY(this._payload);d.setProtectedHeader(c.protectedHeader),d.setUnprotectedHeader(c.unprotectedHeader);let{payload:e,...f}=await d.sign(c.key,c.options);if(0===b)a.payload=e;else if(a.payload!==e)throw new Z.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");a.signatures.push(f)}return a}}class b0{constructor(a){if(!(0,aA.default)(a))throw TypeError("JWT Claims Set MUST be an object");this._payload=a}setIssuer(a){return this._payload={...this._payload,iss:a},this}setSubject(a){return this._payload={...this._payload,sub:a},this}setAudience(a){return this._payload={...this._payload,aud:a},this}setJti(a){return this._payload={...this._payload,jti:a},this}setNotBefore(a){return"number"==typeof a?this._payload={...this._payload,nbf:a}:this._payload={...this._payload,nbf:bQ(new Date)+bS(a)},this}setExpirationTime(a){return"number"==typeof a?this._payload={...this._payload,exp:a}:this._payload={...this._payload,exp:bQ(new Date)+bS(a)},this}setIssuedAt(a){return void 0===a?this._payload={...this._payload,iat:bQ(new Date)}:this._payload={...this._payload,iat:a},this}}class b1 extends b0{setProtectedHeader(a){return this._protectedHeader=a,this}async sign(a,b){var c;let d=new bZ(af.encoder.encode(JSON.stringify(this._payload)));if(d.setProtectedHeader(this._protectedHeader),Array.isArray(null==(c=this._protectedHeader)?void 0:c.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new Z.JWTInvalid("JWTs MUST NOT use unencoded payload");return d.sign(a,b)}}class b2 extends b0{setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setKeyManagementParameters(a){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=a,this}setContentEncryptionKey(a){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=a,this}setInitializationVector(a){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=a,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(a,b){let c=new bX(af.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),c.setProtectedHeader(this._protectedHeader),this._iv&&c.setInitializationVector(this._iv),this._cek&&c.setContentEncryptionKey(this._cek),this._keyManagementParameters&&c.setKeyManagementParameters(this._keyManagementParameters),c.encrypt(a,b)}}var b3=a.i(971866);let b4=(a,b)=>{if("string"!=typeof a||!a)throw new Z.JWKInvalid(`${b} missing or invalid`)};async function b5(a,b){let c;if(!(0,aA.default)(a))throw TypeError("JWK must be an object");if(null!=b||(b="sha256"),"sha256"!==b&&"sha384"!==b&&"sha512"!==b)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(a.kty){case"EC":b4(a.crv,'"crv" (Curve) Parameter'),b4(a.x,'"x" (X Coordinate) Parameter'),b4(a.y,'"y" (Y Coordinate) Parameter'),c={crv:a.crv,kty:a.kty,x:a.x,y:a.y};break;case"OKP":b4(a.crv,'"crv" (Subtype of Key Pair) Parameter'),b4(a.x,'"x" (Public Key) Parameter'),c={crv:a.crv,kty:a.kty,x:a.x};break;case"RSA":b4(a.e,'"e" (Exponent) Parameter'),b4(a.n,'"n" (Modulus) Parameter'),c={e:a.e,kty:a.kty,n:a.n};break;case"oct":b4(a.k,'"k" (Key Value) Parameter'),c={k:a.k,kty:a.kty};break;default:throw new Z.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let d=af.encoder.encode(JSON.stringify(c));return(0,Y.encode)(await (0,b3.default)(b,d))}async function b6(a,b){null!=b||(b="sha256");let c=await b5(a,b);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${b.slice(-3)}:${c}`}async function b7(a,b){let c={...a,...null==b?void 0:b.header};if(!(0,aA.default)(c.jwk))throw new Z.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let d=await bl({...c.jwk,ext:!0},c.alg,!0);if(d instanceof Uint8Array||"public"!==d.type)throw new Z.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return d}function b8(a){return a&&"object"==typeof a&&Array.isArray(a.keys)&&a.keys.every(b9)}function b9(a){return(0,aA.default)(a)}class ca{constructor(a){if(this._cached=new WeakMap,!b8(a))throw new Z.JWKSInvalid("JSON Web Key Set malformed");this._jwks=function(a){return"function"==typeof structuredClone?structuredClone(a):JSON.parse(JSON.stringify(a))}(a)}async getKey(a,b){let{alg:c,kid:d}={...a,...null==b?void 0:b.header},e=function(a){switch("string"==typeof a&&a.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new Z.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}(c),f=this._jwks.keys.filter(a=>{let b=e===a.kty;if(b&&"string"==typeof d&&(b=d===a.kid),b&&"string"==typeof a.alg&&(b=c===a.alg),b&&"string"==typeof a.use&&(b="sig"===a.use),b&&Array.isArray(a.key_ops)&&(b=a.key_ops.includes("verify")),b&&"EdDSA"===c&&(b="Ed25519"===a.crv||"Ed448"===a.crv),b)switch(c){case"ES256":b="P-256"===a.crv;break;case"ES256K":b="secp256k1"===a.crv;break;case"ES384":b="P-384"===a.crv;break;case"ES512":b="P-521"===a.crv}return b}),{0:g,length:h}=f;if(0===h)throw new Z.JWKSNoMatchingKey;if(1!==h){let a=new Z.JWKSMultipleMatchingKeys,{_cached:b}=this;throw a[Symbol.asyncIterator]=async function*(){for(let a of f)try{yield await cb(b,a,c)}catch{continue}},a}return cb(this._cached,g,c)}}async function cb(a,b,c){let d=a.get(b)||a.set(b,{}).get(b);if(void 0===d[c]){let a=await bl({...b,ext:!0},c);if(a instanceof Uint8Array||"public"!==a.type)throw new Z.JWKSInvalid("JSON Web Key Set members must be public keys");d[c]=a}return d[c]}function cc(a){let b=new ca(a);return async function(a,c){return b.getKey(a,c)}}var cd=a.i(921517),ce=a.i(524836),cf=a.i(427699);let cg=async(a,b,c)=>{let d;switch(a.protocol){case"https:":d=ce.get;break;case"http:":d=cd.get;break;default:throw TypeError("Unsupported URL protocol.")}let{agent:e,headers:f}=c,g=d(a.href,{agent:e,timeout:b,headers:f}),[h]=await Promise.race([(0,cf.once)(g,"response"),(0,cf.once)(g,"timeout")]);if(!h)throw g.destroy(),new Z.JWKSTimeout;if(200!==h.statusCode)throw new Z.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");let i=[];for await(let a of h)i.push(a);try{return JSON.parse(af.decoder.decode((0,af.concat)(...i)))}catch{throw new Z.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}};class ch extends ca{constructor(a,b){if(super({keys:[]}),this._jwks=void 0,!(a instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(a.href),this._options={agent:null==b?void 0:b.agent,headers:null==b?void 0:b.headers},this._timeoutDuration="number"==typeof(null==b?void 0:b.timeoutDuration)?null==b?void 0:b.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==b?void 0:b.cooldownDuration)?null==b?void 0:b.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==b?void 0:b.cacheMaxAge)?null==b?void 0:b.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(a,b){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(a,b)}catch(c){if(c instanceof Z.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),super.getKey(a,b);throw c}}async reload(){this._pendingFetch&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=cg(this._url,this._timeoutDuration,this._options).then(a=>{if(!b8(a))throw new Z.JWKSInvalid("JSON Web Key Set malformed");this._jwks={keys:a.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(a=>{throw this._pendingFetch=void 0,a})),await this._pendingFetch}}function ci(a,b){let c=new ch(a,b);return async function(a,b){return c.getKey(a,b)}}class cj extends b0{encode(){let a=Y.encode(JSON.stringify({alg:"none"})),b=Y.encode(JSON.stringify(this._payload));return`${a}.${b}.`}static decode(a,b){let c;if("string"!=typeof a)throw new Z.JWTInvalid("Unsecured JWT must be a string");let{0:d,1:e,2:f,length:g}=a.split(".");if(3!==g||""!==f)throw new Z.JWTInvalid("Invalid Unsecured JWT");try{if(c=JSON.parse(af.decoder.decode(Y.decode(d))),"none"!==c.alg)throw Error()}catch{throw new Z.JWTInvalid("Invalid Unsecured JWT")}return{payload:bU(c,Y.decode(e),b),header:c}}}var ck=a.i(733865);function cl(a){let b;if("string"==typeof a){let c=a.split(".");(3===c.length||5===c.length)&&([b]=c)}else if("object"==typeof a&&a)if("protected"in a)b=a.protected;else throw TypeError("Token does not contain a Protected Header");try{if("string"!=typeof b||!b)throw Error();let a=JSON.parse(af.decoder.decode((0,ck.decode)(b)));if(!(0,aA.default)(a))throw Error();return a}catch{throw TypeError("Invalid Token or Protected Header formatting")}}var cm=a.i(629116),$=W;let cn=(0,ac.promisify)(W.generateKeyPair);async function co(a,b){let c;switch(a){case"HS256":case"HS384":case"HS512":case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(a.slice(-3),10);break;case"A128KW":case"A192KW":case"A256KW":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(a.slice(1,4),10);break;default:throw new Z.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return(0,W.createSecretKey)((0,$.randomFillSync)(new Uint8Array(c>>3)))}async function cp(a,b){var c,d;switch(a){case"RS256":case"RS384":case"RS512":case"PS256":case"PS384":case"PS512":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":case"RSA1_5":{let a=null!=(c=null==b?void 0:b.modulusLength)?c:2048;if("number"!=typeof a||a<2048)throw new Z.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");let d=await cn("rsa",{modulusLength:a,publicExponent:65537});return aX(d.privateKey,a),aX(d.publicKey,a),d}case"ES256":return cn("ec",{namedCurve:"P-256"});case"ES256K":return cn("ec",{namedCurve:"secp256k1"});case"ES384":return cn("ec",{namedCurve:"P-384"});case"ES512":return cn("ec",{namedCurve:"P-521"});case"EdDSA":switch(null==b?void 0:b.crv){case void 0:case"Ed25519":return cn("ed25519");case"Ed448":return cn("ed448");default:throw new Z.JOSENotSupported("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":let e=null!=(d=null==b?void 0:b.crv)?d:"P-256";switch(e){case void 0:case"P-256":case"P-384":case"P-521":return cn("ec",{namedCurve:e});case"X25519":return cn("x25519");case"X448":return cn("x448");default:throw new Z.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}default:throw new Z.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}}async function cq(a,b){return cp(a,b)}async function cr(a,b){return co(a,b)}a.s(["CompactEncrypt",()=>bX,"CompactSign",()=>bZ,"EmbeddedJWK",()=>b7,"EncryptJWT",()=>b2,"FlattenedEncrypt",()=>bD,"FlattenedSign",()=>bY,"GeneralEncrypt",()=>bF,"GeneralSign",()=>b_,"SignJWT",()=>b1,"UnsecuredJWT",()=>cj,"base64url",0,ck,"calculateJwkThumbprint",()=>b5,"calculateJwkThumbprintUri",()=>b6,"compactDecrypt",()=>bu,"compactVerify",()=>bO,"createLocalJWKSet",()=>cc,"createRemoteJWKSet",()=>ci,"cryptoRuntime",0,"node:crypto","decodeJwt",()=>cm.decodeJwt,"decodeProtectedHeader",()=>cl,"errors",0,Z,"exportJWK",()=>bA,"exportPKCS8",()=>bz,"exportSPKI",()=>by,"flattenedDecrypt",()=>bt,"flattenedVerify",()=>bN,"generalDecrypt",()=>bv,"generalVerify",()=>bP,"generateKeyPair",()=>cq,"generateSecret",()=>cr,"importJWK",()=>bl,"importPKCS8",()=>bk,"importSPKI",()=>bi,"importX509",()=>bj,"jwtDecrypt",()=>bW,"jwtVerify",()=>bV],812412),a.i(812412);var cs=a.i(296715),ct=a.i(485334),cu=a.i(561607),cv=a.i(77719),cw=a.i(945498),cx=a.i(20246),cy=a.i(843933);class cz{constructor(a,b){this.scope=a,this.module=b}storeObject(a,b){this.setItem(a,JSON.stringify(b))}loadObject(a){let b=this.getItem(a);return b?JSON.parse(b):void 0}setItem(a,b){localStorage.setItem(this.scopedKey(a),b)}getItem(a){return localStorage.getItem(this.scopedKey(a))}removeItem(a){localStorage.removeItem(this.scopedKey(a))}clear(){let a=this.scopedKey(""),b=[];for(let c=0;c<localStorage.length;c++){let d=localStorage.key(c);"string"==typeof d&&d.startsWith(a)&&b.push(d)}b.forEach(a=>localStorage.removeItem(a))}scopedKey(a){return`-${this.scope}${this.module?`:${this.module}`:""}:${a}`}static clearAll(){new cz("CBWSDK").clear(),new cz("walletlink").clear()}}let cA=-32602,cB=-32603,cC=4001,cD=4100,cE=4200,cF=4900,cG={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."},4902:{standard:"EIP-3085",message:"Unrecognized chain ID."}},cH="Unspecified error message.";function cI(a,b=cH){if(a&&Number.isInteger(a)){var c;let b=a.toString();if(cK(cG,b))return cG[b].message;if((c=a)>=-32099&&c<=-32e3)return"Unspecified server error."}return b}function cJ(a){return a&&"object"==typeof a&&!Array.isArray(a)?Object.assign({},a):a}function cK(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function cL(a,b){return"object"==typeof a&&null!==a&&b in a&&"string"==typeof a[b]}let cM=a=>cT(cA,a),cN=a=>cT(cB,a),cO=a=>cU(cC,a),cP=a=>cU(cD,a),cQ=a=>cU(cE,a),cR=a=>cU(cF,a),cS=a=>{if(!a||"object"!=typeof a||Array.isArray(a))throw Error("Ethereum Provider custom errors must provide single object argument.");let{code:b,message:c,data:d}=a;if(!c||"string"!=typeof c)throw Error('"message" must be a nonempty string');return new cX(b,c,d)};function cT(a,b){let[c,d]=cV(b);return new cW(a,c||cI(a),d)}function cU(a,b){let[c,d]=cV(b);return new cX(a,c||cI(a),d)}function cV(a){if(a){if("string"==typeof a)return[a];else if("object"==typeof a&&!Array.isArray(a)){let{message:b,data:c}=a;if(b&&"string"!=typeof b)throw Error("Must specify string message.");return[b||void 0,c]}}return[]}class cW extends Error{constructor(a,b,c){if(!Number.isInteger(a))throw Error('"code" must be an integer.');if(!b||"string"!=typeof b)throw Error('"message" must be a nonempty string.');super(b),this.code=a,void 0!==c&&(this.data=c)}}class cX extends cW{constructor(a,b,c){if(!function(a){return Number.isInteger(a)&&a>=1e3&&a<=4999}(a))throw Error('"code" must be an integer such that: 1000 <= code <= 4999');super(a,b,c)}}function cY(a){return Math.floor(a)}let cZ=/^[0-9]*$/,c$=/^[a-f0-9]*$/;function c_(a){return c0(crypto.getRandomValues(new Uint8Array(a)))}function c0(a){return[...a].map(a=>a.toString(16).padStart(2,"0")).join("")}function c1(a){return new Uint8Array(a.match(/.{1,2}/g).map(a=>Number.parseInt(a,16)))}function c2(a,b=!1){let c=a.toString("hex");return b?`0x${c}`:c}function c3(a){return c2(dc(a),!0)}function c4(a){return a.toString(10)}function c5(a){return`0x${BigInt(a).toString(16)}`}function c6(a){return a.startsWith("0x")||a.startsWith("0X")}function c7(a){return c6(a)?a.slice(2):a}function c8(a){return c6(a)?`0x${a.slice(2)}`:`0x${a}`}function c9(a){if("string"!=typeof a)return!1;let b=c7(a).toLowerCase();return c$.test(b)}function da(a,b=!1){let c=function(a,b=!1){if("string"==typeof a){let c=c7(a).toLowerCase();if(c$.test(c))return b?`0x${c}`:c}throw cM(`"${String(a)}" is not a hexadecimal string`)}(a,!1);return c.length%2==1&&(c=`0${c}`),b?`0x${c}`:c}function db(a){if("string"==typeof a){let b=c7(a).toLowerCase();if(c9(b)&&40===b.length)return c8(b)}throw cM(`Invalid Ethereum address: ${String(a)}`)}function dc(a){if(Buffer.isBuffer(a))return a;if("string"==typeof a){if(c9(a)){let b=da(a,!1);return Buffer.from(b,"hex")}return Buffer.from(a,"utf8")}throw cM(`Not binary data: ${String(a)}`)}function dd(a){if("number"==typeof a&&Number.isInteger(a))return cY(a);if("string"==typeof a){if(cZ.test(a))return cY(Number(a));if(c9(a))return cY(Number(BigInt(da(a,!0))))}throw cM(`Not an integer: ${String(a)}`)}function de(a){if(null!==a&&("bigint"==typeof a||function(a){if(null==a||"function"!=typeof a.constructor)return!1;let{constructor:b}=a;return"function"==typeof b.config&&"number"==typeof b.EUCLID}(a)))return BigInt(a.toString(10));if("number"==typeof a)return BigInt(dd(a));if("string"==typeof a){if(cZ.test(a))return BigInt(a);if(c9(a))return BigInt(da(a,!0))}throw cM(`Not an integer: ${String(a)}`)}async function df(){return crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"])}async function dg(a,b){return crypto.subtle.deriveKey({name:"ECDH",public:b},a,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function dh(a,b){let c=crypto.getRandomValues(new Uint8Array(12)),d=await crypto.subtle.encrypt({name:"AES-GCM",iv:c},a,new TextEncoder().encode(b));return{iv:c,cipherText:d}}async function di(a,{iv:b,cipherText:c}){let d=await crypto.subtle.decrypt({name:"AES-GCM",iv:b},a,c);return new TextDecoder().decode(d)}function dj(a){switch(a){case"public":return"spki";case"private":return"pkcs8"}}async function dk(a,b){let c=dj(a);return c0(new Uint8Array(await crypto.subtle.exportKey(c,b)))}async function dl(a,b){let c=dj(a),d=c1(b).buffer;return await crypto.subtle.importKey(c,new Uint8Array(d),{name:"ECDH",namedCurve:"P-256"},!0,"private"===a?["deriveKey"]:[])}async function dm(a,b){return dh(b,JSON.stringify(a,(a,b)=>b instanceof Error?Object.assign(Object.assign({},b.code?{code:b.code}:{}),{message:b.message}):b))}async function dn(a,b){return JSON.parse(await di(b,a))}let dp={storageKey:"ownPrivateKey",keyType:"private"},dq={storageKey:"ownPublicKey",keyType:"public"},dr={storageKey:"peerPublicKey",keyType:"public"};class ds{constructor(){this.storage=new cz("CBWSDK","SCWKeyManager"),this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null}async getOwnPublicKey(){return await this.loadKeysIfNeeded(),this.ownPublicKey}async getSharedSecret(){return await this.loadKeysIfNeeded(),this.sharedSecret}async setPeerPublicKey(a){this.sharedSecret=null,this.peerPublicKey=a,await this.storeKey(dr,a),await this.loadKeysIfNeeded()}async clear(){this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null,this.storage.removeItem(dq.storageKey),this.storage.removeItem(dp.storageKey),this.storage.removeItem(dr.storageKey)}async generateKeyPair(){let a=await df();this.ownPrivateKey=a.privateKey,this.ownPublicKey=a.publicKey,await this.storeKey(dp,a.privateKey),await this.storeKey(dq,a.publicKey)}async loadKeysIfNeeded(){null===this.ownPrivateKey&&(this.ownPrivateKey=await this.loadKey(dp)),null===this.ownPublicKey&&(this.ownPublicKey=await this.loadKey(dq)),(null===this.ownPrivateKey||null===this.ownPublicKey)&&await this.generateKeyPair(),null===this.peerPublicKey&&(this.peerPublicKey=await this.loadKey(dr)),null===this.sharedSecret&&null!==this.ownPrivateKey&&null!==this.peerPublicKey&&(this.sharedSecret=await dg(this.ownPrivateKey,this.peerPublicKey))}async loadKey(a){let b=this.storage.getItem(a.storageKey);return b?dl(a.keyType,b):null}async storeKey(a,b){let c=await dk(a.keyType,b);this.storage.setItem(a.storageKey,c)}}let dt="4.3.2",du="@coinbase/wallet-sdk";async function dv(a,b){let c=Object.assign(Object.assign({},a),{jsonrpc:"2.0",id:crypto.randomUUID()}),d=await window.fetch(b,{method:"POST",body:JSON.stringify(c),mode:"cors",headers:{"Content-Type":"application/json","X-Cbw-Sdk-Version":dt,"X-Cbw-Sdk-Platform":du}}),{result:e,error:f}=await d.json();if(f)throw f;return e}let dw="accounts",dx="activeChain",dy="availableChains",dz="walletCapabilities";class dA{constructor(a){var b,c,d;this.metadata=a.metadata,this.communicator=a.communicator,this.callback=a.callback,this.keyManager=new ds,this.storage=new cz("CBWSDK","SCWStateManager"),this.accounts=null!=(b=this.storage.loadObject(dw))?b:[],this.chain=this.storage.loadObject(dx)||{id:null!=(d=null==(c=a.metadata.appChainIds)?void 0:c[0])?d:1},this.handshake=this.handshake.bind(this),this.request=this.request.bind(this),this.createRequestMessage=this.createRequestMessage.bind(this),this.decryptResponseMessage=this.decryptResponseMessage.bind(this)}async handshake(a){var b,c,d,e;await (null==(c=(b=this.communicator).waitForPopupLoaded)?void 0:c.call(b));let f=await this.createRequestMessage({handshake:{method:a.method,params:Object.assign({},this.metadata,null!=(d=a.params)?d:{})}}),g=await this.communicator.postRequestAndWaitForResponse(f);if("failure"in g.content)throw g.content.failure;let h=await dl("public",g.sender);await this.keyManager.setPeerPublicKey(h);let i=(await this.decryptResponseMessage(g)).result;if("error"in i)throw i.error;if("eth_requestAccounts"===a.method){let a=i.value;this.accounts=a,this.storage.storeObject(dw,a),null==(e=this.callback)||e.call(this,"accountsChanged",a)}}async request(a){var b;if(0===this.accounts.length)if("wallet_sendCalls"===a.method)return this.sendRequestToPopup(a);else throw cP();switch(a.method){case"eth_requestAccounts":return null==(b=this.callback)||b.call(this,"connect",{chainId:c5(this.chain.id)}),this.accounts;case"eth_accounts":return this.accounts;case"eth_coinbase":return this.accounts[0];case"net_version":return this.chain.id;case"eth_chainId":return c5(this.chain.id);case"wallet_getCapabilities":return this.storage.loadObject(dz);case"wallet_switchEthereumChain":return this.handleSwitchChainRequest(a);case"eth_ecRecover":case"personal_sign":case"wallet_sign":case"personal_ecRecover":case"eth_signTransaction":case"eth_sendTransaction":case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":case"wallet_addEthereumChain":case"wallet_watchAsset":case"wallet_sendCalls":case"wallet_showCallsStatus":case"wallet_grantPermissions":return this.sendRequestToPopup(a);default:if(!this.chain.rpcUrl)throw cN("No RPC URL set for chain");return dv(a,this.chain.rpcUrl)}}async sendRequestToPopup(a){var b,c;await (null==(c=(b=this.communicator).waitForPopupLoaded)?void 0:c.call(b));let d=await this.sendEncryptedRequest(a),e=(await this.decryptResponseMessage(d)).result;if("error"in e)throw e.error;return e.value}async cleanup(){var a,b;this.storage.clear(),await this.keyManager.clear(),this.accounts=[],this.chain={id:null!=(b=null==(a=this.metadata.appChainIds)?void 0:a[0])?b:1}}async handleSwitchChainRequest(a){var b;let c=a.params;if(!c||!(null==(b=c[0])?void 0:b.chainId))throw cM();let d=dd(c[0].chainId);if(this.updateChain(d))return null;let e=await this.sendRequestToPopup(a);return null===e&&this.updateChain(d),e}async sendEncryptedRequest(a){let b=await this.keyManager.getSharedSecret();if(!b)throw cP("No valid session found, try requestAccounts before other methods");let c=await dm({action:a,chainId:this.chain.id},b),d=await this.createRequestMessage({encrypted:c});return this.communicator.postRequestAndWaitForResponse(d)}async createRequestMessage(a){let b=await dk("public",await this.keyManager.getOwnPublicKey());return{id:crypto.randomUUID(),sender:b,content:a,timestamp:new Date}}async decryptResponseMessage(a){var b,c;let d=a.content;if("failure"in d)throw d.failure;let e=await this.keyManager.getSharedSecret();if(!e)throw cP("Invalid session");let f=await dn(d.encrypted,e),g=null==(b=f.data)?void 0:b.chains;if(g){let a=Object.entries(g).map(([a,b])=>({id:Number(a),rpcUrl:b}));this.storage.storeObject(dy,a),this.updateChain(this.chain.id,a)}let h=null==(c=f.data)?void 0:c.capabilities;return h&&this.storage.storeObject(dz,h),f}updateChain(a,b){var c;let d=null!=b?b:this.storage.loadObject(dy),e=null==d?void 0:d.find(b=>b.id===a);return!!e&&(e!==this.chain&&(this.chain=e,this.storage.storeObject(dx,e),null==(c=this.callback)||c.call(this,"chainChanged",c5(e.id))),!0)}}var dB=a.i(449105);let dC="Addresses";function dD(a){return void 0!==a.errorMessage}class dE{constructor(a){this.secret=a}async encrypt(a){let b=this.secret;if(64!==b.length)throw Error("secret must be 256 bits");let c=crypto.getRandomValues(new Uint8Array(12)),d=await crypto.subtle.importKey("raw",c1(b),{name:"aes-gcm"},!1,["encrypt","decrypt"]),e=new TextEncoder,f=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:c},d,e.encode(a)),g=f.slice(f.byteLength-16),h=f.slice(0,f.byteLength-16),i=new Uint8Array(g),j=new Uint8Array(h);return c0(new Uint8Array([...c,...i,...j]))}async decrypt(a){let b=this.secret;if(64!==b.length)throw Error("secret must be 256 bits");return new Promise((c,d)=>{!async function(){let e=await crypto.subtle.importKey("raw",c1(b),{name:"aes-gcm"},!1,["encrypt","decrypt"]),f=c1(a),g=f.slice(0,12),h=f.slice(12,28),i=new Uint8Array([...f.slice(28),...h]),j={name:"AES-GCM",iv:new Uint8Array(g)};try{let a=await window.crypto.subtle.decrypt(j,e,i),b=new TextDecoder;c(b.decode(a))}catch(a){d(a)}}()})}}class dF{constructor(a,b,c){this.linkAPIUrl=a,this.sessionId=b;const d=`${b}:${c}`;this.auth=`Basic ${btoa(d)}`}async markUnseenEventsAsSeen(a){return Promise.all(a.map(a=>fetch(`${this.linkAPIUrl}/events/${a.eventId}/seen`,{method:"POST",headers:{Authorization:this.auth}}))).catch(a=>console.error("Unabled to mark event as failed:",a))}async fetchUnseenEvents(){var a;let b=await fetch(`${this.linkAPIUrl}/events?unseen=true`,{headers:{Authorization:this.auth}});if(b.ok){let{events:c,error:d}=await b.json();if(d)throw Error(`Check unseen events failed: ${d}`);let e=null!=(a=null==c?void 0:c.filter(a=>"Web3Response"===a.event).map(a=>({type:"Event",sessionId:this.sessionId,eventId:a.id,event:a.event,data:a.data})))?a:[];return this.markUnseenEventsAsSeen(e),e}throw Error(`Check unseen events failed: ${b.status}`)}}(dS=dT||(dT={}))[dS.DISCONNECTED=0]="DISCONNECTED",dS[dS.CONNECTING=1]="CONNECTING",dS[dS.CONNECTED=2]="CONNECTED";class dG{setConnectionStateListener(a){this.connectionStateListener=a}setIncomingDataListener(a){this.incomingDataListener=a}constructor(a,b=WebSocket){this.WebSocketClass=b,this.webSocket=null,this.pendingData=[],this.url=a.replace(/^http/,"ws")}async connect(){if(this.webSocket)throw Error("webSocket object is not null");return new Promise((a,b)=>{var c;let d;try{this.webSocket=d=new this.WebSocketClass(this.url)}catch(a){b(a);return}null==(c=this.connectionStateListener)||c.call(this,dT.CONNECTING),d.onclose=a=>{var c;this.clearWebSocket(),b(Error(`websocket error ${a.code}: ${a.reason}`)),null==(c=this.connectionStateListener)||c.call(this,dT.DISCONNECTED)},d.onopen=b=>{var c;a(),null==(c=this.connectionStateListener)||c.call(this,dT.CONNECTED),this.pendingData.length>0&&([...this.pendingData].forEach(a=>this.sendData(a)),this.pendingData=[])},d.onmessage=a=>{var b,c;if("h"===a.data)null==(b=this.incomingDataListener)||b.call(this,{type:"Heartbeat"});else try{let b=JSON.parse(a.data);null==(c=this.incomingDataListener)||c.call(this,b)}catch(a){}}})}disconnect(){var a;let{webSocket:b}=this;if(b){this.clearWebSocket(),null==(a=this.connectionStateListener)||a.call(this,dT.DISCONNECTED),this.connectionStateListener=void 0,this.incomingDataListener=void 0;try{b.close()}catch(a){}}}sendData(a){let{webSocket:b}=this;if(!b){this.pendingData.push(a),this.connect();return}b.send(a)}clearWebSocket(){let{webSocket:a}=this;a&&(this.webSocket=null,a.onclose=null,a.onerror=null,a.onmessage=null,a.onopen=null)}}class dH{constructor({session:a,linkAPIUrl:b,listener:c}){this.destroyed=!1,this.lastHeartbeatResponse=0,this.nextReqId=cY(1),this._connected=!1,this._linked=!1,this.shouldFetchUnseenEventsOnConnect=!1,this.requestResolutions=new Map,this.handleSessionMetadataUpdated=a=>{a&&new Map([["__destroyed",this.handleDestroyed],["EthereumAddress",this.handleAccountUpdated],["WalletUsername",this.handleWalletUsernameUpdated],["AppVersion",this.handleAppVersionUpdated],["ChainId",b=>a.JsonRpcUrl&&this.handleChainUpdated(b,a.JsonRpcUrl)]]).forEach((b,c)=>{let d=a[c];void 0!==d&&b(d)})},this.handleDestroyed=a=>{var b;"1"===a&&(null==(b=this.listener)||b.resetAndReload())},this.handleAccountUpdated=async a=>{var b;let c=await this.cipher.decrypt(a);null==(b=this.listener)||b.accountUpdated(c)},this.handleMetadataUpdated=async(a,b)=>{var c;let d=await this.cipher.decrypt(b);null==(c=this.listener)||c.metadataUpdated(a,d)},this.handleWalletUsernameUpdated=async a=>{this.handleMetadataUpdated("walletUsername",a)},this.handleAppVersionUpdated=async a=>{this.handleMetadataUpdated("AppVersion",a)},this.handleChainUpdated=async(a,b)=>{var c;let d=await this.cipher.decrypt(a),e=await this.cipher.decrypt(b);null==(c=this.listener)||c.chainUpdated(d,e)},this.session=a,this.cipher=new dE(a.secret),this.listener=c;const d=new dG(`${b}/rpc`,WebSocket);d.setConnectionStateListener(async a=>{let b=!1;switch(a){case dT.DISCONNECTED:if(!this.destroyed){let a=async()=>{await new Promise(a=>setTimeout(a,5e3)),this.destroyed||d.connect().catch(()=>{a()})};a()}break;case dT.CONNECTED:b=await this.handleConnected(),this.updateLastHeartbeat(),setInterval(()=>{this.heartbeat()},1e4),this.shouldFetchUnseenEventsOnConnect&&this.fetchUnseenEventsAPI();case dT.CONNECTING:}this.connected!==b&&(this.connected=b)}),d.setIncomingDataListener(a=>{var b;switch(a.type){case"Heartbeat":this.updateLastHeartbeat();return;case"IsLinkedOK":case"Linked":{let b="IsLinkedOK"===a.type?a.linked:void 0;this.linked=b||a.onlineGuests>0;break}case"GetSessionConfigOK":case"SessionConfigUpdated":this.handleSessionMetadataUpdated(a.metadata);break;case"Event":this.handleIncomingEvent(a)}void 0!==a.id&&(null==(b=this.requestResolutions.get(a.id))||b(a))}),this.ws=d,this.http=new dF(b,a.id,a.key)}connect(){if(this.destroyed)throw Error("instance is destroyed");this.ws.connect()}async destroy(){this.destroyed||(await this.makeRequest({type:"SetSessionConfig",id:cY(this.nextReqId++),sessionId:this.session.id,metadata:{__destroyed:"1"}},{timeout:1e3}),this.destroyed=!0,this.ws.disconnect(),this.listener=void 0)}get connected(){return this._connected}set connected(a){this._connected=a}get linked(){return this._linked}set linked(a){var b,c;this._linked=a,a&&(null==(b=this.onceLinked)||b.call(this)),null==(c=this.listener)||c.linkedUpdated(a)}setOnceLinked(a){return new Promise(b=>{this.linked?a().then(b):this.onceLinked=()=>{a().then(b),this.onceLinked=void 0}})}async handleIncomingEvent(a){var b;if("Event"!==a.type||"Web3Response"!==a.event)return;let c=JSON.parse(await this.cipher.decrypt(a.data));if("WEB3_RESPONSE"!==c.type)return;let{id:d,response:e}=c;null==(b=this.listener)||b.handleWeb3ResponseMessage(d,e)}async checkUnseenEvents(){if(!this.connected){this.shouldFetchUnseenEventsOnConnect=!0;return}await new Promise(a=>setTimeout(a,250));try{await this.fetchUnseenEventsAPI()}catch(a){console.error("Unable to check for unseen events",a)}}async fetchUnseenEventsAPI(){this.shouldFetchUnseenEventsOnConnect=!1,(await this.http.fetchUnseenEvents()).forEach(a=>this.handleIncomingEvent(a))}async publishEvent(a,b,c=!1){let d=await this.cipher.encrypt(JSON.stringify(Object.assign(Object.assign({},b),{origin:location.origin,location:location.href,relaySource:"coinbaseWalletExtension"in window&&window.coinbaseWalletExtension?"injected_sdk":"sdk"}))),e={type:"PublishEvent",id:cY(this.nextReqId++),sessionId:this.session.id,event:a,data:d,callWebhook:c};return this.setOnceLinked(async()=>{let a=await this.makeRequest(e);if("Fail"===a.type)throw Error(a.error||"failed to publish event");return a.eventId})}sendData(a){this.ws.sendData(JSON.stringify(a))}updateLastHeartbeat(){this.lastHeartbeatResponse=Date.now()}heartbeat(){if(Date.now()-this.lastHeartbeatResponse>2e4)return void this.ws.disconnect();try{this.ws.sendData("h")}catch(a){}}async makeRequest(a,b={timeout:6e4}){let c,d=a.id;return this.sendData(a),Promise.race([new Promise((a,e)=>{c=window.setTimeout(()=>{e(Error(`request ${d} timed out`))},b.timeout)}),new Promise(a=>{this.requestResolutions.set(d,b=>{clearTimeout(c),a(b),this.requestResolutions.delete(d)})})])}async handleConnected(){return"Fail"!==(await this.makeRequest({type:"HostSession",id:cY(this.nextReqId++),sessionId:this.session.id,sessionKey:this.session.key})).type&&(this.sendData({type:"IsLinked",id:cY(this.nextReqId++),sessionId:this.session.id}),this.sendData({type:"GetSessionConfig",id:cY(this.nextReqId++),sessionId:this.session.id}),!0)}}class dI{constructor(){this._nextRequestId=0,this.callbacks=new Map}makeRequestId(){this._nextRequestId=(this._nextRequestId+1)%0x7fffffff;let a=this._nextRequestId,b=c8(a.toString(16));return this.callbacks.get(b)&&this.callbacks.delete(b),a}}var dJ=a.i(34160),dK=a.i(677832);let dL="session:id",dM="session:secret",dN="session:linked";class dO{constructor(a,b,c,d=!1){this.storage=a,this.id=b,this.secret=c,this.key=(0,dK.bytesToHex)((0,dJ.sha256)(`${b}, ${c} WalletLink`)),this._linked=!!d}static create(a){return new dO(a,c_(16),c_(32)).save()}static load(a){let b=a.getItem(dL),c=a.getItem(dN),d=a.getItem(dM);return b&&d?new dO(a,b,d,"1"===c):null}get linked(){return this._linked}set linked(a){this._linked=a,this.persistLinked()}save(){return this.storage.setItem(dL,this.id),this.storage.setItem(dM,this.secret),this.persistLinked(),this}persistLinked(){this.storage.setItem(dN,this._linked?"1":"0")}}function dP(){var a,b;return null!=(b=null==(a=null==window?void 0:window.matchMedia)?void 0:a.call(window,"(prefers-color-scheme: dark)").matches)&&b}function dQ(){let a=document.createElement("style");a.type="text/css",a.appendChild(document.createTextNode('@namespace svg "http://www.w3.org/2000/svg";.-cbwsdk-css-reset,.-cbwsdk-css-reset *{animation:none;animation-delay:0;animation-direction:normal;animation-duration:0;animation-fill-mode:none;animation-iteration-count:1;animation-name:none;animation-play-state:running;animation-timing-function:ease;backface-visibility:visible;background:0;background-attachment:scroll;background-clip:border-box;background-color:rgba(0,0,0,0);background-image:none;background-origin:padding-box;background-position:0 0;background-position-x:0;background-position-y:0;background-repeat:repeat;background-size:auto auto;border:0;border-style:none;border-width:medium;border-color:inherit;border-bottom:0;border-bottom-color:inherit;border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-style:none;border-bottom-width:medium;border-collapse:separate;border-image:none;border-left:0;border-left-color:inherit;border-left-style:none;border-left-width:medium;border-radius:0;border-right:0;border-right-color:inherit;border-right-style:none;border-right-width:medium;border-spacing:0;border-top:0;border-top-color:inherit;border-top-left-radius:0;border-top-right-radius:0;border-top-style:none;border-top-width:medium;box-shadow:none;box-sizing:border-box;caption-side:top;clear:none;clip:auto;color:inherit;columns:auto;column-count:auto;column-fill:balance;column-gap:normal;column-rule:medium none currentColor;column-rule-color:currentColor;column-rule-style:none;column-rule-width:none;column-span:1;column-width:auto;counter-increment:none;counter-reset:none;direction:ltr;empty-cells:show;float:none;font:normal;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:normal;height:auto;hyphens:none;letter-spacing:normal;line-height:normal;list-style:none;list-style-image:none;list-style-position:outside;list-style-type:disc;margin:0;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;opacity:1;orphans:0;outline:0;outline-color:invert;outline-style:none;outline-width:medium;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;perspective:none;perspective-origin:50% 50%;pointer-events:auto;position:static;quotes:"\\201C" "\\201D" "\\2018" "\\2019";tab-size:8;table-layout:auto;text-align:inherit;text-align-last:auto;text-decoration:none;text-decoration-color:inherit;text-decoration-line:none;text-decoration-style:solid;text-indent:0;text-shadow:none;text-transform:none;transform:none;transform-style:flat;transition:none;transition-delay:0s;transition-duration:0s;transition-property:none;transition-timing-function:ease;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:0;word-spacing:normal;z-index:auto}.-cbwsdk-css-reset strong{font-weight:bold}.-cbwsdk-css-reset *{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;line-height:1}.-cbwsdk-css-reset [class*=container]{margin:0;padding:0}.-cbwsdk-css-reset style{display:none}')),document.documentElement.appendChild(a)}function dR(){for(var a,b,c=0,d="";c<arguments.length;)(a=arguments[c++])&&(b=function a(b){var c,d,e="";if("string"==typeof b||"number"==typeof b)e+=b;else if("object"==typeof b)if(Array.isArray(b))for(c=0;c<b.length;c++)b[c]&&(d=a(b[c]))&&(e&&(e+=" "),e+=d);else for(c in b)b[c]&&(e&&(e+=" "),e+=c);return e}(a))&&(d&&(d+=" "),d+=b);return d}var dS,dT,dU,dV,dW,dX,dY,dZ,d$,d_,d0,d1,d2,d3={},d4=[],d5=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,d6=Array.isArray;function d7(a,b){for(var c in b)a[c]=b[c];return a}function d8(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function d9(a,b,c){var d,e,f,g={};for(f in b)"key"==f?d=b[f]:"ref"==f?e=b[f]:g[f]=b[f];if(arguments.length>2&&(g.children=arguments.length>3?dU.call(arguments,2):c),"function"==typeof a&&null!=a.defaultProps)for(f in a.defaultProps)void 0===g[f]&&(g[f]=a.defaultProps[f]);return ea(a,g,d,e,null)}function ea(a,b,c,d,e){var f={type:a,props:b,key:c,ref:d,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==e?++dW:e,__i:-1,__u:0};return null==e&&null!=dV.vnode&&dV.vnode(f),f}function eb(a){return a.children}function ec(a,b){this.props=a,this.context=b}function ed(a,b){if(null==b)return a.__?ed(a.__,a.__i+1):null;for(var c;b<a.__k.length;b++)if(null!=(c=a.__k[b])&&null!=c.__e)return c.__e;return"function"==typeof a.type?ed(a):null}function ee(a){(!a.__d&&(a.__d=!0)&&dX.push(a)&&!ef.__r++||dY!=dV.debounceRendering)&&((dY=dV.debounceRendering)||dZ)(ef)}function ef(){for(var a,b,c,d,e,f,g=1;dX.length;)dX.length>g&&dX.sort(d$),a=dX.shift(),g=dX.length,a.__d&&(b=void 0,c=void 0,d=(c=a.__v).__e,e=[],f=[],a.__P&&((b=d7({},c)).__v=c.__v+1,dV.vnode&&dV.vnode(b),ek(a.__P,b,c,a.__n,a.__P.namespaceURI,32&c.__u?[d]:null,e,null==d?ed(c):d,!!(32&c.__u),f),b.__v=c.__v,b.__.__k[b.__i]=b,em(e,b,f),c.__e=c.__=null,b.__e!=d&&function a(b){var c,d;if(null!=(b=b.__)&&null!=b.__c){for(b.__e=b.__c.base=null,c=0;c<b.__k.length;c++)if(null!=(d=b.__k[c])&&null!=d.__e){b.__e=b.__c.base=d.__e;break}return a(b)}}(b)));ef.__r=0}function eg(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p,q,r,s=d&&d.__k||d4,t=b.length;for(i=function(a,b,c,d,e){var f,g,h,i,j,k=c.length,l=k,m=0;for(a.__k=Array(e),f=0;f<e;f++)null!=(g=b[f])&&"boolean"!=typeof g&&"function"!=typeof g?("string"==typeof g||"number"==typeof g||"bigint"==typeof g||g.constructor==String?g=a.__k[f]=ea(null,g,null,null,null):d6(g)?g=a.__k[f]=ea(eb,{children:g},null,null,null):null==g.constructor&&g.__b>0?g=a.__k[f]=ea(g.type,g.props,g.key,g.ref?g.ref:null,g.__v):a.__k[f]=g,i=f+m,g.__=a,g.__b=a.__b+1,h=null,-1!=(j=g.__i=function(a,b,c,d){var e,f,g,h=a.key,i=a.type,j=b[c],k=null!=j&&0==(2&j.__u);if(null===j&&null==h||k&&h==j.key&&i==j.type)return c;if(d>+!!k){for(e=c-1,f=c+1;e>=0||f<b.length;)if(null!=(j=b[g=e>=0?e--:f++])&&0==(2&j.__u)&&h==j.key&&i==j.type)return g}return -1}(g,c,i,l))&&(l--,(h=c[j])&&(h.__u|=2)),null==h||null==h.__v?(-1==j&&(e>k?m--:e<k&&m++),"function"!=typeof g.type&&(g.__u|=4)):j!=i&&(j==i-1?m--:j==i+1?m++:(j>i?m--:m++,g.__u|=4))):a.__k[f]=null;if(l)for(f=0;f<k;f++)null!=(h=c[f])&&0==(2&h.__u)&&(h.__e==d&&(d=ed(h)),function a(b,c,d){var e,f;if(dV.unmount&&dV.unmount(b),(e=b.ref)&&(e.current&&e.current!=b.__e||en(e,null,c)),null!=(e=b.__c)){if(e.componentWillUnmount)try{e.componentWillUnmount()}catch(a){dV.__e(a,c)}e.base=e.__P=null}if(e=b.__k)for(f=0;f<e.length;f++)e[f]&&a(e[f],c,d||"function"!=typeof b.type);d||d8(b.__e),b.__c=b.__=b.__e=void 0}(h,h));return d}(c,b,s,i,t),l=0;l<t;l++)null!=(n=c.__k[l])&&(m=-1==n.__i?d3:s[n.__i]||d3,n.__i=l,q=ek(a,n,m,e,f,g,h,i,j,k),o=n.__e,n.ref&&m.ref!=n.ref&&(m.ref&&en(m.ref,null,n),k.push(n.ref,n.__c||o,n)),null==p&&null!=o&&(p=o),(r=!!(4&n.__u))||m.__k===n.__k?i=function a(b,c,d,e){var f,g;if("function"==typeof b.type){for(f=b.__k,g=0;f&&g<f.length;g++)f[g]&&(f[g].__=b,c=a(f[g],c,d,e));return c}b.__e!=c&&(e&&(c&&b.type&&!c.parentNode&&(c=ed(b)),d.insertBefore(b.__e,c||null)),c=b.__e);do c=c&&c.nextSibling;while(null!=c&&8==c.nodeType)return c}(n,i,a,r):"function"==typeof n.type&&void 0!==q?i=q:o&&(i=o.nextSibling),n.__u&=-7);return c.__e=p,i}function eh(a,b,c){"-"==b[0]?a.setProperty(b,null==c?"":c):a[b]=null==c?"":"number"!=typeof c||d5.test(b)?c:c+"px"}function ei(a,b,c,d,e){var f,g;a:if("style"==b)if("string"==typeof c)a.style.cssText=c;else{if("string"==typeof d&&(a.style.cssText=d=""),d)for(b in d)c&&b in c||eh(a.style,b,"");if(c)for(b in c)d&&c[b]==d[b]||eh(a.style,b,c[b])}else if("o"==b[0]&&"n"==b[1])f=b!=(b=b.replace(d_,"$1")),b=(g=b.toLowerCase())in a||"onFocusOut"==b||"onFocusIn"==b?g.slice(2):b.slice(2),a.l||(a.l={}),a.l[b+f]=c,c?d?c.u=d.u:(c.u=d0,a.addEventListener(b,f?d2:d1,f)):a.removeEventListener(b,f?d2:d1,f);else{if("http://www.w3.org/2000/svg"==e)b=b.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=b&&"height"!=b&&"href"!=b&&"list"!=b&&"form"!=b&&"tabIndex"!=b&&"download"!=b&&"rowSpan"!=b&&"colSpan"!=b&&"role"!=b&&"popover"!=b&&b in a)try{a[b]=null==c?"":c;break a}catch(a){}"function"==typeof c||(null==c||!1===c&&"-"!=b[4]?a.removeAttribute(b):a.setAttribute(b,"popover"==b&&1==c?"":c))}}function ej(a){return function(b){if(this.l){var c=this.l[b.type+a];if(null==b.t)b.t=d0++;else if(b.t<c.u)return;return c(dV.event?dV.event(b):b)}}}function ek(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=b.type;if(null!=b.constructor)return null;128&c.__u&&(i=!!(32&c.__u),f=[h=b.__e=c.__e]),(k=dV.__b)&&k(b);a:if("function"==typeof B)try{if(r=b.props,s="prototype"in B&&B.prototype.render,t=(k=B.contextType)&&d[k.__c],u=k?t?t.props.value:k.__:d,c.__c?q=(l=b.__c=c.__c).__=l.__E:(s?b.__c=l=new B(r,u):(b.__c=l=new ec(r,u),l.constructor=B,l.render=eo),t&&t.sub(l),l.state||(l.state={}),l.__n=d,m=l.__d=!0,l.__h=[],l._sb=[]),s&&null==l.__s&&(l.__s=l.state),s&&null!=B.getDerivedStateFromProps&&(l.__s==l.state&&(l.__s=d7({},l.__s)),d7(l.__s,B.getDerivedStateFromProps(r,l.__s))),n=l.props,o=l.state,l.__v=b,m)s&&null==B.getDerivedStateFromProps&&null!=l.componentWillMount&&l.componentWillMount(),s&&null!=l.componentDidMount&&l.__h.push(l.componentDidMount);else{if(s&&null==B.getDerivedStateFromProps&&r!==n&&null!=l.componentWillReceiveProps&&l.componentWillReceiveProps(r,u),b.__v==c.__v||!l.__e&&null!=l.shouldComponentUpdate&&!1===l.shouldComponentUpdate(r,l.__s,u)){for(b.__v!=c.__v&&(l.props=r,l.state=l.__s,l.__d=!1),b.__e=c.__e,b.__k=c.__k,b.__k.some(function(a){a&&(a.__=b)}),v=0;v<l._sb.length;v++)l.__h.push(l._sb[v]);l._sb=[],l.__h.length&&g.push(l);break a}null!=l.componentWillUpdate&&l.componentWillUpdate(r,l.__s,u),s&&null!=l.componentDidUpdate&&l.__h.push(function(){l.componentDidUpdate(n,o,p)})}if(l.context=u,l.props=r,l.__P=a,l.__e=!1,w=dV.__r,x=0,s){for(l.state=l.__s,l.__d=!1,w&&w(b),k=l.render(l.props,l.state,l.context),y=0;y<l._sb.length;y++)l.__h.push(l._sb[y]);l._sb=[]}else do l.__d=!1,w&&w(b),k=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++x<25)l.state=l.__s,null!=l.getChildContext&&(d=d7(d7({},d),l.getChildContext())),s&&!m&&null!=l.getSnapshotBeforeUpdate&&(p=l.getSnapshotBeforeUpdate(n,o)),z=k,null!=k&&k.type===eb&&null==k.key&&(z=function a(b){return"object"!=typeof b||null==b||b.__b&&b.__b>0?b:d6(b)?b.map(a):d7({},b)}(k.props.children)),h=eg(a,d6(z)?z:[z],b,c,d,e,f,g,h,i,j),l.base=b.__e,b.__u&=-161,l.__h.length&&g.push(l),q&&(l.__E=l.__=null)}catch(a){if(b.__v=null,i||null!=f)if(a.then){for(b.__u|=i?160:128;h&&8==h.nodeType&&h.nextSibling;)h=h.nextSibling;f[f.indexOf(h)]=null,b.__e=h}else{for(A=f.length;A--;)d8(f[A]);el(b)}else b.__e=c.__e,b.__k=c.__k,a.then||el(b);dV.__e(a,b,c)}else null==f&&b.__v==c.__v?(b.__k=c.__k,b.__e=c.__e):h=b.__e=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q=c.props||d3,r=b.props,s=b.type;if("svg"==s?e="http://www.w3.org/2000/svg":"math"==s?e="http://www.w3.org/1998/Math/MathML":e||(e="http://www.w3.org/1999/xhtml"),null!=f){for(j=0;j<f.length;j++)if((n=f[j])&&"setAttribute"in n==!!s&&(s?n.localName==s:3==n.nodeType)){a=n,f[j]=null;break}}if(null==a){if(null==s)return document.createTextNode(r);a=document.createElementNS(e,s,r.is&&r),h&&(dV.__m&&dV.__m(b,f),h=!1),f=null}if(null==s)q===r||h&&a.data==r||(a.data=r);else{if(f=f&&dU.call(a.childNodes),!h&&null!=f)for(q={},j=0;j<a.attributes.length;j++)q[(n=a.attributes[j]).name]=n.value;for(j in q)if(n=q[j],"children"==j);else if("dangerouslySetInnerHTML"==j)l=n;else if(!(j in r)){if("value"==j&&"defaultValue"in r||"checked"==j&&"defaultChecked"in r)continue;ei(a,j,null,n,e)}for(j in r)n=r[j],"children"==j?m=n:"dangerouslySetInnerHTML"==j?k=n:"value"==j?o=n:"checked"==j?p=n:h&&"function"!=typeof n||q[j]===n||ei(a,j,n,q[j],e);if(k)h||l&&(k.__html==l.__html||k.__html==a.innerHTML)||(a.innerHTML=k.__html),b.__k=[];else if(l&&(a.innerHTML=""),eg("template"==b.type?a.content:a,d6(m)?m:[m],b,c,d,"foreignObject"==s?"http://www.w3.org/1999/xhtml":e,f,g,f?f[0]:c.__k&&ed(c,0),h,i),null!=f)for(j=f.length;j--;)d8(f[j]);h||(j="value","progress"==s&&null==o?a.removeAttribute("value"):null==o||o===a[j]&&("progress"!=s||o)&&("option"!=s||o==q[j])||ei(a,j,o,q[j],e),j="checked",null!=p&&p!=a[j]&&ei(a,j,p,q[j],e))}return a}(c.__e,b,c,d,e,f,g,i,j);return(k=dV.diffed)&&k(b),128&b.__u?void 0:h}function el(a){a&&a.__c&&(a.__c.__e=!0),a&&a.__k&&a.__k.forEach(el)}function em(a,b,c){for(var d=0;d<c.length;d++)en(c[d],c[++d],c[++d]);dV.__c&&dV.__c(b,a),a.some(function(b){try{a=b.__h,b.__h=[],a.some(function(a){a.call(b)})}catch(a){dV.__e(a,b.__v)}})}function en(a,b,c){try{if("function"==typeof a){var d="function"==typeof a.__u;d&&a.__u(),d&&null==b||(a.__u=a(b))}else a.current=b}catch(a){dV.__e(a,c)}}function eo(a,b,c){return this.constructor(a,c)}function ep(a,b,c){var d,e,f,g;b==document&&(b=document.documentElement),dV.__&&dV.__(a,b),e=(d="function"==typeof c)?null:c&&c.__k||b.__k,f=[],g=[],ek(b,a=(!d&&c||b).__k=d9(eb,null,[a]),e||d3,d3,b.namespaceURI,!d&&c?[c]:e?null:b.firstChild?dU.call(b.childNodes):null,f,!d&&c?c:e?e.__e:b.firstChild,d,g),em(f,a,g)}dU=d4.slice,dV={__e:function(a,b,c,d){for(var e,f,g;b=b.__;)if((e=b.__c)&&!e.__)try{if((f=e.constructor)&&null!=f.getDerivedStateFromError&&(e.setState(f.getDerivedStateFromError(a)),g=e.__d),null!=e.componentDidCatch&&(e.componentDidCatch(a,d||{}),g=e.__d),g)return e.__E=e}catch(b){a=b}throw a}},dW=0,ec.prototype.setState=function(a,b){var c;c=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=d7({},this.state),"function"==typeof a&&(a=a(d7({},c),this.props)),a&&d7(c,a),null!=a&&this.__v&&(b&&this._sb.push(b),ee(this))},ec.prototype.forceUpdate=function(a){this.__v&&(this.__e=!0,a&&this.__h.push(a),ee(this))},ec.prototype.render=eb,dX=[],dZ="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,d$=function(a,b){return a.__v.__b-b.__v.__b},ef.__r=0,d_=/(PointerCapture)$|Capture$/i,d0=0,d1=ej(!1),d2=ej(!0);var eq,er,es,et,eu=0,ev=[],ew=dV,ex=ew.__b,ey=ew.__r,ez=ew.diffed,eA=ew.__c,eB=ew.unmount,eC=ew.__;function eD(a,b){ew.__h&&ew.__h(er,a,eu||b),eu=0;var c=er.__H||(er.__H={__:[],__h:[]});return a>=c.__.length&&c.__.push({}),c.__[a]}function eE(a,b,c){var d=eD(eq++,2);if(d.t=a,!d.__c&&(d.__=[c?c(b):eJ(void 0,b),function(a){var b=d.__N?d.__N[0]:d.__[0],c=d.t(b,a);b!==c&&(d.__N=[c,d.__[1]],d.__c.setState({}))}],d.__c=er,!er.__f)){var e=function(a,b,c){if(!d.__c.__H)return!0;var e=d.__c.__H.__.filter(function(a){return!!a.__c});if(e.every(function(a){return!a.__N}))return!f||f.call(this,a,b,c);var g=d.__c.props!==a;return e.forEach(function(a){if(a.__N){var b=a.__[0];a.__=a.__N,a.__N=void 0,b!==a.__[0]&&(g=!0)}}),f&&f.call(this,a,b,c)||g};er.__f=!0;var f=er.shouldComponentUpdate,g=er.componentWillUpdate;er.componentWillUpdate=function(a,b,c){if(this.__e){var d=f;f=void 0,e(a,b,c),f=d}g&&g.call(this,a,b,c)},er.shouldComponentUpdate=e}return d.__N||d.__}function eF(){for(var a;a=ev.shift();)if(a.__P&&a.__H)try{a.__H.__h.forEach(eH),a.__H.__h.forEach(eI),a.__H.__h=[]}catch(b){a.__H.__h=[],ew.__e(b,a.__v)}}ew.__b=function(a){er=null,ex&&ex(a)},ew.__=function(a,b){a&&b.__k&&b.__k.__m&&(a.__m=b.__k.__m),eC&&eC(a,b)},ew.__r=function(a){ey&&ey(a),eq=0;var b=(er=a.__c).__H;b&&(es===er?(b.__h=[],er.__h=[],b.__.forEach(function(a){a.__N&&(a.__=a.__N),a.u=a.__N=void 0})):(b.__h.forEach(eH),b.__h.forEach(eI),b.__h=[],eq=0)),es=er},ew.diffed=function(a){ez&&ez(a);var b=a.__c;b&&b.__H&&(b.__H.__h.length&&(1!==ev.push(b)&&et===ew.requestAnimationFrame||((et=ew.requestAnimationFrame)||function(a){var b,c=function(){clearTimeout(d),eG&&cancelAnimationFrame(b),setTimeout(a)},d=setTimeout(c,35);eG&&(b=requestAnimationFrame(c))})(eF)),b.__H.__.forEach(function(a){a.u&&(a.__H=a.u),a.u=void 0})),es=er=null},ew.__c=function(a,b){b.some(function(a){try{a.__h.forEach(eH),a.__h=a.__h.filter(function(a){return!a.__||eI(a)})}catch(c){b.some(function(a){a.__h&&(a.__h=[])}),b=[],ew.__e(c,a.__v)}}),eA&&eA(a,b)},ew.unmount=function(a){eB&&eB(a);var b,c=a.__c;c&&c.__H&&(c.__H.__.forEach(function(a){try{eH(a)}catch(a){b=a}}),c.__H=void 0,b&&ew.__e(b,c.__v))};var eG="function"==typeof requestAnimationFrame;function eH(a){var b=er,c=a.__c;"function"==typeof c&&(a.__c=void 0,c()),er=b}function eI(a){var b=er;a.__c=a.__(),er=b}function eJ(a,b){return"function"==typeof b?b(a):b}class eK{constructor(){this.items=new Map,this.nextItemKey=0,this.root=null,this.darkMode=dP()}attach(a){this.root=document.createElement("div"),this.root.className="-cbwsdk-snackbar-root",a.appendChild(this.root),this.render()}presentItem(a){let b=this.nextItemKey++;return this.items.set(b,a),this.render(),()=>{this.items.delete(b),this.render()}}clear(){this.items.clear(),this.render()}render(){this.root&&ep(d9("div",null,d9(eL,{darkMode:this.darkMode},Array.from(this.items.entries()).map(([a,b])=>d9(eM,Object.assign({},b,{key:a}))))),this.root)}}let eL=a=>d9("div",{class:dR("-cbwsdk-snackbar-container")},d9("style",null,".-cbwsdk-css-reset .-gear-container{margin-left:16px !important;margin-right:9px !important;display:flex;align-items:center;justify-content:center;width:24px;height:24px;transition:opacity .25s}.-cbwsdk-css-reset .-gear-container *{user-select:none}.-cbwsdk-css-reset .-gear-container svg{opacity:0;position:absolute}.-cbwsdk-css-reset .-gear-icon{height:12px;width:12px;z-index:10000}.-cbwsdk-css-reset .-cbwsdk-snackbar{align-items:flex-end;display:flex;flex-direction:column;position:fixed;right:0;top:0;z-index:2147483647}.-cbwsdk-css-reset .-cbwsdk-snackbar *{user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance{display:flex;flex-direction:column;margin:8px 16px 0 16px;overflow:visible;text-align:left;transform:translateX(0);transition:opacity .25s,transform .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header:hover .-gear-container svg{opacity:1}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header{display:flex;align-items:center;background:#fff;overflow:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-cblogo{margin:8px 8px 8px 8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-message{color:#000;font-size:13px;line-height:1.5;user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu{background:#fff;transition:opacity .25s ease-in-out,transform .25s linear,visibility 0s;visibility:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;opacity:0;flex-direction:column;padding-left:8px;padding-right:8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:last-child{margin-bottom:8px !important}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover{background:#f5f7f8;border-radius:6px;transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover span{color:#050f19;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover svg path{fill:#000;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item{visibility:inherit;height:35px;margin-top:8px;margin-bottom:0;display:flex;flex-direction:row;align-items:center;padding:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item *{visibility:inherit;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover{background:rgba(223,95,103,.2);transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover svg path{fill:#df5f67;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover span{color:#df5f67;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-info{color:#aaa;font-size:13px;margin:0 8px 0 32px;position:absolute}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-hidden{opacity:0;text-align:left;transform:translateX(25%);transition:opacity .5s linear}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-expanded .-cbwsdk-snackbar-instance-menu{opacity:1;display:flex;transform:translateY(8px);visibility:visible}"),d9("div",{class:"-cbwsdk-snackbar"},a.children)),eM=({autoExpand:a,message:b,menuItems:c})=>{var d,e,f,g;let[h,i]=(eu=1,eE(eJ,!0)),[j,k]=(eu=1,eE(eJ,null!=a&&a));return d=()=>{let a=[window.setTimeout(()=>{i(!1)},1),window.setTimeout(()=>{k(!0)},1e4)];return()=>{a.forEach(window.clearTimeout)}},e=eD(eq++,3),!ew.__s&&(f=e.__H,g=void 0,!f||f.length!==g.length||g.some(function(a,b){return a!==f[b]}))&&(e.__=d,e.u=void 0,er.__H.__h.push(e)),d9("div",{class:dR("-cbwsdk-snackbar-instance",h&&"-cbwsdk-snackbar-instance-hidden",j&&"-cbwsdk-snackbar-instance-expanded")},d9("div",{class:"-cbwsdk-snackbar-instance-header",onClick:()=>{k(!j)}},d9("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEuNDkyIDEwLjQxOWE4LjkzIDguOTMgMCAwMTguOTMtOC45M2gxMS4xNjNhOC45MyA4LjkzIDAgMDE4LjkzIDguOTN2MTEuMTYzYTguOTMgOC45MyAwIDAxLTguOTMgOC45M0gxMC40MjJhOC45MyA4LjkzIDAgMDEtOC45My04LjkzVjEwLjQxOXoiIGZpbGw9IiMxNjUyRjAiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEwLjQxOSAwSDIxLjU4QzI3LjMzNSAwIDMyIDQuNjY1IDMyIDEwLjQxOVYyMS41OEMzMiAyNy4zMzUgMjcuMzM1IDMyIDIxLjU4MSAzMkgxMC40MkM0LjY2NSAzMiAwIDI3LjMzNSAwIDIxLjU4MVYxMC40MkMwIDQuNjY1IDQuNjY1IDAgMTAuNDE5IDB6bTAgMS40ODhhOC45MyA4LjkzIDAgMDAtOC45MyA4LjkzdjExLjE2M2E4LjkzIDguOTMgMCAwMDguOTMgOC45M0gyMS41OGE4LjkzIDguOTMgMCAwMDguOTMtOC45M1YxMC40MmE4LjkzIDguOTMgMCAwMC04LjkzLTguOTNIMTAuNDJ6IiBmaWxsPSIjZmZmIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNS45OTggMjYuMDQ5Yy01LjU0OSAwLTEwLjA0Ny00LjQ5OC0xMC4wNDctMTAuMDQ3IDAtNS41NDggNC40OTgtMTAuMDQ2IDEwLjA0Ny0xMC4wNDYgNS41NDggMCAxMC4wNDYgNC40OTggMTAuMDQ2IDEwLjA0NiAwIDUuNTQ5LTQuNDk4IDEwLjA0Ny0xMC4wNDYgMTAuMDQ3eiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik0xMi43NjIgMTQuMjU0YzAtLjgyMi42NjctMS40ODkgMS40ODktMS40ODloMy40OTdjLjgyMiAwIDEuNDg4LjY2NiAxLjQ4OCAxLjQ4OXYzLjQ5N2MwIC44MjItLjY2NiAxLjQ4OC0xLjQ4OCAxLjQ4OGgtMy40OTdhMS40ODggMS40ODggMCAwMS0xLjQ4OS0xLjQ4OHYtMy40OTh6IiBmaWxsPSIjMTY1MkYwIi8+PC9zdmc+",class:"-cbwsdk-snackbar-instance-header-cblogo"})," ",d9("div",{class:"-cbwsdk-snackbar-instance-header-message"},b),d9("div",{class:"-gear-container"},!j&&d9("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},d9("circle",{cx:"12",cy:"12",r:"12",fill:"#F5F7F8"})),d9("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDYuNzV2LTEuNWwtMS43Mi0uNTdjLS4wOC0uMjctLjE5LS41Mi0uMzItLjc3bC44MS0xLjYyLTEuMDYtMS4wNi0xLjYyLjgxYy0uMjQtLjEzLS41LS4yNC0uNzctLjMyTDYuNzUgMGgtMS41bC0uNTcgMS43MmMtLjI3LjA4LS41My4xOS0uNzcuMzJsLTEuNjItLjgxLTEuMDYgMS4wNi44MSAxLjYyYy0uMTMuMjQtLjI0LjUtLjMyLjc3TDAgNS4yNXYxLjVsMS43Mi41N2MuMDguMjcuMTkuNTMuMzIuNzdsLS44MSAxLjYyIDEuMDYgMS4wNiAxLjYyLS44MWMuMjQuMTMuNS4yMy43Ny4zMkw1LjI1IDEyaDEuNWwuNTctMS43MmMuMjctLjA4LjUyLS4xOS43Ny0uMzJsMS42Mi44MSAxLjA2LTEuMDYtLjgxLTEuNjJjLjEzLS4yNC4yMy0uNS4zMi0uNzdMMTIgNi43NXpNNiA4LjVhMi41IDIuNSAwIDAxMC01IDIuNSAyLjUgMCAwMTAgNXoiIGZpbGw9IiMwNTBGMTkiLz48L3N2Zz4=",class:"-gear-icon",title:"Expand"}))),c&&c.length>0&&d9("div",{class:"-cbwsdk-snackbar-instance-menu"},c.map((a,b)=>d9("div",{class:dR("-cbwsdk-snackbar-instance-menu-item",a.isRed&&"-cbwsdk-snackbar-instance-menu-item-is-red"),onClick:a.onClick,key:b},d9("svg",{width:a.svgWidth,height:a.svgHeight,viewBox:"0 0 10 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},d9("path",{"fill-rule":a.defaultFillRule,"clip-rule":a.defaultClipRule,d:a.path,fill:"#AAAAAA"})),d9("span",{class:dR("-cbwsdk-snackbar-instance-menu-item-info",a.isRed&&"-cbwsdk-snackbar-instance-menu-item-info-is-red")},a.info)))))},eN="M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z";class eO{constructor(){this.attached=!1,this.snackbar=new eK}attach(){if(this.attached)throw Error("Coinbase Wallet SDK UI is already attached");let a=document.documentElement,b=document.createElement("div");b.className="-cbwsdk-css-reset",a.appendChild(b),this.snackbar.attach(b),this.attached=!0,dQ()}showConnecting(a){let b;return b=a.isUnlinkedErrorState?{autoExpand:!0,message:"Connection lost",menuItems:[{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:"M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:a.onResetConnection}]}:{message:"Confirm on phone",menuItems:[{isRed:!0,info:"Cancel transaction",svgWidth:"11",svgHeight:"11",path:"M10.3711 1.52346L9.21775 0.370117L5.37109 4.21022L1.52444 0.370117L0.371094 1.52346L4.2112 5.37012L0.371094 9.21677L1.52444 10.3701L5.37109 6.53001L9.21775 10.3701L10.3711 9.21677L6.53099 5.37012L10.3711 1.52346Z",defaultFillRule:"inherit",defaultClipRule:"inherit",onClick:a.onCancel},{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:eN,defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:a.onResetConnection}]},this.snackbar.presentItem(b)}}class eP{constructor(){this.root=null,this.darkMode=dP()}attach(){let a=document.documentElement;this.root=document.createElement("div"),this.root.className="-cbwsdk-css-reset",a.appendChild(this.root),dQ()}present(a){this.render(a)}clear(){this.render(null)}render(a){!this.root||(ep(null,this.root),a&&ep(d9(eQ,Object.assign({},a,{onDismiss:()=>{this.clear()},darkMode:this.darkMode})),this.root))}}let eQ=({title:a,buttonText:b,darkMode:c,onButtonClick:d,onDismiss:e})=>d9(eL,{darkMode:c},d9("div",{class:"-cbwsdk-redirect-dialog"},d9("style",null,".-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop{position:fixed;top:0;left:0;right:0;bottom:0;transition:opacity .25s;background-color:rgba(10,11,13,.5)}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop-hidden{opacity:0}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box{display:block;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);padding:20px;border-radius:8px;background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box p{display:block;font-weight:400;font-size:14px;line-height:20px;padding-bottom:12px;color:#5b636e}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box button{appearance:none;border:none;background:none;color:#0052ff;padding:0;text-decoration:none;display:block;font-weight:600;font-size:16px;line-height:24px}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark{background-color:#0a0b0d;color:#fff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark button{color:#0052ff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light{background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light button{color:#0052ff}"),d9("div",{class:"-cbwsdk-redirect-dialog-backdrop",onClick:e}),d9("div",{class:dR("-cbwsdk-redirect-dialog-box",c?"dark":"light")},d9("p",null,a),d9("button",{onClick:d},b)))),eR="https://www.walletlink.org";class eS{constructor(){this.attached=!1,this.redirectDialog=new eP}attach(){if(this.attached)throw Error("Coinbase Wallet SDK UI is already attached");this.redirectDialog.attach(),this.attached=!0}redirectToCoinbaseWallet(a){let b=new URL("https://go.cb-w.com/walletlink");b.searchParams.append("redirect_url",function(){try{if(function(){try{return null!==window.frameElement}catch(a){return!1}}()&&window.top)return window.top.location;return window.location}catch(a){return window.location}}().href),a&&b.searchParams.append("wl_url",a);let c=document.createElement("a");c.target="cbw-opener",c.href=b.href,c.rel="noreferrer noopener",c.click()}openCoinbaseWalletDeeplink(a){this.redirectDialog.present({title:"Redirecting to Coinbase Wallet...",buttonText:"Open",onButtonClick:()=>{this.redirectToCoinbaseWallet(a)}}),setTimeout(()=>{this.redirectToCoinbaseWallet(a)},99)}showConnecting(a){return()=>{this.redirectDialog.clear()}}}class eT{constructor(a){this.chainCallbackParams={chainId:"",jsonRpcUrl:""},this.isMobileWeb=function(){var a;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(null==(a=null==window?void 0:window.navigator)?void 0:a.userAgent)}(),this.linkedUpdated=a=>{this.isLinked=a;let b=this.storage.getItem(dC);if(a&&(this._session.linked=a),this.isUnlinkedErrorState=!1,b){let c=b.split(" "),d="true"===this.storage.getItem("IsStandaloneSigning");""===c[0]||a||!this._session.linked||d||(this.isUnlinkedErrorState=!0)}},this.metadataUpdated=(a,b)=>{this.storage.setItem(a,b)},this.chainUpdated=(a,b)=>{(this.chainCallbackParams.chainId!==a||this.chainCallbackParams.jsonRpcUrl!==b)&&(this.chainCallbackParams={chainId:a,jsonRpcUrl:b},this.chainCallback&&this.chainCallback(b,Number.parseInt(a,10)))},this.accountUpdated=a=>{this.accountsCallback&&this.accountsCallback([a]),eT.accountRequestCallbackIds.size>0&&(Array.from(eT.accountRequestCallbackIds.values()).forEach(b=>{this.invokeCallback(b,{method:"requestEthereumAccounts",result:[a]})}),eT.accountRequestCallbackIds.clear())},this.resetAndReload=this.resetAndReload.bind(this),this.linkAPIUrl=a.linkAPIUrl,this.storage=a.storage,this.metadata=a.metadata,this.accountsCallback=a.accountsCallback,this.chainCallback=a.chainCallback;const{session:b,ui:c,connection:d}=this.subscribe();this._session=b,this.connection=d,this.relayEventManager=new dI,this.ui=c,this.ui.attach()}subscribe(){let a=dO.load(this.storage)||dO.create(this.storage),{linkAPIUrl:b}=this,c=new dH({session:a,linkAPIUrl:b,listener:this}),d=this.isMobileWeb?new eS:new eO;return c.connect(),{session:a,ui:d,connection:c}}resetAndReload(){this.connection.destroy().then(()=>{let a=dO.load(this.storage);(null==a?void 0:a.id)===this._session.id&&cz.clearAll(),document.location.reload()}).catch(a=>{})}signEthereumTransaction(a){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:a.fromAddress,toAddress:a.toAddress,weiValue:c4(a.weiValue),data:c2(a.data,!0),nonce:a.nonce,gasPriceInWei:a.gasPriceInWei?c4(a.gasPriceInWei):null,maxFeePerGas:a.gasPriceInWei?c4(a.gasPriceInWei):null,maxPriorityFeePerGas:a.gasPriceInWei?c4(a.gasPriceInWei):null,gasLimit:a.gasLimit?c4(a.gasLimit):null,chainId:a.chainId,shouldSubmit:!1}})}signAndSubmitEthereumTransaction(a){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:a.fromAddress,toAddress:a.toAddress,weiValue:c4(a.weiValue),data:c2(a.data,!0),nonce:a.nonce,gasPriceInWei:a.gasPriceInWei?c4(a.gasPriceInWei):null,maxFeePerGas:a.maxFeePerGas?c4(a.maxFeePerGas):null,maxPriorityFeePerGas:a.maxPriorityFeePerGas?c4(a.maxPriorityFeePerGas):null,gasLimit:a.gasLimit?c4(a.gasLimit):null,chainId:a.chainId,shouldSubmit:!0}})}submitEthereumTransaction(a,b){return this.sendRequest({method:"submitEthereumTransaction",params:{signedTransaction:c2(a,!0),chainId:b}})}getWalletLinkSession(){return this._session}sendRequest(a){let b=null,c=c_(8),d=d=>{this.publishWeb3RequestCanceledEvent(c),this.handleErrorResponse(c,a.method,d),null==b||b()};return new Promise((e,f)=>{b=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:d,onResetConnection:this.resetAndReload}),this.relayEventManager.callbacks.set(c,a=>{if(null==b||b(),dD(a))return f(Error(a.errorMessage));e(a)}),this.publishWeb3RequestEvent(c,a)})}publishWeb3RequestEvent(a,b){let c={type:"WEB3_REQUEST",id:a,request:b};this.publishEvent("Web3Request",c,!0).then(a=>{}).catch(a=>{this.handleWeb3ResponseMessage(c.id,{method:b.method,errorMessage:a.message})}),this.isMobileWeb&&this.openCoinbaseWalletDeeplink(b.method)}openCoinbaseWalletDeeplink(a){if(this.ui instanceof eS)switch(a){case"requestEthereumAccounts":case"switchEthereumChain":return;default:window.addEventListener("blur",()=>{window.addEventListener("focus",()=>{this.connection.checkUnseenEvents()},{once:!0})},{once:!0}),this.ui.openCoinbaseWalletDeeplink()}}publishWeb3RequestCanceledEvent(a){this.publishEvent("Web3RequestCanceled",{type:"WEB3_REQUEST_CANCELED",id:a},!1).then()}publishEvent(a,b,c){return this.connection.publishEvent(a,b,c)}handleWeb3ResponseMessage(a,b){if("requestEthereumAccounts"===b.method){eT.accountRequestCallbackIds.forEach(a=>this.invokeCallback(a,b)),eT.accountRequestCallbackIds.clear();return}this.invokeCallback(a,b)}handleErrorResponse(a,b,c){var d;let e=null!=(d=null==c?void 0:c.message)?d:"Unspecified error message.";this.handleWeb3ResponseMessage(a,{method:b,errorMessage:e})}invokeCallback(a,b){let c=this.relayEventManager.callbacks.get(a);c&&(c(b),this.relayEventManager.callbacks.delete(a))}requestEthereumAccounts(){let{appName:a,appLogoUrl:b}=this.metadata,c={method:"requestEthereumAccounts",params:{appName:a,appLogoUrl:b}},d=c_(8);return new Promise((a,b)=>{this.relayEventManager.callbacks.set(d,c=>{if(dD(c))return b(Error(c.errorMessage));a(c)}),eT.accountRequestCallbackIds.add(d),this.publishWeb3RequestEvent(d,c)})}watchAsset(a,b,c,d,e,f){let g={method:"watchAsset",params:{type:a,options:{address:b,symbol:c,decimals:d,image:e},chainId:f}},h=null,i=c_(8),j=a=>{this.publishWeb3RequestCanceledEvent(i),this.handleErrorResponse(i,g.method,a),null==h||h()};return h=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:j,onResetConnection:this.resetAndReload}),new Promise((a,b)=>{this.relayEventManager.callbacks.set(i,c=>{if(null==h||h(),dD(c))return b(Error(c.errorMessage));a(c)}),this.publishWeb3RequestEvent(i,g)})}addEthereumChain(a,b,c,d,e,f){let g={method:"addEthereumChain",params:{chainId:a,rpcUrls:b,blockExplorerUrls:d,chainName:e,iconUrls:c,nativeCurrency:f}},h=null,i=c_(8),j=a=>{this.publishWeb3RequestCanceledEvent(i),this.handleErrorResponse(i,g.method,a),null==h||h()};return h=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:j,onResetConnection:this.resetAndReload}),new Promise((a,b)=>{this.relayEventManager.callbacks.set(i,c=>{if(null==h||h(),dD(c))return b(Error(c.errorMessage));a(c)}),this.publishWeb3RequestEvent(i,g)})}switchEthereumChain(a,b){let c={method:"switchEthereumChain",params:Object.assign({chainId:a},{address:b})},d=null,e=c_(8),f=a=>{this.publishWeb3RequestCanceledEvent(e),this.handleErrorResponse(e,c.method,a),null==d||d()};return d=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:f,onResetConnection:this.resetAndReload}),new Promise((a,b)=>{this.relayEventManager.callbacks.set(e,c=>(null==d||d(),dD(c)&&c.errorCode)?b(cS({code:c.errorCode,message:"Unrecognized chain ID. Try adding the chain using addEthereumChain first."})):dD(c)?b(Error(c.errorMessage)):void a(c)),this.publishWeb3RequestEvent(e,c)})}}eT.accountRequestCallbackIds=new Set;let eU="DefaultChainId",eV="DefaultJsonRpcUrl";class eW{constructor(a){this._relay=null,this._addresses=[],this.metadata=a.metadata,this._storage=new cz("walletlink",eR),this.callback=a.callback||null;const b=this._storage.getItem(dC);if(b){const a=b.split(" ");""!==a[0]&&(this._addresses=a.map(a=>db(a)))}this.initializeRelay()}getSession(){let{id:a,secret:b}=this.initializeRelay().getWalletLinkSession();return{id:a,secret:b}}async handshake(){await this._eth_requestAccounts()}get selectedAddress(){return this._addresses[0]||void 0}get jsonRpcUrl(){var a;return null!=(a=this._storage.getItem(eV))?a:void 0}set jsonRpcUrl(a){this._storage.setItem(eV,a)}updateProviderInfo(a,b){var c;this.jsonRpcUrl=a;let d=this.getChainId();this._storage.setItem(eU,b.toString(10)),dd(b)!==d&&(null==(c=this.callback)||c.call(this,"chainChanged",c5(b)))}async watchAsset(a){let b=Array.isArray(a)?a[0]:a;if(!b.type)throw cM("Type is required");if((null==b?void 0:b.type)!=="ERC20")throw cM(`Asset of type '${b.type}' is not supported`);if(!(null==b?void 0:b.options))throw cM("Options are required");if(!(null==b?void 0:b.options.address))throw cM("Address is required");let c=this.getChainId(),{address:d,symbol:e,image:f,decimals:g}=b.options,h=this.initializeRelay(),i=await h.watchAsset(b.type,d,e,g,f,null==c?void 0:c.toString());return!dD(i)&&!!i.result}async addEthereumChain(a){var b,c;let d=a[0];if((null==(b=d.rpcUrls)?void 0:b.length)===0)throw cM("please pass in at least 1 rpcUrl");if(!d.chainName||""===d.chainName.trim())throw cM("chainName is a required field");if(!d.nativeCurrency)throw cM("nativeCurrency is a required field");let e=Number.parseInt(d.chainId,16);if(e===this.getChainId())return!1;let f=this.initializeRelay(),{rpcUrls:g=[],blockExplorerUrls:h=[],chainName:i,iconUrls:j=[],nativeCurrency:k}=d,l=await f.addEthereumChain(e.toString(),g,j,h,i,k);if(dD(l))return!1;if((null==(c=l.result)?void 0:c.isApproved)===!0)return this.updateProviderInfo(g[0],e),null;throw cN("unable to add ethereum chain")}async switchEthereumChain(a){let b=Number.parseInt(a[0].chainId,16),c=this.initializeRelay(),d=await c.switchEthereumChain(b.toString(10),this.selectedAddress||void 0);if(dD(d))throw d;let e=d.result;return e.isApproved&&e.rpcUrl.length>0&&this.updateProviderInfo(e.rpcUrl,b),null}async cleanup(){this.callback=null,this._relay&&this._relay.resetAndReload(),this._storage.clear()}_setAddresses(a,b){var c;if(!Array.isArray(a))throw Error("addresses is not an array");let d=a.map(a=>db(a));JSON.stringify(d)!==JSON.stringify(this._addresses)&&(this._addresses=d,null==(c=this.callback)||c.call(this,"accountsChanged",d),this._storage.setItem(dC,d.join(" ")))}async request(a){let b=a.params||[];switch(a.method){case"eth_accounts":return[...this._addresses];case"eth_coinbase":return this.selectedAddress||null;case"net_version":return this.getChainId().toString(10);case"eth_chainId":return c5(this.getChainId());case"eth_requestAccounts":return this._eth_requestAccounts();case"eth_ecRecover":case"personal_ecRecover":return this.ecRecover(a);case"personal_sign":return this.personalSign(a);case"eth_signTransaction":return this._eth_signTransaction(b);case"eth_sendRawTransaction":return this._eth_sendRawTransaction(b);case"eth_sendTransaction":return this._eth_sendTransaction(b);case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":return this.signTypedData(a);case"wallet_addEthereumChain":return this.addEthereumChain(b);case"wallet_switchEthereumChain":return this.switchEthereumChain(b);case"wallet_watchAsset":return this.watchAsset(b);default:if(!this.jsonRpcUrl)throw cN("No RPC URL set for chain");return dv(a,this.jsonRpcUrl)}}_ensureKnownAddress(a){let b=db(a);if(!this._addresses.map(a=>db(a)).includes(b))throw Error("Unknown Ethereum address")}_prepareTransactionParams(a){let b=a.from?db(a.from):this.selectedAddress;if(!b)throw Error("Ethereum address is unavailable");this._ensureKnownAddress(b);let c=a.to?db(a.to):null,d=null!=a.value?de(a.value):BigInt(0),e=a.data?dc(a.data):Buffer.alloc(0),f=null!=a.nonce?dd(a.nonce):null,g=null!=a.gasPrice?de(a.gasPrice):null,h=null!=a.maxFeePerGas?de(a.maxFeePerGas):null,i=null!=a.maxPriorityFeePerGas?de(a.maxPriorityFeePerGas):null;return{fromAddress:b,toAddress:c,weiValue:d,data:e,nonce:f,gasPriceInWei:g,maxFeePerGas:h,maxPriorityFeePerGas:i,gasLimit:null!=a.gas?de(a.gas):null,chainId:a.chainId?dd(a.chainId):this.getChainId()}}async ecRecover(a){let{method:b,params:c}=a;if(!Array.isArray(c))throw cM();let d=this.initializeRelay(),e=await d.sendRequest({method:"ethereumAddressFromSignedMessage",params:{message:c3(c[0]),signature:c3(c[1]),addPrefix:"personal_ecRecover"===b}});if(dD(e))throw e;return e.result}getChainId(){var a;return Number.parseInt(null!=(a=this._storage.getItem(eU))?a:"1",10)}async _eth_requestAccounts(){var a,b;if(this._addresses.length>0)return null==(a=this.callback)||a.call(this,"connect",{chainId:c5(this.getChainId())}),this._addresses;let c=this.initializeRelay(),d=await c.requestEthereumAccounts();if(dD(d))throw d;if(!d.result)throw Error("accounts received is empty");return this._setAddresses(d.result),null==(b=this.callback)||b.call(this,"connect",{chainId:c5(this.getChainId())}),this._addresses}async personalSign({params:a}){if(!Array.isArray(a))throw cM();let b=a[1],c=a[0];this._ensureKnownAddress(b);let d=this.initializeRelay(),e=await d.sendRequest({method:"signEthereumMessage",params:{address:db(b),message:c3(c),addPrefix:!0,typedDataJson:null}});if(dD(e))throw e;return e.result}async _eth_signTransaction(a){let b=this._prepareTransactionParams(a[0]||{}),c=this.initializeRelay(),d=await c.signEthereumTransaction(b);if(dD(d))throw d;return d.result}async _eth_sendRawTransaction(a){let b=dc(a[0]),c=this.initializeRelay(),d=await c.submitEthereumTransaction(b,this.getChainId());if(dD(d))throw d;return d.result}async _eth_sendTransaction(a){let b=this._prepareTransactionParams(a[0]||{}),c=this.initializeRelay(),d=await c.signAndSubmitEthereumTransaction(b);if(dD(d))throw d;return d.result}async signTypedData(a){let{method:b,params:c}=a;if(!Array.isArray(c))throw cM();let d=c[+("eth_signTypedData_v1"===b)],e=c[+("eth_signTypedData_v1"!==b)];this._ensureKnownAddress(d);let f=this.initializeRelay(),g=await f.sendRequest({method:"signEthereumMessage",params:{address:db(d),message:c2(({eth_signTypedData_v1:dB.default.hashForSignTypedDataLegacy,eth_signTypedData_v3:dB.default.hashForSignTypedData_v3,eth_signTypedData_v4:dB.default.hashForSignTypedData_v4,eth_signTypedData:dB.default.hashForSignTypedData_v4})[b]({data:function(a){if("string"==typeof a)return JSON.parse(a);if("object"==typeof a)return a;throw cM(`Not a JSON string or an object: ${String(a)}`)}(e)}),!0),typedDataJson:JSON.stringify(e,null,2),addPrefix:!1}});if(dD(g))throw g;return g.result}initializeRelay(){return this._relay||(this._relay=new eT({linkAPIUrl:eR,storage:this._storage,metadata:this.metadata,accountsCallback:this._setAddresses.bind(this),chainCallback:this.updateProviderInfo.bind(this)})),this._relay}}let eX="SignerType",eY=new cz("CBWSDK","SignerConfigurator");async function eZ(a){let{communicator:b,metadata:c,handshakeRequest:d,callback:e}=a;e$(b,c,e).catch(()=>{});let f={id:crypto.randomUUID(),event:"selectSignerType",data:Object.assign(Object.assign({},a.preference),{handshakeRequest:d})},{data:g}=await b.postRequestAndWaitForResponse(f);return g}async function e$(a,b,c){await a.onMessage(({event:a})=>"WalletLinkSessionRequest"===a);let d=new eW({metadata:b,callback:c});a.postMessage({event:"WalletLinkUpdate",data:{session:d.getSession()}}),await d.handshake(),a.postMessage({event:"WalletLinkUpdate",data:{connected:!0}})}let{checkCrossOriginOpenerPolicy:e_,getCrossOriginOpenerPolicy:e0}={getCrossOriginOpenerPolicy:()=>void 0===p?"undefined":p,checkCrossOriginOpenerPolicy:async()=>{p="non-browser-env"}},e1={isRed:!1,info:"Retry",svgWidth:"10",svgHeight:"11",path:eN,defaultFillRule:"evenodd",defaultClipRule:"evenodd"},e2=null;class e3{constructor({url:a="https://keys.coinbase.com/connect",metadata:b,preference:c}){this.popup=null,this.listeners=new Map,this.postMessage=async a=>{(await this.waitForPopupLoaded()).postMessage(a,this.url.origin)},this.postRequestAndWaitForResponse=async a=>{let b=this.onMessage(({requestId:b})=>b===a.id);return this.postMessage(a),await b},this.onMessage=async a=>new Promise((b,c)=>{let d=c=>{if(c.origin!==this.url.origin)return;let e=c.data;a(e)&&(b(e),window.removeEventListener("message",d),this.listeners.delete(d))};window.addEventListener("message",d),this.listeners.set(d,{reject:c})}),this.disconnect=()=>{var a;(a=this.popup)&&!a.closed&&a.close(),this.popup=null,this.listeners.forEach(({reject:a},b)=>{a(cO("Request rejected")),window.removeEventListener("message",b)}),this.listeners.clear()},this.waitForPopupLoaded=async()=>this.popup&&!this.popup.closed?(this.popup.focus(),this.popup):(this.popup=await function(a){let b=(window.innerWidth-420)/2+window.screenX,c=(window.innerHeight-540)/2+window.screenY;function d(){let d=`wallet_${crypto.randomUUID()}`,e=window.open(a,d,`width=420, height=540, left=${b}, top=${c}`);return(null==e||e.focus(),e)?e:null}var e=a;for(let[a,b]of Object.entries({sdkName:du,sdkVersion:dt,origin:window.location.origin,coop:e0()}))e.searchParams.append(a,b.toString());let f=d();if(!f){let a=function(){if(!e2){let a=document.createElement("div");a.className="-cbwsdk-css-reset",document.body.appendChild(a),(e2=new eK).attach(a)}return e2}();return new Promise((b,c)=>{a.presentItem({autoExpand:!0,message:"Popup was blocked. Try again.",menuItems:[Object.assign(Object.assign({},e1),{onClick:()=>{(f=d())?b(f):c(cN("Popup window was blocked")),a.clear()}})]})})}return Promise.resolve(f)}(this.url),this.onMessage(({event:a})=>"PopupUnload"===a).then(this.disconnect).catch(()=>{}),this.onMessage(({event:a})=>"PopupLoaded"===a).then(a=>{this.postMessage({requestId:a.id,data:{version:dt,metadata:this.metadata,preference:this.preference,location:window.location.toString()}})}).then(()=>{if(!this.popup)throw cN();return this.popup})),this.url=new URL(a),this.metadata=b,this.preference=c}}var e4=a.i(645544);class e5 extends e4.EventEmitter{}var e6=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c};class e7 extends e5{constructor(a){var{metadata:b}=a,c=a.preference,{keysUrl:d}=c,e=e6(c,["keysUrl"]);super(),this.signer=null,this.isCoinbaseWallet=!0,this.metadata=b,this.preference=e,this.communicator=new e3({url:d,metadata:b,preference:e});const f=eY.getItem(eX);f&&(this.signer=this.initSigner(f))}async request(a){try{if(!function(a){if(!a||"object"!=typeof a||Array.isArray(a))throw cM({message:"Expected a single, non-array, object argument.",data:a});let{method:b,params:c}=a;if("string"!=typeof b||0===b.length)throw cM({message:"'args.method' must be a non-empty string.",data:a});if(void 0!==c&&!Array.isArray(c)&&("object"!=typeof c||null===c))throw cM({message:"'args.params' must be an object or array if provided.",data:a});switch(b){case"eth_sign":case"eth_signTypedData_v2":case"eth_subscribe":case"eth_unsubscribe":throw cQ()}}(a),!this.signer)switch(a.method){case"eth_requestAccounts":{let b=await this.requestSignerSelection(a),c=this.initSigner(b);await c.handshake(a),this.signer=c,eY.setItem(eX,b);break}case"wallet_sendCalls":{let b=this.initSigner("scw");await b.handshake({method:"handshake"});let c=await b.request(a);return await b.cleanup(),c}case"wallet_getCallsStatus":return dv(a,"https://rpc.wallet.coinbase.com");case"net_version":return 1;case"eth_chainId":return c5(1);default:throw cP("Must call 'eth_requestAccounts' before other methods")}return await this.signer.request(a)}catch(d){let a,b,{code:c}=d;return c===cD&&this.disconnect(),Promise.reject((a=function(a,{shouldIncludeStack:b=!1}={}){var c,d;let e={};if(a&&"object"==typeof a&&!Array.isArray(a)&&cK(a,"code")&&Number.isInteger(c=a.code)&&(cG[c.toString()]||(d=c)>=-32099&&d<=-32e3))e.code=a.code,a.message&&"string"==typeof a.message?(e.message=a.message,cK(a,"data")&&(e.data=a.data)):(e.message=cI(e.code),e.data={originalError:cJ(a)});else e.code=cB,e.message=cL(a,"message")?a.message:cH,e.data={originalError:cJ(a)};return b&&(e.stack=cL(a,"stack")?a.stack:void 0),e}(function(a){var b;if("string"==typeof a)return{message:a,code:cB};if(dD(a)){let c=a.errorMessage,d=null!=(b=a.errorCode)?b:c.match(/(denied|rejected)/i)?cC:void 0;return Object.assign(Object.assign({},a),{message:c,code:d,data:{method:a.method}})}return a}(d),{shouldIncludeStack:!0}),(b=new URL("https://docs.cloud.coinbase.com/wallet-sdk/docs/errors")).searchParams.set("version",dt),b.searchParams.set("code",a.code.toString()),b.searchParams.set("message",a.message),Object.assign(Object.assign({},a),{docUrl:b.href})))}}async enable(){return console.warn('.enable() has been deprecated. Please use .request({ method: "eth_requestAccounts" }) instead.'),await this.request({method:"eth_requestAccounts"})}async disconnect(){var a;await (null==(a=this.signer)?void 0:a.cleanup()),this.signer=null,cz.clearAll(),this.emit("disconnect",cR("User initiated disconnection"))}requestSignerSelection(a){return eZ({communicator:this.communicator,preference:this.preference,metadata:this.metadata,handshakeRequest:a,callback:this.emit.bind(this)})}initSigner(a){return function(a){let{signerType:b,metadata:c,communicator:d,callback:e}=a;switch(b){case"scw":return new dA({metadata:c,callback:e,communicator:d});case"walletlink":return new eW({metadata:c,callback:e})}}({signerType:a,metadata:this.metadata,communicator:this.communicator,callback:this.emit.bind(this)})}}let e8={options:"all"};function e9(a){new cz("CBWSDK").setItem("VERSION",dt),e_();let b={metadata:{appName:a.appName||"Dapp",appLogoUrl:a.appLogoUrl||"",appChainIds:a.appChainIds||[]},preference:Object.assign(e8,null!=(c=a.preference)?c:{})};var c,d=b.preference;if(d){if(!["all","smartWalletOnly","eoaOnly"].includes(d.options))throw Error(`Invalid options: ${d.options}`);if(d.attribution&&void 0!==d.attribution.auto&&void 0!==d.attribution.dataSuffix)throw Error("Attribution cannot contain both auto and dataSuffix properties")}let e=null;return{getProvider:()=>{var a;let c;return e||(e=null!=(a=function({metadata:a,preference:b}){var c,d;let{appName:e,appLogoUrl:f,appChainIds:g}=a;if("smartWalletOnly"!==b.options){let a=globalThis.coinbaseWalletExtension;if(a)return null==(c=a.setAppInfo)||c.call(a,e,f,g,b),a}let h=function(){var a,b;try{let c=globalThis;return null!=(a=c.ethereum)?a:null==(b=c.top)?void 0:b.ethereum}catch(a){return}}();if(null==h?void 0:h.isCoinbaseBrowser)return null==(d=h.setAppInfo)||d.call(h,e,f,g,b),h}(c={metadata:b.metadata,preference:b.preference}))?a:new e7(c)),e}}}var fa=a.i(737018),fb=a.i(866756),fc=a.i(906301),fd=a.i(221570),fe=a.i(540302),ff=a.i(116330),fg=a.i(748894),fh=a.i(442134),fi=a.i(603455);let fj="/api/v1/sessions",fk="/api/v1/sessions/logout",fl="/api/v1/siwe/init",fm="/api/v1/siwe/authenticate",fn="/api/v1/siwe/link",fo="/api/v1/siwe/link_smart_wallet",fp="/api/v1/siwe/unlink",fq="/api/v1/siwe/transfer",fr="/api/v1/siws/init",fs="/api/v1/siws/authenticate",ft="/api/v1/siws/link",fu="/api/v1/siws/unlink",fv="/api/v1/siws/transfer",fw="/api/v1/farcaster/init",fx="/api/v1/farcaster/authenticate",fy="/api/v1/farcaster/link",fz="/api/v1/farcaster/status",fA="/api/v1/farcaster/unlink",fB="/api/v1/farcaster/transfer",fC="/api/v1/passwordless/init",fD="/api/v1/passwordless/authenticate",fE="/api/v1/passwordless/link",fF="/api/v1/passwordless/unlink",fG="/api/v1/passwordless/update",fH="/api/v1/passwordless/transfer",fI="/api/v1/passwordless_sms/init",fJ="/api/v1/passwordless_sms/link",fK="/api/v1/passwordless_sms/unlink",fL="/api/v1/passwordless_sms/authenticate",fM="/api/v1/passwordless_sms/update",fN="/api/v1/passwordless_sms/transfer",fO="/api/v1/oauth/init",fP="/api/v1/oauth/authenticate",fQ="/api/v1/oauth/link",fR="/api/v1/oauth/unlink",fS="/api/v1/oauth/transfer",fT="/api/v1/passkeys/link/init",fU="/api/v1/passkeys/authenticate/init",fV="/api/v1/passkeys/register/init",fW="/api/v1/passkeys/link",fX="/api/v1/passkeys/authenticate",fY="/api/v1/passkeys/register",fZ="/api/v1/telegram/authenticate",f$="/api/v1/telegram/link",f_="/api/v1/telegram/unlink",f0="/api/v1/telegram/transfer",f1="/api/v1/mfa/passwordless_sms/init",f2="/api/v1/mfa/passkeys/init",f3="/api/v1/users/me/accept_terms",f4="/api/v1/analytics_events",f5="/api/v1/custom_jwt_account/authenticate",f6="/api/v1/custom_jwt_account/link",f7="/api/v1/guest/authenticate",f8="/api/v1/plugins/moonpay_on_ramp/sign",f9="/api/v1/funding/coinbase_on_ramp/init",ga="/api/v1/funding/coinbase_on_ramp/status",gb="/api/v1/wallets/revoke",gc="/api/v1/users/me",gd="/api/v1/scan/transaction";a.s(["$",()=>fq,"A",()=>fk,"B",()=>f4,"C",()=>f7,"D",()=>f1,"E",()=>f2,"F",()=>f3,"G",()=>fF,"H",()=>fK,"I",()=>fp,"J",()=>fu,"K",()=>fR,"L",()=>fA,"M",()=>f_,"N",()=>gb,"O",()=>f8,"P",()=>f9,"Q",()=>ga,"R",()=>fl,"S",()=>fm,"T",()=>fn,"U",()=>fo,"V",()=>fr,"W",()=>fs,"X",()=>fS,"Y",()=>fv,"Z",()=>f0,"_",()=>fB,"a",()=>fE,"a0",()=>fN,"a1",()=>fH,"a2",()=>ft,"a3",()=>gc,"a4",()=>gd,"a5",()=>"api/v2/farcaster/init","a6",()=>"api/v2/farcaster/authenticate","a8",()=>"/api/v1/recovery/oauth/authenticate","a9",()=>"/api/v1/recovery/oauth/init_icloud","aa",()=>"/api/v1/recovery/oauth/init","b",()=>fC,"c",()=>fy,"d",()=>fw,"e",()=>fz,"f",()=>fx,"g",()=>fQ,"h",()=>fO,"i",()=>fY,"j",()=>fX,"k",()=>fW,"l",()=>fV,"m",()=>fU,"n",()=>fT,"o",()=>fP,"p",()=>fD,"q",()=>fL,"r",()=>fJ,"s",()=>fI,"t",()=>fM,"u",()=>fG,"v",()=>fZ,"w",()=>f$,"x",()=>f5,"y",()=>f6,"z",()=>fj],425041);var ge=a.i(506228),gf=a.i(501060),gg=a.i(775716),gh=a.i(610113),gi=a.i(197262);function gj(a){"function"==typeof queueMicrotask?queueMicrotask(a):Promise.resolve().then(a).catch(a=>setTimeout(()=>{throw a}))}function gk(){let a=[],b={addEventListener:(a,c,d,e)=>(a.addEventListener(c,d,e),b.add(()=>a.removeEventListener(c,d,e))),requestAnimationFrame(...a){let c=requestAnimationFrame(...a);return b.add(()=>cancelAnimationFrame(c))},nextFrame:(...a)=>b.requestAnimationFrame(()=>b.requestAnimationFrame(...a)),setTimeout(...a){let c=setTimeout(...a);return b.add(()=>clearTimeout(c))},microTask(...a){let c={current:!0};return gj(()=>{c.current&&a[0]()}),b.add(()=>{c.current=!1})},style(a,b,c){let d=a.style.getPropertyValue(b);return Object.assign(a.style,{[b]:c}),this.add(()=>{Object.assign(a.style,{[b]:d})})},group(a){let b=gk();return a(b),this.add(()=>b.dispose())},add:b=>(a.includes(b)||a.push(b),()=>{let c=a.indexOf(b);if(c>=0)for(let b of a.splice(c,1))b()}),dispose(){for(let b of a.splice(0))b()}};return b}function gl(){let[a]=(0,R.useState)(gk);return(0,R.useEffect)(()=>()=>a.dispose(),[a]),a}a.s(["disposables",()=>gk],925479),a.s(["useDisposables",()=>gl],555282);var gm=Object.defineProperty,gn=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?gm(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c,c};let go=new class{constructor(){gn(this,"current",this.detect()),gn(this,"handoffState","pending"),gn(this,"currentId",0)}set(a){this.current!==a&&(this.handoffState="pending",this.currentId=0,this.current=a)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return"server"===this.current}get isClient(){return"client"===this.current}detect(){return"server"}handoff(){"pending"===this.handoffState&&(this.handoffState="complete")}get isHandoffComplete(){return"complete"===this.handoffState}},gp=(a,b)=>{go.isServer?(0,R.useEffect)(a,b):(0,R.useLayoutEffect)(a,b)};function gq(a){let b=(0,R.useRef)(a);return gp(()=>{b.current=a},[a]),b}a.s(["useIsoMorphicEffect",()=>gp],916501);let gr=function(a){let b=gq(a);return R.default.useCallback((...a)=>b.current(...a),[b])};function gs(){let a=(0,R.useRef)(!1);return gp(()=>(a.current=!0,()=>{a.current=!1}),[]),a}function gt(){let a,b=(a="undefined"==typeof document,"useSyncExternalStore"in R&&(0,R.useSyncExternalStore)(()=>()=>{},()=>!1,()=>!a)),[c,d]=R.useState(go.isHandoffComplete);return c&&!1===go.isHandoffComplete&&d(!1),R.useEffect(()=>{!0!==c&&d(!0)},[c]),R.useEffect(()=>go.handoff(),[]),!b&&c}a.s(["useEvent",()=>gr],249765);let gu=Symbol();function gv(a,b=!0){return Object.assign(a,{[gu]:b})}function gw(...a){let b=(0,R.useRef)(a);(0,R.useEffect)(()=>{b.current=a},[a]);let c=gr(a=>{for(let c of b.current)null!=c&&("function"==typeof c?c(a):c.current=a)});return a.every(a=>null==a||(null==a?void 0:a[gu]))?void 0:c}a.s(["optionalRef",()=>gv,"useSyncRefs",()=>gw],710912),"undefined"!=typeof process&&"undefined"!=typeof globalThis&&"undefined"!=typeof Element&&(null==(D0=null==process?void 0:process.env)?void 0:D0.NODE_ENV)==="test"&&void 0===(null==(D1=null==Element?void 0:Element.prototype)?void 0:D1.getAnimations)&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var gx=((q=gx||{})[q.None=0]="None",q[q.Closed=1]="Closed",q[q.Enter=2]="Enter",q[q.Leave=4]="Leave",q);function gy(a){let b={};for(let c in a)!0===a[c]&&(b[`data-${c}`]="");return b}function gz(a,b,c,d){let[e,f]=(0,R.useState)(c),{hasFlag:g,addFlag:h,removeFlag:i}=function(a=0){let[b,c]=(0,R.useState)(a),d=(0,R.useCallback)(a=>c(a),[]),e=(0,R.useCallback)(a=>c(b=>b|a),[]),f=(0,R.useCallback)(a=>(b&a)===a,[b]);return{flags:b,setFlag:d,addFlag:e,hasFlag:f,removeFlag:(0,R.useCallback)(a=>c(b=>b&~a),[]),toggleFlag:(0,R.useCallback)(a=>c(b=>b^a),[])}}(a&&e?3:0),j=(0,R.useRef)(!1),k=(0,R.useRef)(!1);return gp(()=>{var e;if(a){if(c&&f(!0),!b){c&&h(3);return}return null==(e=null==d?void 0:d.start)||e.call(d,c),function(a,{prepare:b,run:c,done:d,inFlight:e}){let f=gk();return function(a,{inFlight:b,prepare:c}){if(null!=b&&b.current)return c();let d=a.style.transition;a.style.transition="none",c(),a.offsetHeight,a.style.transition=d}(a,{prepare:b,inFlight:e}),f.nextFrame(()=>{c(),f.requestAnimationFrame(()=>{f.add(function(a,b){var c,d;let e=gk();if(!a)return e.dispose;let f=!1;e.add(()=>{f=!0});let g=null!=(d=null==(c=a.getAnimations)?void 0:c.call(a).filter(a=>a instanceof CSSTransition))?d:[];return 0===g.length?b():Promise.allSettled(g.map(a=>a.finished)).then(()=>{f||b()}),e.dispose}(a,d))})}),f.dispose}(b,{inFlight:j,prepare(){k.current?k.current=!1:k.current=j.current,j.current=!0,k.current||(c?(h(3),i(4)):(h(4),i(2)))},run(){k.current?c?(i(3),h(4)):(i(4),h(3)):c?i(1):h(1)},done(){var a,e,g,h;k.current&&(null!=(h=null==(g=(e=b).getAnimations)?void 0:g.call(e))?h:[]).some(a=>a instanceof CSSTransition&&"finished"!==a.playState)||(j.current=!1,i(7),c||f(!1),null==(a=null==d?void 0:d.end)||a.call(d,c))}})}},[a,c,b,gl()]),a?[e,{closed:g(1),enter:g(2),leave:g(4),transition:g(2)||g(4)}]:[c,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}a.s(["transitionDataAttributes",()=>gy,"useTransition",()=>gz],448808);let gA=(0,R.createContext)(null);gA.displayName="OpenClosedContext";var gB=((r=gB||{})[r.Open=1]="Open",r[r.Closed=2]="Closed",r[r.Closing=4]="Closing",r[r.Opening=8]="Opening",r);function gC(){return(0,R.useContext)(gA)}function gD({value:a,children:b}){return R.default.createElement(gA.Provider,{value:a},b)}function gE({children:a}){return R.default.createElement(gA.Provider,{value:null},a)}function gF(...a){return Array.from(new Set(a.flatMap(a=>"string"==typeof a?a.split(" "):[]))).filter(Boolean).join(" ")}function gG(a,b,...c){if(a in b){let d=b[a];return"function"==typeof d?d(...c):d}let d=Error(`Tried to handle "${a}" but there is no handler defined. Only defined handlers are: ${Object.keys(b).map(a=>`"${a}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(d,gG),d}a.s(["OpenClosedProvider",()=>gD,"ResetOpenClosedProvider",()=>gE,"State",()=>gB,"useOpenClosed",()=>gC],532681),a.s(["match",()=>gG],218524);var gH=((s=gH||{})[s.None=0]="None",s[s.RenderStrategy=1]="RenderStrategy",s[s.Static=2]="Static",s),gI=((t=gI||{})[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t);function gJ(){let a,b,c=(a=(0,R.useRef)([]),b=(0,R.useCallback)(b=>{for(let c of a.current)null!=c&&("function"==typeof c?c(b):c.current=b)},[]),(...c)=>{if(!c.every(a=>null==a))return a.current=c,b});return(0,R.useCallback)(a=>(function({ourProps:a,theirProps:b,slot:c,defaultTag:d,features:e,visible:f=!0,name:g,mergeRefs:h}){h=null!=h?h:gL;let i=gM(b,a);if(f)return gK(i,c,d,g,h);let j=null!=e?e:0;if(2&j){let{static:a=!1,...b}=i;if(a)return gK(b,c,d,g,h)}if(1&j){let{unmount:a=!0,...b}=i;return gG(+!a,{0:()=>null,1:()=>gK({...b,hidden:!0,style:{display:"none"}},c,d,g,h)})}return gK(i,c,d,g,h)})({mergeRefs:c,...a}),[c])}function gK(a,b={},c,d,e){let{as:f=c,children:g,refName:h="ref",...i}=gQ(a,["unmount","static"]),j=void 0!==a.ref?{[h]:a.ref}:{},k="function"==typeof g?g(b):g;"className"in i&&i.className&&"function"==typeof i.className&&(i.className=i.className(b)),i["aria-labelledby"]&&i["aria-labelledby"]===i.id&&(i["aria-labelledby"]=void 0);let l={};if(b){let a=!1,c=[];for(let[d,e]of Object.entries(b))"boolean"==typeof e&&(a=!0),!0===e&&c.push(d.replace(/([A-Z])/g,a=>`-${a.toLowerCase()}`));if(a)for(let a of(l["data-headlessui-state"]=c.join(" "),c))l[`data-${a}`]=""}if(gR(f)&&(Object.keys(gP(i)).length>0||Object.keys(gP(l)).length>0))if(!(0,R.isValidElement)(k)||Array.isArray(k)&&k.length>1||gR(k.type)){if(Object.keys(gP(i)).length>0)throw Error(['Passing props on "Fragment"!',"",`The current component <${d} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(gP(i)).concat(Object.keys(gP(l))).map(a=>`  - ${a}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(a=>`  - ${a}`).join(`
`)].join(`
`))}else{var m;let a=k.props,b=null==a?void 0:a.className,c="function"==typeof b?(...a)=>gF(b(...a),i.className):gF(b,i.className),d=gM(k.props,gP(gQ(i,["ref"])));for(let a in l)a in d&&delete l[a];return(0,R.cloneElement)(k,Object.assign({},d,l,j,{ref:e((m=k,R.default.version.split(".")[0]>="19"?m.props.ref:m.ref),j.ref)},c?{className:c}:{}))}return(0,R.createElement)(f,Object.assign({},gQ(i,["ref"]),!gR(f)&&j,!gR(f)&&l),k)}function gL(...a){return a.every(a=>null==a)?void 0:b=>{for(let c of a)null!=c&&("function"==typeof c?c(b):c.current=b)}}function gM(...a){if(0===a.length)return{};if(1===a.length)return a[0];let b={},c={};for(let d of a)for(let a in d)a.startsWith("on")&&"function"==typeof d[a]?(null!=c[a]||(c[a]=[]),c[a].push(d[a])):b[a]=d[a];if(b.disabled||b["aria-disabled"])for(let a in c)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(a)&&(c[a]=[a=>{var b;return null==(b=null==a?void 0:a.preventDefault)?void 0:b.call(a)}]);for(let a in c)Object.assign(b,{[a](b,...d){for(let e of c[a]){if((b instanceof Event||(null==b?void 0:b.nativeEvent)instanceof Event)&&b.defaultPrevented)return;e(b,...d)}}});return b}function gN(...a){if(0===a.length)return{};if(1===a.length)return a[0];let b={},c={};for(let d of a)for(let a in d)a.startsWith("on")&&"function"==typeof d[a]?(null!=c[a]||(c[a]=[]),c[a].push(d[a])):b[a]=d[a];for(let a in c)Object.assign(b,{[a](...b){for(let d of c[a])null==d||d(...b)}});return b}function gO(a){var b;return Object.assign((0,R.forwardRef)(a),{displayName:null!=(b=a.displayName)?b:a.name})}function gP(a){let b=Object.assign({},a);for(let a in b)void 0===b[a]&&delete b[a];return b}function gQ(a,b=[]){let c=Object.assign({},a);for(let a of b)a in c&&delete c[a];return c}function gR(a){return a===R.Fragment||a===Symbol.for("react.fragment")}function gS(a){var b;return!!(a.enter||a.enterFrom||a.enterTo||a.leave||a.leaveFrom||a.leaveTo)||!gR(null!=(b=a.as)?b:gY)||1===R.default.Children.count(a.children)}a.s(["RenderFeatures",()=>gH,"RenderStrategy",()=>gI,"compact",()=>gP,"forwardRefWithAs",()=>gO,"isFragment",()=>gR,"mergeProps",()=>gN,"useRender",()=>gJ],322870);let gT=(0,R.createContext)(null);gT.displayName="TransitionContext";var gU=((u=gU||{}).Visible="visible",u.Hidden="hidden",u);let gV=(0,R.createContext)(null);function gW(a){return"children"in a?gW(a.children):a.current.filter(({el:a})=>null!==a.current).filter(({state:a})=>"visible"===a).length>0}function gX(a,b){let c=gq(a),d=(0,R.useRef)([]),e=gs(),f=gl(),g=gr((a,b=gI.Hidden)=>{let g=d.current.findIndex(({el:b})=>b===a);-1!==g&&(gG(b,{[gI.Unmount](){d.current.splice(g,1)},[gI.Hidden](){d.current[g].state="hidden"}}),f.microTask(()=>{var a;!gW(d)&&e.current&&(null==(a=c.current)||a.call(c))}))}),h=gr(a=>{let b=d.current.find(({el:b})=>b===a);return b?"visible"!==b.state&&(b.state="visible"):d.current.push({el:a,state:"visible"}),()=>g(a,gI.Unmount)}),i=(0,R.useRef)([]),j=(0,R.useRef)(Promise.resolve()),k=(0,R.useRef)({enter:[],leave:[]}),l=gr((a,c,d)=>{i.current.splice(0),b&&(b.chains.current[c]=b.chains.current[c].filter(([b])=>b!==a)),null==b||b.chains.current[c].push([a,new Promise(a=>{i.current.push(a)})]),null==b||b.chains.current[c].push([a,new Promise(a=>{Promise.all(k.current[c].map(([a,b])=>b)).then(()=>a())})]),"enter"===c?j.current=j.current.then(()=>null==b?void 0:b.wait.current).then(()=>d(c)):d(c)}),m=gr((a,b,c)=>{Promise.all(k.current[b].splice(0).map(([a,b])=>b)).then(()=>{var a;null==(a=i.current.shift())||a()}).then(()=>c(b))});return(0,R.useMemo)(()=>({children:d,register:h,unregister:g,onStart:l,onStop:m,wait:j,chains:k}),[h,g,d,l,m,k,j])}gV.displayName="NestingContext";let gY=R.Fragment,gZ=gH.RenderStrategy,g$=gO(function(a,b){let{show:c,appear:d=!1,unmount:e=!0,...f}=a,g=(0,R.useRef)(null),h=gw(...gS(a)?[g,b]:null===b?[]:[b]);gt();let i=gC();if(void 0===c&&null!==i&&(c=(i&gB.Open)===gB.Open),void 0===c)throw Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[j,k]=(0,R.useState)(c?"visible":"hidden"),l=gX(()=>{c||k("hidden")}),[m,n]=(0,R.useState)(!0),o=(0,R.useRef)([c]);gp(()=>{!1!==m&&o.current[o.current.length-1]!==c&&(o.current.push(c),n(!1))},[o,c]);let p=(0,R.useMemo)(()=>({show:c,appear:d,initial:m}),[c,d,m]);gp(()=>{c?k("visible"):gW(l)||null===g.current||k("hidden")},[c,l]);let q={unmount:e},r=gr(()=>{var b;m&&n(!1),null==(b=a.beforeEnter)||b.call(a)}),s=gr(()=>{var b;m&&n(!1),null==(b=a.beforeLeave)||b.call(a)}),t=gJ();return R.default.createElement(gV.Provider,{value:l},R.default.createElement(gT.Provider,{value:p},t({ourProps:{...q,as:R.Fragment,children:R.default.createElement(g_,{ref:h,...q,...f,beforeEnter:r,beforeLeave:s})},theirProps:{},defaultTag:R.Fragment,features:gZ,visible:"visible"===j,name:"Transition"})))}),g_=gO(function(a,b){var c,d;let{transition:e=!0,beforeEnter:f,afterEnter:g,beforeLeave:h,afterLeave:i,enter:j,enterFrom:k,enterTo:l,entered:m,leave:n,leaveFrom:o,leaveTo:p,...q}=a,[r,s]=(0,R.useState)(null),t=(0,R.useRef)(null),u=gS(a),v=gw(...u?[t,b,s]:null===b?[]:[b]),w=null==(c=q.unmount)||c?gI.Unmount:gI.Hidden,{show:x,appear:y,initial:z}=function(){let a=(0,R.useContext)(gT);if(null===a)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return a}(),[A,B]=(0,R.useState)(x?"visible":"hidden"),C=function(){let a=(0,R.useContext)(gV);if(null===a)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return a}(),{register:D,unregister:E}=C;gp(()=>D(t),[D,t]),gp(()=>{if(w===gI.Hidden&&t.current)return x&&"visible"!==A?void B("visible"):gG(A,{hidden:()=>E(t),visible:()=>D(t)})},[A,t,D,E,x,w]);let F=gt();gp(()=>{if(u&&F&&"visible"===A&&null===t.current)throw Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[t,A,F,u]);let G=z&&!y,H=y&&x&&z,I=(0,R.useRef)(!1),J=gX(()=>{I.current||(B("hidden"),E(t))},C),K=gr(a=>{I.current=!0,J.onStart(t,a?"enter":"leave",a=>{"enter"===a?null==f||f():"leave"===a&&(null==h||h())})}),L=gr(a=>{let b=a?"enter":"leave";I.current=!1,J.onStop(t,b,a=>{"enter"===a?null==g||g():"leave"===a&&(null==i||i())}),"leave"!==b||gW(J)||(B("hidden"),E(t))});(0,R.useEffect)(()=>{u&&e||(K(x),L(x))},[x,u,e]);let[,M]=gz(!(!e||!u||!F||G),r,x,{start:K,end:L}),N=gP({ref:v,className:(null==(d=gF(q.className,H&&j,H&&k,M.enter&&j,M.enter&&M.closed&&k,M.enter&&!M.closed&&l,M.leave&&n,M.leave&&!M.closed&&o,M.leave&&M.closed&&p,!M.transition&&x&&m))?void 0:d.trim())||void 0,...gy(M)}),O=0;"visible"===A&&(O|=gB.Open),"hidden"===A&&(O|=gB.Closed),x&&"hidden"===A&&(O|=gB.Opening),x||"visible"!==A||(O|=gB.Closing);let P=gJ();return R.default.createElement(gV.Provider,{value:J},R.default.createElement(gD,{value:O},P({ourProps:N,theirProps:q,defaultTag:gY,features:gZ,visible:"visible"===A,name:"Transition.Child"})))}),g0=gO(function(a,b){let c=null!==(0,R.useContext)(gT),d=null!==gC();return R.default.createElement(R.default.Fragment,null,!c&&d?R.default.createElement(g$,{ref:b,...a}):R.default.createElement(g_,{ref:b,...a}))}),g1=Object.assign(g$,{Child:g0,Root:g$});var g2=((v=g2||{}).Space=" ",v.Enter="Enter",v.Escape="Escape",v.Backspace="Backspace",v.Delete="Delete",v.ArrowLeft="ArrowLeft",v.ArrowUp="ArrowUp",v.ArrowRight="ArrowRight",v.ArrowDown="ArrowDown",v.Home="Home",v.End="End",v.PageUp="PageUp",v.PageDown="PageDown",v.Tab="Tab",v);function g3(a,b,c,d){let e=gq(c);(0,R.useEffect)(()=>{function c(a){e.current(a)}return(a=null!=a?a:window).addEventListener(b,c,d),()=>a.removeEventListener(b,c,d)},[a,b,d])}a.s(["Keys",()=>g2],304053);class g4 extends Map{constructor(a){super(),this.factory=a}get(a){let b=super.get(a);return void 0===b&&(b=this.factory(a),this.set(a,b)),b}}var g5=Object.defineProperty,g6=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot "+c)},g7=(a,b,c)=>(g6(a,b,"read from private field"),c?c.call(a):b.get(a)),g8=(a,b,c)=>{if(b.has(a))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(a):b.set(a,c)},g9=(a,b,c,d)=>(g6(a,b,"write to private field"),d?d.call(a,c):b.set(a,c),c);class ha{constructor(a){g8(this,D2,{}),g8(this,D3,new g4(()=>new Set)),g8(this,D4,new Set),((a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?g5(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c})(this,"disposables",gk()),g9(this,D2,a),go.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return g7(this,D2)}subscribe(a,b){if(go.isServer)return()=>{};let c={selector:a,callback:b,current:a(g7(this,D2))};return g7(this,D4).add(c),this.disposables.add(()=>{g7(this,D4).delete(c)})}on(a,b){return go.isServer?()=>{}:(g7(this,D3).get(a).add(b),this.disposables.add(()=>{g7(this,D3).get(a).delete(b)}))}send(a){let b=this.reduce(g7(this,D2),a);if(b!==g7(this,D2)){for(let a of(g9(this,D2,b),g7(this,D4))){let b=a.selector(g7(this,D2));hb(a.current,b)||(a.current=b,a.callback(b))}for(let b of g7(this,D3).get(a.type))b(g7(this,D2),a)}}}function hb(a,b){return!!Object.is(a,b)||"object"==typeof a&&null!==a&&"object"==typeof b&&null!==b&&(Array.isArray(a)&&Array.isArray(b)?a.length===b.length&&hc(a[Symbol.iterator](),b[Symbol.iterator]()):a instanceof Map&&b instanceof Map||a instanceof Set&&b instanceof Set?a.size===b.size&&hc(a.entries(),b.entries()):!!(hd(a)&&hd(b))&&hc(Object.entries(a)[Symbol.iterator](),Object.entries(b)[Symbol.iterator]()))}function hc(a,b){for(;;){let c=a.next(),d=b.next();if(c.done&&d.done)return!0;if(c.done||d.done||!Object.is(c.value,d.value))return!1}}function hd(a){if("[object Object]"!==Object.prototype.toString.call(a))return!1;let b=Object.getPrototypeOf(a);return null===b||null===Object.getPrototypeOf(b)}function he(a){let[b,c]=a(),d=gk();return(...a)=>{b(...a),d.dispose(),d.microTask(c)}}D2=new WeakMap,D3=new WeakMap,D4=new WeakMap,a.s(["Machine",()=>ha,"batch",()=>he,"shallowEqual",()=>hb],55887);var hf=Object.defineProperty,hg=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?hf(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c,c},hh=((w=hh||{})[w.Push=0]="Push",w[w.Pop=1]="Pop",w);let hi={0(a,b){let c=b.id,d=a.stack,e=a.stack.indexOf(c);if(-1!==e){let b=a.stack.slice();return b.splice(e,1),b.push(c),d=b,{...a,stack:d}}return{...a,stack:[...a.stack,c]}},1(a,b){let c=b.id,d=a.stack.indexOf(c);if(-1===d)return a;let e=a.stack.slice();return e.splice(d,1),{...a,stack:e}}};class hj extends ha{constructor(){super(...arguments),hg(this,"actions",{push:a=>this.send({type:0,id:a}),pop:a=>this.send({type:1,id:a})}),hg(this,"selectors",{isTop:(a,b)=>a.stack[a.stack.length-1]===b,inStack:(a,b)=>a.stack.includes(b)})}static new(){return new hj({stack:[]})}reduce(a,b){return gG(b.type,hi,a,b)}}let hk=new g4(()=>hj.new());a.s(["ActionTypes",()=>hh,"stackMachines",()=>hk],175707);var hl=a.i(332473);function hm(a,b,c=hb){return(0,hl.useSyncExternalStoreWithSelector)(gr(b=>a.subscribe(hn,b)),gr(()=>a.state),gr(()=>a.state),gr(b),c)}function hn(a){return a}function ho(a,b){let c=(0,R.useId)(),d=hk.get(b),[e,f]=hm(d,(0,R.useCallback)(a=>[d.selectors.isTop(a,c),d.selectors.inStack(a,c)],[d,c]));return gp(()=>{if(a)return d.actions.push(c),()=>d.actions.pop(c)},[d,a,c]),!!a&&(!f||e)}function hp(a){var b;return go.isServer?null:null==a?document:null!=(b=null==a?void 0:a.ownerDocument)?b:document}function hq(a){var b,c;return go.isServer?null:null==a?document:null!=(c=null==(b=null==a?void 0:a.getRootNode)?void 0:b.call(a))?c:document}function hr(a){var b,c;return null!=(c=null==(b=hq(a))?void 0:b.activeElement)?c:null}function hs(a){return hr(a)===a}a.s(["useSlice",()=>hm],18264),a.s(["getActiveElement",()=>hr,"getOwnerDocument",()=>hp,"getRootNode",()=>hq,"isActiveElement",()=>hs],355944);let ht=new Map,hu=new Map;function hv(a){var b;let c=null!=(b=hu.get(a))?b:0;return hu.set(a,c+1),0!==c||(ht.set(a,{"aria-hidden":a.getAttribute("aria-hidden"),inert:a.inert}),a.setAttribute("aria-hidden","true"),a.inert=!0),()=>(function(a){var b;let c=null!=(b=hu.get(a))?b:1;if(1===c?hu.delete(a):hu.set(a,c-1),1!==c)return;let d=ht.get(a);d&&(null===d["aria-hidden"]?a.removeAttribute("aria-hidden"):a.setAttribute("aria-hidden",d["aria-hidden"]),a.inert=d.inert,ht.delete(a))})(a)}function hw(a,{allowed:b,disallowed:c}={}){let d=ho(a,"inert-others");gp(()=>{var a,e;if(!d)return;let f=gk();for(let b of null!=(a=null==c?void 0:c())?a:[])b&&f.add(hv(b));let g=null!=(e=null==b?void 0:b())?e:[];for(let a of g){if(!a)continue;let b=hp(a);if(!b)continue;let c=a.parentElement;for(;c&&c!==b.body;){for(let a of c.children)g.some(b=>a.contains(b))||f.add(hv(a));c=c.parentElement}}return f.dispose},[d,b,c])}function hx(a){return"object"==typeof a&&null!==a&&"nodeType"in a}function hy(a){return hx(a)&&"tagName"in a}function hz(a){return hy(a)&&"accessKey"in a}function hA(a){return hy(a)&&"tabIndex"in a}function hB(a){return hy(a)&&"style"in a}function hC(a){return hz(a)&&"IFRAME"===a.nodeName}function hD(a){return hz(a)&&"INPUT"===a.nodeName}function hE(a){return hz(a)&&"LABEL"===a.nodeName}function hF(a){return hz(a)&&"FIELDSET"===a.nodeName}function hG(a){return hz(a)&&"LEGEND"===a.nodeName}function hH(a){return!!hy(a)&&a.matches('a[href],audio[controls],button,details,embed,iframe,img[usemap],input:not([type="hidden"]),label,select,textarea,video[controls]')}function hI(a,b,c){let d=gq(a=>{let b=a.getBoundingClientRect();0===b.x&&0===b.y&&0===b.width&&0===b.height&&c()});(0,R.useEffect)(()=>{if(!a)return;let c=null===b?null:hz(b)?b:b.current;if(!c)return;let e=gk();if("undefined"!=typeof ResizeObserver){let a=new ResizeObserver(()=>d.current(c));a.observe(c),e.add(()=>a.disconnect())}if("undefined"!=typeof IntersectionObserver){let a=new IntersectionObserver(()=>d.current(c));a.observe(c),e.add(()=>a.disconnect())}return()=>e.dispose()},[b,d,a])}a.s(["useInertOthers",()=>hw],256576),a.s(["hasInlineStyle",()=>hB,"isElement",()=>hy,"isHTMLElement",()=>hz,"isHTMLFieldSetElement",()=>hF,"isHTMLIframeElement",()=>hC,"isHTMLInputElement",()=>hD,"isHTMLLabelElement",()=>hE,"isHTMLLegendElement",()=>hG,"isHTMLorSVGElement",()=>hA,"isInteractiveElement",()=>hH,"isNode",()=>hx],859041),a.s(["useOnDisappear",()=>hI],678418);let hJ=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(a=>`${a}:not([tabindex='-1'])`).join(","),hK=["[data-autofocus]"].map(a=>`${a}:not([tabindex='-1'])`).join(",");var hL=((x=hL||{})[x.First=1]="First",x[x.Previous=2]="Previous",x[x.Next=4]="Next",x[x.Last=8]="Last",x[x.WrapAround=16]="WrapAround",x[x.NoScroll=32]="NoScroll",x[x.AutoFocus=64]="AutoFocus",x),hM=((y=hM||{})[y.Error=0]="Error",y[y.Overflow=1]="Overflow",y[y.Success=2]="Success",y[y.Underflow=3]="Underflow",y),hN=((z=hN||{})[z.Previous=-1]="Previous",z[z.Next=1]="Next",z);function hO(a=document.body){return null==a?[]:Array.from(a.querySelectorAll(hJ)).sort((a,b)=>Math.sign((a.tabIndex||Number.MAX_SAFE_INTEGER)-(b.tabIndex||Number.MAX_SAFE_INTEGER)))}var hP=((A=hP||{})[A.Strict=0]="Strict",A[A.Loose=1]="Loose",A);function hQ(a,b=0){var c;return a!==(null==(c=hp(a))?void 0:c.body)&&gG(b,{0:()=>a.matches(hJ),1(){let b=a;for(;null!==b;){if(b.matches(hJ))return!0;b=b.parentElement}return!1}})}function hR(a){gk().nextFrame(()=>{let b=hr(a);b&&hA(b)&&!hQ(b,0)&&hT(a)})}var hS=((B=hS||{})[B.Keyboard=0]="Keyboard",B[B.Mouse=1]="Mouse",B);function hT(a){null==a||a.focus({preventScroll:!0})}function hU(a,b=a=>a){return a.slice().sort((a,c)=>{let d=b(a),e=b(c);if(null===d||null===e)return 0;let f=d.compareDocumentPosition(e);return f&Node.DOCUMENT_POSITION_FOLLOWING?-1:f&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function hV(a,b,c=null===a?document.body:hq(a)){return hW(hO(c),b,{relativeTo:a})}function hW(a,b,{sorted:c=!0,relativeTo:d=null,skipElements:e=[]}={}){var f,g,h;let i=Array.isArray(a)?a.length>0?hq(a[0]):document:hq(a),j=Array.isArray(a)?c?hU(a):a:64&b?function(a=document.body){return null==a?[]:Array.from(a.querySelectorAll(hK)).sort((a,b)=>Math.sign((a.tabIndex||Number.MAX_SAFE_INTEGER)-(b.tabIndex||Number.MAX_SAFE_INTEGER)))}(a):hO(a);e.length>0&&j.length>1&&(j=j.filter(a=>!e.some(b=>null!=b&&"current"in b?(null==b?void 0:b.current)===a:b===a))),d=null!=d?d:null==i?void 0:i.activeElement;let k=(()=>{if(5&b)return 1;if(10&b)return -1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=(()=>{if(1&b)return 0;if(2&b)return Math.max(0,j.indexOf(d))-1;if(4&b)return Math.max(0,j.indexOf(d))+1;if(8&b)return j.length-1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),m=32&b?{preventScroll:!0}:{},n=0,o=j.length,p;do{if(n>=o||n+o<=0)return 0;let a=l+n;if(16&b)a=(a+o)%o;else{if(a<0)return 3;if(a>=o)return 1}null==(p=j[a])||p.focus(m),n+=k}while(p!==hr(p))return 6&b&&null!=(h=null==(g=null==(f=p)?void 0:f.matches)?void 0:g.call(f,"textarea,input"))&&h&&p.select(),2}function hX(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function hY(){return hX()||/Android/gi.test(window.navigator.userAgent)}function hZ(a,b,c,d){let e=gq(c);(0,R.useEffect)(()=>{if(a)return document.addEventListener(b,c,d),()=>document.removeEventListener(b,c,d);function c(a){e.current(a)}},[a,b,d])}function h$(a,b,c,d){let e=gq(c);(0,R.useEffect)(()=>{if(a)return window.addEventListener(b,c,d),()=>window.removeEventListener(b,c,d);function c(a){e.current(a)}},[a,b,d])}function h_(a,b,c){let d=gq(c),e=(0,R.useCallback)(function(a,c){if(a.defaultPrevented)return;let e=c(a);if(null!==e&&e.getRootNode().contains(e)&&e.isConnected){for(let c of function a(b){return"function"==typeof b?a(b()):Array.isArray(b)||b instanceof Set?b:[b]}(b))if(null!==c&&(c.contains(e)||a.composed&&a.composedPath().includes(c)))return;return hQ(e,hP.Loose)||-1===e.tabIndex||a.preventDefault(),d.current(a,e)}},[d,b]),f=(0,R.useRef)(null);hZ(a,"pointerdown",a=>{var b,c;hY()||(f.current=(null==(c=null==(b=a.composedPath)?void 0:b.call(a))?void 0:c[0])||a.target)},!0),hZ(a,"pointerup",a=>{if(hY()||!f.current)return;let b=f.current;return f.current=null,e(a,()=>b)},!0);let g=(0,R.useRef)({x:0,y:0});hZ(a,"touchstart",a=>{g.current.x=a.touches[0].clientX,g.current.y=a.touches[0].clientY},!0),hZ(a,"touchend",a=>{let b={x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY};if(!(Math.abs(b.x-g.current.x)>=30||Math.abs(b.y-g.current.y)>=30))return e(a,()=>hA(a.target)?a.target:null)},!0),h$(a,"blur",a=>e(a,()=>hC(window.document.activeElement)?window.document.activeElement:null),!0)}function h0(...a){return(0,R.useMemo)(()=>hp(...a),[...a])}a.s(["Focus",()=>hL,"FocusResult",()=>hM,"FocusableMode",()=>hP,"focusElement",()=>hT,"focusFrom",()=>hV,"focusIn",()=>hW,"focusableSelector",()=>hJ,"isFocusableElement",()=>hQ,"restoreFocusIfNecessary",()=>hR,"sortByDomNode",()=>hU],805841),a.s(["useDocumentEvent",()=>hZ],760960),a.s(["useOutsideClick",()=>h_],489658),a.s(["useOwnerDocument",()=>h0],877511);var h1=((C=h1||{})[C.None=1]="None",C[C.Focusable=2]="Focusable",C[C.Hidden=4]="Hidden",C);let h2=gO(function(a,b){var c;let{features:d=1,...e}=a,f={ref:b,"aria-hidden":(2&d)==2||(null!=(c=e["aria-hidden"])?c:void 0),hidden:(4&d)==4||void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(4&d)==4&&(2&d)!=2&&{display:"none"}}};return gJ()({ourProps:f,theirProps:e,slot:{},defaultTag:"span",name:"Hidden"})}),h3=(0,R.createContext)(null);function h4({children:a,node:b}){let[c,d]=(0,R.useState)(null),e=h5(null!=b?b:c);return R.default.createElement(h3.Provider,{value:e},a,null===e&&R.default.createElement(h2,{features:h1.Hidden,ref:a=>{var b,c;if(a){for(let e of null!=(c=null==(b=hp(a))?void 0:b.querySelectorAll("html > *, body > *"))?c:[])if(e!==document.body&&e!==document.head&&hy(e)&&null!=e&&e.contains(a)){d(e);break}}}}))}function h5(a=null){var b;return null!=(b=(0,R.useContext)(h3))?b:a}function h6(a){let b={};for(let c of a)Object.assign(b,c(b));return b}let h7=(DM=()=>new Map,DN={PUSH(a,b){var c;let d=null!=(c=this.get(a))?c:{doc:a,count:0,d:gk(),meta:new Set,computedMeta:{}};return d.count++,d.meta.add(b),d.computedMeta=h6(d.meta),this.set(a,d),this},POP(a,b){let c=this.get(a);return c&&(c.count--,c.meta.delete(b),c.computedMeta=h6(c.meta)),this},SCROLL_PREVENT(a){let b,c={doc:a.doc,d:a.d,meta:()=>a.computedMeta},d=[hX()?{before({doc:a,d:b,meta:c}){function d(a){for(let b of c().containers)for(let c of b())if(c.contains(a))return!0;return!1}b.microTask(()=>{var c;if("auto"!==window.getComputedStyle(a.documentElement).scrollBehavior){let c=gk();c.style(a.documentElement,"scrollBehavior","auto"),b.add(()=>b.microTask(()=>c.dispose()))}let e=null!=(c=window.scrollY)?c:window.pageYOffset,f=null;b.addEventListener(a,"click",b=>{if(hA(b.target))try{let c=b.target.closest("a");if(!c)return;let{hash:e}=new URL(c.href),g=a.querySelector(e);hA(g)&&!d(g)&&(f=g)}catch{}},!0),b.group(c=>{b.addEventListener(a,"touchstart",a=>{if(c.dispose(),hA(a.target)&&hB(a.target))if(d(a.target)){let b=a.target;for(;b.parentElement&&d(b.parentElement);)b=b.parentElement;c.style(b,"overscrollBehavior","contain")}else c.style(a.target,"touchAction","none")})}),b.addEventListener(a,"touchmove",a=>{if(hA(a.target)&&!hD(a.target))if(d(a.target)){let b=a.target;for(;b.parentElement&&""!==b.dataset.headlessuiPortal&&!(b.scrollHeight>b.clientHeight||b.scrollWidth>b.clientWidth);)b=b.parentElement;""===b.dataset.headlessuiPortal&&a.preventDefault()}else a.preventDefault()},{passive:!1}),b.add(()=>{var a;e!==(null!=(a=window.scrollY)?a:window.pageYOffset)&&window.scrollTo(0,e),f&&f.isConnected&&(f.scrollIntoView({block:"nearest"}),f=null)})})}}:{},{before({doc:a}){var c;let d=a.documentElement;b=Math.max(0,(null!=(c=a.defaultView)?c:window).innerWidth-d.clientWidth)},after({doc:a,d:c}){let d=a.documentElement,e=Math.max(0,d.clientWidth-d.offsetWidth),f=Math.max(0,b-e);c.style(d,"paddingRight",`${f}px`)}},{before({doc:a,d:b}){b.style(a.documentElement,"overflow","hidden")}}];d.forEach(({before:a})=>null==a?void 0:a(c)),d.forEach(({after:a})=>null==a?void 0:a(c))},SCROLL_ALLOW({d:a}){a.dispose()},TEARDOWN({doc:a}){this.delete(a)}},D=DM(),E=new Set,{getSnapshot:()=>D,subscribe:a=>(E.add(a),()=>E.delete(a)),dispatch(a,...b){let c=DN[a].call(D,...b);c&&(D=c,E.forEach(a=>a()))}});function h8(a,b,c=()=>[document.body]){!function(a,b,c=()=>({containers:[]})){let d=(0,R.useSyncExternalStore)(h7.subscribe,h7.getSnapshot,h7.getSnapshot),e=b?d.get(b):void 0;e&&e.count,gp(()=>{if(!(!b||!a))return h7.dispatch("PUSH",b,c),()=>h7.dispatch("POP",b,c)},[a,b])}(ho(a,"scroll-lock"),b,a=>{var b;return{containers:[...null!=(b=a.containers)?b:[],c]}})}function h9(a){return(0,R.useMemo)(()=>a,Object.values(a))}h7.subscribe(()=>{let a=h7.getSnapshot(),b=new Map;for(let[c]of a)b.set(c,c.documentElement.style.overflow);for(let c of a.values()){let a="hidden"===b.get(c.doc),d=0!==c.count;(d&&!a||!d&&a)&&h7.dispatch(c.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",c),0===c.count&&h7.dispatch("TEARDOWN",c)}}),a.s(["useScrollLock",()=>h8],207712),a.s(["useSlot",()=>h9],705840);let ia=(0,R.createContext)(()=>{});function ib({value:a,children:b}){return R.default.createElement(ia.Provider,{value:a},b)}let ic=(0,R.createContext)(!1);function id(a){return R.default.createElement(ic.Provider,{value:a.force},a.children)}let ie=(0,R.createContext)(void 0);function ig(){return(0,R.useContext)(ie)}a.s(["useDisabled",()=>ig],354187);let ih=(0,R.createContext)(null);function ii(){let[a,b]=(0,R.useState)([]);return[a.length>0?a.join(" "):void 0,(0,R.useMemo)(()=>function(a){let c=gr(a=>(b(b=>[...b,a]),()=>b(b=>{let c=b.slice(),d=c.indexOf(a);return -1!==d&&c.splice(d,1),c}))),d=(0,R.useMemo)(()=>({register:c,slot:a.slot,name:a.name,props:a.props,value:a.value}),[c,a.slot,a.name,a.props,a.value]);return R.default.createElement(ih.Provider,{value:d},a.children)},[b])]}ih.displayName="DescriptionContext";let ij=Object.assign(gO(function(a,b){let c=(0,R.useId)(),d=ig(),{id:e=`headlessui-description-${c}`,...f}=a,g=function a(){let b=(0,R.useContext)(ih);if(null===b){let b=Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(b,a),b}return b}(),h=gw(b);gp(()=>g.register(e),[e,g.register]);let i=h9({...g.slot,disabled:d||!1}),j={ref:h,...g.props,id:e};return gJ()({ourProps:j,theirProps:f,slot:i,defaultTag:"p",name:g.name||"Description"})}),{});function ik(a){let b=gr(a),c=(0,R.useRef)(!1);(0,R.useEffect)(()=>(c.current=!1,()=>{c.current=!0,gj(()=>{c.current&&b()})}),[b])}a.s(["Description",()=>ij,"useDescriptions",()=>ii],308735),a.s(["useOnUnmount",()=>ik],820026);var il=((F=il||{})[F.Forwards=0]="Forwards",F[F.Backwards=1]="Backwards",F);function im(a,b){let c=(0,R.useRef)([]),d=gr(a);(0,R.useEffect)(()=>{let a=[...c.current];for(let[e,f]of b.entries())if(c.current[e]!==f){let e=d(b,a);return c.current=b,e}},[d,...b])}let io=[];function ip(a){if(!a)return new Set;if("function"==typeof a)return new Set(a());let b=new Set;for(let c of a.current)hy(c.current)&&b.add(c.current);return b}var iq=((G=iq||{})[G.None=0]="None",G[G.InitialFocus=1]="InitialFocus",G[G.TabLock=2]="TabLock",G[G.FocusLock=4]="FocusLock",G[G.RestoreFocus=8]="RestoreFocus",G[G.AutoFocus=16]="AutoFocus",G);let ir=Object.assign(gO(function(a,b){let c,d=(0,R.useRef)(null),e=gw(d,b),{initialFocus:f,initialFocusFallback:g,containers:h,features:i=15,...j}=a;gt()||(i=0);let k=h0(d.current);!function(a,{ownerDocument:b}){let c=!!(8&a),d=function(a=!0){let b=(0,R.useRef)(io.slice());return im(([a],[c])=>{!0===c&&!1===a&&gj(()=>{b.current.splice(0)}),!1===c&&!0===a&&(b.current=io.slice())},[a,io,b]),gr(()=>{var a;return null!=(a=b.current.find(a=>null!=a&&a.isConnected))?a:null})}(c);im(()=>{c||hs(null==b?void 0:b.body)&&hT(d())},[c]),ik(()=>{c&&hT(d())})}(i,{ownerDocument:k});let l=function(a,{ownerDocument:b,container:c,initialFocus:d,initialFocusFallback:e}){let f=(0,R.useRef)(null),g=ho(!!(1&a),"focus-trap#initial-focus"),h=gs();return im(()=>{if(0===a)return;if(!g){null!=e&&e.current&&hT(e.current);return}let i=c.current;i&&gj(()=>{if(!h.current)return;let c=null==b?void 0:b.activeElement;if(null!=d&&d.current){if((null==d?void 0:d.current)===c){f.current=c;return}}else if(i.contains(c)){f.current=c;return}if(null!=d&&d.current)hT(d.current);else{if(16&a){if(hW(i,hL.First|hL.AutoFocus)!==hM.Error)return}else if(hW(i,hL.First)!==hM.Error)return;if(null!=e&&e.current&&(hT(e.current),(null==b?void 0:b.activeElement)===e.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}f.current=null==b?void 0:b.activeElement})},[e,g,a]),f}(i,{ownerDocument:k,container:d,initialFocus:f,initialFocusFallback:g});!function(a,{ownerDocument:b,container:c,containers:d,previousActiveElement:e}){let f=gs(),g=!!(4&a);g3(null==b?void 0:b.defaultView,"focus",a=>{if(!g||!f.current)return;let b=ip(d);hz(c.current)&&b.add(c.current);let h=e.current;if(!h)return;let i=a.target;hz(i)?is(b,i)?(e.current=i,hT(i)):(a.preventDefault(),a.stopPropagation(),hT(h)):hT(e.current)},!0)}(i,{ownerDocument:k,container:d,containers:h,previousActiveElement:l});let m=(c=(0,R.useRef)(0),h$(!0,"keydown",a=>{"Tab"===a.key&&(c.current=+!!a.shiftKey)},!0),c),n=gr(a=>{if(!hz(d.current))return;let b=d.current;gG(m.current,{[il.Forwards]:()=>{hW(b,hL.First,{skipElements:[a.relatedTarget,g]})},[il.Backwards]:()=>{hW(b,hL.Last,{skipElements:[a.relatedTarget,g]})}})}),o=ho(!!(2&i),"focus-trap#tab-lock"),p=gl(),q=(0,R.useRef)(!1),r=gJ();return R.default.createElement(R.default.Fragment,null,o&&R.default.createElement(h2,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:n,features:h1.Focusable}),r({ourProps:{ref:e,onKeyDown(a){"Tab"==a.key&&(q.current=!0,p.requestAnimationFrame(()=>{q.current=!1}))},onBlur(a){if(!(4&i))return;let b=ip(h);hz(d.current)&&b.add(d.current);let c=a.relatedTarget;hA(c)&&"true"!==c.dataset.headlessuiFocusGuard&&(is(b,c)||(q.current?hW(d.current,gG(m.current,{[il.Forwards]:()=>hL.Next,[il.Backwards]:()=>hL.Previous})|hL.WrapAround,{relativeTo:a.target}):hA(a.target)&&hT(a.target)))}},theirProps:j,defaultTag:"div",name:"FocusTrap"}),o&&R.default.createElement(h2,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:n,features:h1.Focusable}))}),{features:iq});function is(a,b){for(let c of a)if(c.contains(b))return!0;return!1}var it=a.i(935112);let iu=R.Fragment,iv=gO(function(a,b){let{ownerDocument:c=null,...d}=a,e=(0,R.useRef)(null),f=gw(gv(a=>{e.current=a}),b),g=h0(e.current),h=function(a){let b=(0,R.useContext)(ic),c=(0,R.useContext)(ix),[d,e]=(0,R.useState)(()=>{var d;if(!b&&null!==c)return null!=(d=c.current)?d:null;if(go.isServer)return null;let e=null==a?void 0:a.getElementById("headlessui-portal-root");if(e)return e;if(null===a)return null;let f=a.createElement("div");return f.setAttribute("id","headlessui-portal-root"),a.body.appendChild(f)});return(0,R.useEffect)(()=>{null!==d&&(null!=a&&a.body.contains(d)||null==a||a.body.appendChild(d))},[d,a]),(0,R.useEffect)(()=>{b||null!==c&&e(c.current)},[c,e,b]),d}(null!=c?c:g),i=(0,R.useContext)(iy),j=gl(),k=gJ();return ik(()=>{var a;h&&h.childNodes.length<=0&&(null==(a=h.parentElement)||a.removeChild(h))}),h?(0,it.createPortal)(R.default.createElement("div",{"data-headlessui-portal":"",ref:a=>{j.dispose(),i&&a&&j.add(i.register(a))}},k({ourProps:{ref:f},theirProps:d,slot:{},defaultTag:iu,name:"Portal"})),h):null}),iw=R.Fragment,ix=(0,R.createContext)(null),iy=(0,R.createContext)(null);function iz(){let a=(0,R.useContext)(iy),b=(0,R.useRef)([]),c=gr(c=>(b.current.push(c),a&&a.register(c),()=>d(c))),d=gr(c=>{let d=b.current.indexOf(c);-1!==d&&b.current.splice(d,1),a&&a.unregister(c)}),e=(0,R.useMemo)(()=>({register:c,unregister:d,portals:b}),[c,d,b]);return[b,(0,R.useMemo)(()=>function({children:a}){return R.default.createElement(iy.Provider,{value:e},a)},[e])]}let iA=gO(function(a,b){let c=gw(b),{enabled:d=!0,ownerDocument:e,...f}=a,g=gJ();return d?R.default.createElement(iv,{...f,ownerDocument:e,ref:c}):g({ourProps:{ref:c},theirProps:f,slot:{},defaultTag:iu,name:"Portal"})}),iB=gO(function(a,b){let{target:c,...d}=a,e={ref:gw(b)},f=gJ();return R.default.createElement(ix.Provider,{value:c},f({ourProps:e,theirProps:d,defaultTag:iw,name:"Popover.Group"}))}),iC=Object.assign(iA,{Group:iB});a.s(["Portal",()=>iC,"PortalGroup",()=>iB,"useNestedPortals",()=>iz],445503);var iD=((H=iD||{})[H.Open=0]="Open",H[H.Closed=1]="Closed",H),iE=((I=iE||{})[I.SetTitleId=0]="SetTitleId",I);let iF={0:(a,b)=>a.titleId===b.id?a:{...a,titleId:b.id}},iG=(0,R.createContext)(null);function iH(a){let b=(0,R.useContext)(iG);if(null===b){let b=Error(`<${a} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(b,iH),b}return b}function iI(a,b){return gG(b.type,iF,a,b)}iG.displayName="DialogContext";let iJ=gO(function(a,b){let c=(0,R.useId)(),{id:d=`headlessui-dialog-${c}`,open:e,onClose:f,initialFocus:g,role:h="dialog",autoFocus:i=!0,__demoMode:j=!1,unmount:k=!1,...l}=a,m=(0,R.useRef)(!1);h="dialog"===h||"alertdialog"===h?h:(m.current||(m.current=!0,console.warn(`Invalid role [${h}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog");let n=gC();void 0===e&&null!==n&&(e=(n&gB.Open)===gB.Open);let o=(0,R.useRef)(null),p=gw(o,b),q=h0(o.current),r=+!e,[s,t]=(0,R.useReducer)(iI,{titleId:null,descriptionId:null,panelRef:(0,R.createRef)()}),u=gr(()=>f(!1)),v=gr(a=>t({type:0,id:a})),w=!!gt()&&0===r,[x,y]=iz(),z=h5(),{resolveContainers:A}=function({defaultContainers:a=[],portals:b,mainTreeNode:c}={}){let d=gr(()=>{var d,e;let f=hp(c),g=[];for(let b of a)null!==b&&(hy(b)?g.push(b):"current"in b&&hy(b.current)&&g.push(b.current));if(null!=b&&b.current)for(let a of b.current)g.push(a);for(let a of null!=(d=null==f?void 0:f.querySelectorAll("html > *, body > *"))?d:[])a!==document.body&&a!==document.head&&hy(a)&&"headlessui-portal-root"!==a.id&&(c&&(a.contains(c)||a.contains(null==(e=null==c?void 0:c.getRootNode())?void 0:e.host))||g.some(b=>a.contains(b))||g.push(a));return g});return{resolveContainers:d,contains:gr(a=>d().some(b=>b.contains(a)))}}({mainTreeNode:z,portals:x,defaultContainers:[{get current(){var B;return null!=(B=s.panelRef.current)?B:o.current}}]}),C=null!==n&&(n&gB.Closing)===gB.Closing;hw(!j&&!C&&w,{allowed:gr(()=>{var a,b;return[null!=(b=null==(a=o.current)?void 0:a.closest("[data-headlessui-portal]"))?b:null]}),disallowed:gr(()=>{var a;return[null!=(a=null==z?void 0:z.closest("body > *:not(#headlessui-portal-root)"))?a:null]})});let D=hk.get(null);gp(()=>{if(w)return D.actions.push(d),()=>D.actions.pop(d)},[D,d,w]);let E=hm(D,(0,R.useCallback)(a=>D.selectors.isTop(a,d),[D,d]));h_(E,A,a=>{a.preventDefault(),u()}),function(a,b="undefined"!=typeof document?document.defaultView:null,c){let d=ho(a,"escape");g3(b,"keydown",a=>{d&&(a.defaultPrevented||a.key===g2.Escape&&c(a))})}(E,null==q?void 0:q.defaultView,a=>{a.preventDefault(),a.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur(),u()}),h8(!j&&!C&&w,q,A),hI(w,o,u);let[F,G]=ii(),H=(0,R.useMemo)(()=>[{dialogState:r,close:u,setTitleId:v,unmount:k},s],[r,u,v,k,s]),I=h9({open:0===r}),J={ref:p,id:d,role:h,tabIndex:-1,"aria-modal":j?void 0:0===r||void 0,"aria-labelledby":s.titleId,"aria-describedby":F,unmount:k},K=!function(){var a;let[b]=(0,R.useState)(()=>null),[c,d]=(0,R.useState)(null!=(a=null==b?void 0:b.matches)&&a);return gp(()=>{if(b)return b.addEventListener("change",a),()=>b.removeEventListener("change",a);function a(a){d(a.matches)}},[b]),c}(),L=iq.None;w&&!j&&(L|=iq.RestoreFocus,L|=iq.TabLock,i&&(L|=iq.AutoFocus),K&&(L|=iq.InitialFocus));let M=gJ();return R.default.createElement(gE,null,R.default.createElement(id,{force:!0},R.default.createElement(iC,null,R.default.createElement(iG.Provider,{value:H},R.default.createElement(iB,{target:o},R.default.createElement(id,{force:!1},R.default.createElement(G,{slot:I},R.default.createElement(y,null,R.default.createElement(ir,{initialFocus:g,initialFocusFallback:o,containers:A,features:L},R.default.createElement(ib,{value:u},M({ourProps:J,theirProps:l,slot:I,defaultTag:iK,features:iL,visible:0===r,name:"Dialog"})))))))))))}),iK="div",iL=gH.RenderStrategy|gH.Static,iM=gO(function(a,b){let{transition:c=!1,open:d,...e}=a,f=gC(),g=a.hasOwnProperty("open")||null!==f,h=a.hasOwnProperty("onClose");if(!g&&!h)throw Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!g)throw Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!h)throw Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!f&&"boolean"!=typeof a.open)throw Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${a.open}`);if("function"!=typeof a.onClose)throw Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${a.onClose}`);return(void 0!==d||c)&&!e.static?R.default.createElement(h4,null,R.default.createElement(g1,{show:d,transition:c,unmount:e.unmount},R.default.createElement(iJ,{ref:b,...e}))):R.default.createElement(h4,null,R.default.createElement(iJ,{ref:b,open:d,...e}))}),iN=gO(function(a,b){let c=(0,R.useId)(),{id:d=`headlessui-dialog-panel-${c}`,transition:e=!1,...f}=a,[{dialogState:g,unmount:h},i]=iH("Dialog.Panel"),j=gw(b,i.panelRef),k=h9({open:0===g}),l=gr(a=>{a.stopPropagation()}),m=e?g0:R.Fragment,n=gJ();return R.default.createElement(m,{...e?{unmount:h}:{}},n({ourProps:{ref:j,id:d,onClick:l},theirProps:f,slot:k,defaultTag:"div",name:"Dialog.Panel"}))}),iO=Object.assign(iM,{Panel:iN,Title:(gO(function(a,b){let{transition:c=!1,...d}=a,[{dialogState:e,unmount:f}]=iH("Dialog.Backdrop"),g=h9({open:0===e}),h=c?g0:R.Fragment,i=gJ();return R.default.createElement(h,{...c?{unmount:f}:{}},i({ourProps:{ref:b,"aria-hidden":!0},theirProps:d,slot:g,defaultTag:"div",name:"Dialog.Backdrop"}))}),gO(function(a,b){let c=(0,R.useId)(),{id:d=`headlessui-dialog-title-${c}`,...e}=a,[{dialogState:f,setTitleId:g}]=iH("Dialog.Title"),h=gw(b);(0,R.useEffect)(()=>(g(d),()=>g(null)),[d,g]);let i=h9({open:0===f});return gJ()({ourProps:{ref:h,id:d},theirProps:e,slot:i,defaultTag:"h2",name:"Dialog.Title"})})),Description:ij});var iP=a.i(15388),iQ=a.i(673620),iR=a.i(679628),iS=a.i(741721),iT=a.i(516148),iU=a.i(957162);let iV=BigInt(0),iW=BigInt(1);function iX(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function iY(a){if(!iX(a))throw Error("Uint8Array expected")}function iZ(a,b){if("boolean"!=typeof b)throw Error(a+" boolean expected, got "+b)}function i$(a){let b=a.toString(16);return 1&b.length?"0"+b:b}function i_(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);return""===a?iV:BigInt("0x"+a)}let i0="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,i1=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function i2(a){if(iY(a),i0)return a.toHex();let b="";for(let c=0;c<a.length;c++)b+=i1[a[c]];return b}function i3(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:void 0}function i4(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);if(i0)return Uint8Array.fromHex(a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=i3(a.charCodeAt(e)),f=i3(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d}function i5(a){return i_(i2(a))}function i6(a){return iY(a),i_(i2(Uint8Array.from(a).reverse()))}function i7(a,b){return i4(a.toString(16).padStart(2*b,"0"))}function i8(a,b){return i7(a,b).reverse()}function i9(a,b,c){let d;if("string"==typeof b)try{d=i4(b)}catch(b){throw Error(a+" must be hex string or Uint8Array, cause: "+b)}else if(iX(b))d=Uint8Array.from(b);else throw Error(a+" must be hex string or Uint8Array");let e=d.length;if("number"==typeof c&&e!==c)throw Error(a+" of length "+c+" expected, got "+e);return d}function ja(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];iY(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}let jb=a=>"bigint"==typeof a&&iV<=a;function jc(a,b,c){return jb(a)&&jb(b)&&jb(c)&&b<=a&&a<c}function jd(a,b,c,d){if(!jc(b,c,d))throw Error("expected valid "+a+": "+c+" <= n < "+d+", got "+b)}let je=a=>(iW<<BigInt(a))-iW,jf=a=>new Uint8Array(a),jg={bigint:a=>"bigint"==typeof a,function:a=>"function"==typeof a,boolean:a=>"boolean"==typeof a,string:a=>"string"==typeof a,stringOrUint8Array:a=>"string"==typeof a||iX(a),isSafeInteger:a=>Number.isSafeInteger(a),array:a=>Array.isArray(a),field:(a,b)=>b.Fp.isValid(a),hash:a=>"function"==typeof a&&Number.isSafeInteger(a.outputLen)};function jh(a,b,c={}){let d=(b,c,d)=>{let e=jg[c];if("function"!=typeof e)throw Error("invalid validator function");let f=a[b];if((!d||void 0!==f)&&!e(f,a))throw Error("param "+String(b)+" is invalid. Expected "+c+", got "+f)};for(let[a,c]of Object.entries(b))d(a,c,!1);for(let[a,b]of Object.entries(c))d(a,b,!0);return a}function ji(a){let b=new WeakMap;return(c,...d)=>{let e=b.get(c);if(void 0!==e)return e;let f=a(c,...d);return b.set(c,f),f}}let jj=BigInt(0),jk=BigInt(1),jl=BigInt(2),jm=BigInt(3),jn=BigInt(4),jo=BigInt(5),jp=BigInt(8);function jq(a,b){let c=a%b;return c>=jj?c:b+c}function jr(a,b,c){let d=a;for(;b-- >jj;)d*=d,d%=c;return d}function js(a,b){if(a===jj)throw Error("invert: expected non-zero number");if(b<=jj)throw Error("invert: expected positive modulus, got "+b);let c=jq(a,b),d=b,e=jj,f=jk,g=jk,h=jj;for(;c!==jj;){let a=d/c,b=d%c,i=e-g*a,j=f-h*a;d=c,c=b,e=g,f=h,g=i,h=j}if(d!==jk)throw Error("invert: does not exist");return jq(e,b)}function jt(a,b){let c=(a.ORDER+jk)/jn,d=a.pow(b,c);if(!a.eql(a.sqr(d),b))throw Error("Cannot find square root");return d}function ju(a,b){let c=(a.ORDER-jo)/jp,d=a.mul(b,jl),e=a.pow(d,c),f=a.mul(b,e),g=a.mul(a.mul(f,jl),e),h=a.mul(f,a.sub(g,a.ONE));if(!a.eql(a.sqr(h),b))throw Error("Cannot find square root");return h}let jv=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function jw(a){return jh(a,jv.reduce((a,b)=>(a[b]="function",a),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function jx(a,b,c=!1){let d=Array(b.length).fill(c?a.ZERO:void 0),e=b.reduce((b,c,e)=>a.is0(c)?b:(d[e]=b,a.mul(b,c)),a.ONE),f=a.inv(e);return b.reduceRight((b,c,e)=>a.is0(c)?b:(d[e]=a.mul(b,d[e]),a.mul(b,c)),f),d}function jy(a,b){let c=(a.ORDER-jk)/jl,d=a.pow(b,c),e=a.eql(d,a.ONE),f=a.eql(d,a.ZERO),g=a.eql(d,a.neg(a.ONE));if(!e&&!f&&!g)throw Error("invalid Legendre symbol result");return e?1:f?0:-1}function jz(a,b){void 0!==b&&(0,dK.anumber)(b);let c=void 0!==b?b:a.toString(2).length,d=Math.ceil(c/8);return{nBitLength:c,nByteLength:d}}function jA(a,b,c=!1,d={}){let e;if(a<=jj)throw Error("invalid field: expected ORDER > 0, got "+a);let{nBitLength:f,nByteLength:g}=jz(a,b);if(g>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let h=Object.freeze({ORDER:a,isLE:c,BITS:f,BYTES:g,MASK:je(f),ZERO:jj,ONE:jk,create:b=>jq(b,a),isValid:b=>{if("bigint"!=typeof b)throw Error("invalid field element: expected bigint, got "+typeof b);return jj<=b&&b<a},is0:a=>a===jj,isOdd:a=>(a&jk)===jk,neg:b=>jq(-b,a),eql:(a,b)=>a===b,sqr:b=>jq(b*b,a),add:(b,c)=>jq(b+c,a),sub:(b,c)=>jq(b-c,a),mul:(b,c)=>jq(b*c,a),pow:(a,b)=>(function(a,b,c){if(c<jj)throw Error("invalid exponent, negatives unsupported");if(c===jj)return a.ONE;if(c===jk)return b;let d=a.ONE,e=b;for(;c>jj;)c&jk&&(d=a.mul(d,e)),e=a.sqr(e),c>>=jk;return d})(h,a,b),div:(b,c)=>jq(b*js(c,a),a),sqrN:a=>a*a,addN:(a,b)=>a+b,subN:(a,b)=>a-b,mulN:(a,b)=>a*b,inv:b=>js(b,a),sqrt:d.sqrt||(b=>(e||(e=a%jn===jm?jt:a%jp===jo?ju:function(a){if(a<BigInt(3))throw Error("sqrt is not defined for small field");let b=a-jk,c=0;for(;b%jl===jj;)b/=jl,c++;let d=jl,e=jA(a);for(;1===jy(e,d);)if(d++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===c)return jt;let f=e.pow(d,b),g=(b+jk)/jl;return function(a,d){if(a.is0(d))return d;if(1!==jy(a,d))throw Error("Cannot find square root");let e=c,h=a.mul(a.ONE,f),i=a.pow(d,b),j=a.pow(d,g);for(;!a.eql(i,a.ONE);){if(a.is0(i))return a.ZERO;let b=1,c=a.sqr(i);for(;!a.eql(c,a.ONE);)if(b++,c=a.sqr(c),b===e)throw Error("Cannot find square root");let d=jk<<BigInt(e-b-1),f=a.pow(h,d);e=b,h=a.sqr(f),i=a.mul(i,h),j=a.mul(j,f)}return j}}(a)),e(h,b))),toBytes:a=>c?i8(a,g):i7(a,g),fromBytes:a=>{if(a.length!==g)throw Error("Field.fromBytes: expected "+g+" bytes, got "+a.length);return c?i6(a):i5(a)},invertBatch:a=>jx(h,a),cmov:(a,b,c)=>c?b:a});return Object.freeze(h)}function jB(a){if("bigint"!=typeof a)throw Error("field order must be bigint");return Math.ceil(a.toString(2).length/8)}function jC(a){let b=jB(a);return b+Math.ceil(b/2)}let jD=BigInt(0),jE=BigInt(1);function jF(a,b){let c=b.negate();return a?c:b}function jG(a,b){if(!Number.isSafeInteger(a)||a<=0||a>b)throw Error("invalid window size, expected [1.."+b+"], got W="+a)}function jH(a,b){jG(a,b);let c=Math.ceil(b/a)+1,d=2**(a-1),e=2**a;return{windows:c,windowSize:d,mask:je(a),maxNumber:e,shiftBy:BigInt(a)}}function jI(a,b,c){let{windowSize:d,mask:e,maxNumber:f,shiftBy:g}=c,h=Number(a&e),i=a>>g;h>d&&(h-=f,i+=jE);let j=b*d,k=j+Math.abs(h)-1,l=0===h;return{nextN:i,offset:k,isZero:l,isNeg:h<0,isNegF:b%2!=0,offsetF:j}}let jJ=new WeakMap,jK=new WeakMap;function jL(a){return jK.get(a)||1}function jM(a){return jw(a.Fp),jh(a,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...jz(a.n,a.nBitLength),...a,...{p:a.Fp.ORDER}})}function jN(a){void 0!==a.lowS&&iZ("lowS",a.lowS),void 0!==a.prehash&&iZ("prehash",a.prehash)}let jO={Err:class extends Error{constructor(a=""){super(a)}},_tlv:{encode:(a,b)=>{let{Err:c}=jO;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(1&b.length)throw new c("tlv.encode: unpadded data");let d=b.length/2,e=i$(d);if(e.length/2&128)throw new c("tlv.encode: long form length too big");let f=d>127?i$(e.length/2|128):"";return i$(a)+f+e+b},decode(a,b){let{Err:c}=jO,d=0;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(b.length<2||b[d++]!==a)throw new c("tlv.decode: wrong tlv");let e=b[d++],f=0;if(128&e){let a=127&e;if(!a)throw new c("tlv.decode(long): indefinite length not supported");if(a>4)throw new c("tlv.decode(long): byte length is too big");let g=b.subarray(d,d+a);if(g.length!==a)throw new c("tlv.decode: length bytes not complete");if(0===g[0])throw new c("tlv.decode(long): zero leftmost byte");for(let a of g)f=f<<8|a;if(d+=a,f<128)throw new c("tlv.decode(long): not minimal encoding")}else f=e;let g=b.subarray(d,d+f);if(g.length!==f)throw new c("tlv.decode: wrong value length");return{v:g,l:b.subarray(d+f)}}},_int:{encode(a){let{Err:b}=jO;if(a<jP)throw new b("integer: negative integers are not allowed");let c=i$(a);if(8&Number.parseInt(c[0],16)&&(c="00"+c),1&c.length)throw new b("unexpected DER parsing assertion: unpadded hex");return c},decode(a){let{Err:b}=jO;if(128&a[0])throw new b("invalid signature integer: negative");if(0===a[0]&&!(128&a[1]))throw new b("invalid signature integer: unnecessary leading zero");return i5(a)}},toSig(a){let{Err:b,_int:c,_tlv:d}=jO,e=i9("signature",a),{v:f,l:g}=d.decode(48,e);if(g.length)throw new b("invalid signature: left bytes after parsing");let{v:h,l:i}=d.decode(2,f),{v:j,l:k}=d.decode(2,i);if(k.length)throw new b("invalid signature: left bytes after parsing");return{r:c.decode(h),s:c.decode(j)}},hexFromSig(a){let{_tlv:b,_int:c}=jO,d=b.encode(2,c.encode(a.r)),e=b.encode(2,c.encode(a.s));return b.encode(48,d+e)}},jP=BigInt(0),jQ=BigInt(1),jR=BigInt(2),jS=BigInt(3),jT=BigInt(4),jU=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),jV=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),jW=BigInt(0),jX=BigInt(1),jY=BigInt(2),jZ=(a,b)=>(a+b/jY)/b,j$=jA(jU,void 0,void 0,{sqrt:function(a){let b=BigInt(3),c=BigInt(6),d=BigInt(11),e=BigInt(22),f=BigInt(23),g=BigInt(44),h=BigInt(88),i=a*a*a%jU,j=i*i*a%jU,k=jr(j,b,jU)*j%jU,l=jr(k,b,jU)*j%jU,m=jr(l,jY,jU)*i%jU,n=jr(m,d,jU)*m%jU,o=jr(n,e,jU)*n%jU,p=jr(o,g,jU)*o%jU,q=jr(p,h,jU)*p%jU,r=jr(q,g,jU)*o%jU,s=jr(r,b,jU)*j%jU,t=jr(s,f,jU)*n%jU,u=jr(t,c,jU)*i%jU,v=jr(u,jY,jU);if(!j$.eql(j$.sqr(v),a))throw Error("Cannot find square root");return v}}),j_=(DO={a:jW,b:BigInt(7),Fp:j$,n:jV,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:a=>{let b=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),c=-jX*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),d=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),e=BigInt("0x100000000000000000000000000000000"),f=jZ(b*a,jV),g=jZ(-c*a,jV),h=jq(a-f*b-g*d,jV),i=jq(-f*c-g*b,jV),j=h>e,k=i>e;if(j&&(h=jV-h),k&&(i=jV-i),h>e||i>e)throw Error("splitScalar: Endomorphism failed, k="+a);return{k1neg:j,k1:h,k2neg:k,k2:i}}}},DP=iT.sha256,{...(J=a=>(function(a){let b,c=(jh(b=jM(a),{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...b})),{Fp:d,n:e,nByteLength:f,nBitLength:g}=c,h=d.BYTES+1,i=2*d.BYTES+1;function j(a){return jq(a,e)}let{ProjectivePoint:k,normPrivateKeyToScalar:l,weierstrassEquation:m,isWithinCurveOrder:n}=function(a){var b;let c=function(a){let b=jM(a);jh(b,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});let{endo:c,Fp:d,a:e}=b;if(c){if(!d.eql(e,d.ZERO))throw Error("invalid endo: CURVE.a must be 0");if("object"!=typeof c||"bigint"!=typeof c.beta||"function"!=typeof c.splitScalar)throw Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...b})}(a),{Fp:d}=c,e=jA(c.n,c.nBitLength),f=c.toBytes||((a,b,c)=>{let e=b.toAffine();return ja(Uint8Array.from([4]),d.toBytes(e.x),d.toBytes(e.y))}),g=c.fromBytes||(a=>{let b=a.subarray(1);return{x:d.fromBytes(b.subarray(0,d.BYTES)),y:d.fromBytes(b.subarray(d.BYTES,2*d.BYTES))}});function h(a){let{a:b,b:e}=c,f=d.sqr(a),g=d.mul(f,a);return d.add(d.add(g,d.mul(a,b)),e)}function i(a,b){let c=d.sqr(b),e=h(a);return d.eql(c,e)}if(!i(c.Gx,c.Gy))throw Error("bad curve params: generator point");let j=d.mul(d.pow(c.a,jS),jT),k=d.mul(d.sqr(c.b),BigInt(27));if(d.is0(d.add(j,k)))throw Error("bad curve params: a or b");function l(a){let b,{allowedPrivateKeyLengths:d,nByteLength:e,wrapPrivateKey:f,n:g}=c;if(d&&"bigint"!=typeof a){if(iX(a)&&(a=i2(a)),"string"!=typeof a||!d.includes(a.length))throw Error("invalid private key");a=a.padStart(2*e,"0")}try{b="bigint"==typeof a?a:i5(i9("private key",a,e))}catch(b){throw Error("invalid private key, expected hex or "+e+" bytes, got "+typeof a)}return f&&(b=jq(b,g)),jd("private key",b,jQ,g),b}function m(a){if(!(a instanceof p))throw Error("ProjectivePoint expected")}let n=ji((a,b)=>{let{px:c,py:e,pz:f}=a;if(d.eql(f,d.ONE))return{x:c,y:e};let g=a.is0();null==b&&(b=g?d.ONE:d.inv(f));let h=d.mul(c,b),i=d.mul(e,b),j=d.mul(f,b);if(g)return{x:d.ZERO,y:d.ZERO};if(!d.eql(j,d.ONE))throw Error("invZ was invalid");return{x:h,y:i}}),o=ji(a=>{if(a.is0()){if(c.allowInfinityPoint&&!d.is0(a.py))return;throw Error("bad point: ZERO")}let{x:b,y:e}=a.toAffine();if(!d.isValid(b)||!d.isValid(e))throw Error("bad point: x or y not FE");if(!i(b,e))throw Error("bad point: equation left != right");if(!a.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class p{constructor(a,b,c){if(null==a||!d.isValid(a))throw Error("x required");if(null==b||!d.isValid(b)||d.is0(b))throw Error("y required");if(null==c||!d.isValid(c))throw Error("z required");this.px=a,this.py=b,this.pz=c,Object.freeze(this)}static fromAffine(a){let{x:b,y:c}=a||{};if(!a||!d.isValid(b)||!d.isValid(c))throw Error("invalid affine point");if(a instanceof p)throw Error("projective point not allowed");let e=a=>d.eql(a,d.ZERO);return e(b)&&e(c)?p.ZERO:new p(b,c,d.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(a){let b=jx(d,a.map(a=>a.pz));return a.map((a,c)=>a.toAffine(b[c])).map(p.fromAffine)}static fromHex(a){let b=p.fromAffine(g(i9("pointHex",a)));return b.assertValidity(),b}static fromPrivateKey(a){return p.BASE.multiply(l(a))}static msm(a,b){return function(a,b,c,d){if(!Array.isArray(c))throw Error("array expected");c.forEach((b,c)=>{if(!(b instanceof a))throw Error("invalid point at index "+c)});if(!Array.isArray(d))throw Error("array of scalars expected");d.forEach((a,c)=>{if(!b.isValid(a))throw Error("invalid scalar at index "+c)});let e=c.length,f=d.length;if(e!==f)throw Error("arrays of points and scalars must have equal length");let g=a.ZERO,h=function(a){let b;for(b=0;a>iV;a>>=iW,b+=1);return b}(BigInt(e)),i=1;h>12?i=h-3:h>4?i=h-2:h>0&&(i=2);let j=je(i),k=Array(Number(j)+1).fill(g),l=Math.floor((b.BITS-1)/i)*i,m=g;for(let a=l;a>=0;a-=i){k.fill(g);for(let b=0;b<f;b++){let e=Number(d[b]>>BigInt(a)&j);k[e]=k[e].add(c[b])}let b=g;for(let a=k.length-1,c=g;a>0;a--)c=c.add(k[a]),b=b.add(c);if(m=m.add(b),0!==a)for(let a=0;a<i;a++)m=m.double()}return m}(p,e,a,b)}_setWindowSize(a){s.setWindowSize(this,a)}assertValidity(){o(this)}hasEvenY(){let{y:a}=this.toAffine();if(d.isOdd)return!d.isOdd(a);throw Error("Field doesn't support isOdd")}equals(a){m(a);let{px:b,py:c,pz:e}=this,{px:f,py:g,pz:h}=a,i=d.eql(d.mul(b,h),d.mul(f,e)),j=d.eql(d.mul(c,h),d.mul(g,e));return i&&j}negate(){return new p(this.px,d.neg(this.py),this.pz)}double(){let{a,b}=c,e=d.mul(b,jS),{px:f,py:g,pz:h}=this,i=d.ZERO,j=d.ZERO,k=d.ZERO,l=d.mul(f,f),m=d.mul(g,g),n=d.mul(h,h),o=d.mul(f,g);return o=d.add(o,o),k=d.mul(f,h),k=d.add(k,k),i=d.mul(a,k),j=d.mul(e,n),j=d.add(i,j),i=d.sub(m,j),j=d.add(m,j),j=d.mul(i,j),i=d.mul(o,i),k=d.mul(e,k),n=d.mul(a,n),o=d.sub(l,n),o=d.mul(a,o),o=d.add(o,k),k=d.add(l,l),l=d.add(k,l),l=d.add(l,n),l=d.mul(l,o),j=d.add(j,l),n=d.mul(g,h),n=d.add(n,n),l=d.mul(n,o),i=d.sub(i,l),k=d.mul(n,m),k=d.add(k,k),new p(i,j,k=d.add(k,k))}add(a){m(a);let{px:b,py:e,pz:f}=this,{px:g,py:h,pz:i}=a,j=d.ZERO,k=d.ZERO,l=d.ZERO,n=c.a,o=d.mul(c.b,jS),q=d.mul(b,g),r=d.mul(e,h),s=d.mul(f,i),t=d.add(b,e),u=d.add(g,h);t=d.mul(t,u),u=d.add(q,r),t=d.sub(t,u),u=d.add(b,f);let v=d.add(g,i);return u=d.mul(u,v),v=d.add(q,s),u=d.sub(u,v),v=d.add(e,f),j=d.add(h,i),v=d.mul(v,j),j=d.add(r,s),v=d.sub(v,j),l=d.mul(n,u),j=d.mul(o,s),l=d.add(j,l),j=d.sub(r,l),l=d.add(r,l),k=d.mul(j,l),r=d.add(q,q),r=d.add(r,q),s=d.mul(n,s),u=d.mul(o,u),r=d.add(r,s),s=d.sub(q,s),s=d.mul(n,s),u=d.add(u,s),q=d.mul(r,u),k=d.add(k,q),q=d.mul(v,u),j=d.mul(t,j),j=d.sub(j,q),q=d.mul(t,r),l=d.mul(v,l),new p(j,k,l=d.add(l,q))}subtract(a){return this.add(a.negate())}is0(){return this.equals(p.ZERO)}wNAF(a){return s.wNAFCached(this,a,p.normalizeZ)}multiplyUnsafe(a){let{endo:b,n:e}=c;jd("scalar",a,jP,e);let f=p.ZERO;if(a===jP)return f;if(this.is0()||a===jQ)return this;if(!b||s.hasPrecomputes(this))return s.wNAFCachedUnsafe(this,a,p.normalizeZ);let{k1neg:g,k1:h,k2neg:i,k2:j}=b.splitScalar(a),k=f,l=f,m=this;for(;h>jP||j>jP;)h&jQ&&(k=k.add(m)),j&jQ&&(l=l.add(m)),m=m.double(),h>>=jQ,j>>=jQ;return g&&(k=k.negate()),i&&(l=l.negate()),l=new p(d.mul(l.px,b.beta),l.py,l.pz),k.add(l)}multiply(a){let b,e,{endo:f,n:g}=c;if(jd("scalar",a,jQ,g),f){let{k1neg:c,k1:g,k2neg:h,k2:i}=f.splitScalar(a),{p:j,f:k}=this.wNAF(g),{p:l,f:m}=this.wNAF(i);j=s.constTimeNegate(c,j),l=s.constTimeNegate(h,l),l=new p(d.mul(l.px,f.beta),l.py,l.pz),b=j.add(l),e=k.add(m)}else{let{p:c,f:d}=this.wNAF(a);b=c,e=d}return p.normalizeZ([b,e])[0]}multiplyAndAddUnsafe(a,b,c){let d=p.BASE,e=(a,b)=>b!==jP&&b!==jQ&&a.equals(d)?a.multiply(b):a.multiplyUnsafe(b),f=e(this,b).add(e(a,c));return f.is0()?void 0:f}toAffine(a){return n(this,a)}isTorsionFree(){let{h:a,isTorsionFree:b}=c;if(a===jQ)return!0;if(b)return b(p,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:a,clearCofactor:b}=c;return a===jQ?this:b?b(p,this):this.multiplyUnsafe(c.h)}toRawBytes(a=!0){return iZ("isCompressed",a),this.assertValidity(),f(p,this,a)}toHex(a=!0){return iZ("isCompressed",a),i2(this.toRawBytes(a))}}p.BASE=new p(c.Gx,c.Gy,d.ONE),p.ZERO=new p(d.ZERO,d.ONE,d.ZERO);let{endo:q,nBitLength:r}=c,s=(b=q?Math.ceil(r/2):r,{constTimeNegate:jF,hasPrecomputes:a=>1!==jL(a),unsafeLadder(a,b,c=p.ZERO){let d=a;for(;b>jD;)b&jE&&(c=c.add(d)),d=d.double(),b>>=jE;return c},precomputeWindow(a,c){let{windows:d,windowSize:e}=jH(c,b),f=[],g=a,h=g;for(let a=0;a<d;a++){h=g,f.push(h);for(let a=1;a<e;a++)h=h.add(g),f.push(h);g=h.double()}return f},wNAF(a,c,d){let e=p.ZERO,f=p.BASE,g=jH(a,b);for(let a=0;a<g.windows;a++){let{nextN:b,offset:h,isZero:i,isNeg:j,isNegF:k,offsetF:l}=jI(d,a,g);d=b,i?f=f.add(jF(k,c[l])):e=e.add(jF(j,c[h]))}return{p:e,f}},wNAFUnsafe(a,c,d,e=p.ZERO){let f=jH(a,b);for(let a=0;a<f.windows&&d!==jD;a++){let{nextN:b,offset:g,isZero:h,isNeg:i}=jI(d,a,f);if(d=b,!h){let a=c[g];e=e.add(i?a.negate():a)}}return e},getPrecomputes(a,b,c){let d=jJ.get(b);return d||(d=this.precomputeWindow(b,a),1!==a&&jJ.set(b,c(d))),d},wNAFCached(a,b,c){let d=jL(a);return this.wNAF(d,this.getPrecomputes(d,a,c),b)},wNAFCachedUnsafe(a,b,c,d){let e=jL(a);return 1===e?this.unsafeLadder(a,b,d):this.wNAFUnsafe(e,this.getPrecomputes(e,a,c),b,d)},setWindowSize(a,c){jG(c,b),jK.set(a,c),jJ.delete(a)}});return{CURVE:c,ProjectivePoint:p,normPrivateKeyToScalar:l,weierstrassEquation:h,isWithinCurveOrder:function(a){return jc(a,jQ,c.n)}}}({...c,toBytes(a,b,c){let e=b.toAffine(),f=d.toBytes(e.x);return(iZ("isCompressed",c),c)?ja(Uint8Array.from([b.hasEvenY()?2:3]),f):ja(Uint8Array.from([4]),f,d.toBytes(e.y))},fromBytes(a){let b=a.length,c=a[0],e=a.subarray(1);if(b===h&&(2===c||3===c)){let a,b=i5(e);if(!jc(b,jQ,d.ORDER))throw Error("Point is not on curve");let f=m(b);try{a=d.sqrt(f)}catch(a){throw Error("Point is not on curve"+(a instanceof Error?": "+a.message:""))}return(1&c)==1!=((a&jQ)===jQ)&&(a=d.neg(a)),{x:b,y:a}}if(b===i&&4===c)return{x:d.fromBytes(e.subarray(0,d.BYTES)),y:d.fromBytes(e.subarray(d.BYTES,2*d.BYTES))};throw Error("invalid Point, expected length of "+h+", or uncompressed "+i+", got "+b)}}),o=(a,b,c)=>i5(a.slice(b,c));class p{constructor(a,b,c){jd("r",a,jQ,e),jd("s",b,jQ,e),this.r=a,this.s=b,null!=c&&(this.recovery=c),Object.freeze(this)}static fromCompact(a){return new p(o(a=i9("compactSignature",a,2*f),0,f),o(a,f,2*f))}static fromDER(a){let{r:b,s:c}=jO.toSig(i9("DER",a));return new p(b,c)}assertValidity(){}addRecoveryBit(a){return new p(this.r,this.s,a)}recoverPublicKey(a){let{r:b,s:f,recovery:g}=this,h=s(i9("msgHash",a));if(null==g||![0,1,2,3].includes(g))throw Error("recovery id invalid");let i=2===g||3===g?b+c.n:b;if(i>=d.ORDER)throw Error("recovery id 2 or 3 invalid");let l=(1&g)==0?"02":"03",m=k.fromHex(l+i2(i7(i,d.BYTES))),n=js(i,e),o=j(-h*n),p=j(f*n),q=k.BASE.multiplyAndAddUnsafe(m,o,p);if(!q)throw Error("point at infinify");return q.assertValidity(),q}hasHighS(){return this.s>e>>jQ}normalizeS(){return this.hasHighS()?new p(this.r,j(-this.s),this.recovery):this}toDERRawBytes(){return i4(this.toDERHex())}toDERHex(){return jO.hexFromSig(this)}toCompactRawBytes(){return i4(this.toCompactHex())}toCompactHex(){return i2(i7(this.r,f))+i2(i7(this.s,f))}}function q(a){if("bigint"==typeof a)return!1;if(a instanceof k)return!0;let b=i9("key",a).length,e=d.BYTES,g=e+1;if(!c.allowedPrivateKeyLengths&&f!==g)return b===g||b===2*e+1}let r=c.bits2int||function(a){if(a.length>8192)throw Error("input is too large");let b=i5(a),c=8*a.length-g;return c>0?b>>BigInt(c):b},s=c.bits2int_modN||function(a){return j(r(a))},t=je(g);function u(a){return jd("num < 2^"+g,a,jP,t),i7(a,f)}let v={lowS:c.lowS,prehash:!1},w={lowS:c.lowS,prehash:!1};return k.BASE._setWindowSize(8),{CURVE:c,getPublicKey:function(a,b=!0){return k.fromPrivateKey(a).toRawBytes(b)},getSharedSecret:function(a,b,c=!0){if(!0===q(a))throw Error("first arg must be private key");if(!1===q(b))throw Error("second arg must be public key");return k.fromHex(b).multiply(l(a)).toRawBytes(c)},sign:function(a,b,f=v){let{seed:g,k2sig:h}=function(a,b,f=v){if(["recovered","canonical"].some(a=>a in f))throw Error("sign() legacy options not supported");let{hash:g,randomBytes:h}=c,{lowS:i,prehash:m,extraEntropy:o}=f;null==i&&(i=!0),a=i9("msgHash",a),jN(f),m&&(a=i9("prehashed msgHash",g(a)));let q=s(a),t=l(b),w=[u(t),u(q)];if(null!=o&&!1!==o){let a=!0===o?h(d.BYTES):o;w.push(i9("extraEntropy",a))}return{seed:ja(...w),k2sig:function(a){var b;let c=r(a);if(!n(c))return;let d=js(c,e),f=k.BASE.multiply(c).toAffine(),g=j(f.x);if(g===jP)return;let h=j(d*j(q+g*t));if(h===jP)return;let l=2*(f.x!==g)|Number(f.y&jQ),m=h;return i&&h>e>>jQ&&(m=(b=h)>e>>jQ?j(-b):b,l^=1),new p(g,m,l)}}}(a,b,f);return(function(a,b,c){if("number"!=typeof a||a<2)throw Error("hashLen must be a number");if("number"!=typeof b||b<2)throw Error("qByteLen must be a number");if("function"!=typeof c)throw Error("hmacFn must be a function");let d=jf(a),e=jf(a),f=0,g=()=>{d.fill(1),e.fill(0),f=0},h=(...a)=>c(e,d,...a),i=(a=jf(0))=>{let b;if(e=h((b=[0],Uint8Array.from(b)),a),d=h(),0!==a.length){let b;e=h((b=[1],Uint8Array.from(b)),a),d=h()}},j=()=>{if(f++>=1e3)throw Error("drbg: tried 1000 values");let a=0,c=[];for(;a<b;){let b=(d=h()).slice();c.push(b),a+=d.length}return ja(...c)};return(a,b)=>{let c;for(g(),i(a);!(c=b(j()));)i();return g(),c}})(c.hash.outputLen,c.nByteLength,c.hmac)(g,h)},verify:function(a,b,d,f=w){let g,h;b=i9("msgHash",b),d=i9("publicKey",d);let{lowS:i,prehash:l,format:m}=f;if(jN(f),"strict"in f)throw Error("options.strict was renamed to lowS");if(void 0!==m&&"compact"!==m&&"der"!==m)throw Error("format must be compact or der");let n="string"==typeof a||iX(a),o=!n&&!m&&"object"==typeof a&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!n&&!o)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(o&&(h=new p(a.r,a.s)),n){try{"compact"!==m&&(h=p.fromDER(a))}catch(a){if(!(a instanceof jO.Err))throw a}h||"der"===m||(h=p.fromCompact(a))}g=k.fromHex(d)}catch(a){return!1}if(!h||i&&h.hasHighS())return!1;l&&(b=c.hash(b));let{r:q,s:r}=h,t=s(b),u=js(r,e),v=j(t*u),x=j(q*u),y=k.BASE.multiplyAndAddUnsafe(g,v,x)?.toAffine();return!!y&&j(y.x)===q},ProjectivePoint:k,Signature:p,utils:{isValidPrivateKey(a){try{return l(a),!0}catch(a){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{let a=jC(c.n);return function(a,b,c=!1){let d=a.length,e=jB(b),f=jC(b);if(d<16||d<f||d>1024)throw Error("expected "+f+"-1024 bytes of input, got "+d);let g=jq(c?i6(a):i5(a),b-jk)+jk;return c?i8(g,e):i7(g,e)}(c.randomBytes(a),c.n)},precompute:(a=8,b=k.BASE)=>(b._setWindowSize(a),b.multiply(BigInt(3)),b)}}})({...DO,...{hash:a,hmac:(b,...c)=>(0,iU.hmac)(a,b,(0,dK.concatBytes)(...c)),randomBytes:dK.randomBytes}}))(DP),create:J});j_.ProjectivePoint;let j0=(K=[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(a=>a.map(a=>BigInt(a))).map(a=>Array.from(a).reverse()),(a,b)=>{let[c,d,e,f]=K.map(b=>b.reduce((b,c)=>j$.add(j$.mul(b,a),c))),[g,h]=jx(j$,[d,f],!0);return a=j$.mul(c,g),b=j$.mul(b,j$.mul(e,h)),{x:a,y:b}}),j1=function(a,b){if(jw(a),!a.isValid(b.A)||!a.isValid(b.B)||!a.isValid(b.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let c=function(a,b){let c=a.ORDER,d=jP;for(let a=c-jQ;a%jR===jP;a/=jR)d+=jQ;let e=d,f=jR<<e-jQ-jQ,g=f*jR,h=(c-jQ)/g,i=(h-jQ)/jR,j=g-jQ,k=a.pow(b,h),l=a.pow(b,(h+jQ)/jR),m=(b,c)=>{let d=k,g=a.pow(c,j),h=a.sqr(g);h=a.mul(h,c);let m=a.mul(b,h);m=a.pow(m,i),m=a.mul(m,g),g=a.mul(m,c),h=a.mul(m,b);let n=a.mul(h,g);m=a.pow(n,f);let o=a.eql(m,a.ONE);g=a.mul(h,l),m=a.mul(n,d),h=a.cmov(g,h,o),n=a.cmov(m,n,o);for(let b=e;b>jQ;b--){let c=b-jR;c=jR<<c-jQ;let e=a.pow(n,c),f=a.eql(e,a.ONE);g=a.mul(h,d),d=a.mul(d,d),e=a.mul(n,d),h=a.cmov(g,h,f),n=a.cmov(e,n,f)}return{isValid:o,value:h}};if(a.ORDER%jT===jS){let c=(a.ORDER-jS)/jT,d=a.sqrt(a.neg(b));m=(b,e)=>{let f=a.sqr(e),g=a.mul(b,e);f=a.mul(f,g);let h=a.pow(f,c);h=a.mul(h,g);let i=a.mul(h,d),j=a.mul(a.sqr(h),e),k=a.eql(j,b),l=a.cmov(i,h,k);return{isValid:k,value:l}}}return m}(a,b.Z);if(!a.isOdd)throw Error("Fp.isOdd is not implemented!");return d=>{let e,f,g,h,i,j,k,l;e=a.sqr(d),e=a.mul(e,b.Z),f=a.sqr(e),f=a.add(f,e),g=a.add(f,a.ONE),g=a.mul(g,b.B),h=a.cmov(b.Z,a.neg(f),!a.eql(f,a.ZERO)),h=a.mul(h,b.A),f=a.sqr(g),j=a.sqr(h),i=a.mul(j,b.A),f=a.add(f,i),f=a.mul(f,g),j=a.mul(j,h),i=a.mul(j,b.B),f=a.add(f,i),k=a.mul(e,g);let{isValid:m,value:n}=c(f,j);l=a.mul(e,d),l=a.mul(l,n),k=a.cmov(k,g,m),l=a.cmov(l,n,m);let o=a.isOdd(d)===a.isOdd(l);l=a.cmov(a.neg(l),l,o);let p=jx(a,[h],!0)[0];return{x:k=a.mul(k,p),y:l}}}(j$,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:j$.create(BigInt("-11"))});!function(a,b,c){if("function"!=typeof b)throw Error("mapToCurve() must be defined")}(j_.ProjectivePoint,a=>{let{x:b,y:c}=j1(j$.create(a[0]));return j0(b,c)},(j$.ORDER,iT.sha256));class j2 extends Error{constructor(a,b={}){const c=(()=>{if(b.cause instanceof j2){if(b.cause.details)return b.cause.details;if(b.cause.shortMessage)return b.cause.shortMessage}return b.cause&&"details"in b.cause&&"string"==typeof b.cause.details?b.cause.details:b.cause?.message?b.cause.message:b.details})(),d=b.cause instanceof j2&&b.cause.docsPath||b.docsPath,e=`https://oxlib.sh${d??""}`;super([a||"An error occurred.",...b.metaMessages?["",...b.metaMessages]:[],...c||d?["",c?`Details: ${c}`:void 0,d?`See: ${e}`:void 0]:[]].filter(a=>"string"==typeof a).join("\n"),b.cause?{cause:b.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"ox@0.1.1"}),this.cause=b.cause,this.details=c,this.docs=e,this.docsPath=d,this.shortMessage=a}walk(a){return function a(b,c){return c?.(b)?b:b&&"object"==typeof b&&"cause"in b&&b.cause?a(b.cause,c):c?null:b}(this,a)}}function j3(a,b){if(kd(a)>b)throw new ki({givenSize:kd(a),maxSize:b})}function j4(a,b={}){let{dir:c,size:d=32}=b;if(0===d)return a;let e=a.replace("0x","");if(e.length>2*d)throw new kk({size:Math.ceil(e.length/2),targetSize:d,type:"Hex"});return`0x${e["right"===c?"padEnd":"padStart"](2*d,"0")}`}function j5(a,b,c){return JSON.stringify(a,(a,c)=>"function"==typeof b?b(a,c):"bigint"==typeof c?c.toString()+"#__bigint":c,c)}let j6=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function j7(...a){return`0x${a.reduce((a,b)=>a+b.replace("0x",""),"")}`}function j8(a){return a instanceof Uint8Array?j9(a):Array.isArray(a)?j9(new Uint8Array(a)):a}function j9(a,b={}){let c="";for(let b=0;b<a.length;b++)c+=j6[a[b]];let d=`0x${c}`;return"number"==typeof b.size?(j3(d,b.size),kb(d,b.size)):d}function ka(a,b={}){var c;let d,{signed:e,size:f}=b,g=BigInt(a);f?d=e?(1n<<8n*BigInt(f)-1n)-1n:2n**(8n*BigInt(f))-1n:"number"==typeof a&&(d=BigInt(Number.MAX_SAFE_INTEGER));let h="bigint"==typeof d&&e?-d-1n:0;if(d&&g>d||g<h){let b="bigint"==typeof a?"n":"";throw new kf({max:d?`${d}${b}`:void 0,min:`${h}${b}`,signed:e,size:f,value:`${a}${b}`})}let i=(e&&g<0?(1n<<BigInt(8*f))+BigInt(g):g).toString(16),j=`0x${i}`;return f?(c=j,j4(c,{dir:"left",size:f})):j}function kb(a,b){return j4(a,{dir:"right",size:b})}function kc(a,b,c,d={}){let{strict:e}=d;if("number"==typeof b&&b>0&&b>kd(a)-1)throw new kj({offset:b,position:"start",size:kd(a)});let f=`0x${a.replace("0x","").slice((b??0)*2,(c??a.length)*2)}`;return e&&function(a,b,c){if("number"==typeof b&&"number"==typeof c&&kd(a)!==c-b)throw new kj({offset:c,position:"end",size:kd(a)})}(f,b,c),f}function kd(a){return Math.ceil((a.length-2)/2)}function ke(a){return function(a,b={}){let{dir:c="left"}=b,d=a.replace("0x",""),e=0;for(let a=0;a<d.length-1;a++)if("0"===d["left"===c?a:d.length-a-1].toString())e++;else break;return"0"===(d="left"===c?d.slice(e):d.slice(0,d.length-e))?"0x":"right"===c&&d.length%2==1?`0x${d}0`:`0x${d}`}(a,{dir:"left"})}class kf extends j2{constructor({max:a,min:b,signed:c,size:d,value:e}){super(`Number \`${e}\` is not in safe${d?` ${8*d}-bit`:""}${c?" signed":" unsigned"} integer range ${a?`(\`${b}\` to \`${a}\`)`:`(above \`${b}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class kg extends j2{constructor(a){super(`Value \`${"object"==typeof a?j5(a):a}\` of type \`${typeof a}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class kh extends j2{constructor(a){super(`Value \`${a}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}class ki extends j2{constructor({givenSize:a,maxSize:b}){super(`Size cannot exceed \`${b}\` bytes. Given size: \`${a}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class kj extends j2{constructor({offset:a,position:b,size:c}){super(`Slice ${"start"===b?"starting":"ending"} at offset \`${a}\` is out-of-bounds (size: \`${c}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}class kk extends j2{constructor({size:a,targetSize:b,type:c}){super(`${c.charAt(0).toUpperCase()}${c.slice(1).toLowerCase()} size (\`${a}\`) exceeds padding size (\`${b}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}function kl(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:void 0}let km=new TextEncoder;function kn(a){var b;return a instanceof Uint8Array?a:"string"==typeof a?ko(a):(b=a)instanceof Uint8Array?b:new Uint8Array(b)}function ko(a,b={}){let{size:c}=b,d=a;c&&(j3(a,c),d=kb(a,c));let e=d.slice(2);e.length%2&&(e=`0${e}`);let f=e.length/2,g=new Uint8Array(f);for(let a=0,b=0;a<f;a++){let c=kl(e.charCodeAt(b++)),d=kl(e.charCodeAt(b++));if(void 0===c||void 0===d)throw new j2(`Invalid byte sequence ("${e[b-2]}${e[b-1]}" in "${e}").`);g[a]=16*c+d}return g}class kp extends j2{constructor(a){super(`Value \`${"object"==typeof a?j5(a):a}\` of type \`${typeof a}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class kq extends j2{constructor({givenSize:a,maxSize:b}){super(`Size cannot exceed \`${b}\` bytes. Given size: \`${a}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class kr extends j2{constructor({size:a,targetSize:b,type:c}){super(`${c.charAt(0).toUpperCase()}${c.slice(1).toLowerCase()} size (\`${a}\`) exceeds padding size (\`${b}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}let ks=2n**256n-1n;function kt(a,b={}){let{recovered:c}=b;if(void 0===a.r||void 0===a.s||c&&void 0===a.yParity)throw new kO({signature:a});if(a.r<0n||a.r>ks)throw new kP({value:a.r});if(a.s<0n||a.s>ks)throw new kQ({value:a.s});if("number"==typeof a.yParity&&0!==a.yParity&&1!==a.yParity)throw new kR({value:a.yParity})}function ku(a){return kv(j9(a))}function kv(a){if(130!==a.length&&132!==a.length)throw new kN({signature:a});let b=BigInt(kc(a,0,32)),c=BigInt(kc(a,32,64)),d=(()=>{let b=Number(`0x${a.slice(130)}`);if(!Number.isNaN(b))try{return kL(b)}catch{throw new kR({value:b})}})();return void 0===d?{r:b,s:c}:{r:b,s:c,yParity:d}}function kw(a){if(void 0!==a.r&&void 0!==a.s)return kx(a)}function kx(a){let b="string"==typeof a?kv(a):a instanceof Uint8Array?ku(a):"string"==typeof a.r?kB(a):a.v?kA(a):{r:a.r,s:a.s,...void 0!==a.yParity?{yParity:a.yParity}:{}};return kt(b),b}function ky(a){return kz(j9(a))}function kz(a){let{r:b,s:c}=j_.Signature.fromDER(j8(a).slice(2));return{r:b,s:c}}function kA(a){return{r:a.r,s:a.s,yParity:kL(a.v)}}function kB(a){let b=(()=>{let b=a.v?Number(a.v):void 0,c=a.yParity?Number(a.yParity):void 0;if("number"==typeof b&&"number"!=typeof c&&(c=kL(b)),"number"!=typeof c)throw new kR({value:a.yParity});return c})();return{r:BigInt(a.r),s:BigInt(a.s),yParity:b}}function kC(a){let[b,c,d]=a;return kx({r:"0x"===c?0n:BigInt(c),s:"0x"===d?0n:BigInt(d),yParity:"0x"===b?0:Number(b)})}function kD(a){return ko(kE(a))}function kE(a){kt(a);let b=a.r,c=a.s;return j7(ka(b,{size:32}),ka(c,{size:32}),"number"==typeof a.yParity?ka(kM(a.yParity),{size:1}):"0x")}function kF(a){return new j_.Signature(a.r,a.s).toDERRawBytes()}function kG(a){let b=new j_.Signature(a.r,a.s);return`0x${b.toDERHex()}`}function kH(a){return{r:a.r,s:a.s,v:kM(a.yParity)}}function kI(a){let{r:b,s:c,yParity:d}=a;return{r:ka(b,{size:32}),s:ka(c,{size:32}),yParity:0===d?"0x0":"0x1"}}function kJ(a){let{r:b,s:c,yParity:d}=a;return[d?"0x01":"0x",0n===b?"0x":ke(ka(b)),0n===c?"0x":ke(ka(c))]}function kK(a,b={}){try{return kt(a,b),!0}catch{return!1}}function kL(a){if(0===a||27===a)return 0;if(1===a||28===a)return 1;if(a>=35)return+(a%2==0);throw new kS({value:a})}function kM(a){if(0===a)return 27;if(1===a)return 28;throw new kR({value:a})}class kN extends j2{constructor({signature:a}){super(`Value \`${a}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${kd(j8(a))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class kO extends j2{constructor({signature:a}){super(`Signature \`${j5(a)}\` is missing either an \`r\`, \`s\`, or \`yParity\` property.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.MissingPropertiesError"})}}class kP extends j2{constructor({value:a}){super(`Value \`${a}\` is an invalid r value. r must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidRError"})}}class kQ extends j2{constructor({value:a}){super(`Value \`${a}\` is an invalid s value. s must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSError"})}}class kR extends j2{constructor({value:a}){super(`Value \`${a}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class kS extends j2{constructor({value:a}){super(`Value \`${a}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}a.s(["InvalidRError",()=>kP,"InvalidSError",()=>kQ,"InvalidSerializedSizeError",()=>kN,"InvalidVError",()=>kS,"InvalidYParityError",()=>kR,"MissingPropertiesError",()=>kO,"assert",()=>kt,"extract",()=>kw,"from",()=>kx,"fromBytes",()=>ku,"fromDerBytes",()=>ky,"fromDerHex",()=>kz,"fromHex",()=>kv,"fromLegacy",()=>kA,"fromRpc",()=>kB,"fromTuple",()=>kC,"toBytes",()=>kD,"toDerBytes",()=>kF,"toDerHex",()=>kG,"toHex",()=>kE,"toLegacy",()=>kH,"toRpc",()=>kI,"toTuple",()=>kJ,"vToYParity",()=>kL,"validate",()=>kK,"yParityToV",()=>kM],934671);var kT=a.i(934671),kT=kT;class kU extends Map{constructor(a){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=a}get(a){let b=super.get(a);return super.has(a)&&void 0!==b&&(this.delete(a),super.set(a,b)),b}set(a,b){if(super.set(a,b),this.maxSize&&this.size>this.maxSize){let a=this.keys().next().value;a&&this.delete(a)}return this}}let kV={checksum:new kU(8192)}.checksum;var kW=a.i(993953);function kX(a,b={}){let{as:c="string"==typeof a?"Hex":"Bytes"}=b,d=(0,kW.keccak_256)(kn(a));return"Bytes"===c?d:j9(d)}function kY(a,b={}){let{compressed:c}=b,{prefix:d,x:e,y:f}=a;if(!1===c||"bigint"==typeof e&&"bigint"==typeof f){if(4!==d)throw new k1({prefix:d,cause:new k3});return}if(!0===c||"bigint"==typeof e&&void 0===f){if(3!==d&&2!==d)throw new k1({prefix:d,cause:new k2});return}throw new k0({publicKey:a})}function kZ(a){let b=(()=>{if(function(a,b={}){let{strict:c=!1}=b;try{return!function(a,b={}){let{strict:c=!1}=b;if(!a||"string"!=typeof a)throw new kg(a);if(c&&!/^0x[0-9a-fA-F]*$/.test(a)||!a.startsWith("0x"))throw new kh(a)}(a,{strict:c}),!0}catch{return!1}}(a))return k$(a);if(function(a){try{if(!(a instanceof Uint8Array)&&(!a||"object"!=typeof a||!("BYTES_PER_ELEMENT"in a)||1!==a.BYTES_PER_ELEMENT||"Uint8Array"!==a.constructor.name))throw new kp(a);return!0}catch{return!1}}(a))return k$(j9(a));let{prefix:b,x:c,y:d}=a;return"bigint"==typeof c&&"bigint"==typeof d?{prefix:b??4,x:c,y:d}:{prefix:b,x:c}})();return kY(b),b}function k$(a){if(132!==a.length&&130!==a.length&&68!==a.length)throw new k4({publicKey:a});if(130===a.length)return{prefix:4,x:BigInt(kc(a,0,32)),y:BigInt(kc(a,32,64))};if(132===a.length){let b=Number(kc(a,0,1));return{prefix:b,x:BigInt(kc(a,1,33)),y:BigInt(kc(a,33,65))}}return{prefix:Number(kc(a,0,1)),x:BigInt(kc(a,1,33))}}function k_(a,b={}){kY(a);let{prefix:c,x:d,y:e}=a,{includePrefix:f=!0}=b;return j7(f?ka(c,{size:1}):"0x",ka(d,{size:32}),"bigint"==typeof e?ka(e,{size:32}):"0x")}class k0 extends j2{constructor({publicKey:a}){super(`Value \`${j5(a)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class k1 extends j2{constructor({prefix:a,cause:b}){super(`Prefix "${a}" is invalid.`,{cause:b}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class k2 extends j2{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class k3 extends j2{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}class k4 extends j2{constructor({publicKey:a}){super(`Value \`${a}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${kd(j8(a))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}}let k5=/^0x[a-fA-F0-9]{40}$/;function k6(a,b={}){let{strict:c=!0}=b;if(!k5.test(a))throw new k8({address:a,cause:new k9});if(c){if(a.toLowerCase()===a)return;if(k7(a)!==a)throw new k8({address:a,cause:new la})}}function k7(a){if(kV.has(a))return kV.get(a);k6(a,{strict:!1});let b=a.substring(2).toLowerCase(),c=kX(function(a,b={}){let{size:c}=b,d=km.encode(a);if("number"==typeof c){var e;if(d.length>c)throw new kq({givenSize:d.length,maxSize:c});return e=d,function(a,b={}){let{dir:c,size:d=32}=b;if(0===d)return a;if(a.length>d)throw new kr({size:a.length,targetSize:d,type:"Bytes"});let e=new Uint8Array(d);for(let b=0;b<d;b++){let f="right"===c;e[f?b:d-b-1]=a[f?b:a.length-b-1]}return e}(e,{dir:"right",size:c})}return d}(b),{as:"Bytes"}),d=b.split("");for(let a=0;a<40;a+=2)c[a>>1]>>4>=8&&d[a]&&(d[a]=d[a].toUpperCase()),(15&c[a>>1])>=8&&d[a+1]&&(d[a+1]=d[a+1].toUpperCase());let e=`0x${d.join("")}`;return kV.set(a,e),e}class k8 extends j2{constructor({address:a,cause:b}){super(`Address "${a}" is invalid.`,{cause:b}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class k9 extends j2{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class la extends j2{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}function lb(a={}){let{as:b="Hex"}=a,c=le({as:b}),d=lc({privateKey:c});return{privateKey:c,publicKey:d}}function lc(a){let{privateKey:b}=a;return kZ(j_.ProjectivePoint.fromPrivateKey(j8(b).slice(2)))}function ld(a){let{as:b="Hex",privateKey:c,publicKey:d}=a,e=j_.ProjectivePoint.fromHex(k_(d).slice(2)).multiply(j_.utils.normPrivateKeyToScalar(j8(c).slice(2))).toRawBytes(!0);return"Hex"===b?j9(e):e}function le(a={}){let{as:b="Hex"}=a,c=j_.utils.randomPrivateKey();return"Hex"===b?j9(c):c}function lf(a){return function(a,b={}){let c=kX(`0x${k_(a).slice(4)}`).substring(26);return function(a,b={}){let{checksum:c=!1}=b;return(k6(a),c)?k7(a):a}(`0x${c}`,b)}(lg(a))}function lg(a){let{payload:b,signature:c}=a,{r:d,s:e,yParity:f}=c;return kZ(new j_.Signature(BigInt(d),BigInt(e)).addRecoveryBit(f).recoverPublicKey(j8(b).substring(2)))}function lh(a){let{extraEntropy:b=!1,hash:c,payload:d,privateKey:e}=a,{r:f,s:g,recovery:h}=j_.sign(kn(d),kn(e),{extraEntropy:"boolean"==typeof b?b:j8(b).slice(2),lowS:!0,...c?{prehash:!0}:{}});return{r:f,s:g,yParity:h}}function li(a){let{address:b,hash:c,payload:d,publicKey:e,signature:f}=a;if(b){var g;return g=lf({payload:d,signature:f}),k6(b,{strict:!1}),k6(g,{strict:!1}),b.toLowerCase()===g.toLowerCase()}return j_.verify(f,kn(d),function(a,b={}){return ko(k_(a,b))}(e),...c?[{prehash:!0,lowS:!0}]:[])}a.s(["createKeyPair",()=>lb,"getPublicKey",()=>lc,"getSharedSecret",()=>ld,"noble",0,j_,"randomPrivateKey",()=>le,"recoverAddress",()=>lf,"recoverPublicKey",()=>lg,"sign",()=>lh,"verify",()=>li],5494);var lj=a.i(5494),lj=lj,lk=a.i(130934),ll=a.i(165782),lm=a.i(934008),ln=a.i(832819);a.i(78125);var lo=a.i(282800),lp=a.i(864671),lq=a.i(60611),lr=a.i(73915),ls=a.i(572696),lt=a.i(247181),lu=a.i(920275),lv=Object.defineProperty,lw=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?lv(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class lx{constructor(a){lw(this,"nodeValue"),lw(this,"sizeInBytes"),lw(this,"next"),this.nodeValue=a,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class ly{constructor(a){lw(this,"lengthInNodes"),lw(this,"sizeInBytes"),lw(this,"head"),lw(this,"tail"),lw(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=a,this.sizeInBytes=0}append(a){let b=new lx(a);if(b.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${a} with size ${b.size}`);for(;this.size+b.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=b):this.head=b,this.tail=b,this.lengthInNodes++,this.sizeInBytes+=b.size}shift(){if(!this.head)return;let a=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=a.size}toArray(){let a=[],b=this.head;for(;null!==b;)a.push(b.value),b=b.next;return a}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let a=this.head;return{next:()=>{if(!a)return{done:!0,value:null};let b=a.value;return a=a.next,{done:!1,value:b}}}}}var lz=Object.defineProperty,lA=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?lz(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class lB{constructor(a,b=1024e3){lA(this,"logs"),lA(this,"level"),lA(this,"levelValue"),lA(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=a??"error",this.levelValue=lt.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=b,this.logs=new ly(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(a,b){b===lt.levels.values.error?console.error(a):b===lt.levels.values.warn?console.warn(a):b===lt.levels.values.debug?console.debug(a):b===lt.levels.values.trace?console.trace(a):console.log(a)}appendToLogs(a){this.logs.append((0,lu.safeJsonStringify)({timestamp:new Date().toISOString(),log:a}));let b="string"==typeof a?JSON.parse(a).level:a.level;b>=this.levelValue&&this.forwardToConsole(a,b)}getLogs(){return this.logs}clearLogs(){this.logs=new ly(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(a){let b=this.getLogArray();return b.push((0,lu.safeJsonStringify)({extraMetadata:a})),new Blob(b,{type:"application/json"})}}var lC=Object.defineProperty;class lD{constructor(a,b=1024e3){((a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?lC(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c})(this,"baseChunkLogger"),this.baseChunkLogger=new lB(a,b)}write(a){this.baseChunkLogger.appendToLogs(a)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(a){return this.baseChunkLogger.logsToBlob(a)}}var lE=Object.defineProperty,lF=Object.defineProperties,lG=Object.getOwnPropertyDescriptors,lH=Object.getOwnPropertySymbols,lI=Object.prototype.hasOwnProperty,lJ=Object.prototype.propertyIsEnumerable,lK=(a,b,c)=>b in a?lE(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c;function lL(a){let[b,c]=a.split(":");return{namespace:b,reference:c}}function lM(a,b=[]){let c=[];return Object.keys(a).forEach(d=>{if(b.length&&!b.includes(d))return;let e=a[d];c.push(...e.accounts)}),c}function lN(a,b){return a.includes(":")?[a]:b.chains||[]}var lO=Object.defineProperty,lP=Object.defineProperties,lQ=Object.getOwnPropertyDescriptors,lR=Object.getOwnPropertySymbols,lS=Object.prototype.hasOwnProperty,lT=Object.prototype.propertyIsEnumerable,lU=(a,b,c)=>b in a?lO(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,lV=(a,b)=>{for(var c in b||(b={}))lS.call(b,c)&&lU(a,c,b[c]);if(lR)for(var c of lR(b))lT.call(b,c)&&lU(a,c,b[c]);return a},lW=(a,b,c)=>lU(a,"symbol"!=typeof b?b+"":b,c);let lX="react-native",lY="node",lZ="browser";function l$(){return"u">typeof process&&"u">typeof process.versions&&"u">typeof process.versions.node}function l_(){return!(0,iR.getDocument)()&&!!(0,iR.getNavigator)()&&"ReactNative"===navigator.product}function l0(){return!l$()&&!!(0,iR.getNavigator)()&&!!(0,iR.getDocument)()}function l1(){return l_()?lX:l$()?lY:l0()?lZ:"unknown"}function l2(){var b;try{return l_()&&"u">typeof(null==a.g?void 0:a.g.Application)?null==(b=a.g.Application)?void 0:b.applicationId:void 0}catch{return}}function l3(){return(0,iS.getWindowMetadata)()||{name:"",description:"",url:"",icons:[""]}}function l4(b,c,d){var e;let f,g=function(){if(l1()===lX&&"u">typeof(null==a.g?void 0:a.g.Platform)){let{OS:b,Version:c}=a.g.Platform;return[b,c].join("-")}let b=(0,iP.detect)();if(null===b)return"unknown";let c=b.os?b.os.replace(" ","").toLowerCase():"unknown";return"browser"===b.type?[c,b.name,b.version].join("-"):[c,b.version].join("-")}(),h=(f=l1())===lZ?[f,(null==(e=(0,iR.getLocation)())?void 0:e.host)||"unknown"].join(":"):f;return[[b,c].join("-"),["js",d].join("-"),g,h].join("/")}function l5(a,b){return a.filter(a=>b.includes(a)).length===a.length}function l6(a){return Object.fromEntries(a.entries())}function l7(a){return new Map(Object.entries(a))}function l8(a=iQ.FIVE_MINUTES,b){let c,d,e,f,g=(0,iQ.toMiliseconds)(a||iQ.FIVE_MINUTES);return{resolve:a=>{e&&c&&(clearTimeout(e),c(a),f=Promise.resolve(a))},reject:a=>{e&&d&&(clearTimeout(e),d(a))},done:()=>new Promise((a,h)=>{if(f)return a(f);e=setTimeout(()=>{let a=Error(b);f=Promise.reject(a),h(a)},g),c=a,d=h})}}function l9(a,b,c){return new Promise(async(d,e)=>{let f=setTimeout(()=>e(Error(c)),b);try{let b=await a;d(b)}catch(a){e(a)}clearTimeout(f)})}function ma(a,b){if("string"==typeof b&&b.startsWith(`${a}:`))return b;if("topic"===a.toLowerCase()){if("string"!=typeof b)throw Error('Value must be "string" for expirer target type: topic');return`topic:${b}`}if("id"===a.toLowerCase()){if("number"!=typeof b)throw Error('Value must be "number" for expirer target type: id');return`id:${b}`}throw Error(`Unknown expirer target type: ${a}`)}function mb(a){let[b,c]=a.split(":"),d={id:void 0,topic:void 0};if("topic"===b&&"string"==typeof c)d.topic=c;else if("id"===b&&Number.isInteger(Number(c)))d.id=Number(c);else throw Error(`Invalid target, expected id:number or topic:string, got ${b}:${c}`);return d}function mc(a,b){return(0,iQ.fromMiliseconds)((b||Date.now())+(0,iQ.toMiliseconds)(a))}function md(a){return Date.now()>=(0,iQ.toMiliseconds)(a)}function me(a,b){return`${a}${b?`:${b}`:""}`}function mf(a=[],b=[]){return[...new Set([...a,...b])]}async function mg({id:b,topic:c,wcDeepLink:d}){var e,f;try{if(!d)return;let g="string"==typeof d?JSON.parse(d):d,h=g?.href;if("string"!=typeof h)return;let i=function(a,b,c){let d=`requestId=${b}&sessionTopic=${c}`;a.endsWith("/")&&(a=a.slice(0,-1));let e=`${a}`;if(a.startsWith("https://t.me")){let b=a.includes("?")?"&startapp=":"?startapp=";e=`${e}${b}${function(a,b=!1){let c=Buffer.from(a).toString("base64");return b?c.replace(/[=]/g,""):c}(d,!0)}`}else e=`${e}/wc?${d}`;return e}(h,b,c),j=l1();if(j===lZ){let a;if(!(null!=(e=(0,iR.getDocument)())&&e.hasFocus()))return void console.warn("Document does not have focus, skipping deeplink.");f=i,a="_self",!function(){try{return window.self!==window.top}catch{return!1}}()?(f.startsWith("https://")||f.startsWith("http://"))&&(a="_blank"):a="_top",window.open(f,a,"noreferrer noopener")}else j===lX&&"u">typeof(null==a.g?void 0:a.g.Linking)&&await a.g.Linking.openURL(i)}catch(a){console.error(a)}}async function mh(a,b){let c="";try{if(l0()&&(c=localStorage.getItem(b)))return c;c=await a.getItem(b)}catch(a){console.error(a)}return c}function mi(a,b){if(!a.includes(b))return null;let c=a.split(/([&,?,=])/),d=c.indexOf(b);return c[d+2]}function mj(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,a=>{let b=16*Math.random()|0;return("x"===a?b:3&b|8).toString(16)})}function mk(){return"u">typeof process&&"true"===process.env.IS_VITEST}function ml(a){return Buffer.from(a,"base64").toString("utf-8")}class mm{constructor({limit:a}){lW(this,"limit"),lW(this,"set"),this.limit=a,this.set=new Set}add(a){if(!this.set.has(a)){if(this.set.size>=this.limit){let a=this.set.values().next().value;a&&this.set.delete(a)}this.set.add(a)}}has(a){return this.set.has(a)}}let mn=BigInt(0x100000000-1),mo=BigInt(32);function mp(a,b=!1){return b?{h:Number(a&mn),l:Number(a>>mo&mn)}:{h:0|Number(a>>mo&mn),l:0|Number(a&mn)}}function mq(a,b=!1){let c=a.length,d=new Uint32Array(c),e=new Uint32Array(c);for(let f=0;f<c;f++){let{h:c,l:g}=mp(a[f],b);[d[f],e[f]]=[c,g]}return[d,e]}let mr=(a,b,c)=>a>>>c,ms=(a,b,c)=>a<<32-c|b>>>c,mt=(a,b,c)=>a>>>c|b<<32-c,mu=(a,b,c)=>a<<32-c|b>>>c,mv=(a,b,c)=>a<<64-c|b>>>c-32,mw=(a,b,c)=>a>>>c-32|b<<64-c;function mx(a,b,c,d){let e=(b>>>0)+(d>>>0);return{h:a+c+(e/0x100000000|0)|0,l:0|e}}let my=(a,b,c)=>(a>>>0)+(b>>>0)+(c>>>0),mz=(a,b,c,d)=>b+c+d+(a/0x100000000|0)|0,mA=(a,b,c,d)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0),mB=(a,b,c,d,e)=>b+c+d+e+(a/0x100000000|0)|0,mC=(a,b,c,d,e)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0)+(e>>>0),mD=(a,b,c,d,e,f)=>b+c+d+e+f+(a/0x100000000|0)|0,mE="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function mF(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function mG(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function mH(a,...b){if(!mF(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function mI(a){if("function"!=typeof a||"function"!=typeof a.create)throw Error("Hash should be wrapped by utils.createHasher");mG(a.outputLen),mG(a.blockLen)}function mJ(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function mK(a,b){mH(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}function mL(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}function mM(...a){for(let b=0;b<a.length;b++)a[b].fill(0)}function mN(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function mO(a,b){return a<<32-b|a>>>b}let mP=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function mQ(a){return a<<24&0xff000000|a<<8&0xff0000|a>>>8&65280|a>>>24&255}let mR=mP?a=>a:a=>mQ(a),mS=mP?a=>a:function(a){for(let b=0;b<a.length;b++)a[b]=mQ(a[b]);return a},mT="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,mU=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function mV(a){if(mH(a),mT)return a.toHex();let b="";for(let c=0;c<a.length;c++)b+=mU[a[c]];return b}function mW(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:void 0}function mX(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);if(mT)return Uint8Array.fromHex(a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=mW(a.charCodeAt(e)),f=mW(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d}function mY(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}function mZ(a){return"string"==typeof a&&(a=mY(a)),mH(a),a}function m$(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];mH(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}class m_{}function m0(a){let b=b=>a().update(mZ(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b}function m1(a=32){if(mE&&"function"==typeof mE.getRandomValues)return mE.getRandomValues(new Uint8Array(a));if(mE&&"function"==typeof mE.randomBytes)return Uint8Array.from(mE.randomBytes(a));throw Error("crypto.getRandomValues must be defined")}let m2=BigInt(0),m3=BigInt(1),m4=BigInt(2),m5=BigInt(7),m6=BigInt(256),m7=BigInt(113),m8=[],m9=[],na=[];for(let a=0,b=m3,c=1,d=0;a<24;a++){[c,d]=[d,(2*c+3*d)%5],m8.push(2*(5*d+c)),m9.push((a+1)*(a+2)/2%64);let e=m2;for(let a=0;a<7;a++)(b=(b<<m3^(b>>m5)*m7)%m6)&m4&&(e^=m3<<(m3<<BigInt(a))-m3);na.push(e)}let nb=mq(na,!0),nc=nb[0],nd=nb[1],ne=(a,b,c)=>c>32?b<<c-32|a>>>64-c:a<<c|b>>>32-c,nf=(a,b,c)=>c>32?a<<c-32|b>>>64-c:b<<c|a>>>32-c;class ng extends m_{constructor(a,b,c,d=!1,e=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=a,this.suffix=b,this.outputLen=c,this.enableXOF=d,this.rounds=e,mG(c),!(0<a&&a<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=mL(this.state)}clone(){return this._cloneInto()}keccak(){mS(this.state32),function(a,b=24){let c=new Uint32Array(10);for(let d=24-b;d<24;d++){for(let b=0;b<10;b++)c[b]=a[b]^a[b+10]^a[b+20]^a[b+30]^a[b+40];for(let b=0;b<10;b+=2){let d=(b+8)%10,e=(b+2)%10,f=c[e],g=c[e+1],h=ne(f,g,1)^c[d],i=nf(f,g,1)^c[d+1];for(let c=0;c<50;c+=10)a[b+c]^=h,a[b+c+1]^=i}let b=a[2],e=a[3];for(let c=0;c<24;c++){let d=m9[c],f=ne(b,e,d),g=nf(b,e,d),h=m8[c];b=a[h],e=a[h+1],a[h]=f,a[h+1]=g}for(let b=0;b<50;b+=10){for(let d=0;d<10;d++)c[d]=a[b+d];for(let d=0;d<10;d++)a[b+d]^=~c[(d+2)%10]&c[(d+4)%10]}a[0]^=nc[d],a[1]^=nd[d]}mM(c)}(this.state32,this.rounds),mS(this.state32),this.posOut=0,this.pos=0}update(a){mJ(this),mH(a=mZ(a));let{blockLen:b,state:c}=this,d=a.length;for(let e=0;e<d;){let f=Math.min(b-this.pos,d-e);for(let b=0;b<f;b++)c[this.pos++]^=a[e++];this.pos===b&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:a,suffix:b,pos:c,blockLen:d}=this;a[c]^=b,(128&b)!=0&&c===d-1&&this.keccak(),a[d-1]^=128,this.keccak()}writeInto(a){mJ(this,!1),mH(a),this.finish();let b=this.state,{blockLen:c}=this;for(let d=0,e=a.length;d<e;){this.posOut>=c&&this.keccak();let f=Math.min(c-this.posOut,e-d);a.set(b.subarray(this.posOut,this.posOut+f),d),this.posOut+=f,d+=f}return a}xofInto(a){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(a)}xof(a){return mG(a),this.xofInto(new Uint8Array(a))}digestInto(a){if(mK(a,this),this.finished)throw Error("digest() was already called");return this.writeInto(a),this.destroy(),a}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,mM(this.state)}_cloneInto(a){let{blockLen:b,suffix:c,outputLen:d,rounds:e,enableXOF:f}=this;return a||(a=new ng(b,c,d,f,e)),a.state32.set(this.state32),a.pos=this.pos,a.posOut=this.posOut,a.finished=this.finished,a.rounds=e,a.suffix=c,a.outputLen=d,a.enableXOF=f,a.destroyed=this.destroyed,a}}let nh=m0(()=>new ng(136,1,32));class ni extends m_{constructor(a,b,c,d){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=a,this.outputLen=b,this.padOffset=c,this.isLE=d,this.buffer=new Uint8Array(a),this.view=mN(this.buffer)}update(a){mJ(this),mH(a=mZ(a));let{view:b,buffer:c,blockLen:d}=this,e=a.length;for(let f=0;f<e;){let g=Math.min(d-this.pos,e-f);if(g===d){let b=mN(a);for(;d<=e-f;f+=d)this.process(b,f);continue}c.set(a.subarray(f,f+g),this.pos),this.pos+=g,f+=g,this.pos===d&&(this.process(b,0),this.pos=0)}return this.length+=a.length,this.roundClean(),this}digestInto(a){mJ(this),mK(a,this),this.finished=!0;let{buffer:b,view:c,blockLen:d,isLE:e}=this,{pos:f}=this;b[f++]=128,mM(this.buffer.subarray(f)),this.padOffset>d-f&&(this.process(c,0),f=0);for(let a=f;a<d;a++)b[a]=0;(function(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)})(c,d-8,BigInt(8*this.length),e),this.process(c,0);let g=mN(a),h=this.outputLen;if(h%4)throw Error("_sha2: outputLen should be aligned to 32bit");let i=h/4,j=this.get();if(i>j.length)throw Error("_sha2: outputLen bigger than state");for(let a=0;a<i;a++)g.setUint32(4*a,j[a],e)}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){a||(a=new this.constructor),a.set(...this.get());let{blockLen:b,buffer:c,length:d,finished:e,destroyed:f,pos:g}=this;return a.destroyed=f,a.finished=e,a.length=d,a.pos=g,d%b&&a.buffer.set(c),a}clone(){return this._cloneInto()}}let nj=Uint32Array.from([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),nk=Uint32Array.from([0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]),nl=Uint32Array.from([0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179]),nm=Uint32Array.from([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),nn=new Uint32Array(64);class no extends ni{constructor(a=32){super(64,a,8,!1),this.A=0|nj[0],this.B=0|nj[1],this.C=0|nj[2],this.D=0|nj[3],this.E=0|nj[4],this.F=0|nj[5],this.G=0|nj[6],this.H=0|nj[7]}get(){let{A:a,B:b,C:c,D:d,E:e,F:f,G:g,H:h}=this;return[a,b,c,d,e,f,g,h]}set(a,b,c,d,e,f,g,h){this.A=0|a,this.B=0|b,this.C=0|c,this.D=0|d,this.E=0|e,this.F=0|f,this.G=0|g,this.H=0|h}process(a,b){for(let c=0;c<16;c++,b+=4)nn[c]=a.getUint32(b,!1);for(let a=16;a<64;a++){let b=nn[a-15],c=nn[a-2],d=mO(b,7)^mO(b,18)^b>>>3,e=mO(c,17)^mO(c,19)^c>>>10;nn[a]=e+nn[a-7]+d+nn[a-16]|0}let{A:c,B:d,C:e,D:f,E:g,F:h,G:i,H:j}=this;for(let a=0;a<64;a++){var k,l,m,n;let b=j+(mO(g,6)^mO(g,11)^mO(g,25))+((k=g)&h^~k&i)+nm[a]+nn[a]|0,o=(mO(c,2)^mO(c,13)^mO(c,22))+((l=c)&(m=d)^l&(n=e)^m&n)|0;j=i,i=h,h=g,g=f+b|0,f=e,e=d,d=c,c=b+o|0}c=c+this.A|0,d=d+this.B|0,e=e+this.C|0,f=f+this.D|0,g=g+this.E|0,h=h+this.F|0,i=i+this.G|0,j=j+this.H|0,this.set(c,d,e,f,g,h,i,j)}roundClean(){mM(nn)}destroy(){this.set(0,0,0,0,0,0,0,0),mM(this.buffer)}}let np=mq(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(a=>BigInt(a))),nq=np[0],nr=np[1],ns=new Uint32Array(80),nt=new Uint32Array(80);class nu extends ni{constructor(a=64){super(128,a,16,!1),this.Ah=0|nl[0],this.Al=0|nl[1],this.Bh=0|nl[2],this.Bl=0|nl[3],this.Ch=0|nl[4],this.Cl=0|nl[5],this.Dh=0|nl[6],this.Dl=0|nl[7],this.Eh=0|nl[8],this.El=0|nl[9],this.Fh=0|nl[10],this.Fl=0|nl[11],this.Gh=0|nl[12],this.Gl=0|nl[13],this.Hh=0|nl[14],this.Hl=0|nl[15]}get(){let{Ah:a,Al:b,Bh:c,Bl:d,Ch:e,Cl:f,Dh:g,Dl:h,Eh:i,El:j,Fh:k,Fl:l,Gh:m,Gl:n,Hh:o,Hl:p}=this;return[a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p]}set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.Ah=0|a,this.Al=0|b,this.Bh=0|c,this.Bl=0|d,this.Ch=0|e,this.Cl=0|f,this.Dh=0|g,this.Dl=0|h,this.Eh=0|i,this.El=0|j,this.Fh=0|k,this.Fl=0|l,this.Gh=0|m,this.Gl=0|n,this.Hh=0|o,this.Hl=0|p}process(a,b){for(let c=0;c<16;c++,b+=4)ns[c]=a.getUint32(b),nt[c]=a.getUint32(b+=4);for(let a=16;a<80;a++){let b=0|ns[a-15],c=0|nt[a-15],d=mt(b,c,1)^mt(b,c,8)^mr(b,c,7),e=mu(b,c,1)^mu(b,c,8)^ms(b,c,7),f=0|ns[a-2],g=0|nt[a-2],h=mt(f,g,19)^mv(f,g,61)^mr(f,g,6),i=mA(e,mu(f,g,19)^mw(f,g,61)^ms(f,g,6),nt[a-7],nt[a-16]),j=mB(i,d,h,ns[a-7],ns[a-16]);ns[a]=0|j,nt[a]=0|i}let{Ah:c,Al:d,Bh:e,Bl:f,Ch:g,Cl:h,Dh:i,Dl:j,Eh:k,El:l,Fh:m,Fl:n,Gh:o,Gl:p,Hh:q,Hl:r}=this;for(let a=0;a<80;a++){let b=mt(k,l,14)^mt(k,l,18)^mv(k,l,41),s=mu(k,l,14)^mu(k,l,18)^mw(k,l,41),t=k&m^~k&o,u=mC(r,s,l&n^~l&p,nr[a],nt[a]),v=mD(u,q,b,t,nq[a],ns[a]),w=0|u,x=mt(c,d,28)^mv(c,d,34)^mv(c,d,39),y=mu(c,d,28)^mw(c,d,34)^mw(c,d,39),z=c&e^c&g^e&g,A=d&f^d&h^f&h;q=0|o,r=0|p,o=0|m,p=0|n,m=0|k,n=0|l,({h:k,l:l}=mx(0|i,0|j,0|v,0|w)),i=0|g,j=0|h,g=0|e,h=0|f,e=0|c,f=0|d;let B=my(w,y,A);c=mz(B,v,x,z),d=0|B}({h:c,l:d}=mx(0|this.Ah,0|this.Al,0|c,0|d)),({h:e,l:f}=mx(0|this.Bh,0|this.Bl,0|e,0|f)),({h:g,l:h}=mx(0|this.Ch,0|this.Cl,0|g,0|h)),({h:i,l:j}=mx(0|this.Dh,0|this.Dl,0|i,0|j)),({h:k,l:l}=mx(0|this.Eh,0|this.El,0|k,0|l)),({h:m,l:n}=mx(0|this.Fh,0|this.Fl,0|m,0|n)),({h:o,l:p}=mx(0|this.Gh,0|this.Gl,0|o,0|p)),({h:q,l:r}=mx(0|this.Hh,0|this.Hl,0|q,0|r)),this.set(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r)}roundClean(){mM(ns,nt)}destroy(){mM(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class nv extends nu{constructor(){super(48),this.Ah=0|nk[0],this.Al=0|nk[1],this.Bh=0|nk[2],this.Bl=0|nk[3],this.Ch=0|nk[4],this.Cl=0|nk[5],this.Dh=0|nk[6],this.Dl=0|nk[7],this.Eh=0|nk[8],this.El=0|nk[9],this.Fh=0|nk[10],this.Fl=0|nk[11],this.Gh=0|nk[12],this.Gl=0|nk[13],this.Hh=0|nk[14],this.Hl=0|nk[15]}}let nw=Uint32Array.from([0x22312194,0xfc2bf72c,0x9f555fa3,0xc84c64c2,0x2393b86b,0x6f53b151,0x96387719,0x5940eabd,0x96283ee2,0xa88effe3,0xbe5e1e25,0x53863992,0x2b0199fc,0x2c85b8aa,0xeb72ddc,0x81c52ca2]);class nx extends nu{constructor(){super(32),this.Ah=0|nw[0],this.Al=0|nw[1],this.Bh=0|nw[2],this.Bl=0|nw[3],this.Ch=0|nw[4],this.Cl=0|nw[5],this.Dh=0|nw[6],this.Dl=0|nw[7],this.Eh=0|nw[8],this.El=0|nw[9],this.Fh=0|nw[10],this.Fl=0|nw[11],this.Gh=0|nw[12],this.Gl=0|nw[13],this.Hh=0|nw[14],this.Hl=0|nw[15]}}let ny=m0(()=>new no),nz=m0(()=>new nu),nA=m0(()=>new nv),nB=m0(()=>new nx),nC=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),nD=Uint32Array.from([0xf3bcc908,0x6a09e667,0x84caa73b,0xbb67ae85,0xfe94f82b,0x3c6ef372,0x5f1d36f1,0xa54ff53a,0xade682d1,0x510e527f,0x2b3e6c1f,0x9b05688c,0xfb41bd6b,0x1f83d9ab,0x137e2179,0x5be0cd19]),nE=new Uint32Array(32);function nF(a,b,c,d,e,f){let g=e[f],h=e[f+1],i=nE[2*a],j=nE[2*a+1],k=nE[2*b],l=nE[2*b+1],m=nE[2*c],n=nE[2*c+1],o=nE[2*d],p=nE[2*d+1],q=my(i,k,g);j=mz(q,j,l,h),i=0|q,({Dh:p,Dl:o}={Dh:p^j,Dl:o^i}),({Dh:p,Dl:o}={Dh:o,Dl:p}),({h:n,l:m}=mx(n,m,p,o)),({Bh:l,Bl:k}={Bh:l^n,Bl:k^m}),({Bh:l,Bl:k}={Bh:mt(l,k,24),Bl:mu(l,k,24)}),nE[2*a]=i,nE[2*a+1]=j,nE[2*b]=k,nE[2*b+1]=l,nE[2*c]=m,nE[2*c+1]=n,nE[2*d]=o,nE[2*d+1]=p}function nG(a,b,c,d,e,f){let g=e[f],h=e[f+1],i=nE[2*a],j=nE[2*a+1],k=nE[2*b],l=nE[2*b+1],m=nE[2*c],n=nE[2*c+1],o=nE[2*d],p=nE[2*d+1],q=my(i,k,g);j=mz(q,j,l,h),i=0|q,({Dh:p,Dl:o}={Dh:p^j,Dl:o^i}),({Dh:p,Dl:o}={Dh:mt(p,o,16),Dl:mu(p,o,16)}),({h:n,l:m}=mx(n,m,p,o)),({Bh:l,Bl:k}={Bh:l^n,Bl:k^m}),({Bh:l,Bl:k}={Bh:mv(l,k,63),Bl:mw(l,k,63)}),nE[2*a]=i,nE[2*a+1]=j,nE[2*b]=k,nE[2*b+1]=l,nE[2*c]=m,nE[2*c+1]=n,nE[2*d]=o,nE[2*d+1]=p}class nH extends m_{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,mG(a),mG(b),this.blockLen=a,this.outputLen=b,this.buffer=new Uint8Array(a),this.buffer32=mL(this.buffer)}update(a){mJ(this),mH(a=mZ(a));let{blockLen:b,buffer:c,buffer32:d}=this,e=a.length,f=a.byteOffset,g=a.buffer;for(let h=0;h<e;){this.pos===b&&(mS(d),this.compress(d,0,!1),mS(d),this.pos=0);let i=Math.min(b-this.pos,e-h),j=f+h;if(i===b&&!(j%4)&&h+i<e){let a=new Uint32Array(g,j,Math.floor((e-h)/4));mS(a);for(let c=0;h+b<e;c+=d.length,h+=b)this.length+=b,this.compress(a,c,!1);mS(a);continue}c.set(a.subarray(h,h+i),this.pos),this.pos+=i,this.length+=i,h+=i}return this}digestInto(a){mJ(this),mK(a,this);let{pos:b,buffer32:c}=this;this.finished=!0,mM(this.buffer.subarray(b)),mS(c),this.compress(c,0,!0),mS(c);let d=mL(a);this.get().forEach((a,b)=>d[b]=mR(a))}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){let{buffer:b,length:c,finished:d,destroyed:e,outputLen:f,pos:g}=this;return a||(a=new this.constructor({dkLen:f})),a.set(...this.get()),a.buffer.set(b),a.destroyed=e,a.finished=d,a.length=c,a.pos=g,a.outputLen=f,a}clone(){return this._cloneInto()}}class nI extends nH{constructor(a={}){const b=void 0===a.dkLen?64:a.dkLen;super(128,b),this.v0l=0|nD[0],this.v0h=0|nD[1],this.v1l=0|nD[2],this.v1h=0|nD[3],this.v2l=0|nD[4],this.v2h=0|nD[5],this.v3l=0|nD[6],this.v3h=0|nD[7],this.v4l=0|nD[8],this.v4h=0|nD[9],this.v5l=0|nD[10],this.v5h=0|nD[11],this.v6l=0|nD[12],this.v6h=0|nD[13],this.v7l=0|nD[14],this.v7h=0|nD[15],function(a,b={},c,d,e){if(mG(64),a<0||a>64)throw Error("outputLen bigger than keyLen");let{key:f,salt:g,personalization:h}=b;if(void 0!==f&&(f.length<1||f.length>64))throw Error("key length must be undefined or 1..64");if(void 0!==g&&16!==g.length)throw Error("salt must be undefined or 16");if(void 0!==h&&16!==h.length)throw Error("personalization must be undefined or 16")}(b,a,0,0,0);let{key:c,personalization:d,salt:e}=a,f=0;if(void 0!==c&&(f=(c=mZ(c)).length),this.v0l^=this.outputLen|f<<8|0x1010000,void 0!==e){const a=mL(e=mZ(e));this.v4l^=mR(a[0]),this.v4h^=mR(a[1]),this.v5l^=mR(a[2]),this.v5h^=mR(a[3])}if(void 0!==d){const a=mL(d=mZ(d));this.v6l^=mR(a[0]),this.v6h^=mR(a[1]),this.v7l^=mR(a[2]),this.v7h^=mR(a[3])}if(void 0!==c){const a=new Uint8Array(this.blockLen);a.set(c),this.update(a)}}get(){let{v0l:a,v0h:b,v1l:c,v1h:d,v2l:e,v2h:f,v3l:g,v3h:h,v4l:i,v4h:j,v5l:k,v5h:l,v6l:m,v6h:n,v7l:o,v7h:p}=this;return[a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p]}set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.v0l=0|a,this.v0h=0|b,this.v1l=0|c,this.v1h=0|d,this.v2l=0|e,this.v2h=0|f,this.v3l=0|g,this.v3h=0|h,this.v4l=0|i,this.v4h=0|j,this.v5l=0|k,this.v5h=0|l,this.v6l=0|m,this.v6h=0|n,this.v7l=0|o,this.v7h=0|p}compress(a,b,c){this.get().forEach((a,b)=>nE[b]=a),nE.set(nD,16);let{h:d,l:e}=mp(BigInt(this.length));nE[24]=nD[8]^e,nE[25]=nD[9]^d,c&&(nE[28]=~nE[28],nE[29]=~nE[29]);let f=0;for(let c=0;c<12;c++)nF(0,4,8,12,a,b+2*nC[f++]),nG(0,4,8,12,a,b+2*nC[f++]),nF(1,5,9,13,a,b+2*nC[f++]),nG(1,5,9,13,a,b+2*nC[f++]),nF(2,6,10,14,a,b+2*nC[f++]),nG(2,6,10,14,a,b+2*nC[f++]),nF(3,7,11,15,a,b+2*nC[f++]),nG(3,7,11,15,a,b+2*nC[f++]),nF(0,5,10,15,a,b+2*nC[f++]),nG(0,5,10,15,a,b+2*nC[f++]),nF(1,6,11,12,a,b+2*nC[f++]),nG(1,6,11,12,a,b+2*nC[f++]),nF(2,7,8,13,a,b+2*nC[f++]),nG(2,7,8,13,a,b+2*nC[f++]),nF(3,4,9,14,a,b+2*nC[f++]),nG(3,4,9,14,a,b+2*nC[f++]);this.v0l^=nE[0]^nE[16],this.v0h^=nE[1]^nE[17],this.v1l^=nE[2]^nE[18],this.v1h^=nE[3]^nE[19],this.v2l^=nE[4]^nE[20],this.v2h^=nE[5]^nE[21],this.v3l^=nE[6]^nE[22],this.v3h^=nE[7]^nE[23],this.v4l^=nE[8]^nE[24],this.v4h^=nE[9]^nE[25],this.v5l^=nE[10]^nE[26],this.v5h^=nE[11]^nE[27],this.v6l^=nE[12]^nE[28],this.v6h^=nE[13]^nE[29],this.v7l^=nE[14]^nE[30],this.v7h^=nE[15]^nE[31],mM(nE)}destroy(){this.destroyed=!0,mM(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}let nJ=(DQ=a=>new nI(a),(L=(a,b)=>DQ(b).update(mZ(a)).digest()).outputLen=(M=DQ({})).outputLen,L.blockLen=M.blockLen,L.create=a=>DQ(a),L);function nK(a){let b=`Ethereum Signed Message:
${a.length}`,c=new TextEncoder().encode(b+a);return"0x"+Buffer.from(nh(c)).toString("hex")}async function nL(a,b,c,d,e,f){switch(c.t){case"eip191":var g,h,i;let j;return await (g=a,h=b,i=c.s,j=kT.fromHex(i),lj.recoverAddress({payload:nK(h),signature:j}).toLowerCase()===g.toLowerCase());case"eip1271":return await nM(a,b,c.s,d,e,f);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${c.t}`)}}async function nM(a,b,c,d,e,f){let g=lL(d);if(!g.namespace||!g.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${d}`);try{let g="0x1626ba7e",h=c.substring(2),i=(h.length/2).toString(16).padStart(64,"0"),j=(b.startsWith("0x")?b:nK(b)).substring(2),k=g+j+"0000000000000000000000000000000000000000000000000000000000000040"+i+h,l=await fetch(`${f||"https://rpc.walletconnect.org/v1"}/?chainId=${d}&projectId=${e}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:a,data:k},"latest"]})}),{result:m}=await l.json();return!!m&&m.slice(0,g.length).toLowerCase()===g.toLowerCase()}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function nN(a){let b=new Uint8Array(ny(function(a){if(a instanceof Uint8Array)return a;if(Array.isArray(a))return new Uint8Array(a);if("object"==typeof a&&null!=a&&a.data)return new Uint8Array(Object.values(a.data));if("object"==typeof a&&a)return new Uint8Array(Object.values(a));throw Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}(a)));return lk.default.encode(b)}function nO(a){let b=Buffer.from(a,"base64"),c=(0,ll.decode)(b).txn;if(!c)throw Error("Invalid signed transaction: missing 'txn' field");let d=(0,lm.encode)(c),e=Buffer.from("TX"),f=nB(Buffer.concat([e,Buffer.from(d)]));return gf.base32.encode(f).replace(/=+$/,"")}function nP(a){let b=[],c=BigInt(a);for(;c>=BigInt(128);)b.push(Number(c&BigInt(127)|BigInt(128))),c>>=BigInt(7);return b.push(Number(c)),Buffer.from(b)}var nQ=Object.defineProperty,nR=Object.defineProperties,nS=Object.getOwnPropertyDescriptors,nT=Object.getOwnPropertySymbols,nU=Object.prototype.hasOwnProperty,nV=Object.prototype.propertyIsEnumerable,nW=(a,b,c)=>b in a?nQ(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c;let nX=a=>a?.split(":"),nY=a=>{let b=a&&nX(a);if(b)return b[2]+":"+b[3]},nZ=a=>{let b=a&&nX(a);if(b)return b.pop()};async function n$(a){let{cacao:b,projectId:c}=a,{s:d,p:e}=b,f=n_(e,e.iss),g=nZ(e.iss);return await nL(g,f,d,nY(e.iss),c)}let n_=(a,b)=>{let c=`${a.domain} wants you to sign in with your Ethereum account:`,d=nZ(b);if(!a.aud&&!a.uri)throw Error("Either `aud` or `uri` is required to construct the message");let e=a.statement||void 0,f=`URI: ${a.aud||a.uri}`,g=`Version: ${a.version}`,h=`Chain ID: ${(a=>{let b=a&&nX(a);if(b)return a.includes("did:pkh:")?b[3]:b[1]})(b)}`,i=`Nonce: ${a.nonce}`,j=`Issued At: ${a.iat}`,k=a.exp?`Expiration Time: ${a.exp}`:void 0,l=a.nbf?`Not Before: ${a.nbf}`:void 0,m=a.requestId?`Request ID: ${a.requestId}`:void 0,n=a.resources?`Resources:${a.resources.map(a=>`
- ${a}`).join("")}`:void 0,o=n5(a.resources);return o&&(e=function(a="",b){n0(b);let c="I further authorize the stated URI to perform the following actions on my behalf: ";if(a.includes(c))return a;let d=[],e=0;Object.keys(b.att).forEach(a=>{let c=Object.keys(b.att[a]).map(a=>({ability:a.split("/")[0],action:a.split("/")[1]}));c.sort((a,b)=>a.action.localeCompare(b.action));let f={};c.forEach(a=>{f[a.ability]||(f[a.ability]=[]),f[a.ability].push(a.action)});let g=Object.keys(f).map(b=>(e++,`(${e}) '${b}': '${f[b].join("', '")}' for '${a}'.`));d.push(g.join(", ").replace(".,","."))});let f=d.join(" "),g=`${c}${f}`;return`${a?a+" ":""}${g}`}(e,n2(o))),[c,d,"",e,"",f,g,h,i,j,k,l,m,n].filter(a=>null!=a).join(`
`)};function n0(a){if(!a)throw Error("No recap provided, value is undefined");if(!a.att)throw Error("No `att` property found");let b=Object.keys(a.att);if(!(null!=b&&b.length))throw Error("No resources found in `att` property");b.forEach(b=>{let c=a.att[b];if(Array.isArray(c)||"object"!=typeof c)throw Error(`Resource must be an object: ${b}`);if(!Object.keys(c).length)throw Error(`Resource object is empty: ${b}`);Object.keys(c).forEach(a=>{let b=c[a];if(!Array.isArray(b))throw Error(`Ability limits ${a} must be an array of objects, found: ${b}`);if(!b.length)throw Error(`Value of ${a} is empty array, must be an array with objects`);b.forEach(b=>{if("object"!=typeof b)throw Error(`Ability limits (${a}) must be an array of objects, found: ${b}`)})})})}function n1(a){return n0(a),`urn:recap:${Buffer.from(JSON.stringify(a)).toString("base64").replace(/=/g,"")}`}function n2(a){var b;let c=(b=a.replace("urn:recap:",""),JSON.parse(Buffer.from(b,"base64").toString("utf-8")));return n0(c),c}function n3(a){var b;let c=n2(a);n0(c);let d=null==(b=c.att)?void 0:b.eip155;return d?Object.keys(d).map(a=>a.split("/")[1]):[]}function n4(a){let b=n2(a);n0(b);let c=[];return Object.values(b.att).forEach(a=>{Object.values(a).forEach(a=>{var b;null!=(b=a?.[0])&&b.chains&&c.push(a[0].chains)})}),[...new Set(c.flat())]}function n5(a){if(!a)return;let b=a?.[a.length-1];return b&&b.includes("urn:recap:")?b:void 0}function n6(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function n7(a){if("boolean"!=typeof a)throw Error(`boolean expected, not ${a}`)}function n8(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function n9(a,...b){if(!n6(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function oa(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function ob(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}function oc(...a){for(let b=0;b<a.length;b++)a[b].fill(0)}let od=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function oe(a){if("string"==typeof a)a=function(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}(a);else if(n6(a))a=oh(a);else throw Error("Uint8Array expected, got "+typeof a);return a}function of(a,b,c=!0){if(void 0===b)return new Uint8Array(a);if(b.length!==a)throw Error("invalid output length, expected "+a+", got: "+b.length);if(c&&b.byteOffset%4!=0)throw Error("invalid output, must be aligned");return b}function og(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)}function oh(a){return Uint8Array.from(a)}let oi=a=>Uint8Array.from(a.split("").map(a=>a.charCodeAt(0))),oj=oi("expand 16-byte k"),ok=oi("expand 32-byte k"),ol=ob(oj),om=ob(ok);function on(a,b){return a<<b|a>>>32-b}function oo(a){return a.byteOffset%4==0}let op=0x100000000-1,oq=new Uint32Array,or=(a,b)=>255&a[b++]|(255&a[b++])<<8;class os{constructor(a){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,n9(a=oe(a),32);const b=or(a,0),c=or(a,2),d=or(a,4),e=or(a,6),f=or(a,8),g=or(a,10),h=or(a,12),i=or(a,14);this.r[0]=8191&b,this.r[1]=(b>>>13|c<<3)&8191,this.r[2]=(c>>>10|d<<6)&7939,this.r[3]=(d>>>7|e<<9)&8191,this.r[4]=(e>>>4|f<<12)&255,this.r[5]=f>>>1&8190,this.r[6]=(f>>>14|g<<2)&8191,this.r[7]=(g>>>11|h<<5)&8065,this.r[8]=(h>>>8|i<<8)&8191,this.r[9]=i>>>5&127;for(let b=0;b<8;b++)this.pad[b]=or(a,16+2*b)}process(a,b,c=!1){let{h:d,r:e}=this,f=e[0],g=e[1],h=e[2],i=e[3],j=e[4],k=e[5],l=e[6],m=e[7],n=e[8],o=e[9],p=or(a,b+0),q=or(a,b+2),r=or(a,b+4),s=or(a,b+6),t=or(a,b+8),u=or(a,b+10),v=or(a,b+12),w=or(a,b+14),x=d[0]+(8191&p),y=d[1]+((p>>>13|q<<3)&8191),z=d[2]+((q>>>10|r<<6)&8191),A=d[3]+((r>>>7|s<<9)&8191),B=d[4]+((s>>>4|t<<12)&8191),C=d[5]+(t>>>1&8191),D=d[6]+((t>>>14|u<<2)&8191),E=d[7]+((u>>>11|v<<5)&8191),F=d[8]+((v>>>8|w<<8)&8191),G=d[9]+(w>>>5|2048*!c),H=0,I=0+x*f+5*o*y+5*n*z+5*m*A+5*l*B;H=I>>>13,I&=8191,I+=5*k*C+5*j*D+5*i*E+5*h*F+5*g*G,H+=I>>>13,I&=8191;let J=H+x*g+y*f+5*o*z+5*n*A+5*m*B;H=J>>>13,J&=8191,J+=5*l*C+5*k*D+5*j*E+5*i*F+5*h*G,H+=J>>>13,J&=8191;let K=H+x*h+y*g+z*f+5*o*A+5*n*B;H=K>>>13,K&=8191,K+=5*m*C+5*l*D+5*k*E+5*j*F+5*i*G,H+=K>>>13,K&=8191;let L=H+x*i+y*h+z*g+A*f+5*o*B;H=L>>>13,L&=8191,L+=5*n*C+5*m*D+5*l*E+5*k*F+5*j*G,H+=L>>>13,L&=8191;let M=H+x*j+y*i+z*h+A*g+B*f;H=M>>>13,M&=8191,M+=5*o*C+5*n*D+5*m*E+5*l*F+5*k*G,H+=M>>>13,M&=8191;let N=H+x*k+y*j+z*i+A*h+B*g;H=N>>>13,N&=8191,N+=C*f+5*o*D+5*n*E+5*m*F+5*l*G,H+=N>>>13,N&=8191;let O=H+x*l+y*k+z*j+A*i+B*h;H=O>>>13,O&=8191,O+=C*g+D*f+5*o*E+5*n*F+5*m*G,H+=O>>>13,O&=8191;let P=H+x*m+y*l+z*k+A*j+B*i;H=P>>>13,P&=8191,P+=C*h+D*g+E*f+5*o*F+5*n*G,H+=P>>>13,P&=8191;let Q=H+x*n+y*m+z*l+A*k+B*j;H=Q>>>13,Q&=8191,Q+=C*i+D*h+E*g+F*f+5*o*G,H+=Q>>>13,Q&=8191;let R=H+x*o+y*n+z*m+A*l+B*k;H=R>>>13,R&=8191,R+=C*j+D*i+E*h+F*g+G*f,H+=R>>>13,R&=8191,I=8191&(H=(H=(H<<2)+H|0)+I|0),H>>>=13,J+=H,d[0]=I,d[1]=J,d[2]=K,d[3]=L,d[4]=M,d[5]=N,d[6]=O,d[7]=P,d[8]=Q,d[9]=R}finalize(){let{h:a,pad:b}=this,c=new Uint16Array(10),d=a[1]>>>13;a[1]&=8191;for(let b=2;b<10;b++)a[b]+=d,d=a[b]>>>13,a[b]&=8191;a[0]+=5*d,d=a[0]>>>13,a[0]&=8191,a[1]+=d,d=a[1]>>>13,a[1]&=8191,a[2]+=d,c[0]=a[0]+5,d=c[0]>>>13,c[0]&=8191;for(let b=1;b<10;b++)c[b]=a[b]+d,d=c[b]>>>13,c[b]&=8191;c[9]-=8192;let e=(1^d)-1;for(let a=0;a<10;a++)c[a]&=e;e=~e;for(let b=0;b<10;b++)a[b]=a[b]&e|c[b];a[0]=(a[0]|a[1]<<13)&65535,a[1]=(a[1]>>>3|a[2]<<10)&65535,a[2]=(a[2]>>>6|a[3]<<7)&65535,a[3]=(a[3]>>>9|a[4]<<4)&65535,a[4]=(a[4]>>>12|a[5]<<1|a[6]<<14)&65535,a[5]=(a[6]>>>2|a[7]<<11)&65535,a[6]=(a[7]>>>5|a[8]<<8)&65535,a[7]=(a[8]>>>8|a[9]<<5)&65535;let f=a[0]+b[0];a[0]=65535&f;for(let c=1;c<8;c++)f=(a[c]+b[c]|0)+(f>>>16)|0,a[c]=65535&f;oc(c)}update(a){oa(this),n9(a=oe(a));let{buffer:b,blockLen:c}=this,d=a.length;for(let e=0;e<d;){let f=Math.min(c-this.pos,d-e);if(f===c){for(;c<=d-e;e+=c)this.process(a,e);continue}b.set(a.subarray(e,e+f),this.pos),this.pos+=f,e+=f,this.pos===c&&(this.process(b,0,!1),this.pos=0)}return this}destroy(){oc(this.h,this.r,this.buffer,this.pad)}digestInto(a){oa(this),function(a,b){n9(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}(a,this),this.finished=!0;let{buffer:b,h:c}=this,{pos:d}=this;if(d){for(b[d++]=1;d<16;d++)b[d]=0;this.process(b,0,!0)}this.finalize();let e=0;for(let b=0;b<8;b++)a[e++]=c[b]>>>0,a[e++]=c[b]>>>8;return a}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}}let ot=(DR=a=>new os(a),(N=(a,b)=>DR(b).update(oe(a)).digest()).outputLen=(O=DR(new Uint8Array(32))).outputLen,N.blockLen=O.blockLen,N.create=a=>DR(a),N),ou=function(a,b){let{allowShortKeys:c,extendNonceFn:d,counterLength:e,counterRight:f,rounds:g}=function(a,b){if(null==b||"object"!=typeof b)throw Error("options must be defined");return Object.assign(a,b)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},b);if("function"!=typeof a)throw Error("core must be a function");return n8(e),n8(g),n7(f),n7(c),(b,h,i,j,k=0)=>{n9(b),n9(h),n9(i);let l=i.length;if(void 0===j&&(j=new Uint8Array(l)),n9(j),n8(k),k<0||k>=op)throw Error("arx: counter overflow");if(j.length<l)throw Error(`arx: output (${j.length}) is shorter than data (${l})`);let m=[],n=b.length,o,p;if(32===n)m.push(o=oh(b)),p=om;else if(16===n&&c)(o=new Uint8Array(32)).set(b),o.set(b,16),p=ol,m.push(o);else throw Error(`arx: invalid 32-byte key, got length=${n}`);oo(h)||m.push(h=oh(h));let q=ob(o);if(d){if(24!==h.length)throw Error("arx: extended nonce must be 24 bytes");d(p,q,ob(h.subarray(0,16)),q),h=h.subarray(16)}let r=16-e;if(r!==h.length)throw Error(`arx: nonce must be ${r} or 16 bytes`);if(12!==r){let a=new Uint8Array(12);a.set(h,f?0:12-h.length),h=a,m.push(h)}return function(a,b,c,d,e,f,g,h){let i=e.length,j=new Uint8Array(64),k=ob(j),l=oo(e)&&oo(f),m=l?ob(e):oq,n=l?ob(f):oq;for(let o=0;o<i;g++){if(a(b,c,d,k,g,h),g>=op)throw Error("arx: counter overflow");let p=Math.min(64,i-o);if(l&&64===p){let a=o/4;if(o%4!=0)throw Error("arx: invalid block position");for(let b=0,c;b<16;b++)n[c=a+b]=m[c]^k[b];o+=64;continue}for(let a=0,b;a<p;a++)f[b=o+a]=e[b]^j[a];o+=p}}(a,p,q,ob(h),i,j,k,g),oc(...m),j}}(function(a,b,c,d,e,f=20){let g=a[0],h=a[1],i=a[2],j=a[3],k=b[0],l=b[1],m=b[2],n=b[3],o=b[4],p=b[5],q=b[6],r=b[7],s=c[0],t=c[1],u=c[2],v=g,w=h,x=i,y=j,z=k,A=l,B=m,C=n,D=o,E=p,F=q,G=r,H=e,I=s,J=t,K=u;for(let a=0;a<f;a+=2)D=D+(H=on(H^(v=v+z|0),16))|0,v=v+(z=on(z^D,12))|0,D=D+(H=on(H^v,8))|0,z=on(z^D,7),E=E+(I=on(I^(w=w+A|0),16))|0,w=w+(A=on(A^E,12))|0,E=E+(I=on(I^w,8))|0,A=on(A^E,7),F=F+(J=on(J^(x=x+B|0),16))|0,x=x+(B=on(B^F,12))|0,F=F+(J=on(J^x,8))|0,B=on(B^F,7),G=G+(K=on(K^(y=y+C|0),16))|0,y=y+(C=on(C^G,12))|0,G=G+(K=on(K^y,8))|0,C=on(C^G,7),F=F+(K=on(K^(v=v+A|0),16))|0,v=v+(A=on(A^F,12))|0,F=F+(K=on(K^v,8))|0,A=on(A^F,7),G=G+(H=on(H^(w=w+B|0),16))|0,w=w+(B=on(B^G,12))|0,G=G+(H=on(H^w,8))|0,B=on(B^G,7),D=D+(I=on(I^(x=x+C|0),16))|0,x=x+(C=on(C^D,12))|0,D=D+(I=on(I^x,8))|0,C=on(C^D,7),E=E+(J=on(J^(y=y+z|0),16))|0,y=y+(z=on(z^E,12))|0,E=E+(J=on(J^y,8))|0,z=on(z^E,7);let L=0;d[L++]=g+v|0,d[L++]=h+w|0,d[L++]=i+x|0,d[L++]=j+y|0,d[L++]=k+z|0,d[L++]=l+A|0,d[L++]=m+B|0,d[L++]=n+C|0,d[L++]=o+D|0,d[L++]=p+E|0,d[L++]=q+F|0,d[L++]=r+G|0,d[L++]=e+H|0,d[L++]=s+I|0,d[L++]=t+J|0,d[L++]=u+K|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),ov=new Uint8Array(16),ow=(a,b)=>{a.update(b);let c=b.length%16;c&&a.update(ov.subarray(c))},ox=new Uint8Array(32);function oy(a,b,c,d,e){var f,g;let h,i,j=a(b,c,ox),k=ot.create(j);e&&ow(k,e),ow(k,d);let l=(f=d.length,g=e?e.length:0,n7(!0),og(i=new DataView((h=new Uint8Array(16)).buffer,h.byteOffset,h.byteLength),0,BigInt(g),!0),og(i,8,BigInt(f),!0),h);k.update(l);let m=k.digest();return oc(j,l),m}let oz=((a,b)=>{function c(d,...e){if(n9(d),!od)throw Error("Non little-endian hardware is not yet supported");if(void 0!==a.nonceLength){let b=e[0];if(!b)throw Error("nonce / iv required");a.varSizeNonce?n9(b):n9(b,a.nonceLength)}let f=a.tagLength;f&&void 0!==e[1]&&n9(e[1]);let g=b(d,...e),h=(a,b)=>{if(void 0!==b){if(2!==a)throw Error("cipher output not supported");n9(b)}},i=!1;return{encrypt(a,b){if(i)throw Error("cannot encrypt() twice with same key + nonce");return i=!0,n9(a),h(g.encrypt.length,b),g.encrypt(a,b)},decrypt(a,b){if(n9(a),f&&a.length<f)throw Error("invalid ciphertext length: smaller than tagLength="+f);return h(g.decrypt.length,b),g.decrypt(a,b)}}}return Object.assign(c,a),c})({blockSize:64,nonceLength:12,tagLength:16},(a,b,c)=>({encrypt(d,e){let f=d.length;(e=of(f+16,e,!1)).set(d);let g=e.subarray(0,-16);ou(a,b,g,g,1);let h=oy(ou,a,b,g,c);return e.set(h,f),oc(h),e},decrypt(d,e){e=of(d.length-16,e,!1);let f=d.subarray(0,-16),g=d.subarray(-16),h=oy(ou,a,b,f,c);if(!function(a,b){if(a.length!==b.length)return!1;let c=0;for(let d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c}(g,h))throw Error("invalid tag");return e.set(d.subarray(0,-16)),ou(a,b,e,e,1),oc(h),e}}));class oA extends m_{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,mI(a);const c=mZ(b);if(this.iHash=a.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const d=this.blockLen,e=new Uint8Array(d);e.set(c.length>d?a.create().update(c).digest():c);for(let a=0;a<e.length;a++)e[a]^=54;this.iHash.update(e),this.oHash=a.create();for(let a=0;a<e.length;a++)e[a]^=106;this.oHash.update(e),mM(e)}update(a){return mJ(this),this.iHash.update(a),this}digestInto(a){mJ(this),mH(a,this.outputLen),this.finished=!0,this.iHash.digestInto(a),this.oHash.update(a),this.oHash.digestInto(a),this.destroy()}digest(){let a=new Uint8Array(this.oHash.outputLen);return this.digestInto(a),a}_cloneInto(a){a||(a=Object.create(Object.getPrototypeOf(this),{}));let{oHash:b,iHash:c,finished:d,destroyed:e,blockLen:f,outputLen:g}=this;return a.finished=d,a.destroyed=e,a.blockLen=f,a.outputLen=g,a.oHash=b._cloneInto(a.oHash),a.iHash=c._cloneInto(a.iHash),a}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let oB=(a,b,c)=>new oA(a,b).update(c).digest();oB.create=(a,b)=>new oA(a,b);let oC=Uint8Array.from([0]),oD=Uint8Array.of(),oE=BigInt(0),oF=BigInt(1);function oG(a,b=""){if("boolean"!=typeof a)throw Error((b&&`"${b}"`)+"expected boolean, got type="+typeof a);return a}function oH(a,b,c=""){let d=mF(a),e=a?.length,f=void 0!==b;if(!d||f&&e!==b)throw Error((c&&`"${c}" `)+"expected Uint8Array"+(f?` of length ${b}`:"")+", got "+(d?`length=${e}`:`type=${typeof a}`));return a}function oI(a){let b=a.toString(16);return 1&b.length?"0"+b:b}function oJ(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);return""===a?oE:BigInt("0x"+a)}function oK(a){return mH(a),oJ(mV(Uint8Array.from(a).reverse()))}function oL(a,b){return mX(a.toString(16).padStart(2*b,"0"))}function oM(a,b){return oL(a,b).reverse()}function oN(a,b,c){let d;if("string"==typeof b)try{d=mX(b)}catch(b){throw Error(a+" must be hex string or Uint8Array, cause: "+b)}else if(mF(b))d=Uint8Array.from(b);else throw Error(a+" must be hex string or Uint8Array");let e=d.length;if("number"==typeof c&&e!==c)throw Error(a+" of length "+c+" expected, got "+e);return d}let oO=a=>"bigint"==typeof a&&oE<=a;function oP(a,b,c,d){if(!(oO(b)&&oO(c)&&oO(d))||!(c<=b)||!(b<d))throw Error("expected valid "+a+": "+c+" <= n < "+d+", got "+b)}function oQ(a){let b;for(b=0;a>oE;a>>=oF,b+=1);return b}let oR=a=>(oF<<BigInt(a))-oF;function oS(a,b,c={}){if(!a||"object"!=typeof a)throw Error("expected valid options object");function d(b,c,d){let e=a[b];if(d&&void 0===e)return;let f=typeof e;if(f!==c||null===e)throw Error(`param "${b}" is invalid: expected ${c}, got ${f}`)}Object.entries(b).forEach(([a,b])=>d(a,b,!1)),Object.entries(c).forEach(([a,b])=>d(a,b,!0))}function oT(a){let b=new WeakMap;return(c,...d)=>{let e=b.get(c);if(void 0!==e)return e;let f=a(c,...d);return b.set(c,f),f}}let oU=BigInt(0),oV=BigInt(1),oW=BigInt(2),oX=BigInt(3),oY=BigInt(4),oZ=BigInt(5),o$=BigInt(7),o_=BigInt(8),o0=BigInt(9),o1=BigInt(16);function o2(a,b){let c=a%b;return c>=oU?c:b+c}function o3(a,b,c){let d=a;for(;b-- >oU;)d*=d,d%=c;return d}function o4(a,b){if(a===oU)throw Error("invert: expected non-zero number");if(b<=oU)throw Error("invert: expected positive modulus, got "+b);let c=o2(a,b),d=b,e=oU,f=oV;for(;c!==oU;){let a=d/c,b=d%c,g=e-f*a;d=c,c=b,e=f,f=g}if(d!==oV)throw Error("invert: does not exist");return o2(e,b)}function o5(a,b,c){if(!a.eql(a.sqr(b),c))throw Error("Cannot find square root")}function o6(a,b){let c=(a.ORDER+oV)/oY,d=a.pow(b,c);return o5(a,d,b),d}function o7(a,b){let c=(a.ORDER-oZ)/o_,d=a.mul(b,oW),e=a.pow(d,c),f=a.mul(b,e),g=a.mul(a.mul(f,oW),e),h=a.mul(f,a.sub(g,a.ONE));return o5(a,h,b),h}function o8(a){if(a<oX)throw Error("sqrt is not defined for small field");let b=a-oV,c=0;for(;b%oW===oU;)b/=oW,c++;let d=oW,e=pd(a);for(;1===pb(e,d);)if(d++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===c)return o6;let f=e.pow(d,b),g=(b+oV)/oW;return function(a,d){if(a.is0(d))return d;if(1!==pb(a,d))throw Error("Cannot find square root");let e=c,h=a.mul(a.ONE,f),i=a.pow(d,b),j=a.pow(d,g);for(;!a.eql(i,a.ONE);){if(a.is0(i))return a.ZERO;let b=1,c=a.sqr(i);for(;!a.eql(c,a.ONE);)if(b++,c=a.sqr(c),b===e)throw Error("Cannot find square root");let d=oV<<BigInt(e-b-1),f=a.pow(h,d);e=b,h=a.sqr(f),i=a.mul(i,h),j=a.mul(j,f)}return j}}let o9=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function pa(a,b,c=!1){let d=Array(b.length).fill(c?a.ZERO:void 0),e=b.reduce((b,c,e)=>a.is0(c)?b:(d[e]=b,a.mul(b,c)),a.ONE),f=a.inv(e);return b.reduceRight((b,c,e)=>a.is0(c)?b:(d[e]=a.mul(b,d[e]),a.mul(b,c)),f),d}function pb(a,b){let c=(a.ORDER-oV)/oW,d=a.pow(b,c),e=a.eql(d,a.ONE),f=a.eql(d,a.ZERO),g=a.eql(d,a.neg(a.ONE));if(!e&&!f&&!g)throw Error("invalid Legendre symbol result");return e?1:f?0:-1}function pc(a,b){void 0!==b&&mG(b);let c=void 0!==b?b:a.toString(2).length,d=Math.ceil(c/8);return{nBitLength:c,nByteLength:d}}function pd(a,b,c=!1,d={}){let e;if(a<=oU)throw Error("invalid field: expected ORDER > 0, got "+a);let f,g,h=!1,i;if("object"==typeof b&&null!=b){if(d.sqrt||c)throw Error("cannot specify opts in two arguments");b.BITS&&(f=b.BITS),b.sqrt&&(g=b.sqrt),"boolean"==typeof b.isLE&&(c=b.isLE),"boolean"==typeof b.modFromBytes&&(h=b.modFromBytes),i=b.allowedLengths}else"number"==typeof b&&(f=b),d.sqrt&&(g=d.sqrt);let{nBitLength:j,nByteLength:k}=pc(a,f);if(k>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let l=Object.freeze({ORDER:a,isLE:c,BITS:j,BYTES:k,MASK:oR(j),ZERO:oU,ONE:oV,allowedLengths:i,create:b=>o2(b,a),isValid:b=>{if("bigint"!=typeof b)throw Error("invalid field element: expected bigint, got "+typeof b);return oU<=b&&b<a},is0:a=>a===oU,isValidNot0:a=>!l.is0(a)&&l.isValid(a),isOdd:a=>(a&oV)===oV,neg:b=>o2(-b,a),eql:(a,b)=>a===b,sqr:b=>o2(b*b,a),add:(b,c)=>o2(b+c,a),sub:(b,c)=>o2(b-c,a),mul:(b,c)=>o2(b*c,a),pow:(a,b)=>(function(a,b,c){if(c<oU)throw Error("invalid exponent, negatives unsupported");if(c===oU)return a.ONE;if(c===oV)return b;let d=a.ONE,e=b;for(;c>oU;)c&oV&&(d=a.mul(d,e)),e=a.sqr(e),c>>=oV;return d})(l,a,b),div:(b,c)=>o2(b*o4(c,a),a),sqrN:a=>a*a,addN:(a,b)=>a+b,subN:(a,b)=>a-b,mulN:(a,b)=>a*b,inv:b=>o4(b,a),sqrt:g||(b=>{let c,d,f,g,h,i;return e||(e=a%oY===oX?o6:a%o_===oZ?o7:a%o1===o0?(c=pd(a),f=(d=o8(a))(c,c.neg(c.ONE)),g=d(c,f),h=d(c,c.neg(f)),i=(a+o$)/o1,(a,b)=>{let c=a.pow(b,i),d=a.mul(c,f),e=a.mul(c,g),j=a.mul(c,h),k=a.eql(a.sqr(d),b),l=a.eql(a.sqr(e),b);c=a.cmov(c,d,k),d=a.cmov(j,e,l);let m=a.eql(a.sqr(d),b),n=a.cmov(c,d,m);return o5(a,n,b),n}):o8(a)),e(l,b)}),toBytes:a=>c?oM(a,k):oL(a,k),fromBytes:(b,d=!0)=>{if(i){if(!i.includes(b.length)||b.length>k)throw Error("Field.fromBytes: expected "+i+" bytes, got "+b.length);let a=new Uint8Array(k);a.set(b,c?0:a.length-b.length),b=a}if(b.length!==k)throw Error("Field.fromBytes: expected "+k+" bytes, got "+b.length);let e=c?oK(b):oJ(mV(b));if(h&&(e=o2(e,a)),!d&&!l.isValid(e))throw Error("invalid field element: outside of range 0..ORDER");return e},invertBatch:a=>pa(l,a),cmov:(a,b,c)=>c?b:a});return Object.freeze(l)}function pe(a){if("bigint"!=typeof a)throw Error("field order must be bigint");return Math.ceil(a.toString(2).length/8)}function pf(a){let b=pe(a);return b+Math.ceil(b/2)}let pg=BigInt(0),ph=BigInt(1);function pi(a,b){let c=b.negate();return a?c:b}function pj(a,b){let c=pa(a.Fp,b.map(a=>a.Z));return b.map((b,d)=>a.fromAffine(b.toAffine(c[d])))}function pk(a,b){if(!Number.isSafeInteger(a)||a<=0||a>b)throw Error("invalid window size, expected [1.."+b+"], got W="+a)}function pl(a,b){pk(a,b);let c=Math.ceil(b/a)+1,d=2**(a-1),e=2**a;return{windows:c,windowSize:d,mask:oR(a),maxNumber:e,shiftBy:BigInt(a)}}function pm(a,b,c){let{windowSize:d,mask:e,maxNumber:f,shiftBy:g}=c,h=Number(a&e),i=a>>g;h>d&&(h-=f,i+=ph);let j=b*d;return{nextN:i,offset:j+Math.abs(h)-1,isZero:0===h,isNeg:h<0,isNegF:b%2!=0,offsetF:j}}let pn=new WeakMap,po=new WeakMap;function pp(a){return po.get(a)||1}function pq(a){if(a!==pg)throw Error("invalid wNAF")}class pr{constructor(a,b){this.BASE=a.BASE,this.ZERO=a.ZERO,this.Fn=a.Fn,this.bits=b}_unsafeLadder(a,b,c=this.ZERO){let d=a;for(;b>pg;)b&ph&&(c=c.add(d)),d=d.double(),b>>=ph;return c}precomputeWindow(a,b){let{windows:c,windowSize:d}=pl(b,this.bits),e=[],f=a,g=f;for(let a=0;a<c;a++){g=f,e.push(g);for(let a=1;a<d;a++)g=g.add(f),e.push(g);f=g.double()}return e}wNAF(a,b,c){if(!this.Fn.isValid(c))throw Error("invalid scalar");let d=this.ZERO,e=this.BASE,f=pl(a,this.bits);for(let a=0;a<f.windows;a++){let{nextN:g,offset:h,isZero:i,isNeg:j,isNegF:k,offsetF:l}=pm(c,a,f);c=g,i?e=e.add(pi(k,b[l])):d=d.add(pi(j,b[h]))}return pq(c),{p:d,f:e}}wNAFUnsafe(a,b,c,d=this.ZERO){let e=pl(a,this.bits);for(let a=0;a<e.windows&&c!==pg;a++){let{nextN:f,offset:g,isZero:h,isNeg:i}=pm(c,a,e);if(c=f,!h){let a=b[g];d=d.add(i?a.negate():a)}}return pq(c),d}getPrecomputes(a,b,c){let d=pn.get(b);return d||(d=this.precomputeWindow(b,a),1!==a&&("function"==typeof c&&(d=c(d)),pn.set(b,d))),d}cached(a,b,c){let d=pp(a);return this.wNAF(d,this.getPrecomputes(d,a,c),b)}unsafe(a,b,c,d){let e=pp(a);return 1===e?this._unsafeLadder(a,b,d):this.wNAFUnsafe(e,this.getPrecomputes(e,a,c),b,d)}createCache(a,b){pk(b,this.bits),po.set(a,b),pn.delete(a)}hasCache(a){return 1!==pp(a)}}function ps(a,b,c){if(!b)return pd(a,{isLE:c});if(b.ORDER!==a)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return oS(b,o9.reduce((a,b)=>(a[b]="function",a),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),b}BigInt(0),BigInt(1),BigInt(2),BigInt(8),mY("HashToScalar-");let pt=BigInt(0),pu=BigInt(1),pv=BigInt(2),pw=BigInt(1),px=BigInt(2),py=BigInt(3),pz=BigInt(5),pA=BigInt(8),pB=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),pC={p:pB,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:pA,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")},pD=function(a){let{P:b,type:c,adjustScalarBytes:d,powPminus2:e,randomBytes:f}=(oS(a,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...a})),g="x25519"===c;if(!g&&"x448"!==c)throw Error("invalid type");let h=f||m1,i=g?255:448,j=g?32:56,k=BigInt(g?9:5),l=BigInt(g?121665:39081),m=g?pv**BigInt(254):pv**BigInt(447),n=m+(g?BigInt(8)*pv**BigInt(251)-pu:BigInt(4)*pv**BigInt(445)-pu)+pu,o=a=>o2(a,b),p=oM(o(k),j);function q(a,c){let f,h=function(a,c){oP("u",a,pt,b),oP("scalar",c,m,n);let d=pu,f=pt,g=a,h=pu,j=pt;for(let b=BigInt(i-1);b>=pt;b--){let e=c>>b&pu;j^=e,({x_2:d,x_3:g}=s(j,d,g)),({x_2:f,x_3:h}=s(j,f,h)),j=e;let i=d+f,k=o(i*i),m=d-f,n=o(m*m),p=k-n,q=g+h,r=o((g-h)*i),t=o(q*m),u=r+t,v=r-t;g=o(u*u),h=o(a*o(v*v)),d=o(k*n),f=o(p*(k+o(l*p)))}return{x_2:d,x_3:g}=s(j,d,g),{x_2:f,x_3:h}=s(j,f,h),o(d*e(f))}((f=oN("u coordinate",c,j),g&&(f[31]&=127),o(oK(f))),oK(d(oN("scalar",a,j))));if(h===pt)throw Error("invalid private or public key received");return oM(o(h),j)}function r(a){return q(a,p)}function s(a,b,c){let d=o(a*(b-c));return{x_2:b=o(b-d),x_3:c=o(c+d)}}let t={secretKey:j,publicKey:j,seed:j},u=(a=h(j))=>(mH(a,t.seed),a);return{keygen:function(a){let b=u(a);return{secretKey:b,publicKey:r(b)}},getSharedSecret:(a,b)=>q(a,b),getPublicKey:a=>r(a),scalarMult:q,scalarMultBase:r,utils:{randomSecretKey:u,randomPrivateKey:u},GuBytes:p.slice(),lengths:t}}({P:P=pd(pC.p,{isLE:!0}).ORDER,type:"x25519",powPminus2:a=>{let b,c,d,e,f,g,h,i,j,k,l,m,n,o,{pow_p_5_8:p,b2:q}=(b=BigInt(10),c=BigInt(20),d=BigInt(40),e=BigInt(80),g=o3(f=a*a%pB*a%pB,px,pB)*f%pB,h=o3(g,pw,pB)*a%pB,i=o3(h,pz,pB)*h%pB,j=o3(i,b,pB)*i%pB,k=o3(j,c,pB)*j%pB,l=o3(k,d,pB)*k%pB,m=o3(l,e,pB)*l%pB,n=o3(m,e,pB)*l%pB,o=o3(n,b,pB)*i%pB,{pow_p_5_8:o3(o,px,pB)*a%pB,b2:f});return o2(o3(p,py,P)*q,P)},adjustScalarBytes:function(a){return a[0]&=248,a[31]&=127,a[31]|=64,a}}),pE=(a,b)=>(a+(a>=0?b:-b)/pK)/b;function pF(a){if(!["compact","recovered","der"].includes(a))throw Error('Signature format must be "compact", "recovered", or "der"');return a}function pG(a,b){let c={};for(let d of Object.keys(b))c[d]=void 0===a[d]?b[d]:a[d];return oG(c.lowS,"lowS"),oG(c.prehash,"prehash"),void 0!==c.format&&pF(c.format),c}let pH={Err:class extends Error{constructor(a=""){super(a)}},_tlv:{encode:(a,b)=>{let{Err:c}=pH;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(1&b.length)throw new c("tlv.encode: unpadded data");let d=b.length/2,e=oI(d);if(e.length/2&128)throw new c("tlv.encode: long form length too big");let f=d>127?oI(e.length/2|128):"";return oI(a)+f+e+b},decode(a,b){let{Err:c}=pH,d=0;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(b.length<2||b[d++]!==a)throw new c("tlv.decode: wrong tlv");let e=b[d++],f=0;if(128&e){let a=127&e;if(!a)throw new c("tlv.decode(long): indefinite length not supported");if(a>4)throw new c("tlv.decode(long): byte length is too big");let g=b.subarray(d,d+a);if(g.length!==a)throw new c("tlv.decode: length bytes not complete");if(0===g[0])throw new c("tlv.decode(long): zero leftmost byte");for(let a of g)f=f<<8|a;if(d+=a,f<128)throw new c("tlv.decode(long): not minimal encoding")}else f=e;let g=b.subarray(d,d+f);if(g.length!==f)throw new c("tlv.decode: wrong value length");return{v:g,l:b.subarray(d+f)}}},_int:{encode(a){let{Err:b}=pH;if(a<pI)throw new b("integer: negative integers are not allowed");let c=oI(a);if(8&Number.parseInt(c[0],16)&&(c="00"+c),1&c.length)throw new b("unexpected DER parsing assertion: unpadded hex");return c},decode(a){let{Err:b}=pH;if(128&a[0])throw new b("invalid signature integer: negative");if(0===a[0]&&!(128&a[1]))throw new b("invalid signature integer: unnecessary leading zero");return oJ(mV(a))}},toSig(a){let{Err:b,_int:c,_tlv:d}=pH,e=oN("signature",a),{v:f,l:g}=d.decode(48,e);if(g.length)throw new b("invalid signature: left bytes after parsing");let{v:h,l:i}=d.decode(2,f),{v:j,l:k}=d.decode(2,i);if(k.length)throw new b("invalid signature: left bytes after parsing");return{r:c.decode(h),s:c.decode(j)}},hexFromSig(a){let{_tlv:b,_int:c}=pH,d=b.encode(2,c.encode(a.r)),e=b.encode(2,c.encode(a.s));return b.encode(48,d+e)}},pI=BigInt(0),pJ=BigInt(1),pK=BigInt(2),pL=BigInt(3),pM=BigInt(4);function pN(a,b){let c,{BYTES:d}=a;if("bigint"==typeof b)c=b;else{let e=oN("private key",b);try{c=a.fromBytes(e)}catch{throw Error(`invalid private key: expected ui8a of size ${d}, got ${typeof b}`)}}if(!a.isValidNot0(c))throw Error("invalid private key: out of range [1..N-1]");return c}function pO(a){return Uint8Array.of(a?2:3)}function pP(a,b){return{secretKey:b.BYTES,publicKey:1+a.BYTES,publicKeyUncompressed:1+2*a.BYTES,publicKeyHasPrefix:!0,signature:2*b.BYTES}}function pQ(a,b){let c=b=>(function(a){let b,{CURVE:c,curveOpts:d,hash:e,ecdsaOpts:f}=function(a){let b,c,d,e,{CURVE:f,curveOpts:g}=(b={a:a.a,b:a.b,p:a.Fp.ORDER,n:a.n,h:a.h,Gx:a.Gx,Gy:a.Gy},c=a.Fp,d=a.allowedPrivateKeyLengths?Array.from(new Set(a.allowedPrivateKeyLengths.map(a=>Math.ceil(a/2)))):void 0,e={Fp:c,Fn:pd(b.n,{BITS:a.nBitLength,allowedLengths:d,modFromBytes:a.wrapPrivateKey}),allowInfinityPoint:a.allowInfinityPoint,endo:a.endo,isTorsionFree:a.isTorsionFree,clearCofactor:a.clearCofactor,fromBytes:a.fromBytes,toBytes:a.toBytes},{CURVE:b,curveOpts:e}),h={hmac:a.hmac,randomBytes:a.randomBytes,lowS:a.lowS,bits2int:a.bits2int,bits2int_modN:a.bits2int_modN};return{CURVE:f,curveOpts:g,hash:a.hash,ecdsaOpts:h}}(a),g=function(a,b,c={}){mI(b),oS(c,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let d=c.randomBytes||m1,e=c.hmac||((a,...c)=>oB(b,a,m$(...c))),{Fp:f,Fn:g}=a,{ORDER:h,BITS:i}=g,{keygen:j,getPublicKey:k,getSharedSecret:l,utils:m,lengths:n}=function(a,b={}){let{Fn:c}=a,d=b.randomBytes||m1,e=Object.assign(pP(a.Fp,c),{seed:pf(c.ORDER)});function f(a){try{return!!pN(c,a)}catch{return!1}}function g(a=d(e.seed)){return function(a,b,c=!1){let d=a.length,e=pe(b),f=pf(b);if(d<16||d<f||d>1024)throw Error("expected "+f+"-1024 bytes of input, got "+d);let g=o2(c?oK(a):oJ(mV(a)),b-oV)+oV;return c?oM(g,e):oL(g,e)}(oH(a,e.seed,"seed"),c.ORDER)}function h(b,d=!0){return a.BASE.multiply(pN(c,b)).toBytes(d)}function i(b){if("bigint"==typeof b)return!1;if(b instanceof a)return!0;let{secretKey:d,publicKey:f,publicKeyUncompressed:g}=e;if(c.allowedLengths||d===f)return;let h=oN("key",b).length;return h===f||h===g}return Object.freeze({getPublicKey:h,getSharedSecret:function(b,d,e=!0){if(!0===i(b))throw Error("first arg must be private key");if(!1===i(d))throw Error("second arg must be public key");let f=pN(c,b);return a.fromHex(d).multiply(f).toBytes(e)},keygen:function(a){let b=g(a);return{secretKey:b,publicKey:h(b)}},Point:a,utils:{isValidSecretKey:f,isValidPublicKey:function(b,c){let{publicKey:d,publicKeyUncompressed:f}=e;try{let e=b.length;return(!0!==c||e===d)&&(!1!==c||e===f)&&!!a.fromBytes(b)}catch{return!1}},randomSecretKey:g,isValidPrivateKey:f,randomPrivateKey:g,normPrivateKeyToScalar:a=>pN(c,a),precompute:(b=8,c=a.BASE)=>c.precompute(b,!1)},lengths:e})}(a,c),o={prehash:!1,lowS:"boolean"==typeof c.lowS&&c.lowS,format:void 0,extraEntropy:!1},p="compact";function q(a,b){if(!g.isValidNot0(b))throw Error(`invalid signature ${a}: out of range 1..Point.Fn.ORDER`);return b}class r{constructor(a,b,c){this.r=q("r",a),this.s=q("s",b),null!=c&&(this.recovery=c),Object.freeze(this)}static fromBytes(a,b=p){var c,d;let e,f;if(c=a,pF(d=b),f=n.signature,oH(c,"compact"===d?f:"recovered"===d?f+1:void 0,`${d} signature`),"der"===b){let{r:b,s:c}=pH.toSig(oH(a));return new r(b,c)}"recovered"===b&&(e=a[0],b="compact",a=a.subarray(1));let h=g.BYTES,i=a.subarray(0,h),j=a.subarray(h,2*h);return new r(g.fromBytes(i),g.fromBytes(j),e)}static fromHex(a,b){return this.fromBytes(mX(a),b)}addRecoveryBit(a){return new r(this.r,this.s,a)}recoverPublicKey(b){let c=f.ORDER,{r:d,s:e,recovery:i}=this;if(null==i||![0,1,2,3].includes(i))throw Error("recovery id invalid");if(h*pK<c&&i>1)throw Error("recovery id is ambiguous for h>1 curve");let j=2===i||3===i?d+h:d;if(!f.isValid(j))throw Error("recovery id 2 or 3 invalid");let k=f.toBytes(j),l=a.fromBytes(m$(pO((1&i)==0),k)),m=g.inv(j),n=t(oN("msgHash",b)),o=g.create(-n*m),p=g.create(e*m),q=a.BASE.multiplyUnsafe(o).add(l.multiplyUnsafe(p));if(q.is0())throw Error("point at infinify");return q.assertValidity(),q}hasHighS(){return this.s>h>>pJ}toBytes(a=p){if(pF(a),"der"===a)return mX(pH.hexFromSig(this));let b=g.toBytes(this.r),c=g.toBytes(this.s);if("recovered"===a){if(null==this.recovery)throw Error("recovery bit must be present");return m$(Uint8Array.of(this.recovery),b,c)}return m$(b,c)}toHex(a){return mV(this.toBytes(a))}assertValidity(){}static fromCompact(a){return r.fromBytes(oN("sig",a),"compact")}static fromDER(a){return r.fromBytes(oN("sig",a),"der")}normalizeS(){return this.hasHighS()?new r(this.r,g.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return mV(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return mV(this.toBytes("compact"))}}let s=c.bits2int||function(a){if(a.length>8192)throw Error("input is too large");let b=oJ(mV(a)),c=8*a.length-i;return c>0?b>>BigInt(c):b},t=c.bits2int_modN||function(a){return g.create(s(a))},u=oR(i);function v(a){return oP("num < 2^"+i,a,pI,u),g.toBytes(a)}function w(a,c){return oH(a,void 0,"message"),c?oH(b(a),void 0,"prehashed message"):a}return Object.freeze({keygen:j,getPublicKey:k,getSharedSecret:l,utils:m,lengths:n,Point:a,sign:function(c,f,i={}){let{seed:j,k2sig:k}=function(b,c,e){if(["recovered","canonical"].some(a=>a in e))throw Error("sign() legacy options not supported");let{lowS:f,prehash:i,extraEntropy:j}=pG(e,o),k=t(b=w(b,i)),l=pN(g,c),m=[v(l),v(k)];if(null!=j&&!1!==j){let a=!0===j?d(n.secretKey):j;m.push(oN("extraEntropy",a))}return{seed:m$(...m),k2sig:function(b){let c=s(b);if(!g.isValidNot0(c))return;let d=g.inv(c),e=a.BASE.multiply(c).toAffine(),i=g.create(e.x);if(i===pI)return;let j=g.create(d*g.create(k+i*l));if(j===pI)return;let m=2*(e.x!==i)|Number(e.y&pJ),n=j;return f&&j>h>>pJ&&(n=g.neg(j),m^=1),new r(i,n,m)}}}(c=oN("message",c),f,i);return(function(a,b,c){if("number"!=typeof a||a<2)throw Error("hashLen must be a number");if("number"!=typeof b||b<2)throw Error("qByteLen must be a number");if("function"!=typeof c)throw Error("hmacFn must be a function");let d=a=>new Uint8Array(a),e=d(a),f=d(a),g=0,h=()=>{e.fill(1),f.fill(0),g=0},i=(...a)=>c(f,e,...a),j=(a=d(0))=>{f=i(Uint8Array.of(0),a),e=i(),0!==a.length&&(f=i(Uint8Array.of(1),a),e=i())},k=()=>{if(g++>=1e3)throw Error("drbg: tried 1000 values");let a=0,c=[];for(;a<b;){let b=(e=i()).slice();c.push(b),a+=e.length}return m$(...c)};return(a,b)=>{let c;for(h(),j(a);!(c=b(k()));)j();return h(),c}})(b.outputLen,g.BYTES,e)(j,k)},verify:function(b,c,d,e={}){let{lowS:f,prehash:h,format:i}=pG(e,o);if(d=oN("publicKey",d),c=w(oN("message",c),h),"strict"in e)throw Error("options.strict was renamed to lowS");let j=void 0===i?function(a){let b,c="string"==typeof a||mF(a),d=!c&&null!==a&&"object"==typeof a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!c&&!d)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(d)b=new r(a.r,a.s);else if(c){try{b=r.fromBytes(oN("sig",a),"der")}catch(a){if(!(a instanceof pH.Err))throw a}if(!b)try{b=r.fromBytes(oN("sig",a),"compact")}catch{return!1}}return b||!1}(b):r.fromBytes(oN("sig",b),i);if(!1===j)return!1;try{let b=a.fromBytes(d);if(f&&j.hasHighS())return!1;let{r:e,s:h}=j,i=t(c),k=g.inv(h),l=g.create(i*k),m=g.create(e*k),n=a.BASE.multiplyUnsafe(l).add(b.multiplyUnsafe(m));return!n.is0()&&g.create(n.x)===e}catch{return!1}},recoverPublicKey:function(a,b,c={}){let{prehash:d}=pG(c,o);return b=w(b,d),r.fromBytes(a,"recovered").recoverPublicKey(b).toBytes()},Signature:r,hash:b})}(function(a,b={}){let c=function(a,b,c={},d){if(void 0===d&&(d="edwards"===a),!b||"object"!=typeof b)throw Error(`expected valid ${a} CURVE object`);for(let a of["p","n","h"]){let c=b[a];if(!("bigint"==typeof c&&c>pg))throw Error(`CURVE.${a} must be positive bigint`)}let e=ps(b.p,c.Fp,d),f=ps(b.n,c.Fn,d);for(let c of["Gx","Gy","a","weierstrass"===a?"b":"d"])if(!e.isValid(b[c]))throw Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return{CURVE:b=Object.freeze(Object.assign({},b)),Fp:e,Fn:f}}("weierstrass",a,b),{Fp:d,Fn:e}=c,f=c.CURVE,{h:g,n:h}=f;oS(b,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:i}=b;if(i&&(!d.is0(f.a)||"bigint"!=typeof i.beta||!Array.isArray(i.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let j=pP(d,e);function k(){if(!d.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let l=b.toBytes||function(a,b,c){let{x:e,y:f}=b.toAffine(),g=d.toBytes(e);return(oG(c,"isCompressed"),c)?(k(),m$(pO(!d.isOdd(f)),g)):m$(Uint8Array.of(4),g,d.toBytes(f))},m=b.fromBytes||function(a){oH(a,void 0,"Point");let{publicKey:b,publicKeyUncompressed:c}=j,e=a.length,f=a[0],g=a.subarray(1);if(e===b&&(2===f||3===f)){let a,b=d.fromBytes(g);if(!d.isValid(b))throw Error("bad point: is not on curve, wrong x");let c=n(b);try{a=d.sqrt(c)}catch(a){throw Error("bad point: is not on curve, sqrt error"+(a instanceof Error?": "+a.message:""))}return k(),(1&f)==1!==d.isOdd(a)&&(a=d.neg(a)),{x:b,y:a}}if(e===c&&4===f){let a=d.BYTES,b=d.fromBytes(g.subarray(0,a)),c=d.fromBytes(g.subarray(a,2*a));if(!o(b,c))throw Error("bad point: is not on curve");return{x:b,y:c}}throw Error(`bad point: got length ${e}, expected compressed=${b} or uncompressed=${c}`)};function n(a){let b=d.sqr(a),c=d.mul(b,a);return d.add(d.add(c,d.mul(a,f.a)),f.b)}function o(a,b){let c=d.sqr(b),e=n(a);return d.eql(c,e)}if(!o(f.Gx,f.Gy))throw Error("bad curve params: generator point");let p=d.mul(d.pow(f.a,pL),pM),q=d.mul(d.sqr(f.b),BigInt(27));if(d.is0(d.add(p,q)))throw Error("bad curve params: a or b");function r(a,b,c=!1){if(!d.isValid(b)||c&&d.is0(b))throw Error(`bad point coordinate ${a}`);return b}function s(a){if(!(a instanceof x))throw Error("ProjectivePoint expected")}function t(a){if(!i||!i.basises)throw Error("no endo");return function(a,b,c){let[[d,e],[f,g]]=b,h=pE(g*a,c),i=pE(-e*a,c),j=a-h*d-i*f,k=-h*e-i*g,l=j<pI,m=k<pI;l&&(j=-j),m&&(k=-k);let n=oR(Math.ceil(oQ(c)/2))+pJ;if(j<pI||j>=n||k<pI||k>=n)throw Error("splitScalar (endomorphism): failed, k="+a);return{k1neg:l,k1:j,k2neg:m,k2:k}}(a,i.basises,e.ORDER)}let u=oT((a,b)=>{let{X:c,Y:e,Z:f}=a;if(d.eql(f,d.ONE))return{x:c,y:e};let g=a.is0();null==b&&(b=g?d.ONE:d.inv(f));let h=d.mul(c,b),i=d.mul(e,b),j=d.mul(f,b);if(g)return{x:d.ZERO,y:d.ZERO};if(!d.eql(j,d.ONE))throw Error("invZ was invalid");return{x:h,y:i}}),v=oT(a=>{if(a.is0()){if(b.allowInfinityPoint&&!d.is0(a.Y))return;throw Error("bad point: ZERO")}let{x:c,y:e}=a.toAffine();if(!d.isValid(c)||!d.isValid(e))throw Error("bad point: x or y not field elements");if(!o(c,e))throw Error("bad point: equation left != right");if(!a.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function w(a,b,c,e,f){return c=new x(d.mul(c.X,a),c.Y,c.Z),b=pi(e,b),c=pi(f,c),b.add(c)}class x{constructor(a,b,c){this.X=r("x",a),this.Y=r("y",b,!0),this.Z=r("z",c),Object.freeze(this)}static CURVE(){return f}static fromAffine(a){let{x:b,y:c}=a||{};if(!a||!d.isValid(b)||!d.isValid(c))throw Error("invalid affine point");if(a instanceof x)throw Error("projective point not allowed");return d.is0(b)&&d.is0(c)?x.ZERO:new x(b,c,d.ONE)}static fromBytes(a){let b=x.fromAffine(m(oH(a,void 0,"point")));return b.assertValidity(),b}static fromHex(a){return x.fromBytes(oN("pointHex",a))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(a=8,b=!0){return z.createCache(this,a),b||this.multiply(pL),this}assertValidity(){v(this)}hasEvenY(){let{y:a}=this.toAffine();if(!d.isOdd)throw Error("Field doesn't support isOdd");return!d.isOdd(a)}equals(a){s(a);let{X:b,Y:c,Z:e}=this,{X:f,Y:g,Z:h}=a,i=d.eql(d.mul(b,h),d.mul(f,e)),j=d.eql(d.mul(c,h),d.mul(g,e));return i&&j}negate(){return new x(this.X,d.neg(this.Y),this.Z)}double(){let{a:a,b}=f,c=d.mul(b,pL),{X:e,Y:g,Z:h}=this,i=d.ZERO,j=d.ZERO,k=d.ZERO,l=d.mul(e,e),m=d.mul(g,g),n=d.mul(h,h),o=d.mul(e,g);return o=d.add(o,o),k=d.mul(e,h),k=d.add(k,k),i=d.mul(a,k),j=d.mul(c,n),j=d.add(i,j),i=d.sub(m,j),j=d.add(m,j),j=d.mul(i,j),i=d.mul(o,i),k=d.mul(c,k),n=d.mul(a,n),o=d.sub(l,n),o=d.mul(a,o),o=d.add(o,k),k=d.add(l,l),l=d.add(k,l),l=d.add(l,n),l=d.mul(l,o),j=d.add(j,l),n=d.mul(g,h),n=d.add(n,n),l=d.mul(n,o),i=d.sub(i,l),k=d.mul(n,m),k=d.add(k,k),new x(i,j,k=d.add(k,k))}add(a){s(a);let{X:b,Y:c,Z:e}=this,{X:g,Y:h,Z:i}=a,j=d.ZERO,k=d.ZERO,l=d.ZERO,m=f.a,n=d.mul(f.b,pL),o=d.mul(b,g),p=d.mul(c,h),q=d.mul(e,i),r=d.add(b,c),t=d.add(g,h);r=d.mul(r,t),t=d.add(o,p),r=d.sub(r,t),t=d.add(b,e);let u=d.add(g,i);return t=d.mul(t,u),u=d.add(o,q),t=d.sub(t,u),u=d.add(c,e),j=d.add(h,i),u=d.mul(u,j),j=d.add(p,q),u=d.sub(u,j),l=d.mul(m,t),j=d.mul(n,q),l=d.add(j,l),j=d.sub(p,l),l=d.add(p,l),k=d.mul(j,l),p=d.add(o,o),p=d.add(p,o),q=d.mul(m,q),t=d.mul(n,t),p=d.add(p,q),q=d.sub(o,q),q=d.mul(m,q),t=d.add(t,q),o=d.mul(p,t),k=d.add(k,o),o=d.mul(u,t),j=d.mul(r,j),j=d.sub(j,o),o=d.mul(r,p),l=d.mul(u,l),new x(j,k,l=d.add(l,o))}subtract(a){return this.add(a.negate())}is0(){return this.equals(x.ZERO)}multiply(a){let c,d,{endo:f}=b;if(!e.isValidNot0(a))throw Error("invalid scalar: out of range");let g=a=>z.cached(this,a,a=>pj(x,a));if(f){let{k1neg:b,k1:e,k2neg:h,k2:i}=t(a),{p:j,f:k}=g(e),{p:l,f:m}=g(i);d=k.add(m),c=w(f.beta,j,l,b,h)}else{let{p:b,f:e}=g(a);c=b,d=e}return pj(x,[c,d])[0]}multiplyUnsafe(a){let{endo:c}=b;if(!e.isValid(a))throw Error("invalid scalar: out of range");if(a===pI||this.is0())return x.ZERO;if(a===pJ)return this;if(z.hasCache(this))return this.multiply(a);if(!c)return z.unsafe(this,a);{let{k1neg:b,k1:d,k2neg:e,k2:f}=t(a),{p1:g,p2:h}=function(a,b,c,d){let e=b,f=a.ZERO,g=a.ZERO;for(;c>pg||d>pg;)c&ph&&(f=f.add(e)),d&ph&&(g=g.add(e)),e=e.double(),c>>=ph,d>>=ph;return{p1:f,p2:g}}(x,this,d,f);return w(c.beta,g,h,b,e)}}multiplyAndAddUnsafe(a,b,c){let d=this.multiplyUnsafe(b).add(a.multiplyUnsafe(c));return d.is0()?void 0:d}toAffine(a){return u(this,a)}isTorsionFree(){let{isTorsionFree:a}=b;return g===pJ||(a?a(x,this):z.unsafe(this,h).is0())}clearCofactor(){let{clearCofactor:a}=b;return g===pJ?this:a?a(x,this):this.multiplyUnsafe(g)}isSmallOrder(){return this.multiplyUnsafe(g).is0()}toBytes(a=!0){return oG(a,"isCompressed"),this.assertValidity(),l(x,this,a)}toHex(a=!0){return mV(this.toBytes(a))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(a=!0){return this.toBytes(a)}_setWindowSize(a){this.precompute(a)}static normalizeZ(a){return pj(x,a)}static msm(a,b){return function(a,b,c,d){(function(a,b){if(!Array.isArray(a))throw Error("array expected");a.forEach((a,c)=>{if(!(a instanceof b))throw Error("invalid point at index "+c)})})(c,a),function(a,b){if(!Array.isArray(a))throw Error("array of scalars expected");a.forEach((a,c)=>{if(!b.isValid(a))throw Error("invalid scalar at index "+c)})}(d,b);let e=c.length,f=d.length;if(e!==f)throw Error("arrays of points and scalars must have equal length");let g=a.ZERO,h=oQ(BigInt(e)),i=1;h>12?i=h-3:h>4?i=h-2:h>0&&(i=2);let j=oR(i),k=Array(Number(j)+1).fill(g),l=Math.floor((b.BITS-1)/i)*i,m=g;for(let a=l;a>=0;a-=i){k.fill(g);for(let b=0;b<f;b++){let e=Number(d[b]>>BigInt(a)&j);k[e]=k[e].add(c[b])}let b=g;for(let a=k.length-1,c=g;a>0;a--)c=c.add(k[a]),b=b.add(c);if(m=m.add(b),0!==a)for(let a=0;a<i;a++)m=m.double()}return m}(x,e,a,b)}static fromPrivateKey(a){return x.BASE.multiply(pN(e,a))}}x.BASE=new x(f.Gx,f.Gy,d.ONE),x.ZERO=new x(d.ZERO,d.ONE,d.ZERO),x.Fp=d,x.Fn=e;let y=e.BITS,z=new pr(x,b.endo?Math.ceil(y/2):y);return x.BASE.precompute(8),x}(c,d),e,f);return b=g.Point,Object.assign({},g,{ProjectivePoint:b,CURVE:Object.assign({},a,pc(b.Fn.ORDER,b.Fn.BITS))})})({...a,hash:b});return{...c(b),create:c}}let pR={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},pS={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},pT={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},pU=pd(pR.p),pV=pd(pS.p),pW=pd(pT.p),pX=pQ({...pR,Fp:pU,lowS:!1},ny);pQ({...pS,Fp:pV,lowS:!1},nA),pQ({...pT,Fp:pW,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},nz);let pY="base10",pZ="base16",p$="base64pad",p_="base64url",p0="utf8";function p1(){let a=m1(32);return(0,lo.toString)(a,pZ)}function p2(a){let b=ny((0,lp.fromString)(a,pZ));return(0,lo.toString)(b,pZ)}function p3(a){let b=ny((0,lp.fromString)(a,p0));return(0,lo.toString)(b,pZ)}function p4(a){return(0,lp.fromString)(`${a}`,pY)}function p5(a){return Number((0,lo.toString)(a,pY))}function p6(a){return a.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function p7(a){let b=a.replace(/-/g,"+").replace(/_/g,"/"),c=(4-b.length%4)%4;return b+"=".repeat(c)}function p8(a){if(2===p5(a.type))return(0,lo.toString)((0,lq.concat)([a.type,a.sealed]),p$);if(1===p5(a.type)){if(typeof a.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return(0,lo.toString)((0,lq.concat)([a.type,a.senderPublicKey,a.iv,a.sealed]),p$)}return(0,lo.toString)((0,lq.concat)([a.type,a.iv,a.sealed]),p$)}function p9(a){let b=(a.encoding||p$)===p_?p7(a.encoded):a.encoded,c=(0,lp.fromString)(b,p$),d=c.slice(0,1);if(1===p5(d)){let a=c.slice(1,33),b=c.slice(33,45);return{type:d,sealed:c.slice(45),iv:b,senderPublicKey:a}}if(2===p5(d))return{type:d,sealed:c.slice(1),iv:m1(12)};let e=c.slice(1,13);return{type:d,sealed:c.slice(13),iv:e}}function qa(a){let b=a?.type||0;if(1===b){if(typeof a?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof a?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:b,senderPublicKey:a?.senderPublicKey,receiverPublicKey:a?.receiverPublicKey}}function qb(a){return 1===a.type&&"string"==typeof a.senderPublicKey&&"string"==typeof a.receiverPublicKey}function qc(a){return a?.relay||{protocol:"irn"}}function qd(a){let b=lr.RELAY_JSONRPC[a];if(typeof b>"u")throw Error(`Relay Protocol not supported: ${a}`);return b}var qe=Object.defineProperty,qf=Object.defineProperties,qg=Object.getOwnPropertyDescriptors,qh=Object.getOwnPropertySymbols,qi=Object.prototype.hasOwnProperty,qj=Object.prototype.propertyIsEnumerable,qk=(a,b,c)=>b in a?qe(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,ql=(a,b)=>{for(var c in b||(b={}))qi.call(b,c)&&qk(a,c,b[c]);if(qh)for(var c of qh(b))qj.call(b,c)&&qk(a,c,b[c]);return a};function qm(a){var b;if(!a.includes("wc:")){let b=ml(a);null!=b&&b.includes("wc:")&&(a=b)}let c=(a=(a=a.includes("wc://")?a.replace("wc://",""):a).includes("wc:")?a.replace("wc:",""):a).indexOf(":"),d=-1!==a.indexOf("?")?a.indexOf("?"):void 0,e=a.substring(0,c),f=a.substring(c+1,d).split("@"),g=Object.fromEntries(new URLSearchParams("u">typeof d?a.substring(d):"").entries()),h="string"==typeof g.methods?g.methods.split(","):void 0;return{protocol:e,topic:(b=f[0]).startsWith("//")?b.substring(2):b,version:parseInt(f[1],10),symKey:g.symKey,relay:function(a,b="-"){let c={},d="relay"+b;return Object.keys(a).forEach(b=>{if(b.startsWith(d)){let e=b.replace(d,""),f=a[b];c[e]=f}}),c}(g),methods:h,expiryTimestamp:g.expiryTimestamp?parseInt(g.expiryTimestamp,10):void 0}}function qn(a){let b=new URLSearchParams;return Object.entries(ql(ql(qf(ql({},function(a,b="-"){let c={};return Object.keys(a).forEach(d=>{a[d]&&(c["relay"+b+d]=a[d])}),c}(a.relay)),qg({symKey:a.symKey})),a.expiryTimestamp&&{expiryTimestamp:a.expiryTimestamp.toString()}),a.methods&&{methods:a.methods.join(",")})).sort(([a],[b])=>a.localeCompare(b)).forEach(([a,c])=>{void 0!==c&&b.append(a,String(c))}),`${a.protocol}:${a.topic}@${a.version}?${b}`}function qo(a,b,c){return`${a}?wc_ev=${c}&topic=${b}`}var qp=Object.defineProperty,qq=Object.defineProperties,qr=Object.getOwnPropertyDescriptors,qs=Object.getOwnPropertySymbols,qt=Object.prototype.hasOwnProperty,qu=Object.prototype.propertyIsEnumerable,qv=(a,b,c)=>b in a?qp(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,qw=(a,b)=>{for(var c in b||(b={}))qt.call(b,c)&&qv(a,c,b[c]);if(qs)for(var c of qs(b))qu.call(b,c)&&qv(a,c,b[c]);return a},qx=(a,b)=>qq(a,qr(b));function qy(a){let b=[];return a.forEach(a=>{let[c,d]=a.split(":");b.push(`${c}:${d}`)}),b}function qz(a){return a.includes(":")}function qA(a){return qz(a)?a.split(":")[0]:a}function qB(a){var b,c,d;let e={};if(!qI(a))return e;for(let[f,g]of Object.entries(a)){let a=qz(f)?[f]:g.chains,h=g.methods||[],i=g.events||[],j=qA(f);e[j]=qx(qw({},e[j]),{chains:mf(a,null==(b=e[j])?void 0:b.chains),methods:mf(h,null==(c=e[j])?void 0:c.methods),events:mf(i,null==(d=e[j])?void 0:d.events)})}return e}function qC(a,b){var c;let d,e=(c=b=b.map(a=>a.replace("did:pkh:","")),d={},c?.forEach(a=>{var b;let[c,e]=a.split(":");d[c]||(d[c]={accounts:[],chains:[],events:[],methods:[]}),d[c].accounts.push(a),null==(b=d[c].chains)||b.push(`${c}:${e}`)}),d);for(let[b,c]of Object.entries(e))c.methods?c.methods=mf(c.methods,a):c.methods=a,c.events=["chainChanged","accountsChanged"];return e}let qD={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},qE={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function qF(a,b){let{message:c,code:d}=qE[a];return{message:b?`${c} ${b}`:c,code:d}}function qG(a,b){let{message:c,code:d}=qD[a];return{message:b?`${c} ${b}`:c,code:d}}function qH(a,b){return!!Array.isArray(a)&&(!("u">typeof b)||!a.length||a.every(b))}function qI(a){return Object.getPrototypeOf(a)===Object.prototype&&Object.keys(a).length}function qJ(a){return typeof a>"u"}function qK(a,b){return!!(b&&qJ(a))||"string"==typeof a&&!!a.trim().length}function qL(a,b){return!!(b&&qJ(a))||"number"==typeof a&&!isNaN(a)}function qM(a){return!!(qK(a,!1)&&a.includes(":"))&&2===a.split(":").length}function qN(a){let b=!0;return qH(a)?a.length&&(b=a.every(a=>qK(a,!1))):b=!1,b}function qO(a,b){let c=null;return Object.values(a).forEach(a=>{var d;let e;if(c)return;let f=(d=`${b}, namespace`,e=null,qN(a?.methods)?qN(a?.events)||(e=qG("UNSUPPORTED_EVENTS",`${d}, events should be an array of strings or empty array for no events`)):e=qG("UNSUPPORTED_METHODS",`${d}, methods should be an array of strings or empty array for no methods`),e);f&&(c=f)}),c}function qP(a,b){let c=null;if(a&&qI(a)){let d,e=qO(a,b);e&&(c=e);let f=(d=null,Object.values(a).forEach(a=>{var c,e;let f;if(d)return;let g=(c=a?.accounts,e=`${b} namespace`,f=null,qH(c)?c.forEach(a=>{f||function(a){if(qK(a,!1)&&a.includes(":")){let b=a.split(":");if(3===b.length){let a=b[0]+":"+b[1];return!!b[2]&&qM(a)}}return!1}(a)||(f=qG("UNSUPPORTED_ACCOUNTS",`${e}, account ${a} should be a string and conform to "namespace:chainId:address" format`))}):f=qG("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),f);g&&(d=g)}),d);f&&(c=f)}else c=qF("MISSING_OR_INVALID",`${b}, namespaces should be an object with data`);return c}function qQ(a){return qK(a.protocol,!0)}function qR(a){return"u">typeof a}function qS(a,b){let c;return!(!qM(b)||!(c=[],Object.values(a).forEach(a=>{c.push(...qy(a.accounts))}),c).includes(b))}function qT(a,b,c){var d,e;let f,g,h=null,i=(f={},Object.keys(d=a).forEach(a=>{var b;a.includes(":")?f[a]=d[a]:null==(b=d[a].chains)||b.forEach(b=>{f[b]={methods:d[a].methods,events:d[a].events}})}),f),j=(g={},Object.keys(e=b).forEach(a=>{if(a.includes(":"))g[a]=e[a];else{let b=qy(e[a].accounts);b?.forEach(b=>{g[b]={accounts:e[a].accounts.filter(a=>a.includes(`${b}:`)),methods:e[a].methods,events:e[a].events}})}}),g),k=Object.keys(i),l=Object.keys(j),m=qU(Object.keys(a)),n=qU(Object.keys(b)),o=m.filter(a=>!n.includes(a));return o.length&&(h=qF("NON_CONFORMING_NAMESPACES",`${c} namespaces keys don't satisfy requiredNamespaces.
      Required: ${o.toString()}
      Received: ${Object.keys(b).toString()}`)),l5(k,l)||(h=qF("NON_CONFORMING_NAMESPACES",`${c} namespaces chains don't satisfy required namespaces.
      Required: ${k.toString()}
      Approved: ${l.toString()}`)),Object.keys(b).forEach(a=>{if(!a.includes(":")||h)return;let d=qy(b[a].accounts);d.includes(a)||(h=qF("NON_CONFORMING_NAMESPACES",`${c} namespaces accounts don't satisfy namespace accounts for ${a}
        Required: ${a}
        Approved: ${d.toString()}`))}),k.forEach(a=>{h||(l5(i[a].methods,j[a].methods)?l5(i[a].events,j[a].events)||(h=qF("NON_CONFORMING_NAMESPACES",`${c} namespaces events don't satisfy namespace events for ${a}`)):h=qF("NON_CONFORMING_NAMESPACES",`${c} namespaces methods don't satisfy namespace methods for ${a}`))}),h}function qU(a){return[...new Set(a.map(a=>a.includes(":")?a.split(":")[0]:a))]}function qV(){let a=l1();return new Promise(b=>{switch(a){case lZ:b(l0()&&navigator?.onLine);break;case lX:b(qW());break;default:b(!0)}})}async function qW(){if(l_()&&null!=a.g&&a.g.NetInfo){let b=await (null==a.g?void 0:a.g.NetInfo.fetch());return b?.isConnected}return!0}let qX={};class qY{static get(a){return qX[a]}static set(a,b){qX[a]=b}static delete(a){delete qX[a]}}function qZ(a){return new Uint8Array(a.replace(/^0x/,"").match(/.{1,2}/g).map(a=>parseInt(a,16)))}function q$({logger:a,name:b}){var c,d;let e,f="string"==typeof a?("u">typeof(c={opts:{level:a,name:b}}).loggerOverride&&"string"!=typeof c.loggerOverride?{logger:c.loggerOverride,chunkLoggerController:null}:(e=new lD(null==(d=c.opts)?void 0:d.level,c.maxSizeInBytes),{logger:(0,lt.default)(lF(((a,b)=>{for(var c in b||(b={}))lI.call(b,c)&&lK(a,c,b[c]);if(lH)for(var c of lH(b))lJ.call(b,c)&&lK(a,c,b[c]);return a})({},c.opts),lG({level:"trace"})),e),chunkLoggerController:e})).logger:a;return f.level="string"==typeof a?a:a.level,f}var q_=a.i(241958),q0=a.i(996840),q1=a.i(486249);let q2="custom_context";var q3=Object.defineProperty,q4=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?q3(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class q5{constructor(a){q4(this,"nodeValue"),q4(this,"sizeInBytes"),q4(this,"next"),this.nodeValue=a,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class q6{constructor(a){q4(this,"lengthInNodes"),q4(this,"sizeInBytes"),q4(this,"head"),q4(this,"tail"),q4(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=a,this.sizeInBytes=0}append(a){let b=new q5(a);if(b.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${a} with size ${b.size}`);for(;this.size+b.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=b):this.head=b,this.tail=b,this.lengthInNodes++,this.sizeInBytes+=b.size}shift(){if(!this.head)return;let a=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=a.size}toArray(){let a=[],b=this.head;for(;null!==b;)a.push(b.value),b=b.next;return a}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let a=this.head;return{next:()=>{if(!a)return{done:!0,value:null};let b=a.value;return a=a.next,{done:!1,value:b}}}}}var q7=Object.defineProperty,q8=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?q7(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class q9{constructor(a,b=1024e3){q8(this,"logs"),q8(this,"level"),q8(this,"levelValue"),q8(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=a??"error",this.levelValue=q1.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=b,this.logs=new q6(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(a,b){b===q1.levels.values.error?console.error(a):b===q1.levels.values.warn?console.warn(a):b===q1.levels.values.debug?console.debug(a):b===q1.levels.values.trace?console.trace(a):console.log(a)}appendToLogs(a){this.logs.append((0,lu.safeJsonStringify)({timestamp:new Date().toISOString(),log:a}));let b="string"==typeof a?JSON.parse(a).level:a.level;b>=this.levelValue&&this.forwardToConsole(a,b)}getLogs(){return this.logs}clearLogs(){this.logs=new q6(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(a){let b=this.getLogArray();return b.push((0,lu.safeJsonStringify)({extraMetadata:a})),new Blob(b,{type:"application/json"})}}var ra=Object.defineProperty;class rb{constructor(a,b=1024e3){((a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?ra(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c})(this,"baseChunkLogger"),this.baseChunkLogger=new q9(a,b)}write(a){this.baseChunkLogger.appendToLogs(a)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(a){return this.baseChunkLogger.logsToBlob(a)}}var rc=Object.defineProperty,rd=Object.defineProperties,re=Object.getOwnPropertyDescriptors,rf=Object.getOwnPropertySymbols,rg=Object.prototype.hasOwnProperty,rh=Object.prototype.propertyIsEnumerable,ri=(a,b,c)=>b in a?rc(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,rj=(a,b)=>{for(var c in b||(b={}))rg.call(b,c)&&ri(a,c,b[c]);if(rf)for(var c of rf(b))rh.call(b,c)&&ri(a,c,b[c]);return a};function rk(a,b=q2){return a[b]||""}function rl(a,b,c=q2){let d=function(a,b,c=q2){let d=rk(a,c);return d.trim()?`${d}/${b}`:b}(a,b,c);return function(a,b,c=q2){return a[c]=b,a}(a.child({context:d}),d,c)}a.i(157938);var rm=a.i(693172),rn=Object.defineProperty,ro=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?rn(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class rp extends rm.IEvents{constructor(a){super(),this.opts=a,ro(this,"protocol","wc"),ro(this,"version",2)}}var rq=Object.defineProperty;class rr extends rm.IEvents{constructor(a,b){super(),this.core=a,this.logger=b,((a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?rq(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c})(this,"records",new Map)}}class rs{constructor(a,b){this.logger=a,this.core=b}}class rt extends rm.IEvents{constructor(a,b){super(),this.relayer=a,this.logger=b}}class ru extends rm.IEvents{constructor(a){super()}}class rv{constructor(a,b,c,d){this.core=a,this.logger=b,this.name=c}}class rw extends rm.IEvents{constructor(a,b){super(),this.relayer=a,this.logger=b}}class rx extends rm.IEvents{constructor(a,b){super(),this.core=a,this.logger=b}}class ry{constructor(a,b,c){this.core=a,this.logger=b,this.store=c}}class rz{constructor(a,b){this.projectId=a,this.logger=b}}class rA{constructor(a,b,c){this.core=a,this.logger=b,this.telemetryEnabled=c}}var rB=Object.defineProperty,rC=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?rB(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};cf.default;class rD{constructor(a){this.opts=a,rC(this,"protocol","wc"),rC(this,"version",2)}}cf.EventEmitter;class rE{constructor(a){this.client=a}}var rF=a.i(271137);a.i(258910);var rG=a.i(499963),rH=a.i(517992),rI=a.i(901631);let rJ="core",rK=`wc@2:${rJ}:`,rL={database:":memory:"},rM="client_ed25519_seed",rN=iQ.ONE_DAY,rO=iQ.SIX_HOURS,rP="wss://relay.walletconnect.org",rQ="relayer_message",rR="relayer_message_ack",rS="relayer_connection_stalled",rT="relayer_publish",rU="payload",rV="connect",rW="disconnect",rX="error",rY="2.22.4",rZ="link_mode",r$="relay",r_="inbound",r0="WALLETCONNECT_LINK_MODE_APPS",r1="subscription_created",r2="subscription_deleted",r3=(iQ.THIRTY_DAYS,iQ.FIVE_SECONDS,iQ.THIRTY_DAYS,{wc_pairingDelete:{req:{ttl:iQ.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:iQ.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:iQ.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:iQ.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:iQ.ONE_DAY,prompt:!1,tag:0},res:{ttl:iQ.ONE_DAY,prompt:!1,tag:0}}}),r4="pairing_create",r5="pairing_delete",r6="history_created",r7="history_updated",r8="history_deleted",r9="expirer_created",sa="expirer_deleted",sb="expirer_expired",sc=(iQ.ONE_DAY,"https://verify.walletconnect.org"),sd=`${sc}/v3`,se=["https://verify.walletconnect.com",sc],sf="malformed_pairing_uri",sg="session_approve_started";var sh=function(a,b){if(a.length>=255)throw TypeError("Alphabet too long");for(var c=new Uint8Array(256),d=0;d<c.length;d++)c[d]=255;for(var e=0;e<a.length;e++){var f=a.charAt(e),g=f.charCodeAt(0);if(255!==c[g])throw TypeError(f+" is ambiguous");c[g]=e}var h=a.length,i=a.charAt(0),j=Math.log(h)/Math.log(256),k=Math.log(256)/Math.log(h);function l(a){if("string"!=typeof a)throw TypeError("Expected String");if(0===a.length)return new Uint8Array;var b=0;if(" "!==a[0]){for(var d=0,e=0;a[b]===i;)d++,b++;for(var f=(a.length-b)*j+1>>>0,g=new Uint8Array(f);a[b];){var k=c[a.charCodeAt(b)];if(255===k)return;for(var l=0,m=f-1;(0!==k||l<e)&&-1!==m;m--,l++)k+=h*g[m]>>>0,g[m]=k%256>>>0,k=k/256>>>0;if(0!==k)throw Error("Non-zero carry");e=l,b++}if(" "!==a[b]){for(var n=f-e;n!==f&&0===g[n];)n++;for(var o=new Uint8Array(d+(f-n)),p=d;n!==f;)o[p++]=g[n++];return o}}}return{encode:function(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===b.length)return"";for(var c=0,d=0,e=0,f=b.length;e!==f&&0===b[e];)e++,c++;for(var g=(f-e)*k+1>>>0,j=new Uint8Array(g);e!==f;){for(var l=b[e],m=0,n=g-1;(0!==l||m<d)&&-1!==n;n--,m++)l+=256*j[n]>>>0,j[n]=l%h>>>0,l=l/h>>>0;if(0!==l)throw Error("Non-zero carry");d=m,e++}for(var o=g-d;o!==g&&0===j[o];)o++;for(var p=i.repeat(c);o<g;++o)p+=a.charAt(j[o]);return p},decodeUnsafe:l,decode:function(a){var c=l(a);if(c)return c;throw Error(`Non-${b} character`)}}};let si=a=>{if(a instanceof Uint8Array&&"Uint8Array"===a.constructor.name)return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw Error("Unknown type, must be binary type")};class sj{constructor(a,b,c){this.name=a,this.prefix=b,this.baseEncode=c}encode(a){if(a instanceof Uint8Array)return`${this.prefix}${this.baseEncode(a)}`;throw Error("Unknown type, must be binary type")}}class sk{constructor(a,b,c){if(this.name=a,this.prefix=b,void 0===b.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=b.codePointAt(0),this.baseDecode=c}decode(a){if("string"==typeof a){if(a.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(a)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(a.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(a){return sm(this,a)}}class sl{constructor(a){this.decoders=a}or(a){return sm(this,a)}decode(a){let b=a[0],c=this.decoders[b];if(c)return c.decode(a);throw RangeError(`Unable to decode multibase string ${JSON.stringify(a)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let sm=(a,b)=>new sl({...a.decoders||{[a.prefix]:a},...b.decoders||{[b.prefix]:b}});class sn{constructor(a,b,c,d){this.name=a,this.prefix=b,this.baseEncode=c,this.baseDecode=d,this.encoder=new sj(a,b,c),this.decoder=new sk(a,b,d)}encode(a){return this.encoder.encode(a)}decode(a){return this.decoder.decode(a)}}let so=({name:a,prefix:b,encode:c,decode:d})=>new sn(a,b,c,d),sp=({prefix:a,name:b,alphabet:c})=>{let{encode:d,decode:e}=sh(c,b);return so({prefix:a,name:b,encode:d,decode:a=>si(e(a))})},sq=({name:a,prefix:b,bitsPerChar:c,alphabet:d})=>so({prefix:b,name:a,encode:a=>((a,b,c)=>{let d="="===b[b.length-1],e=(1<<c)-1,f="",g=0,h=0;for(let d=0;d<a.length;++d)for(h=h<<8|a[d],g+=8;g>c;)g-=c,f+=b[e&h>>g];if(g&&(f+=b[e&h<<c-g]),d)for(;f.length*c&7;)f+="=";return f})(a,d,c),decode:b=>((a,b,c,d)=>{let e={};for(let a=0;a<b.length;++a)e[b[a]]=a;let f=a.length;for(;"="===a[f-1];)--f;let g=new Uint8Array(f*c/8|0),h=0,i=0,j=0;for(let b=0;b<f;++b){let f=e[a[b]];if(void 0===f)throw SyntaxError(`Non-${d} character`);i=i<<c|f,(h+=c)>=8&&(h-=8,g[j++]=255&i>>h)}if(h>=c||255&i<<8-h)throw SyntaxError("Unexpected end of data");return g})(b,d,c,a)});var sr=Object.freeze({__proto__:null,identity:so({prefix:"\0",name:"identity",encode:a=>new TextDecoder().decode(a),decode:a=>new TextEncoder().encode(a)})}),ss=Object.freeze({__proto__:null,base2:sq({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),st=Object.freeze({__proto__:null,base8:sq({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),su=Object.freeze({__proto__:null,base10:sp({prefix:"9",name:"base10",alphabet:"0123456789"})}),sv=Object.freeze({__proto__:null,base16:sq({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:sq({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})}),sw=Object.freeze({__proto__:null,base32:sq({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper:sq({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad:sq({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper:sq({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex:sq({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper:sq({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad:sq({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper:sq({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:sq({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),sx=Object.freeze({__proto__:null,base36:sp({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:sp({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),sy=Object.freeze({__proto__:null,base58btc:sp({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:sp({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})}),sz=Object.freeze({__proto__:null,base64:sq({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad:sq({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url:sq({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:sq({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let sA=Array.from(""),sB=sA.reduce((a,b,c)=>(a[c]=b,a),[]),sC=sA.reduce((a,b,c)=>(a[b.codePointAt(0)]=c,a),[]);var sD=Object.freeze({__proto__:null,base256emoji:so({prefix:"",name:"base256emoji",encode:function(a){return a.reduce((a,b)=>a+=sB[b],"")},decode:function(a){let b=[];for(let c of a){let a=sC[c.codePointAt(0)];if(void 0===a)throw Error(`Non-base256emoji character: ${c}`);b.push(a)}return new Uint8Array(b)}})});function sE(a,b,c){b=b||[],c=c||0;for(var d=c;a>=0x80000000;)b[c++]=255&a|128,a/=128;for(;-128&a;)b[c++]=255&a|128,a>>>=7;return b[c]=0|a,sE.bytes=c-d+1,b}var sF=function(a){return a<128?1:a<16384?2:a<2097152?3:a<0x10000000?4:a<0x800000000?5:a<0x40000000000?6:a<0x2000000000000?7:a<0x100000000000000?8:a<0x8000000000000000?9:10};let sG=(a,b,c=0)=>(sE(a,b,c),b),sH=(a,b)=>{let c=b.byteLength,d=sF(a),e=d+sF(c),f=new Uint8Array(e+c);return sG(a,f,0),sG(c,f,d),f.set(b,e),new sI(a,c,b,f)};class sI{constructor(a,b,c,d){this.code=a,this.size=b,this.digest=c,this.bytes=d}}let sJ=({name:a,code:b,encode:c})=>new sK(a,b,c);class sK{constructor(a,b,c){this.name=a,this.code=b,this.encode=c}digest(a){if(a instanceof Uint8Array){let b=this.encode(a);return b instanceof Uint8Array?sH(this.code,b):b.then(a=>sH(this.code,a))}throw Error("Unknown type, must be binary type")}}let sL=a=>async b=>new Uint8Array(await crypto.subtle.digest(a,b));var sM=Object.freeze({__proto__:null,sha256:sJ({name:"sha2-256",code:18,encode:sL("SHA-256")}),sha512:sJ({name:"sha2-512",code:19,encode:sL("SHA-512")})}),sN=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:si,digest:a=>sH(0,si(a))}});new TextEncoder,new TextDecoder;let sO={...sr,...ss,...st,...su,...sv,...sw,...sx,...sy,...sz,...sD};function sP(a){return null!=globalThis.Buffer?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function sQ(a,b,c,d){return{name:a,prefix:b,encoder:{name:a,prefix:b,encode:c},decoder:{decode:d}}}({...sM,...sN});let sR=sQ("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),sS=sQ("ascii","a",a=>{let b="a";for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},a=>{let b=function(a=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?sP(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}((a=a.substring(1)).length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}),sT={utf8:sR,"utf-8":sR,hex:sO.base16,latin1:sS,ascii:sS,binary:sS,...sO};var sU=Object.defineProperty,sV=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?sU(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class sW{constructor(a,b){this.core=a,this.logger=b,sV(this,"keychain",new Map),sV(this,"name","keychain"),sV(this,"version","0.3"),sV(this,"initialized",!1),sV(this,"storagePrefix",rK),sV(this,"init",async()=>{if(!this.initialized){let a=await this.getKeyChain();"u">typeof a&&(this.keychain=a),this.initialized=!0}}),sV(this,"has",a=>(this.isInitialized(),this.keychain.has(a))),sV(this,"set",async(a,b)=>{this.isInitialized(),this.keychain.set(a,b),await this.persist()}),sV(this,"get",a=>{this.isInitialized();let b=this.keychain.get(a);if(typeof b>"u"){let{message:b}=qF("NO_MATCHING_KEY",`${this.name}: ${a}`);throw Error(b)}return b}),sV(this,"del",async a=>{this.isInitialized(),this.keychain.delete(a),await this.persist()}),this.core=a,this.logger=rl(b,this.name)}get context(){return rk(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(a){await this.core.storage.setItem(this.storageKey,l6(a))}async getKeyChain(){let a=await this.core.storage.getItem(this.storageKey);return"u">typeof a?l7(a):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:a}=qF("NOT_INITIALIZED",this.name);throw Error(a)}}}var sX=Object.defineProperty,sY=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?sX(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class sZ{constructor(a,b,c){this.core=a,this.logger=b,sY(this,"name","crypto"),sY(this,"keychain"),sY(this,"randomSessionIdentifier",p1()),sY(this,"initialized",!1),sY(this,"clientId"),sY(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),sY(this,"hasKeys",a=>(this.isInitialized(),this.keychain.has(a))),sY(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;let a=await this.getClientSeed(),b=ln.generateKeyPair(a),c=ln.encodeIss(b.publicKey);return this.clientId=c,c}),sY(this,"generateKeyPair",()=>{let a,b;this.isInitialized();let c=(a=pD.utils.randomPrivateKey(),b=pD.getPublicKey(a),{privateKey:(0,lo.toString)(a,pZ),publicKey:(0,lo.toString)(b,pZ)});return this.setPrivateKey(c.publicKey,c.privateKey)}),sY(this,"signJWT",async a=>{this.isInitialized();let b=await this.getClientSeed(),c=ln.generateKeyPair(b),d=this.randomSessionIdentifier;return await ln.signJWT(d,a,rN,c)}),sY(this,"generateSharedKey",(a,b,c)=>{var d,e,f;let g,h;this.isInitialized();let i=(d=this.getPrivateKey(a),g=pD.getSharedSecret((0,lp.fromString)(d,pZ),(0,lp.fromString)(b,pZ)),e=void 0,h=function(a,b,c,d=32){mI(a),mG(d);let e=a.outputLen;if(d>255*e)throw Error("Length should be <= 255*HashLen");let f=Math.ceil(d/e);void 0===c&&(c=oD);let g=new Uint8Array(f*e),h=oB.create(a,b),i=h._cloneInto(),j=new Uint8Array(h.outputLen);for(let a=0;a<f;a++)oC[0]=a+1,i.update(0===a?oD:j).update(c).update(oC).digestInto(j),g.set(j,e*a),h._cloneInto(i);return h.destroy(),i.destroy(),mM(j,oC),g.slice(0,d)}(ny,(f=void 0,mI(ny),void 0===f&&(f=new Uint8Array(ny.outputLen)),oB(ny,mZ(f),mZ(g))),e,32),(0,lo.toString)(h,pZ));return this.setSymKey(i,c)}),sY(this,"setSymKey",async(a,b)=>{this.isInitialized();let c=b||p2(a);return await this.keychain.set(c,a),c}),sY(this,"deleteKeyPair",async a=>{this.isInitialized(),await this.keychain.del(a)}),sY(this,"deleteSymKey",async a=>{this.isInitialized(),await this.keychain.del(a)}),sY(this,"encode",async(a,b,c)=>{this.isInitialized();let d=qa(c),e=(0,lu.safeJsonStringify)(b);if(2===d.type){var f;let a,b,d;return f=c?.encoding,a=p4(2),b=m1(12),d=p8({type:a,sealed:(0,lp.fromString)(e,p0),iv:b}),f===p_?p6(d):d}if(qb(d)){let b=d.senderPublicKey,c=d.receiverPublicKey;a=await this.generateSharedKey(b,c)}let g=this.getSymKey(a),{type:h,senderPublicKey:i}=d;return function(a){let b=p4("u">typeof a.type?a.type:0);if(1===p5(b)&&typeof a.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let c="u">typeof a.senderPublicKey?(0,lp.fromString)(a.senderPublicKey,pZ):void 0,d="u">typeof a.iv?(0,lp.fromString)(a.iv,pZ):m1(12),e=p8({type:b,sealed:oz((0,lp.fromString)(a.symKey,pZ),d).encrypt((0,lp.fromString)(a.message,p0)),iv:d,senderPublicKey:c});return a.encoding===p_?p6(e):e}({type:h,symKey:g,message:e,senderPublicKey:i,encoding:c?.encoding})}),sY(this,"decode",async(a,b,c)=>{let d;this.isInitialized();let e=qa({type:p5((d=p9({encoded:b,encoding:c?.encoding})).type),senderPublicKey:"u">typeof d.senderPublicKey?(0,lo.toString)(d.senderPublicKey,pZ):void 0,receiverPublicKey:c?.receiverPublicKey});if(2===e.type){let a=function(a,b){let{sealed:c}=p9({encoded:a,encoding:b});return(0,lo.toString)(c,p0)}(b,c?.encoding);return(0,lu.safeJsonParse)(a)}if(qb(e)){let b=e.receiverPublicKey,c=e.senderPublicKey;a=await this.generateSharedKey(b,c)}try{let d=this.getSymKey(a),e=function(a){let b=(0,lp.fromString)(a.symKey,pZ),{sealed:c,iv:d}=p9({encoded:a.encoded,encoding:a.encoding}),e=oz(b,d).decrypt(c);if(null===e)throw Error("Failed to decrypt");return(0,lo.toString)(e,p0)}({symKey:d,encoded:b,encoding:c?.encoding});return(0,lu.safeJsonParse)(e)}catch(b){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(b)}}),sY(this,"getPayloadType",(a,b=p$)=>p5(p9({encoded:a,encoding:b}).type)),sY(this,"getPayloadSenderPublicKey",(a,b=p$)=>{let c=p9({encoded:a,encoding:b});return c.senderPublicKey?(0,lo.toString)(c.senderPublicKey,pZ):void 0}),this.core=a,this.logger=rl(b,this.name),this.keychain=c||new sW(this.core,this.logger)}get context(){return rk(this.logger)}async setPrivateKey(a,b){return await this.keychain.set(a,b),a}getPrivateKey(a){return this.keychain.get(a)}async getClientSeed(){let a="";try{a=this.keychain.get(rM)}catch{a=p1(),await this.keychain.set(rM,a)}return function(a,b="utf8"){let c=sT[b];if(!c)throw Error(`Unsupported encoding "${b}"`);return("utf8"===b||"utf-8"===b)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?sP(globalThis.Buffer.from(a,"utf-8")):c.decoder.decode(`${c.prefix}${a}`)}(a,"base16")}getSymKey(a){return this.keychain.get(a)}isInitialized(){if(!this.initialized){let{message:a}=qF("NOT_INITIALIZED",this.name);throw Error(a)}}}var s$=Object.defineProperty,s_=Object.defineProperties,s0=Object.getOwnPropertyDescriptors,s1=Object.getOwnPropertySymbols,s2=Object.prototype.hasOwnProperty,s3=Object.prototype.propertyIsEnumerable,s4=(a,b,c)=>b in a?s$(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,s5=(a,b,c)=>s4(a,"symbol"!=typeof b?b+"":b,c);class s6 extends rs{constructor(a,b){super(a,b),this.logger=a,this.core=b,s5(this,"messages",new Map),s5(this,"messagesWithoutClientAck",new Map),s5(this,"name","messages"),s5(this,"version","0.3"),s5(this,"initialized",!1),s5(this,"storagePrefix",rK),s5(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let a=await this.getRelayerMessages();"u">typeof a&&(this.messages=a);let b=await this.getRelayerMessagesWithoutClientAck();"u">typeof b&&(this.messagesWithoutClientAck=b),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(a){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(a)}finally{this.initialized=!0}}}),s5(this,"set",async(a,b,c)=>{this.isInitialized();let d=p3(b),e=this.messages.get(a);if(typeof e>"u"&&(e={}),"u">typeof e[d])return d;if(e[d]=b,this.messages.set(a,e),c===r_){let c=this.messagesWithoutClientAck.get(a)||{};this.messagesWithoutClientAck.set(a,s_(((a,b)=>{for(var c in b||(b={}))s2.call(b,c)&&s4(a,c,b[c]);if(s1)for(var c of s1(b))s3.call(b,c)&&s4(a,c,b[c]);return a})({},c),s0({[d]:b})))}return await this.persist(),d}),s5(this,"get",a=>{this.isInitialized();let b=this.messages.get(a);return typeof b>"u"&&(b={}),b}),s5(this,"getWithoutAck",a=>{this.isInitialized();let b={};for(let c of a){let a=this.messagesWithoutClientAck.get(c)||{};b[c]=Object.values(a)}return b}),s5(this,"has",(a,b)=>(this.isInitialized(),"u">typeof this.get(a)[p3(b)])),s5(this,"ack",async(a,b)=>{this.isInitialized();let c=this.messagesWithoutClientAck.get(a);if(typeof c>"u")return;let d=p3(b);delete c[d],0===Object.keys(c).length?this.messagesWithoutClientAck.delete(a):this.messagesWithoutClientAck.set(a,c),await this.persist()}),s5(this,"del",async a=>{this.isInitialized(),this.messages.delete(a),this.messagesWithoutClientAck.delete(a),await this.persist()}),this.logger=rl(a,this.name),this.core=b}get context(){return rk(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(a){await this.core.storage.setItem(this.storageKey,l6(a))}async setRelayerMessagesWithoutClientAck(a){await this.core.storage.setItem(this.storageKeyWithoutClientAck,l6(a))}async getRelayerMessages(){let a=await this.core.storage.getItem(this.storageKey);return"u">typeof a?l7(a):void 0}async getRelayerMessagesWithoutClientAck(){let a=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return"u">typeof a?l7(a):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:a}=qF("NOT_INITIALIZED",this.name);throw Error(a)}}}var s7=Object.defineProperty,s8=Object.defineProperties,s9=Object.getOwnPropertyDescriptors,ta=Object.getOwnPropertySymbols,tb=Object.prototype.hasOwnProperty,tc=Object.prototype.propertyIsEnumerable,td=(a,b,c)=>b in a?s7(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,te=(a,b)=>{for(var c in b||(b={}))tb.call(b,c)&&td(a,c,b[c]);if(ta)for(var c of ta(b))tc.call(b,c)&&td(a,c,b[c]);return a},tf=(a,b,c)=>td(a,"symbol"!=typeof b?b+"":b,c);class tg extends rt{constructor(a,b){super(a,b),this.relayer=a,this.logger=b,tf(this,"events",new cf.EventEmitter),tf(this,"name","publisher"),tf(this,"queue",new Map),tf(this,"publishTimeout",(0,iQ.toMiliseconds)(iQ.ONE_MINUTE)),tf(this,"initialPublishTimeout",(0,iQ.toMiliseconds)(15*iQ.ONE_SECOND)),tf(this,"needsTransportRestart",!1),tf(this,"publish",async(a,b,c)=>{var d,e,f,g,h;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:a,message:b,opts:c}});let i=c?.ttl||rO,j=c?.prompt||!1,k=c?.tag||0,l=c?.id||(0,rG.getBigIntRpcId)().toString(),m=qd(qc().protocol),n={id:l,method:c?.publishMethod||m.publish,params:te({topic:a,message:b,ttl:i,prompt:j,tag:k,attestation:c?.attestation},c?.tvf)},o=`Failed to publish payload, please try again. id:${l} tag:${k}`;try{qJ(null==(d=n.params)?void 0:d.prompt)&&(null==(e=n.params)||delete e.prompt),qJ(null==(f=n.params)?void 0:f.tag)&&(null==(g=n.params)||delete g.tag);let h=new Promise(async a=>{let b=({id:c})=>{var d;(null==(d=n.id)?void 0:d.toString())===c.toString()&&(this.removeRequestFromQueue(c),this.relayer.events.removeListener(rT,b),a())};this.relayer.events.on(rT,b);let d=l9(new Promise((a,b)=>{this.rpcPublish(n,c).then(a).catch(a=>{this.logger.warn(a,a?.message),b(a)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${l} tag:${k}`);try{await d,this.events.removeListener(rT,b)}catch(a){this.queue.set(l,{request:n,opts:c,attempt:1}),this.logger.warn(a,a?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:l,topic:a,message:b,opts:c}}),await l9(h,this.publishTimeout,o)}catch(a){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(a),null!=(h=c?.internal)&&h.throwOnFailedPublish)throw a}finally{this.queue.delete(l)}}),tf(this,"publishCustom",async a=>{var b,c,d,e,f;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:a});let{payload:g,opts:h={}}=a,{attestation:i,tvf:j,publishMethod:k,prompt:l,tag:m,ttl:n=iQ.FIVE_MINUTES}=h,o=h.id||(0,rG.getBigIntRpcId)().toString(),p=qd(qc().protocol),q=k||p.publish,r={id:o,method:q,params:te(s8(te({},g),s9({ttl:n,prompt:l,tag:m,attestation:i})),j)},s=`Failed to publish custom payload, please try again. id:${o} tag:${m}`;try{qJ(null==(b=r.params)?void 0:b.prompt)&&(null==(c=r.params)||delete c.prompt),qJ(null==(d=r.params)?void 0:d.tag)&&(null==(e=r.params)||delete e.tag);let a=new Promise(async a=>{let b=({id:c})=>{var d;(null==(d=r.id)?void 0:d.toString())===c.toString()&&(this.removeRequestFromQueue(c),this.relayer.events.removeListener(rT,b),a())};this.relayer.events.on(rT,b);let c=l9(new Promise((a,b)=>{this.rpcPublish(r,h).then(a).catch(a=>{this.logger.warn(a,a?.message),b(a)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${q} id:${o} tag:${m}`);try{await c,this.events.removeListener(rT,b)}catch(a){this.queue.set(o,{request:r,opts:h,attempt:1}),this.logger.warn(a,a?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:o,payload:g,opts:h}}),await l9(a,this.publishTimeout,s)}catch(a){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(a),null!=(f=h?.internal)&&f.throwOnFailedPublish)throw a}finally{this.queue.delete(o)}}),tf(this,"on",(a,b)=>{this.events.on(a,b)}),tf(this,"once",(a,b)=>{this.events.once(a,b)}),tf(this,"off",(a,b)=>{this.events.off(a,b)}),tf(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),this.relayer=a,this.logger=rl(b,this.name),this.registerEventListeners()}get context(){return rk(this.logger)}async rpcPublish(a,b){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:a});let c=await this.relayer.request(a);return this.relayer.events.emit(rT,te(te({},a),b)),this.logger.debug("Successfully Published Payload"),c}removeRequestFromQueue(a){this.queue.delete(a)}checkQueue(){this.queue.forEach(async(a,b)=>{var c;let d=a.attempt+1;this.queue.set(b,s8(te({},a),s9({attempt:d}))),this.logger.warn({},`Publisher: queue->publishing: ${a.request.id}, tag: ${null==(c=a.request.params)?void 0:c.tag}, attempt: ${d}`),await this.rpcPublish(a.request,a.opts),this.logger.warn({},`Publisher: queue->published: ${a.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(q_.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(rS);return}this.checkQueue()}),this.relayer.on(rR,a=>{this.removeRequestFromQueue(a.id.toString())})}}var th=Object.defineProperty,ti=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?th(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class tj{constructor(){ti(this,"map",new Map),ti(this,"set",(a,b)=>{let c=this.get(a);this.exists(a,b)||this.map.set(a,[...c,b])}),ti(this,"get",a=>this.map.get(a)||[]),ti(this,"exists",(a,b)=>this.get(a).includes(b)),ti(this,"delete",(a,b)=>{if(typeof b>"u")return void this.map.delete(a);if(!this.map.has(a))return;let c=this.get(a);if(!this.exists(a,b))return;let d=c.filter(a=>a!==b);d.length?this.map.set(a,d):this.map.delete(a)}),ti(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var tk=Object.defineProperty,tl=Object.defineProperties,tm=Object.getOwnPropertyDescriptors,tn=Object.getOwnPropertySymbols,to=Object.prototype.hasOwnProperty,tp=Object.prototype.propertyIsEnumerable,tq=(a,b,c)=>b in a?tk(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,tr=(a,b)=>{for(var c in b||(b={}))to.call(b,c)&&tq(a,c,b[c]);if(tn)for(var c of tn(b))tp.call(b,c)&&tq(a,c,b[c]);return a},ts=(a,b,c)=>tq(a,"symbol"!=typeof b?b+"":b,c);class tt extends rw{constructor(a,b){super(a,b),this.relayer=a,this.logger=b,ts(this,"subscriptions",new Map),ts(this,"topicMap",new tj),ts(this,"events",new cf.EventEmitter),ts(this,"name","subscription"),ts(this,"version","0.3"),ts(this,"pending",new Map),ts(this,"cached",[]),ts(this,"initialized",!1),ts(this,"storagePrefix",rK),ts(this,"subscribeTimeout",(0,iQ.toMiliseconds)(iQ.ONE_MINUTE)),ts(this,"initialSubscribeTimeout",(0,iQ.toMiliseconds)(15*iQ.ONE_SECOND)),ts(this,"clientId"),ts(this,"batchSubscribeTopicsLimit",500),ts(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),ts(this,"subscribe",async(a,b)=>{var c;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:a,opts:b}});try{let d=qc(b),e={topic:a,relay:d,transportType:b?.transportType};null!=(c=b?.internal)&&c.skipSubscribe||this.pending.set(a,e);let f=await this.rpcSubscribe(a,d,b);return"string"==typeof f&&(this.onSubscribe(f,e),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:a,opts:b}})),f}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}}),ts(this,"unsubscribe",async(a,b)=>{this.isInitialized(),"u">typeof b?.id?await this.unsubscribeById(a,b.id,b):await this.unsubscribeByTopic(a,b)}),ts(this,"isSubscribed",a=>new Promise(b=>{b(this.topicMap.topics.includes(a))})),ts(this,"isKnownTopic",a=>new Promise(b=>{b(this.topicMap.topics.includes(a)||this.pending.has(a)||this.cached.some(b=>b.topic===a))})),ts(this,"on",(a,b)=>{this.events.on(a,b)}),ts(this,"once",(a,b)=>{this.events.once(a,b)}),ts(this,"off",(a,b)=>{this.events.off(a,b)}),ts(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),ts(this,"start",async()=>{await this.onConnect()}),ts(this,"stop",async()=>{await this.onDisconnect()}),ts(this,"restart",async()=>{await this.restore(),await this.onRestart()}),ts(this,"checkPending",async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;let a=[];this.pending.forEach(b=>{a.push(b)}),await this.batchSubscribe(a)}),ts(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(q_.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.events.on(r1,async a=>{this.logger.info(`Emitting ${r1}`),this.logger.debug({type:"event",event:r1,data:a}),await this.persist()}),this.events.on(r2,async a=>{this.logger.info(`Emitting ${r2}`),this.logger.debug({type:"event",event:r2,data:a}),await this.persist()})}),this.relayer=a,this.logger=rl(b,this.name),this.clientId=""}get context(){return rk(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(a,b){let c=!1;try{c=this.getSubscription(a).topic===b}catch{}return c}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(a,b){let c=this.topicMap.get(a);await Promise.all(c.map(async c=>await this.unsubscribeById(a,c,b)))}async unsubscribeById(a,b,c){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:a,id:b,opts:c}});try{let d=qc(c);await this.restartToComplete({topic:a,id:b,relay:d}),await this.rpcUnsubscribe(a,b,d);let e=qG("USER_DISCONNECTED",`${this.name}, ${a}`);await this.onUnsubscribe(a,b,e),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:a,id:b,opts:c}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(a,b,c){var d,e;let f=await this.getSubscriptionId(a);if(null!=(d=c?.internal)&&d.skipSubscribe)return f;c&&c?.transportType!==r$||await this.restartToComplete({topic:a,id:a,relay:b});let g={method:qd(b.protocol).subscribe,params:{topic:a}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:g});let h=null==(e=c?.internal)?void 0:e.throwOnFailedPublish;try{if(c?.transportType===rZ)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(g).catch(a=>this.logger.warn(a))},(0,iQ.toMiliseconds)(iQ.ONE_SECOND)),f;let b=new Promise(async b=>{let c=d=>{d.topic===a&&(this.events.removeListener(r1,c),b(d.id))};this.events.on(r1,c);try{let d=await l9(new Promise((a,b)=>{this.relayer.request(g).catch(a=>{this.logger.warn(a,a?.message),b(a)}).then(a)}),this.initialSubscribeTimeout,`Subscribing to ${a} failed, please try again`);this.events.removeListener(r1,c),b(d)}catch{}}),d=await l9(b,this.subscribeTimeout,`Subscribing to ${a} failed, please try again`);if(!d&&h)throw Error(`Subscribing to ${a} failed, please try again`);return d?f:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(rS),h)throw a}return null}async rpcBatchSubscribe(a){if(!a.length)return;let b={method:qd(a[0].relay.protocol).batchSubscribe,params:{topics:a.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:b});try{await await l9(new Promise(a=>{this.relayer.request(b).catch(a=>this.logger.warn(a)).then(a)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(rS)}}async rpcBatchFetchMessages(a){let b;if(!a.length)return;let c={method:qd(a[0].relay.protocol).batchFetchMessages,params:{topics:a.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:c});try{b=await await l9(new Promise((a,b)=>{this.relayer.request(c).catch(a=>{this.logger.warn(a),b(a)}).then(a)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(rS)}return b}rpcUnsubscribe(a,b,c){let d={method:qd(c.protocol).unsubscribe,params:{topic:a,id:b}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:d}),this.relayer.request(d)}onSubscribe(a,b){this.setSubscription(a,tl(tr({},b),tm({id:a}))),this.pending.delete(b.topic)}onBatchSubscribe(a){a.length&&a.forEach(a=>{this.setSubscription(a.id,tr({},a)),this.pending.delete(a.topic)})}async onUnsubscribe(a,b,c){this.events.removeAllListeners(b),this.hasSubscription(b,a)&&this.deleteSubscription(b,c),await this.relayer.messages.del(a)}async setRelayerSubscriptions(a){await this.relayer.core.storage.setItem(this.storageKey,a)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(a,b){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:a,subscription:b}),this.addSubscription(a,b)}addSubscription(a,b){this.subscriptions.set(a,tr({},b)),this.topicMap.set(b.topic,a),this.events.emit(r1,b)}getSubscription(a){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:a});let b=this.subscriptions.get(a);if(!b){let{message:b}=qF("NO_MATCHING_KEY",`${this.name}: ${a}`);throw Error(b)}return b}deleteSubscription(a,b){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:a,reason:b});let c=this.getSubscription(a);this.subscriptions.delete(a),this.topicMap.delete(c.topic,a),this.events.emit(r2,tl(tr({},c),tm({reason:b})))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit("subscription_sync")}async onRestart(){if(this.cached.length){let a=[...this.cached],b=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let c=0;c<b;c++){let b=a.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(b)}}this.events.emit("subscription_resubscribed")}async restore(){try{let a=await this.getRelayerSubscriptions();if(typeof a>"u"||!a.length)return;if(this.subscriptions.size&&!a.every(a=>{var b;return a.topic===(null==(b=this.subscriptions.get(a.id))?void 0:b.topic)})){let{message:a}=qF("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(a){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(a)}}async batchSubscribe(a){a.length&&(await this.rpcBatchSubscribe(a),this.onBatchSubscribe(await Promise.all(a.map(async a=>tl(tr({},a),tm({id:await this.getSubscriptionId(a.topic)}))))))}async batchFetchMessages(a){var b;if(!a.length)return;this.logger.trace(`Fetching batch messages for ${a.length} subscriptions`);let c=await this.rpcBatchFetchMessages(a);c&&c.messages&&(await (b=(0,iQ.toMiliseconds)(iQ.ONE_SECOND),new Promise(a=>setTimeout(a,b))),await this.relayer.handleBatchMessageEvents(c.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:a}=qF("NOT_INITIALIZED",this.name);throw Error(a)}}async restartToComplete(a){this.relayer.connected||this.relayer.connecting||(this.cached.push(a),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(a){return p3(a+await this.getClientId())}}var tu=Object.defineProperty,tv=Object.getOwnPropertySymbols,tw=Object.prototype.hasOwnProperty,tx=Object.prototype.propertyIsEnumerable,ty=(a,b,c)=>b in a?tu(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,tz=(a,b)=>{for(var c in b||(b={}))tw.call(b,c)&&ty(a,c,b[c]);if(tv)for(var c of tv(b))tx.call(b,c)&&ty(a,c,b[c]);return a},tA=(a,b,c)=>ty(a,"symbol"!=typeof b?b+"":b,c);class tB extends ru{constructor(b){var c;super(b),tA(this,"protocol","wc"),tA(this,"version",2),tA(this,"core"),tA(this,"logger"),tA(this,"events",new cf.EventEmitter),tA(this,"provider"),tA(this,"messages"),tA(this,"subscriber"),tA(this,"publisher"),tA(this,"name","relayer"),tA(this,"transportExplicitlyClosed",!1),tA(this,"initialized",!1),tA(this,"connectionAttemptInProgress",!1),tA(this,"relayUrl"),tA(this,"projectId"),tA(this,"packageName"),tA(this,"bundleId"),tA(this,"hasExperiencedNetworkDisruption",!1),tA(this,"pingTimeout"),tA(this,"heartBeatTimeout",(0,iQ.toMiliseconds)(iQ.THIRTY_SECONDS+iQ.FIVE_SECONDS)),tA(this,"reconnectTimeout"),tA(this,"connectPromise"),tA(this,"reconnectInProgress",!1),tA(this,"requestsInFlight",[]),tA(this,"connectTimeout",(0,iQ.toMiliseconds)(15*iQ.ONE_SECOND)),tA(this,"request",async a=>{var b,c;this.logger.debug("Publishing Request Payload");let d=a.id||(0,rG.getBigIntRpcId)().toString();await this.toEstablishConnection();try{this.logger.trace({id:d,method:a.method,topic:null==(b=a.params)?void 0:b.topic},"relayer.request - publishing...");let e=`${d}:${(null==(c=a.params)?void 0:c.tag)||""}`;this.requestsInFlight.push(e);let f=await this.provider.request(a);return this.requestsInFlight=this.requestsInFlight.filter(a=>a!==e),f}catch(a){throw this.logger.debug(`Failed to Publish Request: ${d}`),a}}),tA(this,"resetPingTimeout",()=>{l$()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var a,b,c,d;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(d=null==(c=null==(b=null==(a=this.provider)?void 0:a.connection)?void 0:b.socket)?void 0:c.terminate)||d.call(c)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),tA(this,"onPayloadHandler",a=>{this.onProviderPayload(a),this.resetPingTimeout()}),tA(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit("relayer_connect")}),tA(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),tA(this,"onProviderErrorHandler",a=>{this.logger.fatal(`Fatal socket error: ${a.message}`),this.events.emit("relayer_error",a),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),tA(this,"registerProviderListeners",()=>{this.provider.on(rU,this.onPayloadHandler),this.provider.on(rV,this.onConnectHandler),this.provider.on(rW,this.onDisconnectHandler),this.provider.on(rX,this.onProviderErrorHandler)}),this.core=b.core,this.logger=q$({logger:null!=(c=b.logger)?c:"error",name:this.name}),this.messages=new s6(this.logger,b.core),this.subscriber=new tt(this,this.logger),this.publisher=new tg(this,this.logger),this.projectId=b?.projectId,this.relayUrl=b?.relayUrl||rP,l_()&&"u">typeof(null==a.g?void 0:a.g.Platform)&&(null==a.g?void 0:a.g.Platform.OS)==="android"?this.packageName=l2():l_()&&"u">typeof(null==a.g?void 0:a.g.Platform)&&(null==a.g?void 0:a.g.Platform.OS)==="ios"&&(this.bundleId=l2()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(a=>this.logger.warn(a,a?.message))}get context(){return rk(this.logger)}get connected(){var a,b,c;return(null==(c=null==(b=null==(a=this.provider)?void 0:a.connection)?void 0:b.socket)?void 0:c.readyState)===1}get connecting(){var a,b,c;return(null==(c=null==(b=null==(a=this.provider)?void 0:a.connection)?void 0:b.socket)?void 0:c.readyState)===0||void 0!==this.connectPromise}async publish(a,b,c){this.isInitialized(),await this.publisher.publish(a,b,c),await this.recordMessageEvent({topic:a,message:b,publishedAt:Date.now(),transportType:r$},"outbound")}async publishCustom(a){this.isInitialized(),await this.publisher.publishCustom(a)}async subscribe(a,b){var c,d,e;this.isInitialized(),null!=b&&b.transportType&&b?.transportType!=="relay"||await this.toEstablishConnection();let f=typeof(null==(c=b?.internal)?void 0:c.throwOnFailedPublish)>"u"||(null==(d=b?.internal)?void 0:d.throwOnFailedPublish),g=(null==(e=this.subscriber.topicMap.get(a))?void 0:e[0])||"",h,i=b=>{b.topic===a&&(this.subscriber.off(r1,i),h())};return await Promise.all([new Promise(a=>{h=a,this.subscriber.on(r1,i)}),new Promise(async(c,d)=>{g=await this.subscriber.subscribe(a,tz({internal:{throwOnFailedPublish:f}},b)).catch(a=>{f&&d(a)})||g,c()})]),g}async unsubscribe(a,b){this.isInitialized(),await this.subscriber.unsubscribe(a,b)}on(a,b){this.events.on(a,b)}once(a,b){this.events.once(a,b)}off(a,b){this.events.off(a,b)}removeListener(a,b){this.events.removeListener(a,b)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await l9(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(a){if(!this.subscriber.hasAnyTopics)return void this.logger.info("Starting WS connection skipped because the client has no topics to work with.");if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(b,c)=>{await this.connect(a).then(b).catch(c).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(a){this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress||(this.relayUrl=a||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await qV())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(a){if(a?.length===0)return void this.logger.trace("Batch message events is empty. Ignoring...");let b=a.sort((a,b)=>a.publishedAt-b.publishedAt);for(let a of(this.logger.debug(`Batch of ${b.length} message events sorted`),b))try{await this.onMessageEvent(a)}catch(a){this.logger.warn(a,"Error while processing batch message event: "+a?.message)}this.logger.trace(`Batch of ${b.length} message events processed`)}async onLinkMessageEvent(a,b){let{topic:c}=a;if(!b.sessionExists){let a=mc(iQ.FIVE_MINUTES);await this.core.pairing.pairings.set(c,{topic:c,expiry:a,relay:{protocol:"irn"},active:!1})}this.events.emit(rQ,a),await this.recordMessageEvent(a,r_)}async connect(a){await this.confirmOnlineStateOrThrow(),a&&a!==this.relayUrl&&(this.relayUrl=a,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let b=1;for(;b<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${b}...`),await this.createProvider(),await new Promise(async(a,b)=>{let c=()=>{b(Error("Connection interrupted while trying to connect"))};this.provider.once(rW,c),await l9(new Promise((a,b)=>{this.provider.connect().then(a).catch(b)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>{b(a)}).finally(()=>{this.provider.off(rW,c),clearTimeout(this.reconnectTimeout)}),await new Promise(async(a,c)=>{let d=()=>{b(Error("Connection interrupted while trying to subscribe"))};this.provider.once(rW,d),await this.subscriber.start().then(a).catch(c).finally(()=>{this.provider.off(rW,d)})}),this.hasExperiencedNetworkDisruption=!1,a()})}catch(a){await this.subscriber.stop(),this.logger.warn({},a.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${b}`);break}await new Promise(a=>setTimeout(a,(0,iQ.toMiliseconds)(+b))),b++}}startPingTimeout(){var a,b,c,d,e;if(l$())try{null!=(b=null==(a=this.provider)?void 0:a.connection)&&b.socket&&(null==(e=null==(d=null==(c=this.provider)?void 0:c.connection)?void 0:d.socket)||e.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(a){this.logger.warn(a,a?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let a=await this.core.crypto.signJWT(this.relayUrl);this.provider=new rF.JsonRpcProvider(new rI.default(function({protocol:a,version:b,relayUrl:c,sdkVersion:d,auth:e,projectId:f,useOnCloseEvent:g,bundleId:h,packageName:i}){var j,k;let l,m=c.split("?"),n=l4(a,b,d),o=(j=m[1]||"",k={auth:e,ua:n,projectId:f,useOnCloseEvent:g||void 0,packageName:i||void 0,bundleId:h||void 0},l=new URLSearchParams(j),Object.entries(k).sort(([a],[b])=>a.localeCompare(b)).forEach(([a,b])=>{null!=b&&l.set(a,String(b))}),l.toString());return m[0]+"?"+o}({sdkVersion:rY,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:a,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(a,b){let{topic:c,message:d}=a;await this.messages.set(c,d,b)}async shouldIgnoreMessageEvent(a){let{topic:b,message:c}=a;if(!c||0===c.length)return this.logger.warn(`Ignoring invalid/empty message: ${c}`),!0;if(!await this.subscriber.isKnownTopic(b))return this.logger.warn(`Ignoring message for unknown topic ${b}`),!0;let d=this.messages.has(b,c);return d&&this.logger.warn(`Ignoring duplicate message: ${c}`),d}async onProviderPayload(a){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:a}),(0,rH.isJsonRpcRequest)(a)){if(!a.method.endsWith("_subscription"))return;let b=a.params,{topic:c,message:d,publishedAt:e,attestation:f}=b.data,g={topic:c,message:d,publishedAt:e,transportType:r$,attestation:f};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(tz({type:"event",event:b.id},g)),this.events.emit(b.id,g),await this.acknowledgePayload(a),await this.onMessageEvent(g)}else(0,rH.isJsonRpcResponse)(a)&&this.events.emit(rR,a)}async onMessageEvent(a){await this.shouldIgnoreMessageEvent(a)||(await this.recordMessageEvent(a,r_),this.events.emit(rQ,a))}async acknowledgePayload(a){let b=(0,rG.formatJsonRpcResult)(a.id,!0);await this.provider.connection.send(b)}unregisterProviderListeners(){this.provider.off(rU,this.onPayloadHandler),this.provider.off(rV,this.onConnectHandler),this.provider.off(rW,this.onDisconnectHandler),this.provider.off(rX,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let b=await qV();(function(b){var c,d;switch(l1()){case lZ:c=b,!l_()&&l0()&&(window.addEventListener("online",()=>c(!0)),window.addEventListener("offline",()=>c(!1)));break;case lX:d=b,l_()&&null!=a.g&&a.g.NetInfo&&a.g?.NetInfo.addEventListener(a=>d(a?.isConnected))}})(async a=>{b!==a&&(b=a,a?await this.transportOpen().catch(a=>this.logger.error(a,a?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(q_.HEARTBEAT_EVENTS.pulse,async()=>{var a;if(!this.transportExplicitlyClosed&&!this.connected&&(!(l0()&&(0,iR.getDocument)())||(null==(a=(0,iR.getDocument)())?void 0:a.visibilityState)==="visible"))try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(a){this.logger.warn(a,a?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit("relayer_disconnect"),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(a=>this.logger.error(a,a?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,iQ.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){let{message:a}=qF("NOT_INITIALIZED",this.name);throw Error(a)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise)return void await this.connectPromise;await this.connect()}}}function tC(a){return Object.getOwnPropertySymbols(a).filter(b=>Object.prototype.propertyIsEnumerable.call(a,b))}function tD(a){return null==a?void 0===a?"[object Undefined]":"[object Null]":Object.prototype.toString.call(a)}let tE="[object Arguments]",tF="[object Object]";function tG(){}function tH(a){if(!a||"object"!=typeof a)return!1;let b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&"[object Object]"===Object.prototype.toString.call(a)}var tI=Object.defineProperty,tJ=Object.getOwnPropertySymbols,tK=Object.prototype.hasOwnProperty,tL=Object.prototype.propertyIsEnumerable,tM=(a,b,c)=>b in a?tI(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,tN=(a,b)=>{for(var c in b||(b={}))tK.call(b,c)&&tM(a,c,b[c]);if(tJ)for(var c of tJ(b))tL.call(b,c)&&tM(a,c,b[c]);return a},tO=(a,b,c)=>tM(a,"symbol"!=typeof b?b+"":b,c);class tP extends rv{constructor(a,b,c,d=rK,e){super(a,b,c,d),this.core=a,this.logger=b,this.name=c,tO(this,"map",new Map),tO(this,"version","0.3"),tO(this,"cached",[]),tO(this,"initialized",!1),tO(this,"getKey"),tO(this,"storagePrefix",rK),tO(this,"recentlyDeleted",[]),tO(this,"recentlyDeletedLimit",200),tO(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{var b;this.getKey&&null!==a&&!qJ(a)?this.map.set(this.getKey(a),a):(null==(b=a?.proposer)?void 0:b.publicKey)?this.map.set(a.id,a):a?.topic&&this.map.set(a.topic,a)}),this.cached=[],this.initialized=!0)}),tO(this,"set",async(a,b)=>{this.isInitialized(),this.map.has(a)?await this.update(a,b):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:b}),this.map.set(a,b),await this.persist())}),tO(this,"get",a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a))),tO(this,"getAll",a=>(this.isInitialized(),a?this.values.filter(b=>Object.keys(a).every(c=>{var d;return d=b[c],function a(b,c,d,e,f,g,h){let i=h(b,c,d,e,f,g);if(void 0!==i)return i;if(typeof b==typeof c)switch(typeof b){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return b===c;case"number":return b===c||Object.is(b,c)}return function b(c,d,e,f){if(Object.is(c,d))return!0;let g=tD(c),h=tD(d);if(g===tE&&(g=tF),h===tE&&(h=tF),g!==h)return!1;switch(g){case"[object String]":return c.toString()===d.toString();case"[object Number]":{let a=c.valueOf(),b=d.valueOf();return a===b||Number.isNaN(a)&&Number.isNaN(b)}case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(c.valueOf(),d.valueOf());case"[object RegExp]":return c.source===d.source&&c.flags===d.flags;case"[object Function]":return c===d}let i=(e=e??new Map).get(c),j=e.get(d);if(null!=i&&null!=j)return i===d;e.set(c,d),e.set(d,c);try{switch(g){case"[object Map]":if(c.size!==d.size)return!1;for(let[b,g]of c.entries())if(!d.has(b)||!a(g,d.get(b),b,c,d,e,f))return!1;return!0;case"[object Set]":{if(c.size!==d.size)return!1;let b=Array.from(c.values()),g=Array.from(d.values());for(let h=0;h<b.length;h++){let i=b[h],j=g.findIndex(b=>a(i,b,void 0,c,d,e,f));if(-1===j)return!1;g.splice(j,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if("u">typeof Buffer&&Buffer.isBuffer(c)!==Buffer.isBuffer(d)||c.length!==d.length)return!1;for(let b=0;b<c.length;b++)if(!a(c[b],d[b],b,c,d,e,f))return!1;return!0;case"[object ArrayBuffer]":return c.byteLength===d.byteLength&&b(new Uint8Array(c),new Uint8Array(d),e,f);case"[object DataView]":return c.byteLength===d.byteLength&&c.byteOffset===d.byteOffset&&b(new Uint8Array(c),new Uint8Array(d),e,f);case"[object Error]":return c.name===d.name&&c.message===d.message;case tF:{if(!(b(c.constructor,d.constructor,e,f)||tH(c)&&tH(d)))return!1;let g=[...Object.keys(c),...tC(c)],h=[...Object.keys(d),...tC(d)];if(g.length!==h.length)return!1;for(let b=0;b<g.length;b++){let h=g[b],i=c[h];if(!Object.hasOwn(d,h))return!1;let j=d[h];if(!a(i,j,h,c,d,e,f))return!1}return!0}default:return!1}}finally{e.delete(c),e.delete(d)}}(b,c,g,h)}(d,a[c],void 0,void 0,void 0,void 0,tG)})):this.values)),tO(this,"update",async(a,b)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:b});let c=tN(tN({},this.getData(a)),b);this.map.set(a,c),await this.persist()}),tO(this,"delete",async(a,b)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:b}),this.map.delete(a),this.addToRecentlyDeleted(a),await this.persist())}),this.logger=rl(b,this.name),this.storagePrefix=d,this.getKey=e}get context(){return rk(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(a){this.recentlyDeleted.push(a),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(a){await this.core.storage.setItem(this.storageKey,a)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(a){let b=this.map.get(a);if(!b){if(this.recentlyDeleted.includes(a)){let{message:b}=qF("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${a}`);throw this.logger.error(b),Error(b)}let{message:b}=qF("NO_MATCHING_KEY",`${this.name}: ${a}`);throw this.logger.error(b),Error(b)}return b}async persist(){await this.setDataStore(this.values)}async restore(){try{let a=await this.getDataStore();if(typeof a>"u"||!a.length)return;if(this.map.size){let{message:a}=qF("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(a){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(a)}}isInitialized(){if(!this.initialized){let{message:a}=qF("NOT_INITIALIZED",this.name);throw Error(a)}}}var tQ=Object.defineProperty,tR=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?tQ(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class tS{constructor(a,b){this.core=a,this.logger=b,tR(this,"name","pairing"),tR(this,"version","0.3"),tR(this,"events",new cf.default),tR(this,"pairings"),tR(this,"initialized",!1),tR(this,"storagePrefix",rK),tR(this,"ignoredPayloadTypes",[1]),tR(this,"registeredMethods",[]),tR(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),tR(this,"register",({methods:a})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...a])]}),tR(this,"create",async a=>{this.isInitialized();let b=p1(),c=await this.core.crypto.setSymKey(b),d=mc(iQ.FIVE_MINUTES),e={protocol:"irn"},f={topic:c,expiry:d,relay:e,active:!1,methods:a?.methods},g=qn({protocol:this.core.protocol,version:this.core.version,topic:c,symKey:b,relay:e,expiryTimestamp:d,methods:a?.methods});return this.events.emit(r4,f),this.core.expirer.set(c,d),await this.pairings.set(c,f),await this.core.relayer.subscribe(c,{transportType:a?.transportType,internal:a?.internal}),{topic:c,uri:g}}),tR(this,"pair",async a=>{let b;this.isInitialized();let c=this.core.eventClient.createEvent({properties:{topic:a?.uri,trace:["pairing_started"]}});this.isValidPair(a,c);let{topic:d,symKey:e,relay:f,expiryTimestamp:g,methods:h}=qm(a.uri);if(c.props.properties.topic=d,c.addTrace("pairing_uri_validation_success"),c.addTrace("pairing_uri_not_expired"),this.pairings.keys.includes(d)){if(b=this.pairings.get(d),c.addTrace("existing_pairing"),b.active)throw c.setError("active_pairing_already_exists"),Error(`Pairing already exists: ${d}. Please try again with a new connection URI.`);c.addTrace("pairing_not_expired")}let i=g||mc(iQ.FIVE_MINUTES),j={topic:d,relay:f,expiry:i,active:!1,methods:h};this.core.expirer.set(d,i),await this.pairings.set(d,j),c.addTrace("store_new_pairing"),a.activatePairing&&await this.activate({topic:d}),this.events.emit(r4,j),c.addTrace("emit_inactive_pairing"),this.core.crypto.keychain.has(d)||await this.core.crypto.setSymKey(e,d),c.addTrace("subscribing_pairing_topic");try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{c.setError("no_internet_connection")}try{await this.core.relayer.subscribe(d,{relay:f})}catch(a){throw c.setError("subscribe_pairing_topic_failure"),a}return c.addTrace("subscribe_pairing_topic_success"),j}),tR(this,"activate",async({topic:a})=>{this.isInitialized();let b=mc(iQ.FIVE_MINUTES);this.core.expirer.set(a,b),await this.pairings.update(a,{active:!0,expiry:b})}),tR(this,"ping",async a=>{this.isInitialized(),await this.isValidPing(a),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:b}=a;if(this.pairings.keys.includes(b)){let a=await this.sendRequest(b,"wc_pairingPing",{}),{done:c,resolve:d,reject:e}=l8();this.events.once(me("pairing_ping",a),({error:a})=>{a?e(a):d()}),await c()}}),tR(this,"updateExpiry",async({topic:a,expiry:b})=>{this.isInitialized(),await this.pairings.update(a,{expiry:b})}),tR(this,"updateMetadata",async({topic:a,metadata:b})=>{this.isInitialized(),await this.pairings.update(a,{peerMetadata:b})}),tR(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),tR(this,"disconnect",async a=>{this.isInitialized(),await this.isValidDisconnect(a);let{topic:b}=a;this.pairings.keys.includes(b)&&(await this.sendRequest(b,"wc_pairingDelete",qG("USER_DISCONNECTED")),await this.deletePairing(b))}),tR(this,"formatUriFromPairing",a=>{this.isInitialized();let{topic:b,relay:c,expiry:d,methods:e}=a,f=this.core.crypto.keychain.get(b);return qn({protocol:this.core.protocol,version:this.core.version,topic:b,symKey:f,relay:c,expiryTimestamp:d,methods:e})}),tR(this,"sendRequest",async(a,b,c)=>{let d=(0,rG.formatJsonRpcRequest)(b,c),e=await this.core.crypto.encode(a,d),f=r3[b].req;return this.core.history.set(a,d),this.core.relayer.publish(a,e,f),d.id}),tR(this,"sendResult",async(a,b,c)=>{let d=(0,rG.formatJsonRpcResult)(a,c),e=await this.core.crypto.encode(b,d),f=r3[(await this.core.history.get(b,a)).request.method].res;await this.core.relayer.publish(b,e,f),await this.core.history.resolve(d)}),tR(this,"sendError",async(a,b,c)=>{let d=(0,rG.formatJsonRpcError)(a,c),e=await this.core.crypto.encode(b,d),f=(await this.core.history.get(b,a)).request.method,g=r3[f]?r3[f].res:r3.unregistered_method.res;await this.core.relayer.publish(b,e,g),await this.core.history.resolve(d)}),tR(this,"deletePairing",async(a,b)=>{await this.core.relayer.unsubscribe(a),await Promise.all([this.pairings.delete(a,qG("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(a),b?Promise.resolve():this.core.expirer.del(a)])}),tR(this,"cleanup",async()=>{let a=this.pairings.getAll().filter(a=>md(a.expiry));await Promise.all(a.map(a=>this.deletePairing(a.topic)))}),tR(this,"onRelayEventRequest",async a=>{let{topic:b,payload:c}=a;switch(c.method){case"wc_pairingPing":return await this.onPairingPingRequest(b,c);case"wc_pairingDelete":return await this.onPairingDeleteRequest(b,c);default:return await this.onUnknownRpcMethodRequest(b,c)}}),tR(this,"onRelayEventResponse",async a=>{let{topic:b,payload:c}=a,d=(await this.core.history.get(b,c.id)).request.method;return"wc_pairingPing"===d?this.onPairingPingResponse(b,c):this.onUnknownRpcMethodResponse(d)}),tR(this,"onPairingPingRequest",async(a,b)=>{let{id:c}=b;try{this.isValidPing({topic:a}),await this.sendResult(c,a,!0),this.events.emit("pairing_ping",{id:c,topic:a})}catch(b){await this.sendError(c,a,b),this.logger.error(b)}}),tR(this,"onPairingPingResponse",(a,b)=>{let{id:c}=b;setTimeout(()=>{(0,rH.isJsonRpcResult)(b)?this.events.emit(me("pairing_ping",c),{}):(0,rH.isJsonRpcError)(b)&&this.events.emit(me("pairing_ping",c),{error:b.error})},500)}),tR(this,"onPairingDeleteRequest",async(a,b)=>{let{id:c}=b;try{this.isValidDisconnect({topic:a}),await this.deletePairing(a),this.events.emit(r5,{id:c,topic:a})}catch(b){await this.sendError(c,a,b),this.logger.error(b)}}),tR(this,"onUnknownRpcMethodRequest",async(a,b)=>{let{id:c,method:d}=b;try{if(this.registeredMethods.includes(d))return;let b=qG("WC_METHOD_UNSUPPORTED",d);await this.sendError(c,a,b),this.logger.error(b)}catch(b){await this.sendError(c,a,b),this.logger.error(b)}}),tR(this,"onUnknownRpcMethodResponse",a=>{this.registeredMethods.includes(a)||this.logger.error(qG("WC_METHOD_UNSUPPORTED",a))}),tR(this,"isValidPair",(a,b)=>{var c;if(!qR(a)){let{message:c}=qF("MISSING_OR_INVALID",`pair() params: ${a}`);throw b.setError(sf),Error(c)}if(!function(a){function b(a){try{return"u">typeof new URL(a)}catch{return!1}}try{if(qK(a,!1)){if(b(a))return!0;let c=ml(a);return b(c)}}catch{}return!1}(a.uri)){let{message:c}=qF("MISSING_OR_INVALID",`pair() uri: ${a.uri}`);throw b.setError(sf),Error(c)}let d=qm(a?.uri);if(!(null!=(c=d?.relay)&&c.protocol)){let{message:a}=qF("MISSING_OR_INVALID","pair() uri#relay-protocol");throw b.setError(sf),Error(a)}if(!(null!=d&&d.symKey)){let{message:a}=qF("MISSING_OR_INVALID","pair() uri#symKey");throw b.setError(sf),Error(a)}if(null!=d&&d.expiryTimestamp&&(0,iQ.toMiliseconds)(d?.expiryTimestamp)<Date.now()){b.setError("pairing_expired");let{message:a}=qF("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(a)}}),tR(this,"isValidPing",async a=>{if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`ping() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidPairingTopic(b)}),tR(this,"isValidDisconnect",async a=>{if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`disconnect() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidPairingTopic(b)}),tR(this,"isValidPairingTopic",async a=>{if(!qK(a,!1)){let{message:b}=qF("MISSING_OR_INVALID",`pairing topic should be a string: ${a}`);throw Error(b)}if(!this.pairings.keys.includes(a)){let{message:b}=qF("NO_MATCHING_KEY",`pairing topic doesn't exist: ${a}`);throw Error(b)}if(md(this.pairings.get(a).expiry)){await this.deletePairing(a);let{message:b}=qF("EXPIRED",`pairing topic: ${a}`);throw Error(b)}}),this.core=a,this.logger=rl(b,this.name),this.pairings=new tP(this.core,this.logger,this.name,this.storagePrefix)}get context(){return rk(this.logger)}isInitialized(){if(!this.initialized){let{message:a}=qF("NOT_INITIALIZED",this.name);throw Error(a)}}registerRelayerEvents(){this.core.relayer.on(rQ,async a=>{let{topic:b,message:c,transportType:d}=a;if(this.pairings.keys.includes(b)&&d!==rZ&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(c)))try{let a=await this.core.crypto.decode(b,c);(0,rH.isJsonRpcRequest)(a)?(this.core.history.set(b,a),await this.onRelayEventRequest({topic:b,payload:a})):(0,rH.isJsonRpcResponse)(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:b,payload:a}),this.core.history.delete(b,a.id)),await this.core.relayer.messages.ack(b,c)}catch(a){this.logger.error(a)}})}registerExpirerEvents(){this.core.expirer.on(sb,async a=>{let{topic:b}=mb(a.target);b&&this.pairings.keys.includes(b)&&(await this.deletePairing(b,!0),this.events.emit("pairing_expire",{topic:b}))})}}var tT=Object.defineProperty,tU=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?tT(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class tV extends rr{constructor(a,b){super(a,b),this.core=a,this.logger=b,tU(this,"records",new Map),tU(this,"events",new cf.EventEmitter),tU(this,"name","history"),tU(this,"version","0.3"),tU(this,"cached",[]),tU(this,"initialized",!1),tU(this,"storagePrefix",rK),tU(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>this.records.set(a.id,a)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),tU(this,"set",(a,b,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:a,request:b,chainId:c}),this.records.has(b.id))return;let d={id:b.id,topic:a,request:{method:b.method,params:b.params||null},chainId:c,expiry:mc(iQ.THIRTY_DAYS)};this.records.set(d.id,d),this.persist(),this.events.emit(r6,d)}),tU(this,"resolve",async a=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:a}),!this.records.has(a.id))return;let b=await this.getRecord(a.id);typeof b.response>"u"&&(b.response=(0,rH.isJsonRpcError)(a)?{error:a.error}:{result:a.result},this.records.set(b.id,b),this.persist(),this.events.emit(r7,b))}),tU(this,"get",async(a,b)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:a,id:b}),await this.getRecord(b))),tU(this,"delete",(a,b)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:b}),this.values.forEach(c=>{c.topic===a&&("u">typeof b&&c.id!==b||(this.records.delete(c.id),this.events.emit(r8,c)))}),this.persist()}),tU(this,"exists",async(a,b)=>(this.isInitialized(),!!this.records.has(b)&&(await this.getRecord(b)).topic===a)),tU(this,"on",(a,b)=>{this.events.on(a,b)}),tU(this,"once",(a,b)=>{this.events.once(a,b)}),tU(this,"off",(a,b)=>{this.events.off(a,b)}),tU(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),this.logger=rl(b,this.name)}get context(){return rk(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let a=[];return this.values.forEach(b=>{if("u">typeof b.response)return;let c={topic:b.topic,request:(0,rG.formatJsonRpcRequest)(b.request.method,b.request.params,b.id),chainId:b.chainId};return a.push(c)}),a}async setJsonRpcRecords(a){await this.core.storage.setItem(this.storageKey,a)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(a){this.isInitialized();let b=this.records.get(a);if(!b){let{message:b}=qF("NO_MATCHING_KEY",`${this.name}: ${a}`);throw Error(b)}return b}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit("history_sync")}async restore(){try{let a=await this.getJsonRpcRecords();if(typeof a>"u"||!a.length)return;if(this.records.size){let{message:a}=qF("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(a){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(a)}}registerEventListeners(){this.events.on(r6,a=>{this.logger.info(`Emitting ${r6}`),this.logger.debug({type:"event",event:r6,record:a})}),this.events.on(r7,a=>{this.logger.info(`Emitting ${r7}`),this.logger.debug({type:"event",event:r7,record:a})}),this.events.on(r8,a=>{this.logger.info(`Emitting ${r8}`),this.logger.debug({type:"event",event:r8,record:a})}),this.core.heartbeat.on(q_.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let a=!1;this.records.forEach(b=>{(0,iQ.toMiliseconds)(b.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${b.id}`),this.records.delete(b.id),this.events.emit(r8,b,!1),a=!0)}),a&&this.persist()}catch(a){this.logger.warn(a)}}isInitialized(){if(!this.initialized){let{message:a}=qF("NOT_INITIALIZED",this.name);throw Error(a)}}}var tW=Object.defineProperty,tX=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?tW(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class tY extends rx{constructor(a,b){super(a,b),this.core=a,this.logger=b,tX(this,"expirations",new Map),tX(this,"events",new cf.EventEmitter),tX(this,"name","expirer"),tX(this,"version","0.3"),tX(this,"cached",[]),tX(this,"initialized",!1),tX(this,"storagePrefix",rK),tX(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>this.expirations.set(a.target,a)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),tX(this,"has",a=>{try{let b=this.formatTarget(a);return"u">typeof this.getExpiration(b)}catch{return!1}}),tX(this,"set",(a,b)=>{this.isInitialized();let c=this.formatTarget(a),d={target:c,expiry:b};this.expirations.set(c,d),this.checkExpiry(c,d),this.events.emit(r9,{target:c,expiration:d})}),tX(this,"get",a=>{this.isInitialized();let b=this.formatTarget(a);return this.getExpiration(b)}),tX(this,"del",a=>{if(this.isInitialized(),this.has(a)){let b=this.formatTarget(a),c=this.getExpiration(b);this.expirations.delete(b),this.events.emit(sa,{target:b,expiration:c})}}),tX(this,"on",(a,b)=>{this.events.on(a,b)}),tX(this,"once",(a,b)=>{this.events.once(a,b)}),tX(this,"off",(a,b)=>{this.events.off(a,b)}),tX(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),this.logger=rl(b,this.name)}get context(){return rk(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(a){if("string"==typeof a)return ma("topic",a);if("number"==typeof a)return ma("id",a);let{message:b}=qF("UNKNOWN_TYPE",`Target type: ${typeof a}`);throw Error(b)}async setExpirations(a){await this.core.storage.setItem(this.storageKey,a)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit("expirer_sync")}async restore(){try{let a=await this.getExpirations();if(typeof a>"u"||!a.length)return;if(this.expirations.size){let{message:a}=qF("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(a){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(a)}}getExpiration(a){let b=this.expirations.get(a);if(!b){let{message:b}=qF("NO_MATCHING_KEY",`${this.name}: ${a}`);throw this.logger.warn(b),Error(b)}return b}checkExpiry(a,b){let{expiry:c}=b;(0,iQ.toMiliseconds)(c)-Date.now()<=0&&this.expire(a,b)}expire(a,b){this.expirations.delete(a),this.events.emit(sb,{target:a,expiration:b})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((a,b)=>this.checkExpiry(b,a))}registerEventListeners(){this.core.heartbeat.on(q_.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(r9,a=>{this.logger.info(`Emitting ${r9}`),this.logger.debug({type:"event",event:r9,data:a}),this.persist()}),this.events.on(sb,a=>{this.logger.info(`Emitting ${sb}`),this.logger.debug({type:"event",event:sb,data:a}),this.persist()}),this.events.on(sa,a=>{this.logger.info(`Emitting ${sa}`),this.logger.debug({type:"event",event:sa,data:a}),this.persist()})}isInitialized(){if(!this.initialized){let{message:a}=qF("NOT_INITIALIZED",this.name);throw Error(a)}}}var tZ=Object.defineProperty,t$=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?tZ(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class t_ extends ry{constructor(a,b,c){super(a,b,c),this.core=a,this.logger=b,this.store=c,t$(this,"name","verify-api"),t$(this,"abortController"),t$(this,"isDevEnv"),t$(this,"verifyUrlV3",sd),t$(this,"storagePrefix",rK),t$(this,"version",2),t$(this,"publicKey"),t$(this,"fetchPromise"),t$(this,"init",async()=>{var a;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,iQ.toMiliseconds)(null==(a=this.publicKey)?void 0:a.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),t$(this,"register",async a=>{if(!l0()||this.isDevEnv)return;let b=window.location.origin,{id:c,decryptedId:d}=a,e=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${b}&id=${c}&decryptedId=${d}`;try{let a=(0,iR.getDocument)(),b=this.startAbortTimer(5*iQ.ONE_SECOND),d=await new Promise((d,f)=>{let g=()=>{window.removeEventListener("message",i),a.body.removeChild(h),f("attestation aborted")};this.abortController.signal.addEventListener("abort",g);let h=a.createElement("iframe");h.src=e,h.style.display="none",h.addEventListener("error",g,{signal:this.abortController.signal});let i=e=>{if(e.data&&"string"==typeof e.data)try{let f=JSON.parse(e.data);if("verify_attestation"===f.type){if((0,ln.decodeJWT)(f.attestation).payload.id!==c)return;clearInterval(b),a.body.removeChild(h),this.abortController.signal.removeEventListener("abort",g),window.removeEventListener("message",i),d(null===f.attestation?"":f.attestation)}}catch(a){this.logger.warn(a)}};a.body.appendChild(h),window.addEventListener("message",i,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(a){this.logger.warn(a)}return""}),t$(this,"resolve",async a=>{if(this.isDevEnv)return"";let{attestationId:b,hash:c,encryptedId:d}=a;if(""===b)return void this.logger.debug("resolve: attestationId is empty, skipping");if(b){if((0,ln.decodeJWT)(b).payload.id!==d)return;let a=await this.isValidJwtAttestation(b);if(a)return a.isVerified?a:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!c)return;let e=this.getVerifyUrl(a?.verifyUrl);return this.fetchAttestation(c,e)}),t$(this,"fetchAttestation",async(a,b)=>{this.logger.debug(`resolving attestation: ${a} from url: ${b}`);let c=this.startAbortTimer(5*iQ.ONE_SECOND),d=await fetch(`${b}/attestation/${a}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(c),200===d.status?await d.json():void 0}),t$(this,"getVerifyUrl",a=>{let b=a||sc;return se.includes(b)||(this.logger.info(`verify url: ${b}, not included in trusted list, assigning default: ${sc}`),b=sc),b}),t$(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let a=this.startAbortTimer(iQ.FIVE_SECONDS),b=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(a),await b.json()}catch(a){this.logger.warn(a)}}),t$(this,"persistPublicKey",async a=>{this.logger.debug(a,"persisting public key to local storage"),await this.store.setItem(this.storeKey,a),this.publicKey=a}),t$(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),t$(this,"isValidJwtAttestation",async a=>{let b=await this.getPublicKey();try{if(b)return this.validateAttestation(a,b)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}let c=await this.fetchAndPersistPublicKey();try{if(c)return this.validateAttestation(a,c)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),t$(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),t$(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async a=>{let b=await this.fetchPublicKey();b&&(await this.persistPublicKey(b),a(b))});let a=await this.fetchPromise;return this.fetchPromise=void 0,a}),t$(this,"validateAttestation",(a,b)=>{let c=function(a,b){let c,d,[e,f,g]=a.split("."),h=Buffer.from(p7(g),"base64");if(64!==h.length)throw Error("Invalid signature length");let i=h.slice(0,32),j=h.slice(32,64),k=ny(`${e}.${f}`),l=(c=Buffer.from(b.x,"base64"),d=Buffer.from(b.y,"base64"),(0,lq.concat)([new Uint8Array([4]),c,d]));if(!pX.verify((0,lq.concat)([i,j]),k,l))throw Error("Invalid signature");return(0,ln.decodeJWT)(a).payload}(a,b.publicKey),d={hasExpired:(0,iQ.toMiliseconds)(c.exp)<Date.now(),payload:c};if(d.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:d.payload.origin,isScam:d.payload.isScam,isVerified:d.payload.isVerified}}),this.logger=rl(b,this.name),this.abortController=new AbortController,this.isDevEnv=mk(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return rk(this.logger)}startAbortTimer(a){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,iQ.toMiliseconds)(a))}}var t0=Object.defineProperty,t1=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?t0(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class t2 extends rz{constructor(a,b){super(a,b),this.projectId=a,this.logger=b,t1(this,"context","echo"),t1(this,"registerDeviceToken",async a=>{let{clientId:b,token:c,notificationType:d,enableEncrypted:e=!1}=a,f=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:b,type:d,token:c,always_raw:e})})}),this.logger=rl(b,this.context)}}var t3=Object.defineProperty,t4=Object.getOwnPropertySymbols,t5=Object.prototype.hasOwnProperty,t6=Object.prototype.propertyIsEnumerable,t7=(a,b,c)=>b in a?t3(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,t8=(a,b)=>{for(var c in b||(b={}))t5.call(b,c)&&t7(a,c,b[c]);if(t4)for(var c of t4(b))t6.call(b,c)&&t7(a,c,b[c]);return a},t9=(a,b,c)=>t7(a,"symbol"!=typeof b?b+"":b,c);class ua extends rA{constructor(a,b,c=!0){super(a,b,c),this.core=a,this.logger=b,t9(this,"context","event-client"),t9(this,"storagePrefix",rK),t9(this,"storageVersion",.1),t9(this,"events",new Map),t9(this,"shouldPersist",!1),t9(this,"init",async()=>{if(!mk())try{let a={eventId:mj(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:l4(this.core.relayer.protocol,this.core.relayer.version,rY)}}};await this.sendEvent([a])}catch(a){this.logger.warn(a)}}),t9(this,"createEvent",a=>{let{event:b="ERROR",type:c="",properties:{topic:d,trace:e}}=a,f=mj(),g=this.core.projectId||"",h=t8({eventId:f,timestamp:Date.now(),props:{event:b,type:c,properties:{topic:d,trace:e}},bundleId:g,domain:this.getAppDomain()},this.setMethods(f));return this.telemetryEnabled&&(this.events.set(f,h),this.shouldPersist=!0),h}),t9(this,"getEvent",a=>{let{eventId:b,topic:c}=a;if(b)return this.events.get(b);let d=Array.from(this.events.values()).find(a=>a.props.properties.topic===c);if(d)return t8(t8({},d),this.setMethods(d.eventId))}),t9(this,"deleteEvent",a=>{let{eventId:b}=a;this.events.delete(b),this.shouldPersist=!0}),t9(this,"setEventListeners",()=>{this.core.heartbeat.on(q_.HEARTBEAT_EVENTS.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(a=>{(0,iQ.fromMiliseconds)(Date.now())-(0,iQ.fromMiliseconds)(a.timestamp)>86400&&(this.events.delete(a.eventId),this.shouldPersist=!0)})})}),t9(this,"setMethods",a=>({addTrace:b=>this.addTrace(a,b),setError:b=>this.setError(a,b)})),t9(this,"addTrace",(a,b)=>{let c=this.events.get(a);c&&(c.props.properties.trace.push(b),this.events.set(a,c),this.shouldPersist=!0)}),t9(this,"setError",(a,b)=>{let c=this.events.get(a);c&&(c.props.type=b,c.timestamp=Date.now(),this.events.set(a,c),this.shouldPersist=!0)}),t9(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),t9(this,"restore",async()=>{try{let a=await this.core.storage.getItem(this.storageKey)||[];if(!a.length)return;a.forEach(a=>{this.events.set(a.eventId,t8(t8({},a),this.setMethods(a.eventId)))})}catch(a){this.logger.warn(a)}}),t9(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let a=[];for(let[b,c]of this.events)c.props.type&&a.push(c);if(0!==a.length)try{if((await this.sendEvent(a)).ok)for(let b of a)this.events.delete(b.eventId),this.shouldPersist=!0}catch(a){this.logger.warn(a)}}),t9(this,"sendEvent",async a=>{let b=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${rY}${b}`,{method:"POST",body:JSON.stringify(a)})}),t9(this,"getAppDomain",()=>l3().url),this.logger=rl(b,this.context),this.telemetryEnabled=c,c?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var ub=Object.defineProperty,uc=Object.getOwnPropertySymbols,ud=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,uf=(a,b,c)=>b in a?ub(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,ug=(a,b)=>{for(var c in b||(b={}))ud.call(b,c)&&uf(a,c,b[c]);if(uc)for(var c of uc(b))ue.call(b,c)&&uf(a,c,b[c]);return a},uh=(a,b,c)=>uf(a,"symbol"!=typeof b?b+"":b,c);class ui extends rp{constructor(a){var b;super(a),uh(this,"protocol","wc"),uh(this,"version",2),uh(this,"name",rJ),uh(this,"relayUrl"),uh(this,"projectId"),uh(this,"customStoragePrefix"),uh(this,"events",new cf.EventEmitter),uh(this,"logger"),uh(this,"heartbeat"),uh(this,"relayer"),uh(this,"crypto"),uh(this,"storage"),uh(this,"history"),uh(this,"expirer"),uh(this,"pairing"),uh(this,"verify"),uh(this,"echoClient"),uh(this,"linkModeSupportedApps"),uh(this,"eventClient"),uh(this,"initialized",!1),uh(this,"logChunkController"),uh(this,"on",(a,b)=>this.events.on(a,b)),uh(this,"once",(a,b)=>this.events.once(a,b)),uh(this,"off",(a,b)=>this.events.off(a,b)),uh(this,"removeListener",(a,b)=>this.events.removeListener(a,b)),uh(this,"dispatchEnvelope",({topic:a,message:b,sessionExists:c})=>{if(!a||!b)return;let d={topic:a,message:b,publishedAt:Date.now(),transportType:rZ};this.relayer.onLinkMessageEvent(d,{sessionExists:c})});const c=this.getGlobalCore(a?.customStoragePrefix);if(c)try{return this.customStoragePrefix=c.customStoragePrefix,this.logger=c.logger,this.heartbeat=c.heartbeat,this.crypto=c.crypto,this.history=c.history,this.expirer=c.expirer,this.storage=c.storage,this.relayer=c.relayer,this.pairing=c.pairing,this.verify=c.verify,this.echoClient=c.echoClient,this.linkModeSupportedApps=c.linkModeSupportedApps,this.eventClient=c.eventClient,this.initialized=c.initialized,this.logChunkController=c.logChunkController,c}catch(a){console.warn("Failed to copy global core",a)}this.projectId=a?.projectId,this.relayUrl=a?.relayUrl||rP,this.customStoragePrefix=null!=a&&a.customStoragePrefix?`:${a.customStoragePrefix}`:"";const{logger:d,chunkLoggerController:e}=function(a){var b;let c;return"u">typeof a.loggerOverride&&"string"!=typeof a.loggerOverride?{logger:a.loggerOverride,chunkLoggerController:null}:(c=new rb(null==(b=a.opts)?void 0:b.level,a.maxSizeInBytes),{logger:(0,q1.default)(rd(rj({},a.opts),re({level:"trace"})),c),chunkLoggerController:c})}({opts:function(a){return rd(rj({},a),re({level:a?.level||"info"}))}({level:"string"==typeof a?.logger&&a.logger?a.logger:"error",name:rJ}),maxSizeInBytes:a?.maxLogBlobSizeInBytes,loggerOverride:a?.logger});this.logChunkController=e,null!=(b=this.logChunkController)&&b.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,b;null!=(a=this.logChunkController)&&a.downloadLogsBlobInBrowser&&(null==(b=this.logChunkController)||b.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=rl(d,this.name),this.heartbeat=new q_.HeartBeat,this.crypto=new sZ(this,this.logger,a?.keychain),this.history=new tV(this,this.logger),this.expirer=new tY(this,this.logger),this.storage=null!=a&&a.storage?a.storage:new q0.default(ug(ug({},rL),a?.storageOptions)),this.relayer=new tB({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new tS(this,this.logger),this.verify=new t_(this,this.logger,this.storage),this.echoClient=new t2(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new ua(this,this.logger,a?.telemetryEnabled),this.setGlobalCore(this)}static async init(a){let b=new ui(a);await b.initialize();let c=await b.crypto.getClientId();return await b.storage.setItem("WALLETCONNECT_CLIENT_ID",c),b}get context(){return rk(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var a;return null==(a=this.logChunkController)?void 0:a.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(a){this.linkModeSupportedApps.includes(a)||(this.linkModeSupportedApps.push(a),await this.storage.setItem(r0,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(r0)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(a){throw this.logger.warn(a,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(a.message),a}}getGlobalCore(a=""){try{if(this.isGlobalCoreDisabled())return;let b=`_walletConnectCore_${a}`,c=`${b}_count`;return globalThis[c]=(globalThis[c]||0)+1,globalThis[c]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[c]} times.`),globalThis[b]}catch(a){console.warn("Failed to get global WalletConnect core",a);return}}setGlobalCore(a){var b;try{if(this.isGlobalCoreDisabled())return;let c=`_walletConnectCore_${(null==(b=a.opts)?void 0:b.customStoragePrefix)||""}`;globalThis[c]=a}catch(a){console.warn("Failed to set global WalletConnect core",a)}}isGlobalCoreDisabled(){try{return"u">typeof process&&"true"===process.env.DISABLE_GLOBAL_CORE}catch{return!0}}}let uj="client",uk=`wc@2:${uj}:`,ul="WALLETCONNECT_DEEPLINK_CHOICE",um=(iQ.THIRTY_DAYS,"Proposal expired"),un=iQ.SEVEN_DAYS,uo={wc_sessionPropose:{req:{ttl:iQ.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:iQ.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:iQ.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:iQ.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:iQ.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:iQ.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:iQ.ONE_DAY,prompt:!1,tag:1104},res:{ttl:iQ.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:iQ.ONE_DAY,prompt:!1,tag:1106},res:{ttl:iQ.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:iQ.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:iQ.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:iQ.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:iQ.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:iQ.ONE_DAY,prompt:!1,tag:1112},res:{ttl:iQ.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:iQ.ONE_DAY,prompt:!1,tag:1114},res:{ttl:iQ.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:iQ.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:iQ.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:iQ.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:iQ.FIVE_MINUTES,prompt:!1,tag:1119}}},up={min:iQ.FIVE_MINUTES,max:iQ.SEVEN_DAYS},uq="IDLE",ur="ACTIVE",us={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},ut=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],uu="wc@1.5:auth:",uv=`${uu}:PUB_KEY`;var uw=Object.defineProperty,ux=Object.defineProperties,uy=Object.getOwnPropertyDescriptors,uz=Object.getOwnPropertySymbols,uA=Object.prototype.hasOwnProperty,uB=Object.prototype.propertyIsEnumerable,uC=(a,b,c)=>b in a?uw(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,uD=(a,b)=>{for(var c in b||(b={}))uA.call(b,c)&&uC(a,c,b[c]);if(uz)for(var c of uz(b))uB.call(b,c)&&uC(a,c,b[c]);return a},uE=(a,b,c)=>uC(a,"symbol"!=typeof b?b+"":b,c);class uF extends rE{constructor(b){super(b),uE(this,"name","engine"),uE(this,"events",new cf.default),uE(this,"initialized",!1),uE(this,"requestQueue",{state:uq,queue:[]}),uE(this,"sessionRequestQueue",{state:uq,queue:[]}),uE(this,"emittedSessionRequests",new mm({limit:500})),uE(this,"requestQueueDelay",iQ.ONE_SECOND),uE(this,"expectedPairingMethodMap",new Map),uE(this,"recentlyDeletedMap",new Map),uE(this,"recentlyDeletedLimit",200),uE(this,"relayMessageCache",[]),uE(this,"pendingSessions",new Map),uE(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(uo)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,iQ.toMiliseconds)(this.requestQueueDelay)))}),uE(this,"connect",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let b=ux(uD({},a),uy({requiredNamespaces:a.requiredNamespaces||{},optionalNamespaces:a.optionalNamespaces||{}}));await this.isValidConnect(b),b.optionalNamespaces=function(a,b){var c,d,e,f,g,h;let i=qB(a),j=qB(b),k={};for(let a of Object.keys(i).concat(Object.keys(j)))k[a]={chains:mf(null==(c=i[a])?void 0:c.chains,null==(d=j[a])?void 0:d.chains),methods:mf(null==(e=i[a])?void 0:e.methods,null==(f=j[a])?void 0:f.methods),events:mf(null==(g=i[a])?void 0:g.events,null==(h=j[a])?void 0:h.events)};return k}(b.requiredNamespaces,b.optionalNamespaces),b.requiredNamespaces={};let{pairingTopic:c,requiredNamespaces:d,optionalNamespaces:e,sessionProperties:f,scopedProperties:g,relays:h}=b,i=c,j,k=!1;try{if(i){let a=this.client.core.pairing.pairings.get(i);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),k=a.active}}catch(a){throw this.client.logger.error(`connect() -> pairing.get(${i}) failed`),a}if(!i||!k){let{topic:a,uri:b}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});i=a,j=b}if(!i){let{message:a}=qF("NO_MATCHING_KEY",`connect() pairing topic: ${i}`);throw Error(a)}let l=await this.client.core.crypto.generateKeyPair(),m=uo.wc_sessionPropose.req.ttl||iQ.FIVE_MINUTES,n=mc(m),o=ux(uD(uD({requiredNamespaces:d,optionalNamespaces:e,relays:h??[{protocol:"irn"}],proposer:{publicKey:l,metadata:this.client.metadata},expiryTimestamp:n,pairingTopic:i},f&&{sessionProperties:f}),g&&{scopedProperties:g}),uy({id:(0,rG.payloadId)()})),p=me("session_connect",o.id),{reject:q,resolve:r,done:s}=l8(m,um),t=({id:a})=>{a===o.id&&(this.client.events.off("proposal_expire",t),this.pendingSessions.delete(o.id),this.events.emit(p,{error:{message:um,code:0}}))};return this.client.events.on("proposal_expire",t),this.events.once(p,({error:a,session:b})=>{this.client.events.off("proposal_expire",t),a?q(a):b&&r(b)}),await this.sendProposeSession({proposal:o,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:o.id}}}),await this.setProposal(o.id,o),{uri:j,approval:s}}),uE(this,"pair",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(a)}catch(a){throw this.client.logger.error("pair() failed"),a}}),uE(this,"approve",async a=>{var b,c,d;let e=this.client.core.eventClient.createEvent({properties:{topic:null==(b=a?.id)?void 0:b.toString(),trace:[sg]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(a){throw e.setError("no_internet_connection"),a}try{await this.isValidProposalId(a?.id)}catch(b){throw this.client.logger.error(`approve() -> proposal.get(${a?.id}) failed`),e.setError("proposal_not_found"),b}try{await this.isValidApprove(a)}catch(a){throw this.client.logger.error("approve() -> isValidApprove() failed"),e.setError("session_approve_namespace_validation_failure"),a}let{id:f,relayProtocol:g,namespaces:h,sessionProperties:i,scopedProperties:j,sessionConfig:k}=a,l=this.client.proposal.get(f);this.client.core.eventClient.deleteEvent({eventId:e.eventId});let{pairingTopic:m,proposer:n,requiredNamespaces:o,optionalNamespaces:p}=l,q=null==(c=this.client.core.eventClient)?void 0:c.getEvent({topic:m});q||(q=null==(d=this.client.core.eventClient)?void 0:d.createEvent({type:sg,properties:{topic:m,trace:[sg,"session_namespaces_validation_success"]}}));let r=await this.client.core.crypto.generateKeyPair(),s=n.publicKey,t=await this.client.core.crypto.generateSharedKey(r,s),u=uD(uD(uD({relay:{protocol:g??"irn"},namespaces:h,controller:{publicKey:r,metadata:this.client.metadata},expiry:mc(un)},i&&{sessionProperties:i}),j&&{scopedProperties:j}),k&&{sessionConfig:k});q.addTrace("subscribing_session_topic");try{await this.client.core.relayer.subscribe(t,{transportType:r$,internal:{skipSubscribe:!0}})}catch(a){throw q.setError("subscribe_session_topic_failure"),a}q.addTrace("subscribe_session_topic_success");let v=ux(uD({},u),uy({topic:t,requiredNamespaces:o,optionalNamespaces:p,pairingTopic:m,acknowledged:!1,self:u.controller,peer:{publicKey:n.publicKey,metadata:n.metadata},controller:r,transportType:r$}));await this.client.session.set(t,v),q.addTrace("store_session");try{await this.sendApproveSession({sessionTopic:t,proposal:l,pairingProposalResponse:{relay:{protocol:g??"irn"},responderPublicKey:r},sessionSettleRequest:u,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:f}}}),q.addTrace("session_approve_publish_success")}catch(a){throw this.client.logger.error(a),this.client.session.delete(t,qG("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(t),a}return this.client.core.eventClient.deleteEvent({eventId:q.eventId}),await this.client.core.pairing.updateMetadata({topic:m,metadata:n.metadata}),await this.deleteProposal(f),await this.client.core.pairing.activate({topic:m}),await this.setExpiry(t,mc(un)),{topic:t,acknowledged:()=>Promise.resolve(this.client.session.get(t))}}),uE(this,"reject",async a=>{let b;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(a)}catch(a){throw this.client.logger.error("reject() -> isValidReject() failed"),a}let{id:c,reason:d}=a;try{b=this.client.proposal.get(c).pairingTopic}catch(a){throw this.client.logger.error(`reject() -> proposal.get(${c}) failed`),a}b&&await this.sendError({id:c,topic:b,error:d,rpcOpts:uo.wc_sessionPropose.reject}),await this.deleteProposal(c)}),uE(this,"update",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(a)}catch(a){throw this.client.logger.error("update() -> isValidUpdate() failed"),a}let{topic:b,namespaces:c}=a,{done:d,resolve:e,reject:f}=l8(),g=(0,rG.payloadId)(),h=(0,rG.getBigIntRpcId)().toString(),i=this.client.session.get(b).namespaces;return this.events.once(me("session_update",g),({error:a})=>{a?f(a):e()}),await this.client.session.update(b,{namespaces:c}),await this.sendRequest({topic:b,method:"wc_sessionUpdate",params:{namespaces:c},throwOnFailedPublish:!0,clientRpcId:g,relayRpcId:h}).catch(a=>{this.client.logger.error(a),this.client.session.update(b,{namespaces:i}),f(a)}),{acknowledged:d}}),uE(this,"extend",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(a)}catch(a){throw this.client.logger.error("extend() -> isValidExtend() failed"),a}let{topic:b}=a,c=(0,rG.payloadId)(),{done:d,resolve:e,reject:f}=l8();return this.events.once(me("session_extend",c),({error:a})=>{a?f(a):e()}),await this.setExpiry(b,mc(un)),this.sendRequest({topic:b,method:"wc_sessionExtend",params:{},clientRpcId:c,throwOnFailedPublish:!0}).catch(a=>{f(a)}),{acknowledged:d}}),uE(this,"request",async a=>{this.isInitialized();try{await this.isValidRequest(a)}catch(a){throw this.client.logger.error("request() -> isValidRequest() failed"),a}let{chainId:b,request:c,topic:d,expiry:e=uo.wc_sessionRequest.req.ttl}=a,f=this.client.session.get(d);f?.transportType===r$&&await this.confirmOnlineStateOrThrow();let g=(0,rG.payloadId)(),h=(0,rG.getBigIntRpcId)().toString(),{done:i,resolve:j,reject:k}=l8(e,"Request expired. Please try again.");this.events.once(me("session_request",g),({error:a,result:b})=>{a?k(a):j(b)});let l="wc_sessionRequest",m=this.getAppLinkIfEnabled(f.peer.metadata,f.transportType);if(m)return await this.sendRequest({clientRpcId:g,relayRpcId:h,topic:d,method:l,params:{request:ux(uD({},c),uy({expiryTimestamp:mc(e)})),chainId:b},expiry:e,throwOnFailedPublish:!0,appLink:m}).catch(a=>k(a)),this.client.events.emit("session_request_sent",{topic:d,request:c,chainId:b,id:g}),await i();let n={request:ux(uD({},c),uy({expiryTimestamp:mc(e)})),chainId:b};return await Promise.all([new Promise(async a=>{await this.sendRequest({clientRpcId:g,relayRpcId:h,topic:d,method:l,params:n,expiry:e,throwOnFailedPublish:!0,tvf:this.getTVFParams(g,n)}).catch(a=>k(a)),this.client.events.emit("session_request_sent",{topic:d,request:c,chainId:b,id:g}),a()}),new Promise(async a=>{var b;if(!(null!=(b=f.sessionConfig)&&b.disableDeepLink)){let a=await mh(this.client.core.storage,ul);await mg({id:g,topic:d,wcDeepLink:a})}a()}),i()]).then(a=>a[2])}),uE(this,"respond",async a=>{var b,c;this.isInitialized();let d=this.client.core.eventClient.createEvent({properties:{topic:a?.topic||(null==(c=null==(b=a?.response)?void 0:b.id)?void 0:c.toString()),trace:["session_request_response_started"]}});try{await this.isValidRespond(a)}catch(a){throw d.addTrace(a?.message),d.setError("session_request_response_validation_failure"),a}d.addTrace("session_request_response_validation_success");let{topic:e,response:f}=a,{id:g}=f,h=this.client.session.get(e);h.transportType===r$&&await this.confirmOnlineStateOrThrow();let i=this.getAppLinkIfEnabled(h.peer.metadata,h.transportType);try{d.addTrace("session_request_response_publish_started"),(0,rH.isJsonRpcResult)(f)?await this.sendResult({id:g,topic:e,result:f.result,throwOnFailedPublish:!0,appLink:i}):(0,rH.isJsonRpcError)(f)&&await this.sendError({id:g,topic:e,error:f.error,appLink:i}),this.cleanupAfterResponse(a)}catch(a){throw d.addTrace(a?.message),d.setError("session_request_response_publish_failure"),a}}),uE(this,"ping",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(a)}catch(a){throw this.client.logger.error("ping() -> isValidPing() failed"),a}let{topic:b}=a;if(this.client.session.keys.includes(b)){let a=(0,rG.payloadId)(),c=(0,rG.getBigIntRpcId)().toString(),{done:d,resolve:e,reject:f}=l8();this.events.once(me("session_ping",a),({error:a})=>{a?f(a):e()}),await Promise.all([this.sendRequest({topic:b,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:a,relayRpcId:c}),d()])}else this.client.core.pairing.pairings.keys.includes(b)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:b}))}),uE(this,"emit",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(a);let{topic:b,event:c,chainId:d}=a,e=(0,rG.getBigIntRpcId)().toString(),f=(0,rG.payloadId)();await this.sendRequest({topic:b,method:"wc_sessionEvent",params:{event:c,chainId:d},throwOnFailedPublish:!0,relayRpcId:e,clientRpcId:f})}),uE(this,"disconnect",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(a);let{topic:b}=a;if(this.client.session.keys.includes(b))await this.sendRequest({topic:b,method:"wc_sessionDelete",params:qG("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:b,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(b))await this.client.core.pairing.disconnect({topic:b});else{let{message:a}=qF("MISMATCHED_TOPIC",`Session or pairing topic not found: ${b}`);throw Error(a)}}),uE(this,"find",a=>(this.isInitialized(),this.client.session.getAll().filter(b=>(function(a,b){let{requiredNamespaces:c}=b,d=Object.keys(a.namespaces),e=Object.keys(c),f=!0;return!!l5(e,d)&&(d.forEach(b=>{let{accounts:d,methods:e,events:g}=a.namespaces[b],h=qy(d),i=c[b];l5(lN(b,i),h)&&l5(i.methods,e)&&l5(i.events,g)||(f=!1)}),f)})(b,a)))),uE(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),uE(this,"authenticate",async(a,b)=>{var c,d,e,f,g;let h;this.isInitialized(),this.isValidAuthenticate(a);let i=b&&this.client.core.linkModeSupportedApps.includes(b)&&(null==(c=this.client.metadata.redirect)?void 0:c.linkMode),j=i?rZ:r$;j===r$&&await this.confirmOnlineStateOrThrow();let{chains:k,statement:l="",uri:m,domain:n,nonce:o,type:p,exp:q,nbf:r,methods:s=[],expiry:t}=a,u=[...a.resources||[]],{topic:v,uri:w}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:j});this.client.logger.info({message:"Generated new pairing",pairing:{topic:v,uri:w}});let x=await this.client.core.crypto.generateKeyPair(),y=p2(x);if(await Promise.all([this.client.auth.authKeys.set(uv,{responseTopic:y,publicKey:x}),this.client.auth.pairingTopics.set(y,{topic:y,pairingTopic:v})]),await this.client.core.relayer.subscribe(y,{transportType:j}),this.client.logger.info(`sending request to new pairing topic: ${v}`),s.length>0){let a,b,{namespace:c}=lL(k[0]),h=n1(function(a,b,c,d={}){return c?.sort((a,b)=>a.localeCompare(b)),{att:{[a]:function(a,b,c={}){return Object.assign({},...(b=b?.sort((a,b)=>a.localeCompare(b))).map(b=>({[`${a}/${b}`]:[c]})))}(b,c,d)}}}(c,"request",s));n5(u)&&(d=h,e=u.pop(),h=n1((f=n2(d),g=n2(e),n0(f),n0(g),a=Object.keys(f.att).concat(Object.keys(g.att)).sort((a,b)=>a.localeCompare(b)),b={att:{}},a.forEach(a=>{var c,d;Object.keys((null==(c=f.att)?void 0:c[a])||{}).concat(Object.keys((null==(d=g.att)?void 0:d[a])||{})).sort((a,b)=>a.localeCompare(b)).forEach(c=>{var d,e;b.att[a]=nR(((a,b)=>{for(var c in b||(b={}))nU.call(b,c)&&nW(a,c,b[c]);if(nT)for(var c of nT(b))nV.call(b,c)&&nW(a,c,b[c]);return a})({},b.att[a]),nS({[c]:(null==(d=f.att[a])?void 0:d[c])||(null==(e=g.att[a])?void 0:e[c])}))})}),b))),u.push(h)}let z=t&&t>uo.wc_sessionAuthenticate.req.ttl?t:uo.wc_sessionAuthenticate.req.ttl,A={authPayload:{type:p??"caip122",chains:k,statement:l,aud:m,domain:n,version:"1",nonce:o,iat:new Date().toISOString(),exp:q,nbf:r,resources:u},requester:{publicKey:x,metadata:this.client.metadata},expiryTimestamp:mc(z)},B={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:k,methods:[...new Set(["personal_sign",...s])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:v,proposer:{publicKey:x,metadata:this.client.metadata},expiryTimestamp:mc(uo.wc_sessionPropose.req.ttl),id:(0,rG.payloadId)()},{done:C,resolve:D,reject:E}=l8(z,"Request expired"),F=(0,rG.payloadId)(),G=me("session_connect",B.id),H=me("session_request",F),I=async({error:a,session:b})=>{this.events.off(H,J),a?E(a):b&&D({session:b})},J=async a=>{var c,d,e;let f;if(await this.deletePendingAuthRequest(F,{message:"fulfilled",code:0}),a.error){let b=qG("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return a.error.code===b.code?void 0:(this.events.off(G,I),E(a.error.message))}await this.deleteProposal(B.id),this.events.off(G,I);let{cacaos:g,responder:h}=a.result,i=[],k=[];for(let a of g){await n$({cacao:a,projectId:this.client.core.projectId})||(this.client.logger.error(a,"Signature verification failed"),E(qG("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:b}=a,c=n5(b.resources),d=[nY(b.iss)],e=nZ(b.iss);if(c){let a=n3(c),b=n4(c);i.push(...a),d.push(...b)}for(let a of d)k.push(`${a}:${e}`)}let l=await this.client.core.crypto.generateSharedKey(x,h.publicKey);i.length>0&&(f={topic:l,acknowledged:!0,self:{publicKey:x,metadata:this.client.metadata},peer:h,controller:h.publicKey,expiry:mc(un),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:v,namespaces:qC([...new Set(i)],[...new Set(k)]),transportType:j},await this.client.core.relayer.subscribe(l,{transportType:j}),await this.client.session.set(l,f),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:h.metadata}),f=this.client.session.get(l)),null!=(c=this.client.metadata.redirect)&&c.linkMode&&null!=(d=h.metadata.redirect)&&d.linkMode&&null!=(e=h.metadata.redirect)&&e.universal&&b&&(this.client.core.addLinkModeSupportedApp(h.metadata.redirect.universal),this.client.session.update(l,{transportType:rZ})),D({auths:g,session:f})};this.events.once(G,I),this.events.once(H,J);try{if(i){let a=(0,rG.formatJsonRpcRequest)("wc_sessionAuthenticate",A,F);this.client.core.history.set(v,a);let c=await this.client.core.crypto.encode("",a,{type:2,encoding:p_});h=qo(b,v,c)}else await Promise.all([this.sendRequest({topic:v,method:"wc_sessionAuthenticate",params:A,expiry:a.expiry,throwOnFailedPublish:!0,clientRpcId:F}),this.sendRequest({topic:v,method:"wc_sessionPropose",params:B,expiry:uo.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:B.id})])}catch(a){throw this.events.off(G,I),this.events.off(H,J),a}return await this.setProposal(B.id,B),await this.setAuthRequest(F,{request:ux(uD({},A),uy({verifyContext:{}})),pairingTopic:v,transportType:j}),{uri:h??w,response:C}}),uE(this,"approveSessionAuthenticate",async a=>{let b,{id:c,auths:d}=a,e=this.client.core.eventClient.createEvent({properties:{topic:c.toString(),trace:["authenticated_session_approve_started"]}});try{this.isInitialized()}catch(a){throw e.setError("no_internet_connection"),a}let f=this.getPendingAuthRequest(c);if(!f)throw e.setError("authenticated_session_pending_request_not_found"),Error(`Could not find pending auth request with id ${c}`);let g=f.transportType||r$;g===r$&&await this.confirmOnlineStateOrThrow();let h=f.requester.publicKey,i=await this.client.core.crypto.generateKeyPair(),j=p2(h),k={type:1,receiverPublicKey:h,senderPublicKey:i},l=[],m=[];for(let a of d){if(!await n$({cacao:a,projectId:this.client.core.projectId})){e.setError("invalid_cacao");let a=qG("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:c,topic:j,error:a,encodeOpts:k}),Error(a.message)}e.addTrace("cacaos_verified");let{p:b}=a,d=n5(b.resources),f=[nY(b.iss)],g=nZ(b.iss);if(d){let a=n3(d),b=n4(d);l.push(...a),f.push(...b)}for(let a of f)m.push(`${a}:${g}`)}let n=await this.client.core.crypto.generateSharedKey(i,h);if(e.addTrace("create_authenticated_session_topic"),l?.length>0){b={topic:n,acknowledged:!0,self:{publicKey:i,metadata:this.client.metadata},peer:{publicKey:h,metadata:f.requester.metadata},controller:h,expiry:mc(un),authentication:d,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:f.pairingTopic,namespaces:qC([...new Set(l)],[...new Set(m)]),transportType:g},e.addTrace("subscribing_authenticated_session_topic");try{await this.client.core.relayer.subscribe(n,{transportType:g})}catch(a){throw e.setError("subscribe_authenticated_session_topic_failure"),a}e.addTrace("subscribe_authenticated_session_topic_success"),await this.client.session.set(n,b),e.addTrace("store_authenticated_session"),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:f.requester.metadata})}e.addTrace("publishing_authenticated_session_approve");try{await this.sendResult({topic:j,id:c,result:{cacaos:d,responder:{publicKey:i,metadata:this.client.metadata}},encodeOpts:k,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(f.requester.metadata,g)})}catch(a){throw e.setError("authenticated_session_approve_publish_failure"),a}return await this.client.auth.requests.delete(c,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:f.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:e.eventId}),{session:b}}),uE(this,"rejectSessionAuthenticate",async a=>{this.isInitialized();let{id:b,reason:c}=a,d=this.getPendingAuthRequest(b);if(!d)throw Error(`Could not find pending auth request with id ${b}`);d.transportType===r$&&await this.confirmOnlineStateOrThrow();let e=d.requester.publicKey,f=await this.client.core.crypto.generateKeyPair(),g=p2(e);await this.sendError({id:b,topic:g,error:c,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:f},rpcOpts:uo.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(d.requester.metadata,d.transportType)}),await this.client.auth.requests.delete(b,{message:"rejected",code:0}),await this.deleteProposal(b)}),uE(this,"formatAuthMessage",a=>{this.isInitialized();let{request:b,iss:c}=a;return n_(b,c)}),uE(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let a=this.relayMessageCache.shift();a&&await this.onRelayMessage(a)}catch(a){this.client.logger.error(a)}},50)}),uE(this,"cleanupDuplicatePairings",async a=>{if(a.pairingTopic)try{let b=this.client.core.pairing.pairings.get(a.pairingTopic),c=this.client.core.pairing.pairings.getAll().filter(c=>{var d,e;return(null==(d=c.peerMetadata)?void 0:d.url)&&(null==(e=c.peerMetadata)?void 0:e.url)===a.peer.metadata.url&&c.topic&&c.topic!==b.topic});if(0===c.length)return;this.client.logger.info(`Cleaning up ${c.length} duplicate pairing(s)`),await Promise.all(c.map(a=>this.client.core.pairing.disconnect({topic:a.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(a){this.client.logger.error(a)}}),uE(this,"deleteSession",async a=>{var b;let{topic:c,expirerHasDeleted:d=!1,emitEvent:e=!0,id:f=0}=a,{self:g}=this.client.session.get(c);await this.client.core.relayer.unsubscribe(c),await this.client.session.delete(c,qG("USER_DISCONNECTED")),this.addToRecentlyDeleted(c,"session"),this.client.core.crypto.keychain.has(g.publicKey)&&await this.client.core.crypto.deleteKeyPair(g.publicKey),this.client.core.crypto.keychain.has(c)&&await this.client.core.crypto.deleteSymKey(c),d||this.client.core.expirer.del(c),this.client.core.storage.removeItem(ul).catch(a=>this.client.logger.warn(a)),this.getPendingSessionRequests().forEach(a=>{a.topic===c&&this.deletePendingSessionRequest(a.id,qG("USER_DISCONNECTED"))}),c===(null==(b=this.sessionRequestQueue.queue[0])?void 0:b.topic)&&(this.sessionRequestQueue.state=uq),e&&this.client.events.emit("session_delete",{id:f,topic:c})}),uE(this,"deleteProposal",async(a,b)=>{if(b)try{let b=this.client.proposal.get(a),c=this.client.core.eventClient.getEvent({topic:b.pairingTopic});c?.setError("proposal_expired")}catch{}await Promise.all([this.client.proposal.delete(a,qG("USER_DISCONNECTED")),b?Promise.resolve():this.client.core.expirer.del(a)]),this.addToRecentlyDeleted(a,"proposal")}),uE(this,"deletePendingSessionRequest",async(a,b,c=!1)=>{await Promise.all([this.client.pendingRequest.delete(a,b),c?Promise.resolve():this.client.core.expirer.del(a)]),this.addToRecentlyDeleted(a,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(b=>b.id!==a),c&&(this.sessionRequestQueue.state=uq,this.client.events.emit("session_request_expire",{id:a}))}),uE(this,"deletePendingAuthRequest",async(a,b,c=!1)=>{await Promise.all([this.client.auth.requests.delete(a,b),c?Promise.resolve():this.client.core.expirer.del(a)])}),uE(this,"setExpiry",async(a,b)=>{this.client.session.keys.includes(a)&&(this.client.core.expirer.set(a,b),await this.client.session.update(a,{expiry:b}))}),uE(this,"setProposal",async(a,b)=>{this.client.core.expirer.set(a,mc(uo.wc_sessionPropose.req.ttl)),await this.client.proposal.set(a,b)}),uE(this,"setAuthRequest",async(a,b)=>{let{request:c,pairingTopic:d,transportType:e=r$}=b;this.client.core.expirer.set(a,c.expiryTimestamp),await this.client.auth.requests.set(a,{authPayload:c.authPayload,requester:c.requester,expiryTimestamp:c.expiryTimestamp,id:a,pairingTopic:d,verifyContext:c.verifyContext,transportType:e})}),uE(this,"setPendingSessionRequest",async a=>{let{id:b,topic:c,params:d,verifyContext:e}=a,f=d.request.expiryTimestamp||mc(uo.wc_sessionRequest.req.ttl);this.client.core.expirer.set(b,f),await this.client.pendingRequest.set(b,{id:b,topic:c,params:d,verifyContext:e})}),uE(this,"sendRequest",async b=>{let c,d,{topic:e,method:f,params:g,expiry:h,relayRpcId:i,clientRpcId:j,throwOnFailedPublish:k,appLink:l,tvf:m,publishOpts:n={}}=b,o=(0,rG.formatJsonRpcRequest)(f,g,j),p=!!l;try{let a=p?p_:p$;c=await this.client.core.crypto.encode(e,o,{encoding:a})}catch(a){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${e} failed`),a}if(ut.includes(f)){let a=p3(JSON.stringify(o)),b=p3(c);d=await this.client.core.verify.register({id:b,decryptedId:a})}let q=uD(uD({},uo[f].req),n);if(q.attestation=d,h&&(q.ttl=h),i&&(q.id=i),this.client.core.history.set(e,o),p){let b=qo(l,e,c);await a.g.Linking.openURL(b,this.client.name)}else{let a;q.tvf=ux(uD({},m),uy({correlationId:o.id})),k?(a=uD({},q.internal),q.internal=ux(a,uy({throwOnFailedPublish:!0})),await this.client.core.relayer.publish(e,c,q)):this.client.core.relayer.publish(e,c,q).catch(a=>this.client.logger.error(a))}return o.id}),uE(this,"sendProposeSession",async a=>{let{proposal:b,publishOpts:c}=a,d=(0,rG.formatJsonRpcRequest)("wc_sessionPropose",b,b.id);this.client.core.history.set(b.pairingTopic,d);let e=await this.client.core.crypto.encode(b.pairingTopic,d,{encoding:p$}),f=p3(JSON.stringify(d)),g=p3(e),h=await this.client.core.verify.register({id:g,decryptedId:f});await this.client.core.relayer.publishCustom({payload:{pairingTopic:b.pairingTopic,sessionProposal:e},opts:ux(uD({},c),uy({publishMethod:"wc_proposeSession",attestation:h}))})}),uE(this,"sendApproveSession",async a=>{let{sessionTopic:b,pairingProposalResponse:c,proposal:d,sessionSettleRequest:e,publishOpts:f}=a,g=(0,rG.formatJsonRpcResult)(d.id,c),h=await this.client.core.crypto.encode(d.pairingTopic,g,{encoding:p$}),i=(0,rG.formatJsonRpcRequest)("wc_sessionSettle",e,f?.id),j=await this.client.core.crypto.encode(b,i,{encoding:p$});this.client.core.history.set(b,i),await this.client.core.relayer.publishCustom({payload:{sessionTopic:b,pairingTopic:d.pairingTopic,sessionProposalResponse:h,sessionSettlementRequest:j},opts:ux(uD({},f),uy({publishMethod:"wc_approveSession"}))})}),uE(this,"sendResult",async b=>{let c,d,e,{id:f,topic:g,result:h,throwOnFailedPublish:i,encodeOpts:j,appLink:k}=b,l=(0,rG.formatJsonRpcResult)(f,h),m=k&&"u">typeof(null==a.g?void 0:a.g.Linking);try{let a,b,d=m?p_:p$;c=await this.client.core.crypto.encode(g,l,(a=uD({},j||{}),b={encoding:d},ux(a,uy(b))))}catch(a){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${g} failed`),a}try{let a=(d=await this.client.core.history.get(g,f)).request;try{e=this.getTVFParams(f,a.params,h)}catch(a){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${a?.message}`)}}catch(a){throw this.client.logger.error(`sendResult() -> history.get(${g}, ${f}) failed`),a}if(m){let b=qo(k,g,c);await a.g.Linking.openURL(b,this.client.name)}else{let a,b=uo[d.request.method].res;b.tvf=ux(uD({},e),uy({correlationId:f})),i?(a=uD({},b.internal),b.internal=ux(a,uy({throwOnFailedPublish:!0})),await this.client.core.relayer.publish(g,c,b)):this.client.core.relayer.publish(g,c,b).catch(a=>this.client.logger.error(a))}await this.client.core.history.resolve(l)}),uE(this,"sendError",async b=>{let c,d,{id:e,topic:f,error:g,encodeOpts:h,rpcOpts:i,appLink:j}=b,k=(0,rG.formatJsonRpcError)(e,g),l=j&&"u">typeof(null==a.g?void 0:a.g.Linking);try{let a,b,d=l?p_:p$;c=await this.client.core.crypto.encode(f,k,(a=uD({},h||{}),b={encoding:d},ux(a,uy(b))))}catch(a){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${f} failed`),a}try{d=await this.client.core.history.get(f,e)}catch(a){throw this.client.logger.error(`sendError() -> history.get(${f}, ${e}) failed`),a}if(l){let b=qo(j,f,c);await a.g.Linking.openURL(b,this.client.name)}else{let a=d.request.method,b=i||uo[a].res;this.client.core.relayer.publish(f,c,b)}await this.client.core.history.resolve(k)}),uE(this,"cleanup",async()=>{let a=[],b=[];this.client.session.getAll().forEach(b=>{let c=!1;md(b.expiry)&&(c=!0),this.client.core.crypto.keychain.has(b.topic)||(c=!0),c&&a.push(b.topic)}),this.client.proposal.getAll().forEach(a=>{md(a.expiryTimestamp)&&b.push(a.id)}),await Promise.all([...a.map(a=>this.deleteSession({topic:a})),...b.map(a=>this.deleteProposal(a))])}),uE(this,"onProviderMessageEvent",async a=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(a):await this.onRelayMessage(a)}),uE(this,"onRelayEventRequest",async a=>{this.requestQueue.queue.push(a),await this.processRequestsQueue()}),uE(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===ur)return void this.client.logger.info("Request queue already active, skipping...");for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ur;let a=this.requestQueue.queue.shift();if(a)try{await this.processRequest(a)}catch(a){this.client.logger.warn(a)}}this.requestQueue.state=uq}),uE(this,"processRequest",async a=>{let{topic:b,payload:c,attestation:d,transportType:e,encryptedId:f}=a,g=c.method;if(!this.shouldIgnorePairingRequest({topic:b,requestMethod:g}))switch(g){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:b,payload:c,attestation:d,encryptedId:f});case"wc_sessionSettle":return await this.onSessionSettleRequest(b,c);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(b,c);case"wc_sessionExtend":return await this.onSessionExtendRequest(b,c);case"wc_sessionPing":return await this.onSessionPingRequest(b,c);case"wc_sessionDelete":return await this.onSessionDeleteRequest(b,c);case"wc_sessionRequest":return await this.onSessionRequest({topic:b,payload:c,attestation:d,encryptedId:f,transportType:e});case"wc_sessionEvent":return await this.onSessionEventRequest(b,c);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:b,payload:c,attestation:d,encryptedId:f,transportType:e});default:return this.client.logger.info(`Unsupported request method ${g}`)}}),uE(this,"onRelayEventResponse",async a=>{let{topic:b,payload:c,transportType:d}=a,e=(await this.client.core.history.get(b,c.id)).request.method;switch(e){case"wc_sessionPropose":return this.onSessionProposeResponse(b,c,d);case"wc_sessionSettle":return this.onSessionSettleResponse(b,c);case"wc_sessionUpdate":return this.onSessionUpdateResponse(b,c);case"wc_sessionExtend":return this.onSessionExtendResponse(b,c);case"wc_sessionPing":return this.onSessionPingResponse(b,c);case"wc_sessionRequest":return this.onSessionRequestResponse(b,c);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(b,c);default:return this.client.logger.info(`Unsupported response method ${e}`)}}),uE(this,"onRelayEventUnknownPayload",a=>{let{topic:b}=a,{message:c}=qF("MISSING_OR_INVALID",`Decoded payload on topic ${b} is not identifiable as a JSON-RPC request or a response.`);throw Error(c)}),uE(this,"shouldIgnorePairingRequest",a=>{let{topic:b,requestMethod:c}=a,d=this.expectedPairingMethodMap.get(b);return!(!d||d.includes(c))&&!!(d.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),uE(this,"onSessionProposeRequest",async a=>{let{topic:b,payload:c,attestation:d,encryptedId:e}=a,{params:f,id:g}=c;try{let a=this.client.core.eventClient.getEvent({topic:b});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),a?.setError("proposal_listener_not_found")),this.isValidConnect(uD({},c.params));let h=f.expiryTimestamp||mc(uo.wc_sessionPropose.req.ttl),i=uD({id:g,pairingTopic:b,expiryTimestamp:h,attestation:d,encryptedId:e},f);await this.setProposal(g,i);let j=await this.getVerifyContext({attestationId:d,hash:p3(JSON.stringify(c)),encryptedId:e,metadata:i.proposer.metadata});a?.addTrace("emit_session_proposal"),this.client.events.emit("session_proposal",{id:g,params:i,verifyContext:j})}catch(a){await this.sendError({id:g,topic:b,error:a,rpcOpts:uo.wc_sessionPropose.autoReject}),this.client.logger.error(a)}}),uE(this,"onSessionProposeResponse",async(a,b,c)=>{let{id:d}=b;if((0,rH.isJsonRpcResult)(b)){let{result:e}=b;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:e});let f=this.client.proposal.get(d);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});let g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});let h=e.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});let i=await this.client.core.crypto.generateSharedKey(g,h);this.pendingSessions.set(d,{sessionTopic:i,pairingTopic:a,proposalId:d,publicKey:g});let j=await this.client.core.relayer.subscribe(i,{transportType:c});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:j}),await this.client.core.pairing.activate({topic:a})}else if((0,rH.isJsonRpcError)(b)){await this.deleteProposal(d);let a=me("session_connect",d);if(0===this.events.listenerCount(a))throw Error(`emitting ${a} without any listeners, 954`);this.events.emit(a,{error:b.error})}}),uE(this,"onSessionSettleRequest",async(a,b)=>{let{id:c,params:d}=b;try{let c,e;this.isValidSessionSettleRequest(d);let{relay:f,controller:g,expiry:h,namespaces:i,sessionProperties:j,scopedProperties:k,sessionConfig:l}=b.params,m=[...this.pendingSessions.values()].find(b=>b.sessionTopic===a);if(!m)return this.client.logger.error(`Pending session not found for topic ${a}`);let n=this.client.proposal.get(m.proposalId),o=(c=uD(uD(uD({topic:a,relay:f,expiry:h,namespaces:i,acknowledged:!0,pairingTopic:m.pairingTopic,requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,controller:g.publicKey,self:{publicKey:m.publicKey,metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},j&&{sessionProperties:j}),k&&{scopedProperties:k}),l&&{sessionConfig:l}),e={transportType:r$},ux(c,uy(e)));await this.client.session.set(o.topic,o),await this.setExpiry(o.topic,o.expiry),await this.client.core.pairing.updateMetadata({topic:m.pairingTopic,metadata:o.peer.metadata}),this.client.events.emit("session_connect",{session:o}),this.events.emit(me("session_connect",m.proposalId),{session:o}),this.pendingSessions.delete(m.proposalId),this.deleteProposal(m.proposalId,!1),this.cleanupDuplicatePairings(o),await this.sendResult({id:b.id,topic:a,result:!0})}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),uE(this,"onSessionSettleResponse",async(a,b)=>{let{id:c}=b;(0,rH.isJsonRpcResult)(b)?(await this.client.session.update(a,{acknowledged:!0}),this.events.emit(me("session_approve",c),{})):(0,rH.isJsonRpcError)(b)&&(await this.client.session.delete(a,qG("USER_DISCONNECTED")),this.events.emit(me("session_approve",c),{error:b.error}))}),uE(this,"onSessionUpdateRequest",async(a,b)=>{let{params:c,id:d}=b;try{let b=`${a}_session_update`,e=qY.get(b);if(e&&this.isRequestOutOfSync(e,d)){this.client.logger.warn(`Discarding out of sync request - ${d}`),this.sendError({id:d,topic:a,error:qG("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(uD({topic:a},c));try{qY.set(b,d),await this.client.session.update(a,{namespaces:c.namespaces}),await this.sendResult({id:d,topic:a,result:!0})}catch(a){throw qY.delete(b),a}this.client.events.emit("session_update",{id:d,topic:a,params:c})}catch(b){await this.sendError({id:d,topic:a,error:b}),this.client.logger.error(b)}}),uE(this,"isRequestOutOfSync",(a,b)=>b.toString().slice(0,-3)<a.toString().slice(0,-3)),uE(this,"onSessionUpdateResponse",(a,b)=>{let{id:c}=b,d=me("session_update",c);if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners`);(0,rH.isJsonRpcResult)(b)?this.events.emit(me("session_update",c),{}):(0,rH.isJsonRpcError)(b)&&this.events.emit(me("session_update",c),{error:b.error})}),uE(this,"onSessionExtendRequest",async(a,b)=>{let{id:c}=b;try{this.isValidExtend({topic:a}),await this.setExpiry(a,mc(un)),await this.sendResult({id:c,topic:a,result:!0}),this.client.events.emit("session_extend",{id:c,topic:a})}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),uE(this,"onSessionExtendResponse",(a,b)=>{let{id:c}=b,d=me("session_extend",c);if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners`);(0,rH.isJsonRpcResult)(b)?this.events.emit(me("session_extend",c),{}):(0,rH.isJsonRpcError)(b)&&this.events.emit(me("session_extend",c),{error:b.error})}),uE(this,"onSessionPingRequest",async(a,b)=>{let{id:c}=b;try{this.isValidPing({topic:a}),await this.sendResult({id:c,topic:a,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:c,topic:a})}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),uE(this,"onSessionPingResponse",(a,b)=>{let{id:c}=b,d=me("session_ping",c);setTimeout(()=>{if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners 2176`);(0,rH.isJsonRpcResult)(b)?this.events.emit(me("session_ping",c),{}):(0,rH.isJsonRpcError)(b)&&this.events.emit(me("session_ping",c),{error:b.error})},500)}),uE(this,"onSessionDeleteRequest",async(a,b)=>{let{id:c}=b;try{this.isValidDisconnect({topic:a,reason:b.params}),await Promise.all([new Promise(b=>{this.client.core.relayer.once(rT,async()=>{b(await this.deleteSession({topic:a,id:c}))})}),this.sendResult({id:c,topic:a,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:a,error:qG("USER_DISCONNECTED")})]).catch(a=>this.client.logger.error(a))}catch(a){this.client.logger.error(a)}}),uE(this,"onSessionRequest",async a=>{var b,c,d;let{topic:e,payload:f,attestation:g,encryptedId:h,transportType:i}=a,{id:j,params:k}=f;try{await this.isValidRequest(uD({topic:e},k));let a=this.client.session.get(e),f=await this.getVerifyContext({attestationId:g,hash:p3(JSON.stringify((0,rG.formatJsonRpcRequest)("wc_sessionRequest",k,j))),encryptedId:h,metadata:a.peer.metadata,transportType:i}),l={id:j,topic:e,params:k,verifyContext:f};await this.setPendingSessionRequest(l),i===rZ&&null!=(b=a.peer.metadata.redirect)&&b.universal&&this.client.core.addLinkModeSupportedApp(null==(c=a.peer.metadata.redirect)?void 0:c.universal),null!=(d=this.client.signConfig)&&d.disableRequestQueue?this.emitSessionRequest(l):(this.addSessionRequestToSessionRequestQueue(l),this.processSessionRequestQueue())}catch(a){await this.sendError({id:j,topic:e,error:a}),this.client.logger.error(a)}}),uE(this,"onSessionRequestResponse",(a,b)=>{let{id:c}=b,d=me("session_request",c);if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners`);(0,rH.isJsonRpcResult)(b)?this.events.emit(me("session_request",c),{result:b.result}):(0,rH.isJsonRpcError)(b)&&this.events.emit(me("session_request",c),{error:b.error})}),uE(this,"onSessionEventRequest",async(a,b)=>{let{id:c,params:d}=b;try{let b=`${a}_session_event_${d.event.name}`,e=qY.get(b);if(e&&this.isRequestOutOfSync(e,c))return void this.client.logger.info(`Discarding out of sync request - ${c}`);this.isValidEmit(uD({topic:a},d)),this.client.events.emit("session_event",{id:c,topic:a,params:d}),qY.set(b,c)}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),uE(this,"onSessionAuthenticateResponse",(a,b)=>{let{id:c}=b;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:a,payload:b}),(0,rH.isJsonRpcResult)(b)?this.events.emit(me("session_request",c),{result:b.result}):(0,rH.isJsonRpcError)(b)&&this.events.emit(me("session_request",c),{error:b.error})}),uE(this,"onSessionAuthenticateRequest",async a=>{var b;let{topic:c,payload:d,attestation:e,encryptedId:f,transportType:g}=a;try{let{requester:a,authPayload:h,expiryTimestamp:i}=d.params,j=await this.getVerifyContext({attestationId:e,hash:p3(JSON.stringify(d)),encryptedId:f,metadata:a.metadata,transportType:g}),k={requester:a,pairingTopic:c,id:d.id,authPayload:h,verifyContext:j,expiryTimestamp:i};await this.setAuthRequest(d.id,{request:k,pairingTopic:c,transportType:g}),g===rZ&&null!=(b=a.metadata.redirect)&&b.universal&&this.client.core.addLinkModeSupportedApp(a.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:c,params:d.params,id:d.id,verifyContext:j})}catch(f){this.client.logger.error(f);let a=d.params.requester.publicKey,b=await this.client.core.crypto.generateKeyPair(),e=this.getAppLinkIfEnabled(d.params.requester.metadata,g);await this.sendError({id:d.id,topic:c,error:f,encodeOpts:{type:1,receiverPublicKey:a,senderPublicKey:b},rpcOpts:uo.wc_sessionAuthenticate.autoReject,appLink:e})}}),uE(this,"addSessionRequestToSessionRequestQueue",a=>{this.sessionRequestQueue.queue.push(a)}),uE(this,"cleanupAfterResponse",a=>{this.deletePendingSessionRequest(a.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=uq,this.processSessionRequestQueue()},(0,iQ.toMiliseconds)(this.requestQueueDelay))}),uE(this,"cleanupPendingSentRequestsForTopic",({topic:a,error:b})=>{let c=this.client.core.history.pending;c.length>0&&c.filter(b=>b.topic===a&&"wc_sessionRequest"===b.request.method).forEach(a=>{let c=me("session_request",a.request.id);if(0===this.events.listenerCount(c))throw Error(`emitting ${c} without any listeners`);this.events.emit(me("session_request",a.request.id),{error:b})})}),uE(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===ur)return void this.client.logger.info("session request queue is already active.");let a=this.sessionRequestQueue.queue[0];if(!a)return void this.client.logger.info("session request queue is empty.");try{this.emitSessionRequest(a)}catch(a){this.client.logger.error(a)}}),uE(this,"emitSessionRequest",a=>{this.emittedSessionRequests.has(a.id)?this.client.logger.warn({id:a.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${a.id}`):(this.sessionRequestQueue.state=ur,this.emittedSessionRequests.add(a.id),this.client.events.emit("session_request",a))}),uE(this,"onPairingCreated",a=>{if(a.methods&&this.expectedPairingMethodMap.set(a.topic,a.methods),a.active)return;let b=this.client.proposal.getAll().find(b=>b.pairingTopic===a.topic);b&&this.onSessionProposeRequest({topic:a.topic,payload:(0,rG.formatJsonRpcRequest)("wc_sessionPropose",ux(uD({},b),uy({requiredNamespaces:b.requiredNamespaces,optionalNamespaces:b.optionalNamespaces,relays:b.relays,proposer:b.proposer,sessionProperties:b.sessionProperties,scopedProperties:b.scopedProperties})),b.id),attestation:b.attestation,encryptedId:b.encryptedId})}),uE(this,"isValidConnect",async a=>{let b;if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(a)}`);throw Error(b)}let{pairingTopic:c,requiredNamespaces:d,optionalNamespaces:e,sessionProperties:f,scopedProperties:g,relays:h}=a;if(qJ(c)||await this.isValidPairingTopic(c),b=!1,h?h&&qH(h)&&h.length&&h.forEach(a=>{b=qQ(a)}):b=!0,!b){let{message:a}=qF("MISSING_OR_INVALID",`connect() relays: ${h}`);throw Error(a)}if(d&&!qJ(d)&&0!==qI(d)){let a="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(a):this.client.logger.warn(a),this.validateNamespaces(d,"requiredNamespaces")}if(e&&!qJ(e)&&0!==qI(e)&&this.validateNamespaces(e,"optionalNamespaces"),f&&!qJ(f)&&this.validateSessionProps(f,"sessionProperties"),g&&!qJ(g)){this.validateSessionProps(g,"scopedProperties");let a=Object.keys(d||{}).concat(Object.keys(e||{}));if(!Object.keys(g).every(b=>a.includes(b.split(":")[0])))throw Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(g)}, required/optional namespaces: ${JSON.stringify(a)}`)}}),uE(this,"validateNamespaces",(a,b)=>{let c=function(a,b,c){let d=null;if(a&&qI(a)){let e,f=qO(a,b);f&&(d=f);let g=(e=null,Object.entries(a).forEach(([a,d])=>{var f,g;let h;if(e)return;let i=(f=lN(a,d),g=`${b} ${c}`,h=null,qH(f)&&f.length?f.forEach(a=>{h||qM(a)||(h=qG("UNSUPPORTED_CHAINS",`${g}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):qM(a)||(h=qG("UNSUPPORTED_CHAINS",`${g}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),h);i&&(e=i)}),e);g&&(d=g)}else d=qF("MISSING_OR_INVALID",`${b}, ${c} should be an object with data`);return d}(a,"connect()",b);if(c)throw Error(c.message)}),uE(this,"isValidApprove",async a=>{if(!qR(a))throw Error(qF("MISSING_OR_INVALID",`approve() params: ${a}`).message);let{id:b,namespaces:c,relayProtocol:d,sessionProperties:e,scopedProperties:f}=a;this.checkRecentlyDeleted(b),await this.isValidProposalId(b);let g=this.client.proposal.get(b),h=qP(c,"approve()");if(h)throw Error(h.message);let i=qT(g.requiredNamespaces,c,"approve()");if(i)throw Error(i.message);if(!qK(d,!0)){let{message:a}=qF("MISSING_OR_INVALID",`approve() relayProtocol: ${d}`);throw Error(a)}if(e&&!qJ(e)&&this.validateSessionProps(e,"sessionProperties"),f&&!qJ(f)){this.validateSessionProps(f,"scopedProperties");let a=new Set(Object.keys(c));if(!Object.keys(f).every(b=>a.has(b.split(":")[0])))throw Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(f)}, approved namespaces: ${Array.from(a).join(", ")}`)}}),uE(this,"isValidReject",async a=>{if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`reject() params: ${a}`);throw Error(b)}let{id:b,reason:c}=a;if(this.checkRecentlyDeleted(b),await this.isValidProposalId(b),!c||"object"!=typeof c||!c.code||!qL(c.code,!1)||!c.message||!qK(c.message,!1)){let{message:a}=qF("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(c)}`);throw Error(a)}}),uE(this,"isValidSessionSettleRequest",a=>{let b;if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${a}`);throw Error(b)}let{relay:c,controller:d,namespaces:e,expiry:f}=a;if(!qQ(c)){let{message:a}=qF("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(a)}let g=(b=null,qK(d?.publicKey,!1)||(b=qF("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),b);if(g)throw Error(g.message);let h=qP(e,"onSessionSettleRequest()");if(h)throw Error(h.message);if(md(f)){let{message:a}=qF("EXPIRED","onSessionSettleRequest()");throw Error(a)}}),uE(this,"isValidUpdate",async a=>{if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`update() params: ${a}`);throw Error(b)}let{topic:b,namespaces:c}=a;this.checkRecentlyDeleted(b),await this.isValidSessionTopic(b);let d=this.client.session.get(b),e=qP(c,"update()");if(e)throw Error(e.message);let f=qT(d.requiredNamespaces,c,"update()");if(f)throw Error(f.message)}),uE(this,"isValidExtend",async a=>{if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`extend() params: ${a}`);throw Error(b)}let{topic:b}=a;this.checkRecentlyDeleted(b),await this.isValidSessionTopic(b)}),uE(this,"isValidRequest",async a=>{var b;let c;if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`request() params: ${a}`);throw Error(b)}let{topic:d,request:e,chainId:f,expiry:g}=a;this.checkRecentlyDeleted(d),await this.isValidSessionTopic(d);let{namespaces:h}=this.client.session.get(d);if(!qS(h,f)){let{message:a}=qF("MISSING_OR_INVALID",`request() chainId: ${f}`);throw Error(a)}if(qJ(e)||!qK(e.method,!1)){let{message:a}=qF("MISSING_OR_INVALID",`request() ${JSON.stringify(e)}`);throw Error(a)}if(!(qK(b=e.method,!1)&&(c=[],Object.values(h).forEach(a=>{qy(a.accounts).includes(f)&&c.push(...a.methods)}),c).includes(b))){let{message:a}=qF("MISSING_OR_INVALID",`request() method: ${e.method}`);throw Error(a)}if(g&&(!qL(g,!1)||!(g<=up.max)||!(g>=up.min))){let{message:a}=qF("MISSING_OR_INVALID",`request() expiry: ${g}. Expiry must be a number (in seconds) between ${up.min} and ${up.max}`);throw Error(a)}}),uE(this,"isValidRespond",async a=>{var b;if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`respond() params: ${a}`);throw Error(b)}let{topic:c,response:d}=a;try{await this.isValidSessionTopic(c)}catch(c){throw null!=(b=a?.response)&&b.id&&this.cleanupAfterResponse(a),c}if(qJ(d)||qJ(d.result)&&qJ(d.error)||!qL(d.id,!1)||!qK(d.jsonrpc,!1)){let{message:a}=qF("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(d)}`);throw Error(a)}let e=this.client.pendingRequest.get(d.id);if(e.topic!==c){let{message:a}=qF("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${d.id}, expected topic: ${e.topic}, received topic: ${c}`);throw Error(a)}}),uE(this,"isValidPing",async a=>{if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`ping() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidSessionOrPairingTopic(b)}),uE(this,"isValidEmit",async a=>{var b;let c;if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`emit() params: ${a}`);throw Error(b)}let{topic:d,event:e,chainId:f}=a;await this.isValidSessionTopic(d);let{namespaces:g}=this.client.session.get(d);if(!qS(g,f)){let{message:a}=qF("MISSING_OR_INVALID",`emit() chainId: ${f}`);throw Error(a)}if(qJ(e)||!qK(e.name,!1)||!(qK(b=e.name,!1)&&(c=[],Object.values(g).forEach(a=>{qy(a.accounts).includes(f)&&c.push(...a.events)}),c).includes(b))){let{message:a}=qF("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(e)}`);throw Error(a)}}),uE(this,"isValidDisconnect",async a=>{if(!qR(a)){let{message:b}=qF("MISSING_OR_INVALID",`disconnect() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidSessionOrPairingTopic(b)}),uE(this,"isValidAuthenticate",a=>{let{chains:b,uri:c,domain:d,nonce:e}=a;if(!Array.isArray(b)||0===b.length)throw Error("chains is required and must be a non-empty array");if(!qK(c,!1))throw Error("uri is required parameter");if(!qK(d,!1))throw Error("domain is required parameter");if(!qK(e,!1))throw Error("nonce is required parameter");if([...new Set(b.map(a=>lL(a).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:f}=lL(b[0]);if("eip155"!==f)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),uE(this,"getVerifyContext",async a=>{let{attestationId:b,hash:c,encryptedId:d,metadata:e,transportType:f}=a,g={verified:{verifyUrl:e.verifyUrl||sc,validation:"UNKNOWN",origin:e.url||""}};try{if(f===rZ){let a=this.getAppLinkIfEnabled(e,f);return g.verified.validation=a&&new URL(a).origin===new URL(e.url).origin?"VALID":"INVALID",g}let a=await this.client.core.verify.resolve({attestationId:b,hash:c,encryptedId:d,verifyUrl:e.verifyUrl});a&&(g.verified.origin=a.origin,g.verified.isScam=a.isScam,g.verified.validation=a.origin===new URL(e.url).origin?"VALID":"INVALID")}catch(a){this.client.logger.warn(a)}return this.client.logger.debug(`Verify context: ${JSON.stringify(g)}`),g}),uE(this,"validateSessionProps",(a,b)=>{Object.values(a).forEach((c,d)=>{if(null==c){let{message:e}=qF("MISSING_OR_INVALID",`${b} must contain an existing value for each key. Received: ${c} for key ${Object.keys(a)[d]}`);throw Error(e)}})}),uE(this,"getPendingAuthRequest",a=>{let b=this.client.auth.requests.get(a);return"object"==typeof b?b:void 0}),uE(this,"addToRecentlyDeleted",(a,b)=>{if(this.recentlyDeletedMap.set(a,b),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let a=0,b=this.recentlyDeletedLimit/2;for(let c of this.recentlyDeletedMap.keys()){if(a++>=b)break;this.recentlyDeletedMap.delete(c)}}}),uE(this,"checkRecentlyDeleted",a=>{let b=this.recentlyDeletedMap.get(a);if(b){let{message:c}=qF("MISSING_OR_INVALID",`Record was recently deleted - ${b}: ${a}`);throw Error(c)}}),uE(this,"isLinkModeEnabled",(b,c)=>{var d,e,f,g,h,i,j,k,l;return!!b&&c===rZ&&(null==(e=null==(d=this.client.metadata)?void 0:d.redirect)?void 0:e.linkMode)===!0&&(null==(g=null==(f=this.client.metadata)?void 0:f.redirect)?void 0:g.universal)!==void 0&&(null==(i=null==(h=this.client.metadata)?void 0:h.redirect)?void 0:i.universal)!==""&&(null==(j=b?.redirect)?void 0:j.universal)!==void 0&&(null==(k=b?.redirect)?void 0:k.universal)!==""&&(null==(l=b?.redirect)?void 0:l.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(b.redirect.universal)&&"u">typeof(null==a.g?void 0:a.g.Linking)}),uE(this,"getAppLinkIfEnabled",(a,b)=>{var c;return this.isLinkModeEnabled(a,b)?null==(c=a?.redirect)?void 0:c.universal:void 0}),uE(this,"handleLinkModeMessage",({url:a})=>{if(!a||!a.includes("wc_ev")||!a.includes("topic"))return;let b=mi(a,"topic")||"",c=decodeURIComponent(mi(a,"wc_ev")||""),d=this.client.session.keys.includes(b);d&&this.client.session.update(b,{transportType:rZ}),this.client.core.dispatchEnvelope({topic:b,message:c,sessionExists:d})}),uE(this,"registerLinkModeListeners",async()=>{var b;if(mk()||l_()&&null!=(b=this.client.metadata.redirect)&&b.linkMode){let b=null==a.g?void 0:a.g.Linking;if("u">typeof b){b.addEventListener("url",this.handleLinkModeMessage,this.client.name);let a=await b.getInitialURL();a&&setTimeout(()=>{this.handleLinkModeMessage({url:a})},50)}}}),uE(this,"getTVFParams",(a,b,c)=>{var d,e,f;if(!(null!=(d=b.request)&&d.method))return{};let g={correlationId:a,rpcMethods:[b.request.method],chainId:b.chainId};try{g.txHashes=this.extractTxHashesFromResult(b.request,c),g.contractAddresses=this.isValidContractData(b.request.params)?[null==(f=null==(e=b.request.params)?void 0:e[0])?void 0:f.to]:[]}catch(a){this.client.logger.warn(a,"Error getting TVF params")}return g}),uE(this,"isValidContractData",a=>{var b;if(!a)return!1;try{let c=a?.data||(null==(b=a?.[0])?void 0:b.data);if(!c.startsWith("0x"))return!1;let d=c.slice(2);return!!/^[0-9a-fA-F]*$/.test(d)&&d.length%2==0}catch{}return!1}),uE(this,"extractTxHashesFromResult",(a,b)=>{var c,d,e,f,g;try{if(!b)return[];let h=a.method,i=us[h];if("sui_signTransaction"===h){let a,c,d,f;return[(e=b.transactionBytes,a=new Uint8Array(Buffer.from(e,"base64")),c=Array.from("TransactionData::").map(a=>a.charCodeAt(0)),(d=new Uint8Array(c.length+a.length)).set(c),d.set(a,c.length),f=nJ(d,{dkLen:32}),lk.default.encode(f))]}if("near_signTransaction"===h)return[nN(b)];if("near_signTransactions"===h)return b.map(a=>nN(a));if("xrpl_signTransactionFor"===h||"xrpl_signTransaction"===h)return[null==(c=b.tx_json)?void 0:c.hash];if("polkadot_signTransaction"===h){let c,e,f,g;return[(d={transaction:a.params.transactionPayload,signature:b.signature},f=Uint8Array.from(Buffer.from(d.signature,"hex")),g=function({publicKey:a,signature:b,payload:c}){var d,e,f;let g,h=qZ(c.method),i=128|parseInt((null==(d=c.version)?void 0:d.toString())||"4"),j=(e=c.address,g=lk.default.decode(e)[0],42===g?0:60===g?2:1),k="00"===c.era?new Uint8Array([0]):qZ(c.era);if(1!==k.length&&2!==k.length)throw Error("Invalid era length");let l=parseInt(c.nonce,16),m=new Uint8Array([255&l,l>>8&255]),n=new Uint8Array([0,...a,j,...b,...k,...m,...function(a){if(a<BigInt(1)<<BigInt(6))return new Uint8Array([Number(a<<BigInt(2))]);if(a<BigInt(1)<<BigInt(14)){let b=a<<BigInt(2)|BigInt(1);return new Uint8Array([Number(b&BigInt(255)),Number(b>>BigInt(8)&BigInt(255))])}if(a<BigInt(1)<<BigInt(30)){let b=a<<BigInt(2)|BigInt(2);return new Uint8Array([Number(b&BigInt(255)),Number(b>>BigInt(8)&BigInt(255)),Number(b>>BigInt(16)&BigInt(255)),Number(b>>BigInt(24)&BigInt(255))])}throw Error("BigInt compact encoding not supported > 2^30")}(BigInt(`0x${(f=c.tip).startsWith("0x")?f.slice(2):f}`)),...h]);return new Uint8Array([...function(a){if(a<64)return new Uint8Array([a<<2]);if(a<16384){let b=a<<2|1;return new Uint8Array([255&b,b>>8&255])}if(a<0x40000000){let b=a<<2|2;return new Uint8Array([255&b,b>>8&255,b>>16&255,b>>24&255])}throw Error("Compact encoding > 2^30 not supported")}(n.length+1),i,...n])}({publicKey:function(a){let b=lk.default.decode(a);if(b.length<33)throw Error("Too short to contain a public key");return b.slice(1,33)}(d.transaction.address),signature:f,payload:d.transaction}),c=qZ(Buffer.from(g).toString("hex")),e=(0,ls.blake2b)(c,void 0,32),"0x"+Buffer.from(e).toString("hex"))]}if("algo_signTxn"===h)return qH(b)?b.map(a=>nO(a)):[nO(b)];if("cosmos_signDirect"===h){let a,c,d,e,f;return[(a=Buffer.from(b.signed.bodyBytes,"base64"),c=Buffer.from(b.signed.authInfoBytes,"base64"),d=Buffer.from(b.signature.signature,"base64"),(e=[]).push(Buffer.from([10])),e.push(nP(a.length)),e.push(a),e.push(Buffer.from([18])),e.push(nP(c.length)),e.push(c),e.push(Buffer.from([26])),e.push(nP(d.length)),e.push(d),f=ny(Buffer.concat(e)),Buffer.from(f).toString("hex").toUpperCase())]}if("wallet_sendCalls"===h){let a=[];try{if("string"==typeof b)return a.push(b),a;if("object"!=typeof b)return a;null!=b&&b.id&&a.push(b.id);let c=null==(g=null==(f=b?.capabilities)?void 0:f.caip345)?void 0:g.transactionHashes;c&&a.push(...c)}catch(a){console.warn("getWalletSendCallsHashes failed: ",a)}return a}if("string"==typeof b)return[b];let j=b[i.key];if(qH(j))return"solana_signAllTransactions"===h?j.map(a=>(function(a){let b=atob(a),c=new Uint8Array(b.length);for(let a=0;a<b.length;a++)c[a]=b.charCodeAt(a);let d=c[0];if(0===d)throw Error("No signatures found");if(c.length<1+64*d)throw Error("Transaction data too short for claimed signature count");if(c.length<100)throw Error("Transaction too short");let e=Buffer.from(a,"base64").slice(1,65);return lk.default.encode(e)})(a)):j;if("string"==typeof j)return[j]}catch(a){this.client.logger.warn(a,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{let a=this.client.session.keys,b=this.client.core.relayer.messages.getWithoutAck(a);for(let[a,c]of Object.entries(b))for(let b of c)try{await this.onProviderMessageEvent({topic:a,message:b,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${a}, message: ${b}`)}}catch(a){this.client.logger.warn(a,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){let{message:a}=qF("NOT_INITIALIZED",this.name);throw Error(a)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(rQ,a=>{this.onProviderMessageEvent(a)})}async onRelayMessage(a){let{topic:b,message:c,attestation:d,transportType:e}=a,{publicKey:f}=this.client.auth.authKeys.keys.includes(uv)?this.client.auth.authKeys.get(uv):{responseTopic:void 0,publicKey:void 0};try{let a=await this.client.core.crypto.decode(b,c,{receiverPublicKey:f,encoding:e===rZ?p_:p$});(0,rH.isJsonRpcRequest)(a)?(this.client.core.history.set(b,a),await this.onRelayEventRequest({topic:b,payload:a,attestation:d,transportType:e,encryptedId:p3(c)})):(0,rH.isJsonRpcResponse)(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:b,payload:a,transportType:e}),this.client.core.history.delete(b,a.id)):await this.onRelayEventUnknownPayload({topic:b,payload:a,transportType:e}),await this.client.core.relayer.messages.ack(b,c)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(sb,async a=>{let{topic:b,id:c}=mb(a.target);return c&&this.client.pendingRequest.keys.includes(c)?await this.deletePendingSessionRequest(c,qF("EXPIRED"),!0):c&&this.client.auth.requests.keys.includes(c)?await this.deletePendingAuthRequest(c,qF("EXPIRED"),!0):void(b?this.client.session.keys.includes(b)&&(await this.deleteSession({topic:b,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:b})):c&&(await this.deleteProposal(c,!0),this.client.events.emit("proposal_expire",{id:c})))})}registerPairingEvents(){this.client.core.pairing.events.on(r4,a=>this.onPairingCreated(a)),this.client.core.pairing.events.on(r5,a=>{this.addToRecentlyDeleted(a.topic,"pairing")})}isValidPairingTopic(a){if(!qK(a,!1)){let{message:b}=qF("MISSING_OR_INVALID",`pairing topic should be a string: ${a}`);throw Error(b)}if(!this.client.core.pairing.pairings.keys.includes(a)){let{message:b}=qF("NO_MATCHING_KEY",`pairing topic doesn't exist: ${a}`);throw Error(b)}if(md(this.client.core.pairing.pairings.get(a).expiry)){let{message:b}=qF("EXPIRED",`pairing topic: ${a}`);throw Error(b)}}async isValidSessionTopic(a){if(!qK(a,!1)){let{message:b}=qF("MISSING_OR_INVALID",`session topic should be a string: ${a}`);throw Error(b)}if(this.checkRecentlyDeleted(a),!this.client.session.keys.includes(a)){let{message:b}=qF("NO_MATCHING_KEY",`session topic doesn't exist: ${a}`);throw Error(b)}if(md(this.client.session.get(a).expiry)){await this.deleteSession({topic:a});let{message:b}=qF("EXPIRED",`session topic: ${a}`);throw Error(b)}if(!this.client.core.crypto.keychain.has(a)){let{message:b}=qF("MISSING_OR_INVALID",`session topic does not exist in keychain: ${a}`);throw await this.deleteSession({topic:a}),Error(b)}}async isValidSessionOrPairingTopic(a){if(this.checkRecentlyDeleted(a),this.client.session.keys.includes(a))await this.isValidSessionTopic(a);else if(this.client.core.pairing.pairings.keys.includes(a))this.isValidPairingTopic(a);else if(qK(a,!1)){let{message:b}=qF("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${a}`);throw Error(b)}else{let{message:b}=qF("MISSING_OR_INVALID",`session or pairing topic should be a string: ${a}`);throw Error(b)}}async isValidProposalId(a){if("number"!=typeof a){let{message:b}=qF("MISSING_OR_INVALID",`proposal id should be a number: ${a}`);throw Error(b)}if(!this.client.proposal.keys.includes(a)){let{message:b}=qF("NO_MATCHING_KEY",`proposal id doesn't exist: ${a}`);throw Error(b)}if(md(this.client.proposal.get(a).expiryTimestamp)){await this.deleteProposal(a);let{message:b}=qF("EXPIRED",`proposal id: ${a}`);throw Error(b)}}}class uG extends tP{constructor(a,b){super(a,b,"proposal",uk),this.core=a,this.logger=b}}class uH extends tP{constructor(a,b){super(a,b,"session",uk),this.core=a,this.logger=b}}class uI extends tP{constructor(a,b){super(a,b,"request",uk,a=>a.id),this.core=a,this.logger=b}}class uJ extends tP{constructor(a,b){super(a,b,"authKeys",uu,()=>uv),this.core=a,this.logger=b}}class uK extends tP{constructor(a,b){super(a,b,"pairingTopics",uu),this.core=a,this.logger=b}}class uL extends tP{constructor(a,b){super(a,b,"requests",uu,a=>a.id),this.core=a,this.logger=b}}var uM=Object.defineProperty,uN=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?uM(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class uO{constructor(a,b){this.core=a,this.logger=b,uN(this,"authKeys"),uN(this,"pairingTopics"),uN(this,"requests"),this.authKeys=new uJ(this.core,this.logger),this.pairingTopics=new uK(this.core,this.logger),this.requests=new uL(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var uP=Object.defineProperty,uQ=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?uP(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class uR extends rD{constructor(a){super(a),uQ(this,"protocol","wc"),uQ(this,"version",2),uQ(this,"name",uj),uQ(this,"metadata"),uQ(this,"core"),uQ(this,"logger"),uQ(this,"events",new cf.EventEmitter),uQ(this,"engine"),uQ(this,"session"),uQ(this,"proposal"),uQ(this,"pendingRequest"),uQ(this,"auth"),uQ(this,"signConfig"),uQ(this,"on",(a,b)=>this.events.on(a,b)),uQ(this,"once",(a,b)=>this.events.once(a,b)),uQ(this,"off",(a,b)=>this.events.off(a,b)),uQ(this,"removeListener",(a,b)=>this.events.removeListener(a,b)),uQ(this,"removeAllListeners",a=>this.events.removeAllListeners(a)),uQ(this,"connect",async a=>{try{return await this.engine.connect(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"pair",async a=>{try{return await this.engine.pair(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"approve",async a=>{try{return await this.engine.approve(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"reject",async a=>{try{return await this.engine.reject(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"update",async a=>{try{return await this.engine.update(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"extend",async a=>{try{return await this.engine.extend(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"request",async a=>{try{return await this.engine.request(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"respond",async a=>{try{return await this.engine.respond(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"ping",async a=>{try{return await this.engine.ping(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"emit",async a=>{try{return await this.engine.emit(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"disconnect",async a=>{try{return await this.engine.disconnect(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"find",a=>{try{return this.engine.find(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"authenticate",async(a,b)=>{try{return await this.engine.authenticate(a,b)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"formatAuthMessage",a=>{try{return this.engine.formatAuthMessage(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"approveSessionAuthenticate",async a=>{try{return await this.engine.approveSessionAuthenticate(a)}catch(a){throw this.logger.error(a.message),a}}),uQ(this,"rejectSessionAuthenticate",async a=>{try{return await this.engine.rejectSessionAuthenticate(a)}catch(a){throw this.logger.error(a.message),a}}),this.name=a?.name||uj,this.metadata=function(a){var b,c;let d=l3();try{let e,f;return null!=a&&a.url&&d.url&&new URL(a.url).host!==new URL(d.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${a.url} differs from the actual page url:${d.url}. This is probably unintended and can lead to issues.`),a.url=d.url),null!=(b=a?.icons)&&b.length&&a.icons.length>0&&(a.icons=a.icons.filter(a=>""!==a)),e=lV(lV({},d),a),f={url:a?.url||d.url,name:a?.name||d.name,description:a?.description||d.description,icons:null!=(c=a?.icons)&&c.length&&a.icons.length>0?a.icons:d.icons},lP(e,lQ(f))}catch(b){return console.warn("Error populating app metadata",b),a||d}}(a?.metadata),this.signConfig=a?.signConfig;const b=q$({logger:a?.logger||"error",name:this.name});this.logger=b,this.core=a?.core||new ui(a),this.session=new uH(this.core,this.logger),this.proposal=new uG(this.core,this.logger),this.pendingRequest=new uI(this.core,this.logger),this.engine=new uF(this),this.auth=new uO(this.core,this.logger)}static async init(a){let b=new uR(a);return await b.initialize(),b}get context(){return rk(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(a){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(a.message),a}}}var uS=a.i(419997);function uT(a){return null==a||"object"!=typeof a&&"function"!=typeof a}function uU(a){return Object.getOwnPropertySymbols(a).filter(b=>Object.prototype.propertyIsEnumerable.call(a,b))}function uV(a){return null==a?void 0===a?"[object Undefined]":"[object Null]":Object.prototype.toString.call(a)}let uW="[object String]",uX="[object Number]",uY="[object Boolean]",uZ="[object Arguments]";function u$(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function u_(a,b,c,d=new Map,e){let f=e?.(a,b,c,d);if(null!=f)return f;if(uT(a))return a;if(d.has(a))return d.get(a);if(Array.isArray(a)){let b=Array(a.length);d.set(a,b);for(let f=0;f<a.length;f++)b[f]=u_(a[f],f,c,d,e);return Object.hasOwn(a,"index")&&(b.index=a.index),Object.hasOwn(a,"input")&&(b.input=a.input),b}if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp){let b=new RegExp(a.source,a.flags);return b.lastIndex=a.lastIndex,b}if(a instanceof Map){let b=new Map;for(let[f,g]of(d.set(a,b),a))b.set(f,u_(g,f,c,d,e));return b}if(a instanceof Set){let b=new Set;for(let f of(d.set(a,b),a))b.add(u_(f,void 0,c,d,e));return b}if("u">typeof Buffer&&Buffer.isBuffer(a))return a.subarray();if(u$(a)){let b=new(Object.getPrototypeOf(a)).constructor(a.length);d.set(a,b);for(let f=0;f<a.length;f++)b[f]=u_(a[f],f,c,d,e);return b}if(a instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&a instanceof SharedArrayBuffer)return a.slice(0);if(a instanceof DataView){let b=new DataView(a.buffer.slice(0),a.byteOffset,a.byteLength);return d.set(a,b),u0(b,a,c,d,e),b}if("u">typeof File&&a instanceof File){let b=new File([a],a.name,{type:a.type});return d.set(a,b),u0(b,a,c,d,e),b}if(a instanceof Blob){let b=new Blob([a],{type:a.type});return d.set(a,b),u0(b,a,c,d,e),b}if(a instanceof Error){let b=new a.constructor;return d.set(a,b),b.message=a.message,b.name=a.name,b.stack=a.stack,b.cause=a.cause,u0(b,a,c,d,e),b}if("object"==typeof a&&function(a){switch(uV(a)){case uZ:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case uY:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case uX:case"[object Object]":case"[object RegExp]":case"[object Set]":case uW:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(a)){let b=Object.create(Object.getPrototypeOf(a));return d.set(a,b),u0(b,a,c,d,e),b}return a}function u0(a,b,c=a,d,e){let f=[...Object.keys(b),...uU(b)];for(let g=0;g<f.length;g++){let h=f[g],i=Object.getOwnPropertyDescriptor(a,h);(null==i||i.writable)&&(a[h]=u_(b[h],h,c,d,e))}}function u1(a){var b;return b=(b,c,d,e)=>{let f;if(null!=f)return f;if("object"==typeof a)switch(Object.prototype.toString.call(a)){case uX:case uW:case uY:{let b=new a.constructor(a?.valueOf());return u0(b,a),b}case uZ:{let b={};return u0(b,a),b.length=a.length,b[Symbol.iterator]=a[Symbol.iterator],b}default:return}},u_(a,void 0,a,new Map,b)}function u2(a){return null!==a&&"object"==typeof a&&"[object Arguments]"===uV(a)}function u3(a){return"object"==typeof a&&null!==a}function u4(){}let u5="error",u6="universal_provider",u7=`wc@2:${u6}:`,u8="https://rpc.walletconnect.org/v1/",u9="generic",va=`${u8}bundler`,vb="call_status",vc="default_chain_changed";var vd=Object.defineProperty,ve=Object.defineProperties,vf=Object.getOwnPropertyDescriptors,vg=Object.getOwnPropertySymbols,vh=Object.prototype.hasOwnProperty,vi=Object.prototype.propertyIsEnumerable,vj=(a,b,c)=>b in a?vd(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,vk=(a,b)=>{for(var c in b||(b={}))vh.call(b,c)&&vj(a,c,b[c]);if(vg)for(var c of vg(b))vi.call(b,c)&&vj(a,c,b[c]);return a},vl=(a,b)=>ve(a,vf(b));function vm(a,b,c){var d;let e=lL(a);return(null==(d=b.rpcMap)?void 0:d[e.reference])||`${u8}?chainId=${e.namespace}:${e.reference}&projectId=${c}`}function vn(a){return a.map(a=>`${a.split(":")[0]}:${a.split(":")[1]}`)}function vo(a){return Object.fromEntries(Object.entries(a).filter(([a,b])=>{var c,d;return(null==(c=b?.chains)?void 0:c.length)&&(null==(d=b?.chains)?void 0:d.length)>0}))}function vp(a={},b={}){return function(a,...b){return function(a,...b){let c=b.slice(0,-1),d=b[b.length-1],e=a;for(let a=0;a<c.length;a++)e=function a(b,c,d,e){if(uT(b)&&(b=Object(b)),null==c||"object"!=typeof c)return b;if(e.has(c))return function(a){if(uT(a))return a;if(Array.isArray(a)||u$(a)||a instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&a instanceof SharedArrayBuffer)return a.slice(0);let b=Object.getPrototypeOf(a),c=b.constructor;if(a instanceof Date||a instanceof Map||a instanceof Set)return new c(a);if(a instanceof RegExp){let b=new c(a);return b.lastIndex=a.lastIndex,b}if(a instanceof DataView)return new c(a.buffer.slice(0));if(a instanceof Error){let b=new c(a.message);return b.stack=a.stack,b.name=a.name,b.cause=a.cause,b}return"u">typeof File&&a instanceof File?new c([a],a.name,{type:a.type,lastModified:a.lastModified}):"object"==typeof a?Object.assign(Object.create(b),a):a}(e.get(c));if(e.set(c,b),Array.isArray(c)){c=c.slice();for(let a=0;a<c.length;a++)c[a]=c[a]??void 0}let f=[...Object.keys(c),...uU(c)];for(let g=0;g<f.length;g++){let h=f[g],i=c[h],j=b[h];if(u2(i)&&(i={...i}),u2(j)&&(j={...j}),"u">typeof Buffer&&Buffer.isBuffer(i)&&(i=u1(i)),Array.isArray(i))if("object"==typeof j&&null!=j){let a=[],b=Reflect.ownKeys(j);for(let c=0;c<b.length;c++){let d=b[c];a[d]=j[d]}j=a}else j=[];let k=d(j,i,h,b,c,e);null!=k?b[h]=k:Array.isArray(i)||u3(j)&&u3(i)?b[h]=a(j,i,d,e):null==j&&function(a){if("object"!=typeof a||null==a)return!1;if(null===Object.getPrototypeOf(a))return!0;if("[object Object]"!==Object.prototype.toString.call(a)){let b=a[Symbol.toStringTag];return null!=b&&!!Object.getOwnPropertyDescriptor(a,Symbol.toStringTag)?.writable&&a.toString()===`[object ${b}]`}let b=a;for(;null!==Object.getPrototypeOf(b);)b=Object.getPrototypeOf(b);return Object.getPrototypeOf(a)===b}(i)?b[h]=a({},i,d,e):null==j&&u$(i)?b[h]=u1(i):(void 0===j||void 0!==i)&&(b[h]=i)}return b}(e,c[a],d,new Map);return e}(a,...b,u4)}(vo(vq(a)),vo(vq(b)))}function vq(a){var b,c,d,e,f;let g={};if(!qI(a))return g;for(let[h,i]of Object.entries(a)){let a=qz(h)?[h]:i.chains,j=i.methods||[],k=i.events||[],l=i.rpcMap||{},m=qA(h);g[m]=vl(vk(vk({},g[m]),i),{chains:mf(a,null==(b=g[m])?void 0:b.chains),methods:mf(j,null==(c=g[m])?void 0:c.methods),events:mf(k,null==(d=g[m])?void 0:d.events)}),(qI(l)||qI((null==(e=g[m])?void 0:e.rpcMap)||{}))&&(g[m].rpcMap=vk(vk({},l),null==(f=g[m])?void 0:f.rpcMap))}return g}function vr(a){return a.includes(":")?a.split(":")[2]:a}function vs(a){let b={};for(let[c,d]of Object.entries(a)){let a=d.methods||[],e=d.events||[],f=d.accounts||[],g=qz(c)?[c]:d.chains?d.chains:vn(d.accounts);b[c]={chains:g,methods:a,events:e,accounts:f}}return b}function vt(a){return"number"==typeof a?a:a.includes("0x")?parseInt(a,16):isNaN(Number(a=a.includes(":")?a.split(":")[1]:a))?a:Number(a)}let vu={},vv=a=>vu[a],vw=(a,b)=>{vu[a]=b};var vx=Object.defineProperty,vy=Object.getOwnPropertySymbols,vz=Object.prototype.hasOwnProperty,vA=Object.prototype.propertyIsEnumerable,vB=(a,b,c)=>b in a?vx(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,vC=(a,b)=>{for(var c in b||(b={}))vz.call(b,c)&&vB(a,c,b[c]);if(vy)for(var c of vy(b))vA.call(b,c)&&vB(a,c,b[c]);return a};let vD="eip155",vE=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],vF=a=>a&&a.startsWith("0x")?BigInt(a).toString(10):a,vG=a=>a&&a.startsWith("0x")?a:`0x${BigInt(a).toString(16)}`,vH=a=>Object.keys(a).filter(a=>vE.includes(a)).reduce((b,c)=>(b[c]=vI(a[c]),b),{}),vI=a=>"string"==typeof a&&function(a){try{let b=JSON.parse(a);return"object"==typeof b&&null!==b&&!Array.isArray(b)}catch{return!1}}(a)?JSON.parse(a):a;var vJ=Object.defineProperty;class vK{constructor(a){((a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?vJ(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c})(this,"storage"),this.storage=a}async getItem(a){return await this.storage.getItem(a)}async setItem(a,b){return await this.storage.setItem(a,b)}async removeItem(a){return await this.storage.removeItem(a)}static getStorage(a){return e||(e=new vK(a)),e}}var vL=Object.defineProperty,vM=Object.defineProperties,vN=Object.getOwnPropertyDescriptors,vO=Object.getOwnPropertySymbols,vP=Object.prototype.hasOwnProperty,vQ=Object.prototype.propertyIsEnumerable,vR=(a,b,c)=>b in a?vL(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c;async function vS(a,b){let c,d=lL(a.result.capabilities.caip345.caip2),e=a.result.capabilities.caip345.transactionHashes,f=await Promise.allSettled(e.map(a=>vT(d.reference,a,b))),g=f.filter(a=>"fulfilled"===a.status).map(a=>a.value).filter(a=>a);f.filter(a=>"rejected"===a.status).forEach(a=>console.warn("Failed to fetch transaction receipt:",a.reason));let h=!g.length||g.some(a=>!a),i=g.every(a=>a?.status==="0x1"),j=g.every(a=>a?.status==="0x0"),k=g.some(a=>a?.status==="0x0");return h?c=100:i?c=200:j?c=500:k&&(c=600),{id:a.result.id,version:a.request.version,atomic:a.request.atomicRequired,chainId:a.request.chainId,capabilities:a.result.capabilities,receipts:g,status:c}}async function vT(a,b,c){return await c(parseInt(a)).request((0,rG.formatJsonRpcRequest)("eth_getTransactionReceipt",[b]))}async function vU({sendCalls:a,storage:b}){let c=await b.getItem(vb);await b.setItem(vb,vM(((a,b)=>{for(var c in b||(b={}))vP.call(b,c)&&vR(a,c,b[c]);if(vO)for(var c of vO(b))vQ.call(b,c)&&vR(a,c,b[c]);return a})({},c),vN({[a.result.id]:{request:a.request,result:a.result,expiry:mc(86400)}})))}async function vV({resultId:a,storage:b}){let c=await b.getItem(vb);if(c){for(let d in delete c[a],await b.setItem(vb,c),c)md(c[d].expiry)&&delete c[d];await b.setItem(vb,c)}}async function vW({resultId:a,storage:b}){let c=await b.getItem(vb),d=c?.[a];if(d&&!md(d.expiry))return d;await vV({resultId:a,storage:b})}var vX=Object.defineProperty,vY=Object.defineProperties,vZ=Object.getOwnPropertyDescriptors,v$=Object.getOwnPropertySymbols,v_=Object.prototype.hasOwnProperty,v0=Object.prototype.propertyIsEnumerable,v1=(a,b,c)=>b in a?vX(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,v2=(a,b)=>{for(var c in b||(b={}))v_.call(b,c)&&v1(a,c,b[c]);if(v$)for(var c of v$(b))v0.call(b,c)&&v1(a,c,b[c]);return a},v3=(a,b,c)=>v1(a,"symbol"!=typeof b?b+"":b,c);class v4{constructor(a){v3(this,"name","eip155"),v3(this,"client"),v3(this,"chainId"),v3(this,"namespace"),v3(this,"httpProviders"),v3(this,"events"),v3(this,"storage"),this.namespace=a.namespace,this.events=vv("events"),this.client=vv("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=vK.getStorage(this.client.core.storage)}async request(a){switch(a.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(a);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(a);case"wallet_getCallsStatus":return await this.getCallStatus(a);case"wallet_sendCalls":return await this.sendCalls(a)}return this.namespace.methods.includes(a.request.method)?await this.client.request(a):this.getHttpProvider().request(a.request)}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(parseInt(a),b);let c=this.chainId;this.chainId=parseInt(a),this.events.emit(vc,{currentCaipChainId:`${this.name}:${a}`,previousCaipChainId:`${this.name}:${c}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}createHttpProvider(a,b){let c=b||vm(`${this.name}:${a}`,this.namespace,this.client.core.projectId);return new rF.JsonRpcProvider(new uS.HttpConnection(c,vv("disableProviderPing")))}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{var c;let d=parseInt(b.includes(":")?b.split(":")[1]:b);a[d]=this.createHttpProvider(d,null==(c=this.namespace.rpcMap)?void 0:c[b])}),a}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}getHttpProvider(a){let b=a||this.chainId;return this.httpProviders[b]||(this.httpProviders=vY(v2({},this.httpProviders),vZ({[b]:this.createHttpProvider(b)})),this.httpProviders[b])}async handleSwitchChain(a){var b,c;let d=a.request.params?null==(b=a.request.params[0])?void 0:b.chainId:"0x0",e=parseInt(d=d.startsWith("0x")?d:`0x${d}`,16);if(this.isChainApproved(e))this.setDefaultChain(`${e}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:a.topic,request:{method:a.request.method,params:[{chainId:d}]},chainId:null==(c=this.namespace.chains)?void 0:c[0]}),this.setDefaultChain(`${e}`);else throw Error(`Failed to switch to chain 'eip155:${e}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(a){return this.namespace.chains.includes(`${this.name}:${a}`)}async getCapabilities(a){var b,c,d,e,f;let g,h=null==(c=null==(b=a.request)?void 0:b.params)?void 0:c[0],i=(null==(e=null==(d=a.request)?void 0:d.params)?void 0:e[1])||[];if(!h)throw Error("Missing address parameter in `wallet_getCapabilities` request");let j=this.client.session.get(a.topic),k=(null==(f=j?.sessionProperties)?void 0:f.capabilities)||{},l=`${h}${i.join(",")}`,m=k?.[l];if(m)return m;try{g=((a,b,c)=>{let{sessionProperties:d={},scopedProperties:e={}}=a,f={};if(!qI(e)&&!qI(d))return;let g=vH(d);for(let a of c){let c=vF(a);if(!c)continue;f[vG(c)]=g;let d=e?.[`${vD}:${c}`];if(d){let a=d?.[`${vD}:${c}:${b}`];f[vG(c)]=vC(vC({},f[vG(c)]),vH(a||d))}}for(let[a,b]of Object.entries(f))0===Object.keys(b).length&&delete f[a];return Object.keys(f).length>0?f:void 0})(j,h,i)}catch(a){console.warn("Failed to extract capabilities from session",a)}if(g)return g;let n=await this.client.request(a);try{let b,c,d,e;await this.client.session.update(a.topic,{sessionProperties:(d=v2({},j.sessionProperties||{}),e={capabilities:(b=v2({},k||{}),c={[l]:n},vY(b,vZ(c)))},vY(d,vZ(e)))})}catch(a){console.warn("Failed to update session with capabilities",a)}return n}async getCallStatus(a){var b,c,d;let e=this.client.session.get(a.topic),f=null==(b=e.sessionProperties)?void 0:b.bundler_name;if(f){let b=this.getBundlerUrl(a.chainId,f);try{return await this.getUserOperationReceipt(b,a)}catch(a){console.warn("Failed to fetch call status from bundler",a,b)}}let g=null==(c=e.sessionProperties)?void 0:c.bundler_url;if(g)try{return await this.getUserOperationReceipt(g,a)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,g)}let h=await vW({resultId:null==(d=a.request.params)?void 0:d[0],storage:this.storage});if(h)try{return await vS(h,this.getHttpProvider.bind(this))}catch(a){console.warn("Failed to fetch call status from stored send calls",a,h)}if(this.namespace.methods.includes(a.request.method))return await this.client.request(a);throw Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(a,b){var c;let d=new URL(a),e=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,rG.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(c=b.request.params)?void 0:c[0]]))});if(!e.ok)throw Error(`Failed to fetch user operation receipt - ${e.status}`);return await e.json()}getBundlerUrl(a,b){return`${va}?projectId=${this.client.core.projectId}&chainId=${a}&bundler=${b}`}async sendCalls(a){var b,c,d;let e=await this.client.request(a),f=null==(b=a.request.params)?void 0:b[0],g=e?.id,h=e?.capabilities||{},i=null==(c=h?.caip345)?void 0:c.caip2,j=null==(d=h?.caip345)?void 0:d.transactionHashes;return g&&i&&null!=j&&j.length&&await vU({sendCalls:{request:f,result:e},storage:this.storage}),e}}var v5=Object.defineProperty,v6=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?v5(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class v7{constructor(a){v6(this,"name",u9),v6(this,"client"),v6(this,"httpProviders"),v6(this,"events"),v6(this,"namespace"),v6(this,"chainId"),this.namespace=a.namespace,this.events=vv("events"),this.client=vv("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(a.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(a.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(a.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(a.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider(a.chainId).request(a.request)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(a,b);let c=this.chainId;this.chainId=a,this.events.emit(vc,{currentCaipChainId:`${this.name}:${a}`,previousCaipChainId:`${this.name}:${c}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}getNamespaceName(){let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return lL(a).namespace}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}createHttpProviders(){var a,b;let c={};return null==(b=null==(a=this.namespace)?void 0:a.accounts)||b.forEach(a=>{var b,d;let e=lL(a),f=null==(d=null==(b=this.namespace)?void 0:b.rpcMap)?void 0:d[`${e.namespace}:${e.reference}`];c[e.reference]=this.createHttpProvider(a,f)}),c}getHttpProvider(a){let b=lL(a).reference,c=this.httpProviders[b];if(typeof c>"u")throw Error(`JSON-RPC provider for ${a} not found`);return c}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||vm(a,this.namespace,this.client.core.projectId);return new rF.JsonRpcProvider(new uS.default(c,vv("disableProviderPing")))}}var v8=Object.defineProperty,v9=Object.defineProperties,wa=Object.getOwnPropertyDescriptors,wb=Object.getOwnPropertySymbols,wc=Object.prototype.hasOwnProperty,wd=Object.prototype.propertyIsEnumerable,we=(a,b,c)=>b in a?v8(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,wf=(a,b)=>{for(var c in b||(b={}))wc.call(b,c)&&we(a,c,b[c]);if(wb)for(var c of wb(b))wd.call(b,c)&&we(a,c,b[c]);return a},wg=(a,b,c)=>we(a,"symbol"!=typeof b?b+"":b,c);class wh{constructor(a){var b,c;wg(this,"client"),wg(this,"namespaces"),wg(this,"optionalNamespaces"),wg(this,"sessionProperties"),wg(this,"scopedProperties"),wg(this,"events",new cf.default),wg(this,"rpcProviders",{}),wg(this,"session"),wg(this,"providerOpts"),wg(this,"logger"),wg(this,"uri"),wg(this,"disableProviderPing",!1),this.providerOpts=a,this.logger=q$({logger:null!=(b=a.logger)?b:u5,name:null!=(c=this.providerOpts.name)?c:u6}),this.disableProviderPing=a?.disableProviderPing||!1}static async init(a){let b=new wh(a);return await b.initialize(),b}async request(a,b,c){let[d,e]=this.validateChain(b);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(d).request({request:wf({},a),chainId:`${d}:${e}`,topic:this.session.topic,expiry:c})}sendAsync(a,b,c,d){let e=new Date().getTime();this.request(a,c,d).then(a=>b(null,(0,rG.formatJsonRpcResult)(e,a))).catch(a=>b(a,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var a;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(a=this.session)?void 0:a.topic,reason:qG("USER_DISCONNECTED")}),await this.cleanup()}async connect(a){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(a),this.cleanupPendingPairings(),!a.skipPairing)return await this.pair(a.pairingTopic)}async authenticate(a,b){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(a),await this.cleanupPendingPairings();let{uri:c,response:d}=await this.client.authenticate(a,b);c&&(this.uri=c,this.events.emit("display_uri",c));let e=await d();if(this.session=e.session,this.session){let a=vs(this.session.namespaces);this.namespaces=vp(this.namespaces,a),await this.persist("namespaces",this.namespaces),this.onConnect()}return e}on(a,b){this.events.on(a,b)}once(a,b){this.events.once(a,b)}removeListener(a,b){this.events.removeListener(a,b)}off(a,b){this.events.off(a,b)}get isWalletConnect(){return!0}async pair(a){let{uri:b,approval:c}=await this.client.connect({pairingTopic:a,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});b&&(this.uri=b,this.events.emit("display_uri",b));let d=await c();this.session=d;let e=vs(d.namespaces);return this.namespaces=vp(this.namespaces,e),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(a,b){try{if(!this.session)return;let[c,d]=this.validateChain(a);this.getProvider(c).setDefaultChain(d,b)}catch(a){if(!/Please call connect/.test(a.message))throw a}}async cleanupPendingPairings(a={}){try{this.logger.info("Cleaning up inactive pairings...");let b=this.client.pairing.getAll();if(!qH(b))return;for(let c of b)a.deletePairings?this.client.core.expirer.set(c.topic,0):await this.client.core.relayer.subscriber.unsubscribe(c.topic);this.logger.info(`Inactive pairings cleared: ${b.length}`)}catch(a){this.logger.warn(a,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var a,b;if(this.client=this.providerOpts.client||await uR.init({core:this.providerOpts.core,logger:this.providerOpts.logger||u5,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(c){throw this.logger.error(c,"Failed to get session"),Error(`The provided session: ${null==(b=null==(a=this.providerOpts)?void 0:a.session)?void 0:b.topic} doesn't exist in the Sign client`)}else{let a=this.client.session.getAll();this.session=a[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let a=[...new Set(Object.keys(this.session.namespaces).map(a=>qA(a)))];vw("client",this.client),vw("events",this.events),vw("disableProviderPing",this.disableProviderPing),a.forEach(a=>{if(!this.session)return;let b=function(a,b){let c=Object.keys(b.namespaces).filter(b=>b.includes(a));if(!c.length)return[];let d=[];return c.forEach(a=>{let c=b.namespaces[a].accounts;d.push(...c)}),d}(a,this.session);if(b?.length===0)return;let c=vn(b),d=v9(wf({},vp(this.namespaces,this.optionalNamespaces)[a]),wa({accounts:b,chains:c}));"eip155"===a?this.rpcProviders[a]=new v4({namespace:d}):this.rpcProviders[a]=new v7({namespace:d})})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",a=>{var b;let{topic:c}=a;c===(null==(b=this.session)?void 0:b.topic)&&this.events.emit("session_ping",a)}),this.client.on("session_event",a=>{var b;let{params:c,topic:d}=a;if(d!==(null==(b=this.session)?void 0:b.topic))return;let{event:e}=c;if("accountsChanged"===e.name){let a=e.data;a&&qH(a)&&this.events.emit("accountsChanged",a.map(vr))}else if("chainChanged"===e.name){let a=c.chainId,b=c.event.data,d=qA(a),e=vt(a)!==vt(b)?`${d}:${vt(b)}`:a;this.onChainChanged({currentCaipChainId:e})}else this.events.emit(e.name,e.data);this.events.emit("session_event",a)}),this.client.on("session_update",({topic:a,params:b})=>{var c,d;if(a!==(null==(c=this.session)?void 0:c.topic))return;let{namespaces:e}=b,f=null==(d=this.client)?void 0:d.session.get(a);this.session=v9(wf({},f),wa({namespaces:e})),this.onSessionUpdate(),this.events.emit("session_update",{topic:a,params:b})}),this.client.on("session_delete",async a=>{var b;a.topic===(null==(b=this.session)?void 0:b.topic)&&(await this.cleanup(),this.events.emit("session_delete",a),this.events.emit("disconnect",v9(wf({},qG("USER_DISCONNECTED")),wa({data:a.topic}))))}),this.on(vc,a=>{this.onChainChanged(v9(wf({},a),wa({internal:!0})))})}getProvider(a){return this.rpcProviders[a]||this.rpcProviders[u9]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(a=>{var b;this.getProvider(a).updateNamespace(null==(b=this.session)?void 0:b.namespaces[a])})}setNamespaces(a){let{namespaces:b={},optionalNamespaces:c={},sessionProperties:d,scopedProperties:e}=a;this.optionalNamespaces=vp(b,c),this.sessionProperties=d,this.scopedProperties=e}validateChain(a){let[b,c]=a?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[b,c];if(b&&!Object.keys(this.namespaces||{}).map(a=>qA(a)).includes(b))throw Error(`Namespace '${b}' is not configured. Please call connect() first with namespace config.`);if(b&&c)return[b,c];let d=qA(Object.keys(this.namespaces)[0]),e=this.rpcProviders[d].getDefaultChain();return[d,e]}async requestAccounts(){let[a]=this.validateChain();return await this.getProvider(a).requestAccounts()}async onChainChanged({currentCaipChainId:a,previousCaipChainId:b,internal:c=!1}){if(!this.namespaces)return;let[d,e]=this.validateChain(a);e&&(this.updateNamespaceChain(d,e),c?(this.events.emit("chainChanged",e),this.emitAccountsChangedOnChainChange({namespace:d,currentCaipChainId:a,previousCaipChainId:b})):this.getProvider(d).setDefaultChain(e),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:a,currentCaipChainId:b,previousCaipChainId:c}){var d,e;try{if(c===b)return;let f=null==(e=null==(d=this.session)?void 0:d.namespaces[a])?void 0:e.accounts;if(!f)return;let g=f.filter(a=>a.includes(`${b}:`)).map(vr);if(!qH(g))return;this.events.emit("accountsChanged",g)}catch(a){this.logger.warn(a,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(a,b){if(!this.namespaces)return;let c=this.namespaces[a]?a:`${a}:${b}`;this.namespaces[c]?this.namespaces[c]&&(this.namespaces[c].defaultChain=b):this.namespaces[c]={chains:[],methods:[],events:[],defaultChain:b}}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(a,b){var c;let d=(null==(c=this.session)?void 0:c.topic)||"";await this.client.core.storage.setItem(`${u7}/${a}${d}`,b)}async getFromStore(a){var b;let c=(null==(b=this.session)?void 0:b.topic)||"";return await this.client.core.storage.getItem(`${u7}/${a}${c}`)}async deleteFromStore(a){var b;let c=(null==(b=this.session)?void 0:b.topic)||"";await this.client.core.storage.removeItem(`${u7}/${a}${c}`)}async cleanupStorage(){var a;try{if((null==(a=this.client)?void 0:a.session.length)>0)return;for(let a of(await this.client.core.storage.getKeys()))a.startsWith(u7)&&await this.client.core.storage.removeItem(a)}catch(a){this.logger.warn(a,"Failed to cleanup storage")}}}let wi=["eth_sendTransaction","personal_sign"],wj=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],wk=["chainChanged","accountsChanged"],wl=["chainChanged","accountsChanged","message","disconnect","connect"],wm=async()=>{let{createAppKit:b}=await a.A(225206);return b};var wn=Object.defineProperty,wo=Object.defineProperties,wp=Object.getOwnPropertyDescriptors,wq=Object.getOwnPropertySymbols,wr=Object.prototype.hasOwnProperty,ws=Object.prototype.propertyIsEnumerable,wt=(a,b,c)=>b in a?wn(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,wu=(a,b)=>{for(var c in b||(b={}))wr.call(b,c)&&wt(a,c,b[c]);if(wq)for(var c of wq(b))ws.call(b,c)&&wt(a,c,b[c]);return a},wv=(a,b,c)=>wt(a,"symbol"!=typeof b?b+"":b,c);function ww(a){return Number(a[0].split(":")[1])}function wx(a){return`0x${a.toString(16)}`}class wy{constructor(){wv(this,"events",new cf.EventEmitter),wv(this,"namespace","eip155"),wv(this,"accounts",[]),wv(this,"signer"),wv(this,"chainId",1),wv(this,"modal"),wv(this,"rpc"),wv(this,"STORAGE_KEY","wc@2:ethereum_provider:"),wv(this,"on",(a,b)=>(this.events.on(a,b),this)),wv(this,"once",(a,b)=>(this.events.once(a,b),this)),wv(this,"removeListener",(a,b)=>(this.events.removeListener(a,b),this)),wv(this,"off",(a,b)=>(this.events.off(a,b),this)),wv(this,"parseAccount",a=>this.isCompatibleChainId(a)?this.parseAccountId(a).address:a),this.signer={},this.rpc={}}static async init(a){let b=new wy;return await b.initialize(a),b}async request(a,b){return await this.signer.request(a,this.formatChainId(this.chainId),b)}sendAsync(a,b,c){this.signer.sendAsync(a,b,this.formatChainId(this.chainId),c)}get connected(){return!!this.signer.client&&this.signer.client.core.relayer.connected}get connecting(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(a){var b;if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts(a);let{required:c,optional:d}=function(a){let{chains:b,optionalChains:c,methods:d,optionalMethods:e,events:f,optionalEvents:g,rpcMap:h}=a;if(!qH(b))throw Error("Invalid chains");let i={chains:b,methods:d||wi,events:f||wk,rpcMap:wu({},b.length?{[ww(b)]:h[ww(b)]}:{})},j=f?.filter(a=>!wk.includes(a)),k=d?.filter(a=>!wi.includes(a));if(!c&&!g&&!e&&!(null!=j&&j.length)&&!(null!=k&&k.length))return{required:b.length?i:void 0};let l={chains:[...new Set(j?.length&&k?.length||!c?i.chains.concat(c||[]):c)],methods:[...new Set(i.methods.concat(null!=e&&e.length?e:wj))],events:[...new Set(i.events.concat(null!=g&&g.length?g:wl))],rpcMap:h};return{required:b.length?i:void 0,optional:c.length?l:void 0}}(this.rpc);try{let b=await new Promise(async(b,e)=>{var f,g;let h,i;this.rpc.showQrModal&&(null==(f=this.modal)||f.open(),null==(g=this.modal)||g.subscribeState(a=>{a.open||this.signer.session||(this.signer.abortPairingAttempt(),e(Error("Connection request reset. Please try again.")))}));let j=null!=a&&a.scopedProperties?{[this.namespace]:a.scopedProperties}:void 0;await this.signer.connect((h=wu({namespaces:wu({},c&&{[this.namespace]:c})},d&&{optionalNamespaces:{[this.namespace]:d}}),i={pairingTopic:a?.pairingTopic,scopedProperties:j},wo(h,wp(i)))).then(a=>{b(a)}).catch(a=>{var b;null==(b=this.modal)||b.showErrorMessage("Unable to connect"),e(Error(a.message))})});if(!b)return;let e=lM(b.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:e),this.setAccounts(e),this.events.emit("connect",{chainId:wx(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{null==(b=this.modal)||b.close()}}async authenticate(a,b){var c;if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:a?.chains});try{let c=await new Promise(async(c,d)=>{var e,f;let g,h;this.rpc.showQrModal&&(null==(e=this.modal)||e.open(),null==(f=this.modal)||f.subscribeState(a=>{a.open||this.signer.session||(this.signer.abortPairingAttempt(),d(Error("Connection request reset. Please try again.")))})),await this.signer.authenticate((g=wu({},a),h={chains:this.rpc.chains},wo(g,wp(h))),b).then(a=>{c(a)}).catch(a=>{var b;null==(b=this.modal)||b.showErrorMessage("Unable to connect"),d(Error(a.message))})}),d=c.session;if(d){let a=lM(d.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:wx(this.chainId)})}return c}catch(a){throw this.signer.logger.error(a),a}finally{null==(c=this.modal)||c.close()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",a=>{let{params:b}=a,{event:c}=b;"accountsChanged"===c.name?(this.accounts=this.parseAccounts(c.data),this.events.emit("accountsChanged",this.accounts)):"chainChanged"===c.name?this.setChainId(this.formatChainId(c.data)):this.events.emit(c.name,c.data),this.events.emit("session_event",a)}),this.signer.on("accountsChanged",a=>{this.accounts=this.parseAccounts(a),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",a=>{let b=parseInt(a);this.chainId=b,this.events.emit("chainChanged",wx(this.chainId)),this.persist()}),this.signer.on("session_update",a=>{this.events.emit("session_update",a)}),this.signer.on("session_delete",a=>{this.reset(),this.events.emit("session_delete",a),this.events.emit("disconnect",wo(wu({},qG("USER_DISCONNECTED")),wp({data:a.topic,name:"USER_DISCONNECTED"})))}),this.signer.on("display_uri",a=>{this.events.emit("display_uri",a)})}switchEthereumChain(a){this.request({method:"wallet_switchEthereumChain",params:[{chainId:a.toString(16)}]})}isCompatibleChainId(a){return"string"==typeof a&&a.startsWith(`${this.namespace}:`)}formatChainId(a){return`${this.namespace}:${a}`}parseChainId(a){return Number(a.split(":")[1])}setChainIds(a){let b=a.filter(a=>this.isCompatibleChainId(a)).map(a=>this.parseChainId(a));b.length&&(this.chainId=b[0],this.events.emit("chainChanged",wx(this.chainId)),this.persist())}setChainId(a){if(this.isCompatibleChainId(a)){let b=this.parseChainId(a);this.chainId=b,this.switchEthereumChain(b)}}parseAccountId(a){let[b,c,d]=a.split(":");return{chainId:`${b}:${c}`,address:d}}setAccounts(a){this.accounts=a.filter(a=>this.parseChainId(this.parseAccountId(a).chainId)===this.chainId).map(a=>this.parseAccountId(a).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(a){var b,c;let d=null!=(b=a?.chains)?b:[],e=null!=(c=a?.optionalChains)?c:[],f=d.concat(e);if(!f.length)throw Error("No chains specified in either `chains` or `optionalChains`");let g=d.length?a?.methods||wi:[],h=d.length?a?.events||wk:[],i=a?.optionalMethods||[],j=a?.optionalEvents||[],k=a?.rpcMap||this.buildRpcMap(f,a.projectId),l=a?.qrModalOptions||void 0;return{chains:d?.map(a=>this.formatChainId(a)),optionalChains:e.map(a=>this.formatChainId(a)),methods:g,events:h,optionalMethods:i,optionalEvents:j,rpcMap:k,showQrModal:!!(null!=a&&a.showQrModal),qrModalOptions:l,projectId:a.projectId,metadata:a.metadata}}buildRpcMap(a,b){let c={};return a.forEach(a=>{c[a]=this.getRpcUrl(a,b)}),c}async initialize(a){var b;if(this.rpc=this.getRpcConfig(a),this.chainId=this.rpc.chains.length?ww(this.rpc.chains):ww(this.rpc.optionalChains),this.signer=await wh.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:a.disableProviderPing,relayUrl:a.relayUrl,storage:a.storage,storageOptions:a.storageOptions,customStoragePrefix:a.customStoragePrefix,telemetryEnabled:a.telemetryEnabled,logger:a.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let a;try{let c,d,e,f,g=await wm(),{convertWCMToAppKitOptions:h}=await Promise.resolve().then(function(){return wJ}),i=h((c=wu({},this.rpc.qrModalOptions),d={chains:[...new Set([...this.rpc.chains,...this.rpc.optionalChains])],metadata:this.rpc.metadata,projectId:this.rpc.projectId},wo(c,wp(d))));if(!i.networks.length)throw Error("No networks found for WalletConnect");a=g((e=wu({},i),f={universalProvider:this.signer,manualWCControl:!0,enableMobileFullScreen:(null==(b=this.rpc.qrModalOptions)?void 0:b.enableMobileFullScreen)===!0},wo(e,wp(f))))}catch(a){throw console.warn(a),Error("To use QR modal, please install @reown/appkit package")}if(a)try{this.modal=a}catch(a){throw this.signer.logger.error(a),Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(a){if(!a)return;let{chains:b,optionalChains:c,rpcMap:d}=a;b&&qH(b)&&(this.rpc.chains=b.map(a=>this.formatChainId(a)),b.forEach(a=>{this.rpc.rpcMap[a]=d?.[a]||this.getRpcUrl(a)})),c&&qH(c)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=c?.map(a=>this.formatChainId(a)),c.forEach(a=>{this.rpc.rpcMap[a]=d?.[a]||this.getRpcUrl(a)}))}getRpcUrl(a,b){var c;return(null==(c=this.rpc.rpcMap)?void 0:c[a])||`https://rpc.walletconnect.org/v1/?chainId=eip155:${a}&projectId=${b||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{let a=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),b=this.session.namespaces[`${this.namespace}:${a}`]?this.session.namespaces[`${this.namespace}:${a}`]:this.session.namespaces[this.namespace];this.setChainIds(a?[this.formatChainId(a)]:b?.accounts),this.setAccounts(b?.accounts)}catch(a){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(a),await this.disconnect().catch(a=>this.signer.logger.warn(a))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(a){return"string"==typeof a||a instanceof String?[this.parseAccount(a)]:a.map(a=>this.parseAccount(a))}}var wz=Object.defineProperty,wA=Object.defineProperties,wB=Object.getOwnPropertyDescriptors,wC=Object.getOwnPropertySymbols,wD=Object.prototype.hasOwnProperty,wE=Object.prototype.propertyIsEnumerable,wF=(a,b,c)=>b in a?wz(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,wG=(a,b)=>{for(var c in b||(b={}))wD.call(b,c)&&wF(a,c,b[c]);if(wC)for(var c of wC(b))wE.call(b,c)&&wF(a,c,b[c]);return a};let wH=a=>{let[b,c]=a.split(":");return wI({id:c,caipNetworkId:a,chainNamespace:b,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function wI(a){return wG({formatters:void 0,fees:void 0,serializers:void 0},a)}var wJ=Object.freeze({__proto__:null,convertWCMToAppKitOptions:function(a){var b,c,d,e,f,g,h;let i=null==(b=a.chains)?void 0:b.map(wH).filter(Boolean);if(0===i.length)throw Error("At least one chain must be specified");let j=i.find(b=>{var c;return b.id===(null==(c=a.defaultChain)?void 0:c.id)}),k={projectId:a.projectId,networks:i,themeMode:a.themeMode,themeVariables:function(a){if(a)return{"--w3m-font-family":a["--wcm-font-family"],"--w3m-accent":a["--wcm-accent-color"],"--w3m-color-mix":a["--wcm-background-color"],"--w3m-z-index":a["--wcm-z-index"]?Number(a["--wcm-z-index"]):void 0,"--w3m-qr-color":a["--wcm-accent-color"],"--w3m-font-size-master":a["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":a["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}(a.themeVariables),chainImages:a.chainImages,connectorImages:a.walletImages,defaultNetwork:j,metadata:wA(wG({},a.metadata),wB({name:(null==(c=a.metadata)?void 0:c.name)||"WalletConnect",description:(null==(d=a.metadata)?void 0:d.description)||"Connect to WalletConnect-compatible wallets",url:(null==(e=a.metadata)?void 0:e.url)||"https://walletconnect.org",icons:(null==(f=a.metadata)?void 0:f.icons)||["https://walletconnect.org/walletconnect-logo.png"]})),showWallets:!0,featuredWalletIds:"NONE"===a.explorerRecommendedWalletIds?[]:Array.isArray(a.explorerRecommendedWalletIds)?a.explorerRecommendedWalletIds:[],excludeWalletIds:"ALL"===a.explorerExcludedWalletIds?[]:Array.isArray(a.explorerExcludedWalletIds)?a.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if(null!=(g=a.mobileWallets)&&g.length||null!=(h=a.desktopWallets)&&h.length){let b=[...(a.mobileWallets||[]).map(a=>({id:a.id,name:a.name,links:a.links})),...(a.desktopWallets||[]).map(a=>({id:a.id,name:a.name,links:{native:a.links.native,universal:a.links.universal}}))],c=[...k.featuredWalletIds||[],...k.excludeWalletIds||[]],d=b.filter(a=>!c.includes(a.id));d.length&&(k.customWallets=d)}return k},defineChain:wI}),wK=a.i(629273);a.i(206323);var wL=a.i(584617),wM=a.i(392911);a.i(628952);var wN=a.i(984131),wO=a.i(697913),wP=a.i(505434),wQ=Object.defineProperty,wR=(a,b)=>{for(var c in b)wQ(a,c,{get:b[c],enumerable:!0})},wS={84532:{usdcAddress:"0x036CbD53842c5426634e7929541eC2318f3dCF7e",usdcName:"USDC"},8453:{usdcAddress:"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",usdcName:"USD Coin"},43113:{usdcAddress:"0x5425890298aed601595a70AB815c96711a31Bc65",usdcName:"USD Coin"},43114:{usdcAddress:"0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E",usdcName:"USD Coin"},4689:{usdcAddress:"0xcdf79194c6c285077a58da47641d4dbe51f63542",usdcName:"Bridged USDC"},103:{usdcAddress:"4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU",usdcName:"USDC"},101:{usdcAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",usdcName:"USDC"},1328:{usdcAddress:"0x4fcf1784b31630811181f670aea7a7bef803eaed",usdcName:"USDC"},1329:{usdcAddress:"0xe15fc38f6d8c56af07bbcbe3baf5708a2bf42392",usdcName:"USDC"},137:{usdcAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",usdcName:"USD Coin"},80002:{usdcAddress:"0x41E94Eb019C0762f9Bfcf9Fb1E58725BfB0e7582",usdcName:"USDC"},3338:{usdcAddress:"0xbbA60da06c2c5424f03f7434542280FCAd453d10",usdcName:"USDC"},2741:{usdcAddress:"0x84a71ccd554cc1b02749b35d22f684cc8ec987e1",usdcName:"Bridged USDC"},11124:{usdcAddress:"0xe4C7fBB0a626ed208021ccabA6Be1566905E2dFc",usdcName:"Bridged USDC"},1514:{usdcAddress:"0xF1815bd50389c46847f0Bda824eC8da914045D14",usdcName:"Bridged USDC"},41923:{usdcAddress:"0x12a272A581feE5577A5dFa371afEB4b2F3a8C2F8",usdcName:"Bridged USDC (Stargate)"},0x135a9d92:{usdcAddress:"0x2e08028E3C4c2356572E096d8EF835cD5C6030bD",usdcName:"Bridged USDC (SKALE Bridge)"}},wT=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"authorizer",type:"address"},{indexed:!0,internalType:"bytes32",name:"nonce",type:"bytes32"}],name:"AuthorizationCanceled",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"authorizer",type:"address"},{indexed:!0,internalType:"bytes32",name:"nonce",type:"bytes32"}],name:"AuthorizationUsed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"_account",type:"address"}],name:"Blacklisted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newBlacklister",type:"address"}],name:"BlacklisterChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"burner",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Burn",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newMasterMinter",type:"address"}],name:"MasterMinterChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"minter",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Mint",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"minter",type:"address"},{indexed:!1,internalType:"uint256",name:"minterAllowedAmount",type:"uint256"}],name:"MinterConfigured",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"oldMinter",type:"address"}],name:"MinterRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"previousOwner",type:"address"},{indexed:!1,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[],name:"Pause",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newAddress",type:"address"}],name:"PauserChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newRescuer",type:"address"}],name:"RescuerChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"_account",type:"address"}],name:"UnBlacklisted",type:"event"},{anonymous:!1,inputs:[],name:"Unpause",type:"event"},{inputs:[],name:"CANCEL_AUTHORIZATION_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"PERMIT_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"RECEIVE_WITH_AUTHORIZATION_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"TRANSFER_WITH_AUTHORIZATION_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"authorizer",type:"address"},{internalType:"bytes32",name:"nonce",type:"bytes32"}],name:"authorizationState",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_account",type:"address"}],name:"blacklist",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"blacklister",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_amount",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"authorizer",type:"address"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"cancelAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"authorizer",type:"address"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"cancelAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"},{internalType:"uint256",name:"minterAllowedAmount",type:"uint256"}],name:"configureMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"currency",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"decrement",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"increment",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"tokenName",type:"string"},{internalType:"string",name:"tokenSymbol",type:"string"},{internalType:"string",name:"tokenCurrency",type:"string"},{internalType:"uint8",name:"tokenDecimals",type:"uint8"},{internalType:"address",name:"newMasterMinter",type:"address"},{internalType:"address",name:"newPauser",type:"address"},{internalType:"address",name:"newBlacklister",type:"address"},{internalType:"address",name:"newOwner",type:"address"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"newName",type:"string"}],name:"initializeV2",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"lostAndFound",type:"address"}],name:"initializeV2_1",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"accountsToBlacklist",type:"address[]"},{internalType:"string",name:"newSymbol",type:"string"}],name:"initializeV2_2",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_account",type:"address"}],name:"isBlacklisted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"masterMinter",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_to",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"}],name:"minterAllowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"pauser",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"receiveWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"receiveWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"}],name:"removeMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"tokenContract",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"rescueERC20",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"rescuer",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"transferWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"transferWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_account",type:"address"}],name:"unBlacklist",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unpause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_newBlacklister",type:"address"}],name:"updateBlacklister",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_newMasterMinter",type:"address"}],name:"updateMasterMinter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_newPauser",type:"address"}],name:"updatePauser",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newRescuer",type:"address"}],name:"updateRescuer",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"version",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"pure",type:"function"}];a.s([],958425),a.i(958425),(DS=D5||(D5={})).assertEqual=a=>{},DS.assertIs=function(a){},DS.assertNever=function(a){throw Error()},DS.arrayToEnum=a=>{let b={};for(let c of a)b[c]=c;return b},DS.getValidEnumValues=a=>{let b=DS.objectKeys(a).filter(b=>"number"!=typeof a[a[b]]),c={};for(let d of b)c[d]=a[d];return DS.objectValues(c)},DS.objectValues=a=>DS.objectKeys(a).map(function(b){return a[b]}),DS.objectKeys="function"==typeof Object.keys?a=>Object.keys(a):a=>{let b=[];for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},DS.find=(a,b)=>{for(let c of a)if(b(c))return c},DS.isInteger="function"==typeof Number.isInteger?a=>Number.isInteger(a):a=>"number"==typeof a&&Number.isFinite(a)&&Math.floor(a)===a,DS.joinValues=function(a,b=" | "){return a.map(a=>"string"==typeof a?`'${a}'`:a).join(b)},DS.jsonStringifyReplacer=(a,b)=>"bigint"==typeof b?b.toString():b,(D6||(D6={})).mergeShapes=(a,b)=>({...a,...b});let wU=D5.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),wV=a=>{switch(typeof a){case"undefined":return wU.undefined;case"string":return wU.string;case"number":return Number.isNaN(a)?wU.nan:wU.number;case"boolean":return wU.boolean;case"function":return wU.function;case"bigint":return wU.bigint;case"symbol":return wU.symbol;case"object":if(Array.isArray(a))return wU.array;if(null===a)return wU.null;if(a.then&&"function"==typeof a.then&&a.catch&&"function"==typeof a.catch)return wU.promise;if("undefined"!=typeof Map&&a instanceof Map)return wU.map;if("undefined"!=typeof Set&&a instanceof Set)return wU.set;if("undefined"!=typeof Date&&a instanceof Date)return wU.date;return wU.object;default:return wU.unknown}};a.s(["ZodParsedType",0,wU,"getParsedType",0,wV,"objectUtil",()=>D6,"util",()=>D5],609197);let wW=D5.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),wX=a=>JSON.stringify(a,null,2).replace(/"([^"]+)":/g,"$1:");class wY extends Error{get errors(){return this.issues}constructor(a){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const b=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,b):this.__proto__=b,this.name="ZodError",this.issues=a}format(a){let b=a||function(a){return a.message},c={_errors:[]},d=a=>{for(let e of a.issues)if("invalid_union"===e.code)e.unionErrors.map(d);else if("invalid_return_type"===e.code)d(e.returnTypeError);else if("invalid_arguments"===e.code)d(e.argumentsError);else if(0===e.path.length)c._errors.push(b(e));else{let a=c,d=0;for(;d<e.path.length;){let c=e.path[d];d===e.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(b(e))):a[c]=a[c]||{_errors:[]},a=a[c],d++}}};return d(this),c}static assert(a){if(!(a instanceof wY))throw Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,D5.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(a=a=>a.message){let b={},c=[];for(let d of this.issues)if(d.path.length>0){let c=d.path[0];b[c]=b[c]||[],b[c].push(a(d))}else c.push(a(d));return{formErrors:c,fieldErrors:b}}get formErrors(){return this.flatten()}}wY.create=a=>new wY(a),a.s(["ZodError",()=>wY,"ZodIssueCode",0,wW,"quotelessJson",0,wX],481440);let wZ=(a,b)=>{let c;switch(a.code){case wW.invalid_type:c=a.received===wU.undefined?"Required":`Expected ${a.expected}, received ${a.received}`;break;case wW.invalid_literal:c=`Invalid literal value, expected ${JSON.stringify(a.expected,D5.jsonStringifyReplacer)}`;break;case wW.unrecognized_keys:c=`Unrecognized key(s) in object: ${D5.joinValues(a.keys,", ")}`;break;case wW.invalid_union:c="Invalid input";break;case wW.invalid_union_discriminator:c=`Invalid discriminator value. Expected ${D5.joinValues(a.options)}`;break;case wW.invalid_enum_value:c=`Invalid enum value. Expected ${D5.joinValues(a.options)}, received '${a.received}'`;break;case wW.invalid_arguments:c="Invalid function arguments";break;case wW.invalid_return_type:c="Invalid function return type";break;case wW.invalid_date:c="Invalid date";break;case wW.invalid_string:"object"==typeof a.validation?"includes"in a.validation?(c=`Invalid input: must include "${a.validation.includes}"`,"number"==typeof a.validation.position&&(c=`${c} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?c=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?c=`Invalid input: must end with "${a.validation.endsWith}"`:D5.assertNever(a.validation):c="regex"!==a.validation?`Invalid ${a.validation}`:"Invalid";break;case wW.too_small:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:"number"===a.type||"bigint"===a.type?`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:"date"===a.type?`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:"Invalid input";break;case wW.too_big:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"bigint"===a.type?`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"date"===a.type?`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:"Invalid input";break;case wW.custom:c="Invalid input";break;case wW.invalid_intersection_types:c="Intersection results could not be merged";break;case wW.not_multiple_of:c=`Number must be a multiple of ${a.multipleOf}`;break;case wW.not_finite:c="Number must be finite";break;default:c=b.defaultError,D5.assertNever(a)}return{message:c}},w$=wZ;function w_(a){w$=a}function w0(){return w$}a.s(["getErrorMap",()=>w0,"setErrorMap",()=>w_],929415),a.i(929415),a.s(["defaultErrorMap",0,wZ,"getErrorMap",()=>w0,"setErrorMap",()=>w_],177662),a.i(177662);let w1=a=>{let{data:b,path:c,errorMaps:d,issueData:e}=a,f=[...c,...e.path||[]],g={...e,path:f};if(void 0!==e.message)return{...e,path:f,message:e.message};let h="";for(let a of d.filter(a=>!!a).slice().reverse())h=a(g,{data:b,defaultError:h}).message;return{...e,path:f,message:h}},w2=[];function w3(a,b){let c=w$,d=w1({issueData:b,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,c,c===wZ?void 0:wZ].filter(a=>!!a)});a.common.issues.push(d)}class w4{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(a,b){let c=[];for(let d of b){if("aborted"===d.status)return w5;"dirty"===d.status&&a.dirty(),c.push(d.value)}return{status:a.value,value:c}}static async mergeObjectAsync(a,b){let c=[];for(let a of b){let b=await a.key,d=await a.value;c.push({key:b,value:d})}return w4.mergeObjectSync(a,c)}static mergeObjectSync(a,b){let c={};for(let d of b){let{key:b,value:e}=d;if("aborted"===b.status||"aborted"===e.status)return w5;"dirty"===b.status&&a.dirty(),"dirty"===e.status&&a.dirty(),"__proto__"!==b.value&&(void 0!==e.value||d.alwaysSet)&&(c[b.value]=e.value)}return{status:a.value,value:c}}}let w5=Object.freeze({status:"aborted"}),w6=a=>({status:"dirty",value:a}),w7=a=>({status:"valid",value:a}),w8=a=>"aborted"===a.status,w9=a=>"dirty"===a.status,xa=a=>"valid"===a.status,xb=a=>"undefined"!=typeof Promise&&a instanceof Promise;a.s(["DIRTY",0,w6,"EMPTY_PATH",0,w2,"INVALID",0,w5,"OK",0,w7,"ParseStatus",()=>w4,"addIssueToContext",()=>w3,"isAborted",0,w8,"isAsync",0,xb,"isDirty",0,w9,"isValid",0,xa,"makeIssue",0,w1],285244),a.i(285244),a.s([],65416),a.i(65416),a.i(609197),(DT=D7||(D7={})).errToObj=a=>"string"==typeof a?{message:a}:a||{},DT.toString=a=>"string"==typeof a?a:a?.message;class xc{constructor(a,b,c,d){this._cachedPath=[],this.parent=a,this.data=b,this._path=c,this._key=d}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let xd=(a,b)=>{if(xa(b))return{success:!0,data:b.value};if(!a.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let b=new wY(a.common.issues);return this._error=b,this._error}}};function xe(a){if(!a)return{};let{errorMap:b,invalid_type_error:c,required_error:d,description:e}=a;if(b&&(c||d))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return b?{errorMap:b,description:e}:{errorMap:(b,e)=>{let{message:f}=a;return"invalid_enum_value"===b.code?{message:f??e.defaultError}:void 0===e.data?{message:f??d??e.defaultError}:"invalid_type"!==b.code?{message:e.defaultError}:{message:f??c??e.defaultError}},description:e}}class xf{get description(){return this._def.description}_getType(a){return wV(a.data)}_getOrReturnCtx(a,b){return b||{common:a.parent.common,data:a.data,parsedType:wV(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new w4,ctx:{common:a.parent.common,data:a.data,parsedType:wV(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){let b=this._parse(a);if(xb(b))throw Error("Synchronous parse encountered promise.");return b}_parseAsync(a){return Promise.resolve(this._parse(a))}parse(a,b){let c=this.safeParse(a,b);if(c.success)return c.data;throw c.error}safeParse(a,b){let c={common:{issues:[],async:b?.async??!1,contextualErrorMap:b?.errorMap},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:wV(a)},d=this._parseSync({data:a,path:c.path,parent:c});return xd(c,d)}"~validate"(a){let b={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:wV(a)};if(!this["~standard"].async)try{let c=this._parseSync({data:a,path:[],parent:b});return xa(c)?{value:c.value}:{issues:b.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),b.common={issues:[],async:!0}}return this._parseAsync({data:a,path:[],parent:b}).then(a=>xa(a)?{value:a.value}:{issues:b.common.issues})}async parseAsync(a,b){let c=await this.safeParseAsync(a,b);if(c.success)return c.data;throw c.error}async safeParseAsync(a,b){let c={common:{issues:[],contextualErrorMap:b?.errorMap,async:!0},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:wV(a)},d=this._parse({data:a,path:c.path,parent:c});return xd(c,await (xb(d)?d:Promise.resolve(d)))}refine(a,b){return this._refinement((c,d)=>{let e=a(c),f=()=>d.addIssue({code:wW.custom,..."string"==typeof b||void 0===b?{message:b}:"function"==typeof b?b(c):b});return"undefined"!=typeof Promise&&e instanceof Promise?e.then(a=>!!a||(f(),!1)):!!e||(f(),!1)})}refinement(a,b){return this._refinement((c,d)=>!!a(c)||(d.addIssue("function"==typeof b?b(c,d):b),!1))}_refinement(a){return new x_({schema:this,typeName:D8.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return x0.create(this,this._def)}nullable(){return x1.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return xK.create(this)}promise(){return x$.create(this,this._def)}or(a){return xM.create([this,a],this._def)}and(a){return xP.create(this,a,this._def)}transform(a){return new x_({...xe(this._def),schema:this,typeName:D8.ZodEffects,effect:{type:"transform",transform:a}})}default(a){return new x2({...xe(this._def),innerType:this,defaultValue:"function"==typeof a?a:()=>a,typeName:D8.ZodDefault})}brand(){return new x6({typeName:D8.ZodBranded,type:this,...xe(this._def)})}catch(a){return new x3({...xe(this._def),innerType:this,catchValue:"function"==typeof a?a:()=>a,typeName:D8.ZodCatch})}describe(a){return new this.constructor({...this._def,description:a})}pipe(a){return x7.create(this,a)}readonly(){return x8.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let xg=/^c[^\s-]{8,}$/i,xh=/^[0-9a-z]+$/,xi=/^[0-9A-HJKMNP-TV-Z]{26}$/i,xj=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,xk=/^[a-z0-9_-]{21}$/i,xl=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,xm=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,xn=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,xo=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,xp=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,xq=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,xr=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,xs=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,xt=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,xu="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",xv=RegExp(`^${xu}$`);function xw(a){let b="[0-5]\\d";a.precision?b=`${b}\\.\\d{${a.precision}}`:null==a.precision&&(b=`${b}(\\.\\d+)?`);let c=a.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${b})${c}`}function xx(a){let b=`${xu}T${xw(a)}`,c=[];return c.push(a.local?"Z?":"Z"),a.offset&&c.push("([+-]\\d{2}:?\\d{2})"),b=`${b}(${c.join("|")})`,RegExp(`^${b}$`)}class xy extends xf{_parse(a){var b,c,d,e;let g;if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==wU.string){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.string,received:b.parsedType}),w5}let h=new w4;for(let i of this._def.checks)if("min"===i.kind)a.data.length<i.value&&(w3(g=this._getOrReturnCtx(a,g),{code:wW.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("max"===i.kind)a.data.length>i.value&&(w3(g=this._getOrReturnCtx(a,g),{code:wW.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("length"===i.kind){let b=a.data.length>i.value,c=a.data.length<i.value;(b||c)&&(g=this._getOrReturnCtx(a,g),b?w3(g,{code:wW.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&w3(g,{code:wW.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),h.dirty())}else if("email"===i.kind)xn.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{validation:"email",code:wW.invalid_string,message:i.message}),h.dirty());else if("emoji"===i.kind)f||(f=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),f.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{validation:"emoji",code:wW.invalid_string,message:i.message}),h.dirty());else if("uuid"===i.kind)xj.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{validation:"uuid",code:wW.invalid_string,message:i.message}),h.dirty());else if("nanoid"===i.kind)xk.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{validation:"nanoid",code:wW.invalid_string,message:i.message}),h.dirty());else if("cuid"===i.kind)xg.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{validation:"cuid",code:wW.invalid_string,message:i.message}),h.dirty());else if("cuid2"===i.kind)xh.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{validation:"cuid2",code:wW.invalid_string,message:i.message}),h.dirty());else if("ulid"===i.kind)xi.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{validation:"ulid",code:wW.invalid_string,message:i.message}),h.dirty());else if("url"===i.kind)try{new URL(a.data)}catch{w3(g=this._getOrReturnCtx(a,g),{validation:"url",code:wW.invalid_string,message:i.message}),h.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{validation:"regex",code:wW.invalid_string,message:i.message}),h.dirty())):"trim"===i.kind?a.data=a.data.trim():"includes"===i.kind?a.data.includes(i.value,i.position)||(w3(g=this._getOrReturnCtx(a,g),{code:wW.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),h.dirty()):"toLowerCase"===i.kind?a.data=a.data.toLowerCase():"toUpperCase"===i.kind?a.data=a.data.toUpperCase():"startsWith"===i.kind?a.data.startsWith(i.value)||(w3(g=this._getOrReturnCtx(a,g),{code:wW.invalid_string,validation:{startsWith:i.value},message:i.message}),h.dirty()):"endsWith"===i.kind?a.data.endsWith(i.value)||(w3(g=this._getOrReturnCtx(a,g),{code:wW.invalid_string,validation:{endsWith:i.value},message:i.message}),h.dirty()):"datetime"===i.kind?xx(i).test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{code:wW.invalid_string,validation:"datetime",message:i.message}),h.dirty()):"date"===i.kind?xv.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{code:wW.invalid_string,validation:"date",message:i.message}),h.dirty()):"time"===i.kind?RegExp(`^${xw(i)}$`).test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{code:wW.invalid_string,validation:"time",message:i.message}),h.dirty()):"duration"===i.kind?xm.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{validation:"duration",code:wW.invalid_string,message:i.message}),h.dirty()):"ip"===i.kind?(b=a.data,!(("v4"===(c=i.version)||!c)&&xo.test(b)||("v6"===c||!c)&&xq.test(b))&&1&&(w3(g=this._getOrReturnCtx(a,g),{validation:"ip",code:wW.invalid_string,message:i.message}),h.dirty())):"jwt"===i.kind?!function(a,b){if(!xl.test(a))return!1;try{let[c]=a.split(".");if(!c)return!1;let d=c.replace(/-/g,"+").replace(/_/g,"/").padEnd(c.length+(4-c.length%4)%4,"="),e=JSON.parse(atob(d));if("object"!=typeof e||null===e||"typ"in e&&e?.typ!=="JWT"||!e.alg||b&&e.alg!==b)return!1;return!0}catch{return!1}}(a.data,i.alg)&&(w3(g=this._getOrReturnCtx(a,g),{validation:"jwt",code:wW.invalid_string,message:i.message}),h.dirty()):"cidr"===i.kind?(d=a.data,!(("v4"===(e=i.version)||!e)&&xp.test(d)||("v6"===e||!e)&&xr.test(d))&&1&&(w3(g=this._getOrReturnCtx(a,g),{validation:"cidr",code:wW.invalid_string,message:i.message}),h.dirty())):"base64"===i.kind?xs.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{validation:"base64",code:wW.invalid_string,message:i.message}),h.dirty()):"base64url"===i.kind?xt.test(a.data)||(w3(g=this._getOrReturnCtx(a,g),{validation:"base64url",code:wW.invalid_string,message:i.message}),h.dirty()):D5.assertNever(i);return{status:h.value,value:a.data}}_regex(a,b,c){return this.refinement(b=>a.test(b),{validation:b,code:wW.invalid_string,...D7.errToObj(c)})}_addCheck(a){return new xy({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...D7.errToObj(a)})}url(a){return this._addCheck({kind:"url",...D7.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...D7.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...D7.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...D7.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...D7.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...D7.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...D7.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...D7.errToObj(a)})}base64url(a){return this._addCheck({kind:"base64url",...D7.errToObj(a)})}jwt(a){return this._addCheck({kind:"jwt",...D7.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...D7.errToObj(a)})}cidr(a){return this._addCheck({kind:"cidr",...D7.errToObj(a)})}datetime(a){return"string"==typeof a?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:void 0===a?.precision?null:a?.precision,offset:a?.offset??!1,local:a?.local??!1,...D7.errToObj(a?.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return"string"==typeof a?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:void 0===a?.precision?null:a?.precision,...D7.errToObj(a?.message)})}duration(a){return this._addCheck({kind:"duration",...D7.errToObj(a)})}regex(a,b){return this._addCheck({kind:"regex",regex:a,...D7.errToObj(b)})}includes(a,b){return this._addCheck({kind:"includes",value:a,position:b?.position,...D7.errToObj(b?.message)})}startsWith(a,b){return this._addCheck({kind:"startsWith",value:a,...D7.errToObj(b)})}endsWith(a,b){return this._addCheck({kind:"endsWith",value:a,...D7.errToObj(b)})}min(a,b){return this._addCheck({kind:"min",value:a,...D7.errToObj(b)})}max(a,b){return this._addCheck({kind:"max",value:a,...D7.errToObj(b)})}length(a,b){return this._addCheck({kind:"length",value:a,...D7.errToObj(b)})}nonempty(a){return this.min(1,D7.errToObj(a))}trim(){return new xy({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new xy({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new xy({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>"datetime"===a.kind)}get isDate(){return!!this._def.checks.find(a=>"date"===a.kind)}get isTime(){return!!this._def.checks.find(a=>"time"===a.kind)}get isDuration(){return!!this._def.checks.find(a=>"duration"===a.kind)}get isEmail(){return!!this._def.checks.find(a=>"email"===a.kind)}get isURL(){return!!this._def.checks.find(a=>"url"===a.kind)}get isEmoji(){return!!this._def.checks.find(a=>"emoji"===a.kind)}get isUUID(){return!!this._def.checks.find(a=>"uuid"===a.kind)}get isNANOID(){return!!this._def.checks.find(a=>"nanoid"===a.kind)}get isCUID(){return!!this._def.checks.find(a=>"cuid"===a.kind)}get isCUID2(){return!!this._def.checks.find(a=>"cuid2"===a.kind)}get isULID(){return!!this._def.checks.find(a=>"ulid"===a.kind)}get isIP(){return!!this._def.checks.find(a=>"ip"===a.kind)}get isCIDR(){return!!this._def.checks.find(a=>"cidr"===a.kind)}get isBase64(){return!!this._def.checks.find(a=>"base64"===a.kind)}get isBase64url(){return!!this._def.checks.find(a=>"base64url"===a.kind)}get minLength(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxLength(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}xy.create=a=>new xy({checks:[],typeName:D8.ZodString,coerce:a?.coerce??!1,...xe(a)});class xz extends xf{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){let b;if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==wU.number){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.number,received:b.parsedType}),w5}let c=new w4;for(let d of this._def.checks)"int"===d.kind?D5.isInteger(a.data)||(w3(b=this._getOrReturnCtx(a,b),{code:wW.invalid_type,expected:"integer",received:"float",message:d.message}),c.dirty()):"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(w3(b=this._getOrReturnCtx(a,b),{code:wW.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(w3(b=this._getOrReturnCtx(a,b),{code:wW.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"multipleOf"===d.kind?0!==function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return Number.parseInt(a.toFixed(e).replace(".",""))%Number.parseInt(b.toFixed(e).replace(".",""))/10**e}(a.data,d.value)&&(w3(b=this._getOrReturnCtx(a,b),{code:wW.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):"finite"===d.kind?Number.isFinite(a.data)||(w3(b=this._getOrReturnCtx(a,b),{code:wW.not_finite,message:d.message}),c.dirty()):D5.assertNever(d);return{status:c.value,value:a.data}}gte(a,b){return this.setLimit("min",a,!0,D7.toString(b))}gt(a,b){return this.setLimit("min",a,!1,D7.toString(b))}lte(a,b){return this.setLimit("max",a,!0,D7.toString(b))}lt(a,b){return this.setLimit("max",a,!1,D7.toString(b))}setLimit(a,b,c,d){return new xz({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:D7.toString(d)}]})}_addCheck(a){return new xz({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:D7.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:D7.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:D7.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:D7.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:D7.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:D7.toString(b)})}finite(a){return this._addCheck({kind:"finite",message:D7.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:D7.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:D7.toString(a)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}get isInt(){return!!this._def.checks.find(a=>"int"===a.kind||"multipleOf"===a.kind&&D5.isInteger(a.value))}get isFinite(){let a=null,b=null;for(let c of this._def.checks)if("finite"===c.kind||"int"===c.kind||"multipleOf"===c.kind)return!0;else"min"===c.kind?(null===b||c.value>b)&&(b=c.value):"max"===c.kind&&(null===a||c.value<a)&&(a=c.value);return Number.isFinite(b)&&Number.isFinite(a)}}xz.create=a=>new xz({checks:[],typeName:D8.ZodNumber,coerce:a?.coerce||!1,...xe(a)});class xA extends xf{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){let b;if(this._def.coerce)try{a.data=BigInt(a.data)}catch{return this._getInvalidInput(a)}if(this._getType(a)!==wU.bigint)return this._getInvalidInput(a);let c=new w4;for(let d of this._def.checks)"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(w3(b=this._getOrReturnCtx(a,b),{code:wW.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(w3(b=this._getOrReturnCtx(a,b),{code:wW.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"multipleOf"===d.kind?a.data%d.value!==BigInt(0)&&(w3(b=this._getOrReturnCtx(a,b),{code:wW.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):D5.assertNever(d);return{status:c.value,value:a.data}}_getInvalidInput(a){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.bigint,received:b.parsedType}),w5}gte(a,b){return this.setLimit("min",a,!0,D7.toString(b))}gt(a,b){return this.setLimit("min",a,!1,D7.toString(b))}lte(a,b){return this.setLimit("max",a,!0,D7.toString(b))}lt(a,b){return this.setLimit("max",a,!1,D7.toString(b))}setLimit(a,b,c,d){return new xA({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:D7.toString(d)}]})}_addCheck(a){return new xA({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:D7.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:D7.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:D7.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:D7.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:D7.toString(b)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}xA.create=a=>new xA({checks:[],typeName:D8.ZodBigInt,coerce:a?.coerce??!1,...xe(a)});class xB extends xf{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==wU.boolean){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.boolean,received:b.parsedType}),w5}return w7(a.data)}}xB.create=a=>new xB({typeName:D8.ZodBoolean,coerce:a?.coerce||!1,...xe(a)});class xC extends xf{_parse(a){let b;if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==wU.date){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.date,received:b.parsedType}),w5}if(Number.isNaN(a.data.getTime()))return w3(this._getOrReturnCtx(a),{code:wW.invalid_date}),w5;let c=new w4;for(let d of this._def.checks)"min"===d.kind?a.data.getTime()<d.value&&(w3(b=this._getOrReturnCtx(a,b),{code:wW.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),c.dirty()):"max"===d.kind?a.data.getTime()>d.value&&(w3(b=this._getOrReturnCtx(a,b),{code:wW.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),c.dirty()):D5.assertNever(d);return{status:c.value,value:new Date(a.data.getTime())}}_addCheck(a){return new xC({...this._def,checks:[...this._def.checks,a]})}min(a,b){return this._addCheck({kind:"min",value:a.getTime(),message:D7.toString(b)})}max(a,b){return this._addCheck({kind:"max",value:a.getTime(),message:D7.toString(b)})}get minDate(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return null!=a?new Date(a):null}get maxDate(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return null!=a?new Date(a):null}}xC.create=a=>new xC({checks:[],coerce:a?.coerce||!1,typeName:D8.ZodDate,...xe(a)});class xD extends xf{_parse(a){if(this._getType(a)!==wU.symbol){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.symbol,received:b.parsedType}),w5}return w7(a.data)}}xD.create=a=>new xD({typeName:D8.ZodSymbol,...xe(a)});class xE extends xf{_parse(a){if(this._getType(a)!==wU.undefined){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.undefined,received:b.parsedType}),w5}return w7(a.data)}}xE.create=a=>new xE({typeName:D8.ZodUndefined,...xe(a)});class xF extends xf{_parse(a){if(this._getType(a)!==wU.null){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.null,received:b.parsedType}),w5}return w7(a.data)}}xF.create=a=>new xF({typeName:D8.ZodNull,...xe(a)});class xG extends xf{constructor(){super(...arguments),this._any=!0}_parse(a){return w7(a.data)}}xG.create=a=>new xG({typeName:D8.ZodAny,...xe(a)});class xH extends xf{constructor(){super(...arguments),this._unknown=!0}_parse(a){return w7(a.data)}}xH.create=a=>new xH({typeName:D8.ZodUnknown,...xe(a)});class xI extends xf{_parse(a){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.never,received:b.parsedType}),w5}}xI.create=a=>new xI({typeName:D8.ZodNever,...xe(a)});class xJ extends xf{_parse(a){if(this._getType(a)!==wU.undefined){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.void,received:b.parsedType}),w5}return w7(a.data)}}xJ.create=a=>new xJ({typeName:D8.ZodVoid,...xe(a)});class xK extends xf{_parse(a){let{ctx:b,status:c}=this._processInputParams(a),d=this._def;if(b.parsedType!==wU.array)return w3(b,{code:wW.invalid_type,expected:wU.array,received:b.parsedType}),w5;if(null!==d.exactLength){let a=b.data.length>d.exactLength.value,e=b.data.length<d.exactLength.value;(a||e)&&(w3(b,{code:a?wW.too_big:wW.too_small,minimum:e?d.exactLength.value:void 0,maximum:a?d.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:d.exactLength.message}),c.dirty())}if(null!==d.minLength&&b.data.length<d.minLength.value&&(w3(b,{code:wW.too_small,minimum:d.minLength.value,type:"array",inclusive:!0,exact:!1,message:d.minLength.message}),c.dirty()),null!==d.maxLength&&b.data.length>d.maxLength.value&&(w3(b,{code:wW.too_big,maximum:d.maxLength.value,type:"array",inclusive:!0,exact:!1,message:d.maxLength.message}),c.dirty()),b.common.async)return Promise.all([...b.data].map((a,c)=>d.type._parseAsync(new xc(b,a,b.path,c)))).then(a=>w4.mergeArray(c,a));let e=[...b.data].map((a,c)=>d.type._parseSync(new xc(b,a,b.path,c)));return w4.mergeArray(c,e)}get element(){return this._def.type}min(a,b){return new xK({...this._def,minLength:{value:a,message:D7.toString(b)}})}max(a,b){return new xK({...this._def,maxLength:{value:a,message:D7.toString(b)}})}length(a,b){return new xK({...this._def,exactLength:{value:a,message:D7.toString(b)}})}nonempty(a){return this.min(1,a)}}xK.create=(a,b)=>new xK({type:a,minLength:null,maxLength:null,exactLength:null,typeName:D8.ZodArray,...xe(b)});class xL extends xf{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let a=this._def.shape(),b=D5.objectKeys(a);return this._cached={shape:a,keys:b},this._cached}_parse(a){if(this._getType(a)!==wU.object){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.object,received:b.parsedType}),w5}let{status:b,ctx:c}=this._processInputParams(a),{shape:d,keys:e}=this._getCached(),f=[];if(!(this._def.catchall instanceof xI&&"strip"===this._def.unknownKeys))for(let a in c.data)e.includes(a)||f.push(a);let g=[];for(let a of e){let b=d[a],e=c.data[a];g.push({key:{status:"valid",value:a},value:b._parse(new xc(c,e,c.path,a)),alwaysSet:a in c.data})}if(this._def.catchall instanceof xI){let a=this._def.unknownKeys;if("passthrough"===a)for(let a of f)g.push({key:{status:"valid",value:a},value:{status:"valid",value:c.data[a]}});else if("strict"===a)f.length>0&&(w3(c,{code:wW.unrecognized_keys,keys:f}),b.dirty());else if("strip"===a);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let a=this._def.catchall;for(let b of f){let d=c.data[b];g.push({key:{status:"valid",value:b},value:a._parse(new xc(c,d,c.path,b)),alwaysSet:b in c.data})}}return c.common.async?Promise.resolve().then(async()=>{let a=[];for(let b of g){let c=await b.key,d=await b.value;a.push({key:c,value:d,alwaysSet:b.alwaysSet})}return a}).then(a=>w4.mergeObjectSync(b,a)):w4.mergeObjectSync(b,g)}get shape(){return this._def.shape()}strict(a){return D7.errToObj,new xL({...this._def,unknownKeys:"strict",...void 0!==a?{errorMap:(b,c)=>{let d=this._def.errorMap?.(b,c).message??c.defaultError;return"unrecognized_keys"===b.code?{message:D7.errToObj(a).message??d}:{message:d}}}:{}})}strip(){return new xL({...this._def,unknownKeys:"strip"})}passthrough(){return new xL({...this._def,unknownKeys:"passthrough"})}extend(a){return new xL({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new xL({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:D8.ZodObject})}setKey(a,b){return this.augment({[a]:b})}catchall(a){return new xL({...this._def,catchall:a})}pick(a){let b={};for(let c of D5.objectKeys(a))a[c]&&this.shape[c]&&(b[c]=this.shape[c]);return new xL({...this._def,shape:()=>b})}omit(a){let b={};for(let c of D5.objectKeys(this.shape))a[c]||(b[c]=this.shape[c]);return new xL({...this._def,shape:()=>b})}deepPartial(){return function a(b){if(b instanceof xL){let c={};for(let d in b.shape){let e=b.shape[d];c[d]=x0.create(a(e))}return new xL({...b._def,shape:()=>c})}if(b instanceof xK)return new xK({...b._def,type:a(b.element)});if(b instanceof x0)return x0.create(a(b.unwrap()));if(b instanceof x1)return x1.create(a(b.unwrap()));if(b instanceof xQ)return xQ.create(b.items.map(b=>a(b)));else return b}(this)}partial(a){let b={};for(let c of D5.objectKeys(this.shape)){let d=this.shape[c];a&&!a[c]?b[c]=d:b[c]=d.optional()}return new xL({...this._def,shape:()=>b})}required(a){let b={};for(let c of D5.objectKeys(this.shape))if(a&&!a[c])b[c]=this.shape[c];else{let a=this.shape[c];for(;a instanceof x0;)a=a._def.innerType;b[c]=a}return new xL({...this._def,shape:()=>b})}keyof(){return xX(D5.objectKeys(this.shape))}}xL.create=(a,b)=>new xL({shape:()=>a,unknownKeys:"strip",catchall:xI.create(),typeName:D8.ZodObject,...xe(b)}),xL.strictCreate=(a,b)=>new xL({shape:()=>a,unknownKeys:"strict",catchall:xI.create(),typeName:D8.ZodObject,...xe(b)}),xL.lazycreate=(a,b)=>new xL({shape:a,unknownKeys:"strip",catchall:xI.create(),typeName:D8.ZodObject,...xe(b)});class xM extends xf{_parse(a){let{ctx:b}=this._processInputParams(a),c=this._def.options;if(b.common.async)return Promise.all(c.map(async a=>{let c={...b,common:{...b.common,issues:[]},parent:null};return{result:await a._parseAsync({data:b.data,path:b.path,parent:c}),ctx:c}})).then(function(a){for(let b of a)if("valid"===b.result.status)return b.result;for(let c of a)if("dirty"===c.result.status)return b.common.issues.push(...c.ctx.common.issues),c.result;let c=a.map(a=>new wY(a.ctx.common.issues));return w3(b,{code:wW.invalid_union,unionErrors:c}),w5});{let a,d=[];for(let e of c){let c={...b,common:{...b.common,issues:[]},parent:null},f=e._parseSync({data:b.data,path:b.path,parent:c});if("valid"===f.status)return f;"dirty"!==f.status||a||(a={result:f,ctx:c}),c.common.issues.length&&d.push(c.common.issues)}if(a)return b.common.issues.push(...a.ctx.common.issues),a.result;let e=d.map(a=>new wY(a));return w3(b,{code:wW.invalid_union,unionErrors:e}),w5}}get options(){return this._def.options}}xM.create=(a,b)=>new xM({options:a,typeName:D8.ZodUnion,...xe(b)});let xN=a=>{if(a instanceof xV)return xN(a.schema);if(a instanceof x_)return xN(a.innerType());if(a instanceof xW)return[a.value];if(a instanceof xY)return a.options;if(a instanceof xZ)return D5.objectValues(a.enum);else if(a instanceof x2)return xN(a._def.innerType);else if(a instanceof xE)return[void 0];else if(a instanceof xF)return[null];else if(a instanceof x0)return[void 0,...xN(a.unwrap())];else if(a instanceof x1)return[null,...xN(a.unwrap())];else if(a instanceof x6)return xN(a.unwrap());else if(a instanceof x8)return xN(a.unwrap());else if(a instanceof x3)return xN(a._def.innerType);else return[]};class xO extends xf{_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==wU.object)return w3(b,{code:wW.invalid_type,expected:wU.object,received:b.parsedType}),w5;let c=this.discriminator,d=b.data[c],e=this.optionsMap.get(d);return e?b.common.async?e._parseAsync({data:b.data,path:b.path,parent:b}):e._parseSync({data:b.data,path:b.path,parent:b}):(w3(b,{code:wW.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[c]}),w5)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,b,c){let d=new Map;for(let c of b){let b=xN(c.shape[a]);if(!b.length)throw Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(let e of b){if(d.has(e))throw Error(`Discriminator property ${String(a)} has duplicate value ${String(e)}`);d.set(e,c)}}return new xO({typeName:D8.ZodDiscriminatedUnion,discriminator:a,options:b,optionsMap:d,...xe(c)})}}class xP extends xf{_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=(a,d)=>{if(w8(a)||w8(d))return w5;let e=function a(b,c){let d=wV(b),e=wV(c);if(b===c)return{valid:!0,data:b};if(d===wU.object&&e===wU.object){let d=D5.objectKeys(c),e=D5.objectKeys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1};f[d]=e.data}return{valid:!0,data:f}}if(d===wU.array&&e===wU.array){if(b.length!==c.length)return{valid:!1};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1};d.push(f.data)}return{valid:!0,data:d}}if(d===wU.date&&e===wU.date&&+b==+c)return{valid:!0,data:b};return{valid:!1}}(a.value,d.value);return e.valid?((w9(a)||w9(d))&&b.dirty(),{status:b.value,value:e.data}):(w3(c,{code:wW.invalid_intersection_types}),w5)};return c.common.async?Promise.all([this._def.left._parseAsync({data:c.data,path:c.path,parent:c}),this._def.right._parseAsync({data:c.data,path:c.path,parent:c})]).then(([a,b])=>d(a,b)):d(this._def.left._parseSync({data:c.data,path:c.path,parent:c}),this._def.right._parseSync({data:c.data,path:c.path,parent:c}))}}xP.create=(a,b,c)=>new xP({left:a,right:b,typeName:D8.ZodIntersection,...xe(c)});class xQ extends xf{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==wU.array)return w3(c,{code:wW.invalid_type,expected:wU.array,received:c.parsedType}),w5;if(c.data.length<this._def.items.length)return w3(c,{code:wW.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),w5;!this._def.rest&&c.data.length>this._def.items.length&&(w3(c,{code:wW.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b.dirty());let d=[...c.data].map((a,b)=>{let d=this._def.items[b]||this._def.rest;return d?d._parse(new xc(c,a,c.path,b)):null}).filter(a=>!!a);return c.common.async?Promise.all(d).then(a=>w4.mergeArray(b,a)):w4.mergeArray(b,d)}get items(){return this._def.items}rest(a){return new xQ({...this._def,rest:a})}}xQ.create=(a,b)=>{if(!Array.isArray(a))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new xQ({items:a,typeName:D8.ZodTuple,rest:null,...xe(b)})};class xR extends xf{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==wU.object)return w3(c,{code:wW.invalid_type,expected:wU.object,received:c.parsedType}),w5;let d=[],e=this._def.keyType,f=this._def.valueType;for(let a in c.data)d.push({key:e._parse(new xc(c,a,c.path,a)),value:f._parse(new xc(c,c.data[a],c.path,a)),alwaysSet:a in c.data});return c.common.async?w4.mergeObjectAsync(b,d):w4.mergeObjectSync(b,d)}get element(){return this._def.valueType}static create(a,b,c){return new xR(b instanceof xf?{keyType:a,valueType:b,typeName:D8.ZodRecord,...xe(c)}:{keyType:xy.create(),valueType:a,typeName:D8.ZodRecord,...xe(b)})}}class xS extends xf{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==wU.map)return w3(c,{code:wW.invalid_type,expected:wU.map,received:c.parsedType}),w5;let d=this._def.keyType,e=this._def.valueType,f=[...c.data.entries()].map(([a,b],f)=>({key:d._parse(new xc(c,a,c.path,[f,"key"])),value:e._parse(new xc(c,b,c.path,[f,"value"]))}));if(c.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of f){let d=await c.key,e=await c.value;if("aborted"===d.status||"aborted"===e.status)return w5;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}})}{let a=new Map;for(let c of f){let d=c.key,e=c.value;if("aborted"===d.status||"aborted"===e.status)return w5;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}}}}xS.create=(a,b,c)=>new xS({valueType:b,keyType:a,typeName:D8.ZodMap,...xe(c)});class xT extends xf{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==wU.set)return w3(c,{code:wW.invalid_type,expected:wU.set,received:c.parsedType}),w5;let d=this._def;null!==d.minSize&&c.data.size<d.minSize.value&&(w3(c,{code:wW.too_small,minimum:d.minSize.value,type:"set",inclusive:!0,exact:!1,message:d.minSize.message}),b.dirty()),null!==d.maxSize&&c.data.size>d.maxSize.value&&(w3(c,{code:wW.too_big,maximum:d.maxSize.value,type:"set",inclusive:!0,exact:!1,message:d.maxSize.message}),b.dirty());let e=this._def.valueType;function f(a){let c=new Set;for(let d of a){if("aborted"===d.status)return w5;"dirty"===d.status&&b.dirty(),c.add(d.value)}return{status:b.value,value:c}}let g=[...c.data.values()].map((a,b)=>e._parse(new xc(c,a,c.path,b)));return c.common.async?Promise.all(g).then(a=>f(a)):f(g)}min(a,b){return new xT({...this._def,minSize:{value:a,message:D7.toString(b)}})}max(a,b){return new xT({...this._def,maxSize:{value:a,message:D7.toString(b)}})}size(a,b){return this.min(a,b).max(a,b)}nonempty(a){return this.min(1,a)}}xT.create=(a,b)=>new xT({valueType:a,minSize:null,maxSize:null,typeName:D8.ZodSet,...xe(b)});class xU extends xf{constructor(){super(...arguments),this.validate=this.implement}_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==wU.function)return w3(b,{code:wW.invalid_type,expected:wU.function,received:b.parsedType}),w5;function c(a,c){return w1({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,w$,wZ].filter(a=>!!a),issueData:{code:wW.invalid_arguments,argumentsError:c}})}function d(a,c){return w1({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,w$,wZ].filter(a=>!!a),issueData:{code:wW.invalid_return_type,returnTypeError:c}})}let e={errorMap:b.common.contextualErrorMap},f=b.data;if(this._def.returns instanceof x$){let a=this;return w7(async function(...b){let g=new wY([]),h=await a._def.args.parseAsync(b,e).catch(a=>{throw g.addIssue(c(b,a)),g}),i=await Reflect.apply(f,this,h);return await a._def.returns._def.type.parseAsync(i,e).catch(a=>{throw g.addIssue(d(i,a)),g})})}{let a=this;return w7(function(...b){let g=a._def.args.safeParse(b,e);if(!g.success)throw new wY([c(b,g.error)]);let h=Reflect.apply(f,this,g.data),i=a._def.returns.safeParse(h,e);if(!i.success)throw new wY([d(h,i.error)]);return i.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new xU({...this._def,args:xQ.create(a).rest(xH.create())})}returns(a){return new xU({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,b,c){return new xU({args:a||xQ.create([]).rest(xH.create()),returns:b||xH.create(),typeName:D8.ZodFunction,...xe(c)})}}class xV extends xf{get schema(){return this._def.getter()}_parse(a){let{ctx:b}=this._processInputParams(a);return this._def.getter()._parse({data:b.data,path:b.path,parent:b})}}xV.create=(a,b)=>new xV({getter:a,typeName:D8.ZodLazy,...xe(b)});class xW extends xf{_parse(a){if(a.data!==this._def.value){let b=this._getOrReturnCtx(a);return w3(b,{received:b.data,code:wW.invalid_literal,expected:this._def.value}),w5}return{status:"valid",value:a.data}}get value(){return this._def.value}}function xX(a,b){return new xY({values:a,typeName:D8.ZodEnum,...xe(b)})}xW.create=(a,b)=>new xW({value:a,typeName:D8.ZodLiteral,...xe(b)});class xY extends xf{_parse(a){if("string"!=typeof a.data){let b=this._getOrReturnCtx(a),c=this._def.values;return w3(b,{expected:D5.joinValues(c),received:b.parsedType,code:wW.invalid_type}),w5}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(a.data)){let b=this._getOrReturnCtx(a),c=this._def.values;return w3(b,{received:b.data,code:wW.invalid_enum_value,options:c}),w5}return w7(a.data)}get options(){return this._def.values}get enum(){let a={};for(let b of this._def.values)a[b]=b;return a}get Values(){let a={};for(let b of this._def.values)a[b]=b;return a}get Enum(){let a={};for(let b of this._def.values)a[b]=b;return a}extract(a,b=this._def){return xY.create(a,{...this._def,...b})}exclude(a,b=this._def){return xY.create(this.options.filter(b=>!a.includes(b)),{...this._def,...b})}}xY.create=xX;class xZ extends xf{_parse(a){let b=D5.getValidEnumValues(this._def.values),c=this._getOrReturnCtx(a);if(c.parsedType!==wU.string&&c.parsedType!==wU.number){let a=D5.objectValues(b);return w3(c,{expected:D5.joinValues(a),received:c.parsedType,code:wW.invalid_type}),w5}if(this._cache||(this._cache=new Set(D5.getValidEnumValues(this._def.values))),!this._cache.has(a.data)){let a=D5.objectValues(b);return w3(c,{received:c.data,code:wW.invalid_enum_value,options:a}),w5}return w7(a.data)}get enum(){return this._def.values}}xZ.create=(a,b)=>new xZ({values:a,typeName:D8.ZodNativeEnum,...xe(b)});class x$ extends xf{unwrap(){return this._def.type}_parse(a){let{ctx:b}=this._processInputParams(a);return b.parsedType!==wU.promise&&!1===b.common.async?(w3(b,{code:wW.invalid_type,expected:wU.promise,received:b.parsedType}),w5):w7((b.parsedType===wU.promise?b.data:Promise.resolve(b.data)).then(a=>this._def.type.parseAsync(a,{path:b.path,errorMap:b.common.contextualErrorMap})))}}x$.create=(a,b)=>new x$({type:a,typeName:D8.ZodPromise,...xe(b)});class x_ extends xf{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===D8.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=this._def.effect||null,e={addIssue:a=>{w3(c,a),a.fatal?b.abort():b.dirty()},get path(){return c.path}};if(e.addIssue=e.addIssue.bind(e),"preprocess"===d.type){let a=d.transform(c.data,e);if(c.common.async)return Promise.resolve(a).then(async a=>{if("aborted"===b.value)return w5;let d=await this._def.schema._parseAsync({data:a,path:c.path,parent:c});return"aborted"===d.status?w5:"dirty"===d.status||"dirty"===b.value?w6(d.value):d});{if("aborted"===b.value)return w5;let d=this._def.schema._parseSync({data:a,path:c.path,parent:c});return"aborted"===d.status?w5:"dirty"===d.status||"dirty"===b.value?w6(d.value):d}}if("refinement"===d.type){let a=a=>{let b=d.refinement(a,e);if(c.common.async)return Promise.resolve(b);if(b instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(c=>"aborted"===c.status?w5:("dirty"===c.status&&b.dirty(),a(c.value).then(()=>({status:b.value,value:c.value}))));{let d=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===d.status?w5:("dirty"===d.status&&b.dirty(),a(d.value),{status:b.value,value:d.value})}}if("transform"===d.type)if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(a=>xa(a)?Promise.resolve(d.transform(a.value,e)).then(a=>({status:b.value,value:a})):w5);else{let a=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});if(!xa(a))return w5;let f=d.transform(a.value,e);if(f instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:b.value,value:f}}D5.assertNever(d)}}x_.create=(a,b,c)=>new x_({schema:a,typeName:D8.ZodEffects,effect:b,...xe(c)}),x_.createWithPreprocess=(a,b,c)=>new x_({schema:b,effect:{type:"preprocess",transform:a},typeName:D8.ZodEffects,...xe(c)});class x0 extends xf{_parse(a){return this._getType(a)===wU.undefined?w7(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}x0.create=(a,b)=>new x0({innerType:a,typeName:D8.ZodOptional,...xe(b)});class x1 extends xf{_parse(a){return this._getType(a)===wU.null?w7(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}x1.create=(a,b)=>new x1({innerType:a,typeName:D8.ZodNullable,...xe(b)});class x2 extends xf{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return b.parsedType===wU.undefined&&(c=this._def.defaultValue()),this._def.innerType._parse({data:c,path:b.path,parent:b})}removeDefault(){return this._def.innerType}}x2.create=(a,b)=>new x2({innerType:a,typeName:D8.ZodDefault,defaultValue:"function"==typeof b.default?b.default:()=>b.default,...xe(b)});class x3 extends xf{_parse(a){let{ctx:b}=this._processInputParams(a),c={...b,common:{...b.common,issues:[]}},d=this._def.innerType._parse({data:c.data,path:c.path,parent:{...c}});return xb(d)?d.then(a=>({status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new wY(c.common.issues)},input:c.data})})):{status:"valid",value:"valid"===d.status?d.value:this._def.catchValue({get error(){return new wY(c.common.issues)},input:c.data})}}removeCatch(){return this._def.innerType}}x3.create=(a,b)=>new x3({innerType:a,typeName:D8.ZodCatch,catchValue:"function"==typeof b.catch?b.catch:()=>b.catch,...xe(b)});class x4 extends xf{_parse(a){if(this._getType(a)!==wU.nan){let b=this._getOrReturnCtx(a);return w3(b,{code:wW.invalid_type,expected:wU.nan,received:b.parsedType}),w5}return{status:"valid",value:a.data}}}x4.create=a=>new x4({typeName:D8.ZodNaN,...xe(a)});let x5=Symbol("zod_brand");class x6 extends xf{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return this._def.type._parse({data:c,path:b.path,parent:b})}unwrap(){return this._def.type}}class x7 extends xf{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?w5:"dirty"===a.status?(b.dirty(),w6(a.value)):this._def.out._parseAsync({data:a.value,path:c.path,parent:c})})();{let a=this._def.in._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?w5:"dirty"===a.status?(b.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:c.path,parent:c})}}static create(a,b){return new x7({in:a,out:b,typeName:D8.ZodPipeline})}}class x8 extends xf{_parse(a){let b=this._def.innerType._parse(a),c=a=>(xa(a)&&(a.value=Object.freeze(a.value)),a);return xb(b)?b.then(a=>c(a)):c(b)}unwrap(){return this._def.innerType}}function x9(a,b){let c="function"==typeof a?a(b):"string"==typeof a?{message:a}:a;return"string"==typeof c?{message:c}:c}function ya(a,b={},c){return a?xG.create().superRefine((d,e)=>{let f=a(d);if(f instanceof Promise)return f.then(a=>{if(!a){let a=x9(b,d),f=a.fatal??c??!0;e.addIssue({code:"custom",...a,fatal:f})}});if(!f){let a=x9(b,d),f=a.fatal??c??!0;e.addIssue({code:"custom",...a,fatal:f})}}):xG.create()}x8.create=(a,b)=>new x8({innerType:a,typeName:D8.ZodReadonly,...xe(b)});let yb={object:xL.lazycreate};(DU=D8||(D8={})).ZodString="ZodString",DU.ZodNumber="ZodNumber",DU.ZodNaN="ZodNaN",DU.ZodBigInt="ZodBigInt",DU.ZodBoolean="ZodBoolean",DU.ZodDate="ZodDate",DU.ZodSymbol="ZodSymbol",DU.ZodUndefined="ZodUndefined",DU.ZodNull="ZodNull",DU.ZodAny="ZodAny",DU.ZodUnknown="ZodUnknown",DU.ZodNever="ZodNever",DU.ZodVoid="ZodVoid",DU.ZodArray="ZodArray",DU.ZodObject="ZodObject",DU.ZodUnion="ZodUnion",DU.ZodDiscriminatedUnion="ZodDiscriminatedUnion",DU.ZodIntersection="ZodIntersection",DU.ZodTuple="ZodTuple",DU.ZodRecord="ZodRecord",DU.ZodMap="ZodMap",DU.ZodSet="ZodSet",DU.ZodFunction="ZodFunction",DU.ZodLazy="ZodLazy",DU.ZodLiteral="ZodLiteral",DU.ZodEnum="ZodEnum",DU.ZodEffects="ZodEffects",DU.ZodNativeEnum="ZodNativeEnum",DU.ZodOptional="ZodOptional",DU.ZodNullable="ZodNullable",DU.ZodDefault="ZodDefault",DU.ZodCatch="ZodCatch",DU.ZodPromise="ZodPromise",DU.ZodBranded="ZodBranded",DU.ZodPipeline="ZodPipeline",DU.ZodReadonly="ZodReadonly";let yc=(a,b={message:`Input not instance of ${a.name}`})=>ya(b=>b instanceof a,b),yd=xy.create,ye=xz.create,yf=x4.create,yg=xA.create,yh=xB.create,yi=xC.create,yj=xD.create,yk=xE.create,yl=xF.create,ym=xG.create,yn=xH.create,yo=xI.create,yp=xJ.create,yq=xK.create,yr=xL.create,ys=xL.strictCreate,yt=xM.create,yu=xO.create,yv=xP.create,yw=xQ.create,yx=xR.create,yy=xS.create,yz=xT.create,yA=xU.create,yB=xV.create,yC=xW.create,yD=xY.create,yE=xZ.create,yF=x$.create,yG=x_.create,yH=x0.create,yI=x1.create,yJ=x_.createWithPreprocess,yK=x7.create,yL=()=>yd().optional(),yM=()=>ye().optional(),yN=()=>yh().optional(),yO={string:a=>xy.create({...a,coerce:!0}),number:a=>xz.create({...a,coerce:!0}),boolean:a=>xB.create({...a,coerce:!0}),bigint:a=>xA.create({...a,coerce:!0}),date:a=>xC.create({...a,coerce:!0})};a.s(["BRAND",0,x5,"NEVER",0,w5,"Schema",()=>xf,"ZodAny",()=>xG,"ZodArray",()=>xK,"ZodBigInt",()=>xA,"ZodBoolean",()=>xB,"ZodBranded",()=>x6,"ZodCatch",()=>x3,"ZodDate",()=>xC,"ZodDefault",()=>x2,"ZodDiscriminatedUnion",()=>xO,"ZodEffects",()=>x_,"ZodEnum",()=>xY,"ZodFirstPartyTypeKind",()=>D8,"ZodFunction",()=>xU,"ZodIntersection",()=>xP,"ZodLazy",()=>xV,"ZodLiteral",()=>xW,"ZodMap",()=>xS,"ZodNaN",()=>x4,"ZodNativeEnum",()=>xZ,"ZodNever",()=>xI,"ZodNull",()=>xF,"ZodNullable",()=>x1,"ZodNumber",()=>xz,"ZodObject",()=>xL,"ZodOptional",()=>x0,"ZodPipeline",()=>x7,"ZodPromise",()=>x$,"ZodReadonly",()=>x8,"ZodRecord",()=>xR,"ZodSchema",()=>xf,"ZodSet",()=>xT,"ZodString",()=>xy,"ZodSymbol",()=>xD,"ZodTransformer",()=>x_,"ZodTuple",()=>xQ,"ZodType",()=>xf,"ZodUndefined",()=>xE,"ZodUnion",()=>xM,"ZodUnknown",()=>xH,"ZodVoid",()=>xJ,"any",()=>ym,"array",()=>yq,"bigint",()=>yg,"boolean",()=>yh,"coerce",0,yO,"custom",()=>ya,"date",()=>yi,"datetimeRegex",()=>xx,"discriminatedUnion",()=>yu,"effect",()=>yG,"enum",()=>yD,"function",()=>yA,"instanceof",()=>yc,"intersection",()=>yv,"late",0,yb,"lazy",()=>yB,"literal",()=>yC,"map",()=>yy,"nan",()=>yf,"nativeEnum",()=>yE,"never",()=>yo,"null",()=>yl,"nullable",()=>yI,"number",()=>ye,"object",()=>yr,"oboolean",()=>yN,"onumber",()=>yM,"optional",()=>yH,"ostring",()=>yL,"pipeline",()=>yK,"preprocess",()=>yJ,"promise",()=>yF,"record",()=>yx,"set",()=>yz,"strictObject",()=>ys,"string",()=>yd,"symbol",()=>yj,"transformer",()=>yG,"tuple",()=>yw,"undefined",()=>yk,"union",()=>yt,"unknown",()=>yn,"void",()=>yp],263563),a.i(263563),a.i(481440),a.s(["BRAND",0,x5,"DIRTY",0,w6,"EMPTY_PATH",0,w2,"INVALID",0,w5,"NEVER",0,w5,"OK",0,w7,"ParseStatus",()=>w4,"Schema",()=>xf,"ZodAny",()=>xG,"ZodArray",()=>xK,"ZodBigInt",()=>xA,"ZodBoolean",()=>xB,"ZodBranded",()=>x6,"ZodCatch",()=>x3,"ZodDate",()=>xC,"ZodDefault",()=>x2,"ZodDiscriminatedUnion",()=>xO,"ZodEffects",()=>x_,"ZodEnum",()=>xY,"ZodError",()=>wY,"ZodFirstPartyTypeKind",()=>D8,"ZodFunction",()=>xU,"ZodIntersection",()=>xP,"ZodIssueCode",0,wW,"ZodLazy",()=>xV,"ZodLiteral",()=>xW,"ZodMap",()=>xS,"ZodNaN",()=>x4,"ZodNativeEnum",()=>xZ,"ZodNever",()=>xI,"ZodNull",()=>xF,"ZodNullable",()=>x1,"ZodNumber",()=>xz,"ZodObject",()=>xL,"ZodOptional",()=>x0,"ZodParsedType",0,wU,"ZodPipeline",()=>x7,"ZodPromise",()=>x$,"ZodReadonly",()=>x8,"ZodRecord",()=>xR,"ZodSchema",()=>xf,"ZodSet",()=>xT,"ZodString",()=>xy,"ZodSymbol",()=>xD,"ZodTransformer",()=>x_,"ZodTuple",()=>xQ,"ZodType",()=>xf,"ZodUndefined",()=>xE,"ZodUnion",()=>xM,"ZodUnknown",()=>xH,"ZodVoid",()=>xJ,"addIssueToContext",()=>w3,"any",()=>ym,"array",()=>yq,"bigint",()=>yg,"boolean",()=>yh,"coerce",0,yO,"custom",()=>ya,"date",()=>yi,"datetimeRegex",()=>xx,"defaultErrorMap",0,wZ,"discriminatedUnion",()=>yu,"effect",()=>yG,"enum",()=>yD,"function",()=>yA,"getErrorMap",()=>w0,"getParsedType",0,wV,"instanceof",()=>yc,"intersection",()=>yv,"isAborted",0,w8,"isAsync",0,xb,"isDirty",0,w9,"isValid",0,xa,"late",0,yb,"lazy",()=>yB,"literal",()=>yC,"makeIssue",0,w1,"map",()=>yy,"nan",()=>yf,"nativeEnum",()=>yE,"never",()=>yo,"null",()=>yl,"nullable",()=>yI,"number",()=>ye,"object",()=>yr,"objectUtil",()=>D6,"oboolean",()=>yN,"onumber",()=>yM,"optional",()=>yH,"ostring",()=>yL,"pipeline",()=>yK,"preprocess",()=>yJ,"promise",()=>yF,"quotelessJson",0,wX,"record",()=>yx,"set",()=>yz,"setErrorMap",()=>w_,"strictObject",()=>ys,"string",()=>yd,"symbol",()=>yj,"transformer",()=>yG,"tuple",()=>yw,"undefined",()=>yk,"union",()=>yt,"unknown",()=>yn,"util",()=>D5,"void",()=>yp],673950);var yP=a.i(673950),yP=yP,yQ=a.i(155539),yR=a.i(28387),yS=a.i(796936),yT=a.i(90360),yU=a.i(484786),yV=a.i(111755);let yW={block:(0,yT.defineBlock)({format:a=>({transactions:a.transactions?.map(a=>{if("string"==typeof a)return a;let b=(0,yU.formatTransaction)(a);return"0x7e"===b.typeHex&&(b.isSystemTx=a.isSystemTx,b.mint=a.mint?(0,yS.hexToBigInt)(a.mint):void 0,b.sourceHash=a.sourceHash,b.type="deposit"),b}),stateRoot:a.stateRoot})}),transaction:(0,yU.defineTransaction)({format(a){let b={};return"0x7e"===a.type&&(b.isSystemTx=a.isSystemTx,b.mint=a.mint?(0,yS.hexToBigInt)(a.mint):void 0,b.sourceHash=a.sourceHash,b.type="deposit"),b}}),transactionReceipt:(0,yV.defineTransactionReceipt)({format:a=>({l1GasPrice:a.l1GasPrice?(0,yS.hexToBigInt)(a.l1GasPrice):null,l1GasUsed:a.l1GasUsed?(0,yS.hexToBigInt)(a.l1GasUsed):null,l1Fee:a.l1Fee?(0,yS.hexToBigInt)(a.l1Fee):null,l1FeeScalar:a.l1FeeScalar?Number(a.l1FeeScalar):null})})};var yX=a.i(476705),yY=a.i(429664),yZ=a.i(521045),y$=a.i(372092);let y_={blockTime:2e3,contracts:{gasPriceOracle:{address:"0x420000000000000000000000000000000000000F"},l1Block:{address:"0x4200000000000000000000000000000000000015"},l2CrossDomainMessenger:{address:"0x4200000000000000000000000000000000000007"},l2Erc721Bridge:{address:"0x4200000000000000000000000000000000000014"},l2StandardBridge:{address:"0x4200000000000000000000000000000000000010"},l2ToL1MessagePasser:{address:"0x4200000000000000000000000000000000000016"}},formatters:yW,serializers:{transaction:function(a,b){var c;return"deposit"===(c=a).type||void 0!==c.sourceHash?function(a){!function(a){let{from:b,to:c}=a;if(b&&!(0,fe.isAddress)(b))throw new yX.InvalidAddressError({address:b});if(c&&!(0,fe.isAddress)(c))throw new yX.InvalidAddressError({address:c})}(a);let{sourceHash:b,data:c,from:d,gas:e,isSystemTx:f,mint:g,to:h,value:i}=a,j=[b,d,h??"0x",g?(0,fd.toHex)(g):"0x",i?(0,fd.toHex)(i):"0x",e?(0,fd.toHex)(e):"0x",f?"0x1":"0x",c??"0x"];return(0,yY.concatHex)(["0x7e",(0,yZ.toRlp)(j)])}(a):(0,y$.serializeTransaction)(a,b)}}};var y0=a.i(927549);let y1=(0,y0.defineChain)({...y_,id:84532,network:"base-sepolia",name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://sepolia.basescan.org",apiUrl:"https://api-sepolia.basescan.org/api"}},contracts:{...y_.contracts,disputeGameFactory:{0xaa36a7:{address:"0xd6E6dBf4F7EA0ac412fD8b65ED297e64BB7a06E1"}},l2OutputOracle:{0xaa36a7:{address:"0x84457ca9D0163FbC4bbfe4Dfbb20ba46e48DF254"}},portal:{0xaa36a7:{address:"0x49f53e41452c74589e85ca1677426ba426459e85",blockCreated:4446677}},l1StandardBridge:{0xaa36a7:{address:"0xfd0Bf71F60660E2f608ed56e1659C450eB113120",blockCreated:4446677}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1059647}},testnet:!0,sourceId:0xaa36a7});({...y1,experimental_preconfirmationTime:200,rpcUrls:{default:{http:["https://sepolia-preconf.base.org"]}}});let y2=(0,y0.defineChain)({id:43113,name:"Avalanche Fuji",nativeCurrency:{decimals:18,name:"Avalanche Fuji",symbol:"AVAX"},rpcUrls:{default:{http:["https://api.avax-test.network/ext/bc/C/rpc"]}},blockExplorers:{default:{name:"SnowTrace",url:"https://testnet.snowtrace.io",apiUrl:"https://api-testnet.snowtrace.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7096959}},testnet:!0}),y3=(0,y0.defineChain)({...y_,id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}},contracts:{...y_.contracts,disputeGameFactory:{1:{address:"0x43edB88C4B80fDD2AdFF2412A7BebF9dF42cB40e"}},l2OutputOracle:{1:{address:"0x56315b90c40730925ec5485cf004d835058518A0"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:5022},portal:{1:{address:"0x49048044D57e1C92A77f79988d21Fa8fAF74E97e",blockCreated:0x10ac19f}},l1StandardBridge:{1:{address:"0x3154Cf16ccdb4C6d922629664174b904d80F2C35",blockCreated:0x10ac19f}}},sourceId:1});({...y3,experimental_preconfirmationTime:200,rpcUrls:{default:{http:["https://mainnet-preconf.base.org"]}}});let y4=(0,y0.defineChain)({id:1329,name:"Sei Network",nativeCurrency:{name:"Sei",symbol:"SEI",decimals:18},rpcUrls:{default:{http:["https://evm-rpc.sei-apis.com/"],webSocket:["wss://evm-ws.sei-apis.com/"]}},blockExplorers:{default:{name:"Seitrace",url:"https://seitrace.com",apiUrl:"https://seitrace.com/pacific-1/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11"}}}),y5=(0,y0.defineChain)({id:1328,name:"Sei Testnet",nativeCurrency:{name:"Sei",symbol:"SEI",decimals:18},rpcUrls:{default:{http:["https://evm-rpc-testnet.sei-apis.com"],webSocket:["wss://evm-ws-testnet.sei-apis.com"]}},blockExplorers:{default:{name:"Seitrace",url:"https://seitrace.com"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:0x5e201b3}},testnet:!0}),y6=(0,y0.defineChain)({id:137,name:"Polygon",blockTime:2e3,nativeCurrency:{name:"POL",symbol:"POL",decimals:18},rpcUrls:{default:{http:["https://polygon-rpc.com"]}},blockExplorers:{default:{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.etherscan.io/v2/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:0x18938b0}}}),y7=(0,y0.defineChain)({id:80002,name:"Polygon Amoy",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},rpcUrls:{default:{http:["https://rpc-amoy.polygon.technology"]}},blockExplorers:{default:{name:"PolygonScan",url:"https://amoy.polygonscan.com",apiUrl:"https://api.etherscan.io/v2/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:3127388}},testnet:!0}),y8=(0,y0.defineChain)({id:3338,name:"Peaq",nativeCurrency:{decimals:18,name:"peaq",symbol:"PEAQ"},rpcUrls:{default:{http:["https://quicknode1.peaq.xyz","https://quicknode2.peaq.xyz","https://quicknode3.peaq.xyz"],webSocket:["wss://quicknode1.peaq.xyz","wss://quicknode2.peaq.xyz","wss://quicknode3.peaq.xyz"]}},blockExplorers:{default:{name:"Subscan",url:"https://peaq.subscan.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:3566354}}}),y9=(0,y0.defineChain)({id:43114,name:"Avalanche",blockTime:1700,nativeCurrency:{decimals:18,name:"Avalanche",symbol:"AVAX"},rpcUrls:{default:{http:["https://api.avax.network/ext/bc/C/rpc"]}},blockExplorers:{default:{name:"SnowTrace",url:"https://snowtrace.io",apiUrl:"https://api.snowtrace.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:0xb5b35e}}}),za=(0,y0.defineChain)({id:4690,name:"IoTeX Testnet",nativeCurrency:{decimals:18,name:"IoTeX",symbol:"IOTX"},rpcUrls:{default:{http:["https://babel-api.testnet.iotex.io"],webSocket:["wss://babel-api.testnet.iotex.io"]}},blockExplorers:{default:{name:"IoTeXScan",url:"https://testnet.iotexscan.io"}},contracts:{multicall3:{address:"0xb5cecD6894c6f473Ec726A176f1512399A2e355d",blockCreated:0x17383c8}},testnet:!0}),zb=(0,y0.defineChain)({id:4689,name:"IoTeX",nativeCurrency:{decimals:18,name:"IoTeX",symbol:"IOTX"},rpcUrls:{default:{http:["https://babel-api.mainnet.iotex.io"],webSocket:["wss://babel-api.mainnet.iotex.io"]}},blockExplorers:{default:{name:"IoTeXScan",url:"https://iotexscan.io"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:0x15230d6}}});var zc=a.i(566167),zd=a.i(116508),ze=a.i(637998);let zf=32n*a.i(283678).maxUint16,zg={block:(0,yT.defineBlock)({format(a){let b=a.transactions?.map(a=>{if("string"==typeof a)return a;let b=zg.transaction?.format(a);return"0x71"===b.typeHex?b.type="eip712":"0xff"===b.typeHex&&(b.type="priority"),b});return{l1BatchNumber:a.l1BatchNumber?(0,yS.hexToBigInt)(a.l1BatchNumber):null,l1BatchTimestamp:a.l1BatchTimestamp?(0,yS.hexToBigInt)(a.l1BatchTimestamp):null,transactions:b}}}),transaction:(0,yU.defineTransaction)({format(a){let b={};return"0x71"===a.type?b.type="eip712":"0xff"===a.type&&(b.type="priority"),{...b,l1BatchNumber:a.l1BatchNumber?(0,yS.hexToBigInt)(a.l1BatchNumber):null,l1BatchTxIndex:a.l1BatchTxIndex?(0,yS.hexToBigInt)(a.l1BatchTxIndex):null}}}),transactionReceipt:(0,yV.defineTransactionReceipt)({format:a=>({l1BatchNumber:a.l1BatchNumber?(0,yS.hexToBigInt)(a.l1BatchNumber):null,l1BatchTxIndex:a.l1BatchTxIndex?(0,yS.hexToBigInt)(a.l1BatchTxIndex):null,logs:a.logs.map(a=>({...(0,zd.formatLog)(a),l1BatchNumber:a.l1BatchNumber?(0,yS.hexToBigInt)(a.l1BatchNumber):null,transactionLogIndex:(0,yS.hexToNumber)(a.transactionLogIndex),logType:a.logType})),l2ToL1Logs:a.l2ToL1Logs.map(a=>({blockNumber:(0,yS.hexToBigInt)(a.blockHash),blockHash:a.blockHash,l1BatchNumber:a.l1BatchNumber?(0,yS.hexToBigInt)(a.l1BatchNumber):null,transactionIndex:(0,yS.hexToBigInt)(a.transactionIndex),shardId:(0,yS.hexToBigInt)(a.shardId),isService:a.isService,sender:a.sender,key:a.key,value:a.value,transactionHash:a.transactionHash,logIndex:(0,yS.hexToBigInt)(a.logIndex)}))})}),transactionRequest:(0,ze.defineTransactionRequest)({exclude:["customSignature","factoryDeps","gasPerPubdata","paymaster","paymasterInput"],format:a=>a.gasPerPubdata||a.paymaster&&a.paymasterInput||a.factoryDeps||a.customSignature?{eip712Meta:{...a.gasPerPubdata?{gasPerPubdata:(0,fd.toHex)(a.gasPerPubdata)}:{gasPerPubdata:(0,fd.toHex)(50000n)},...a.paymaster&&a.paymasterInput?{paymasterParams:{paymaster:a.paymaster,paymasterInput:Array.from((0,zc.hexToBytes)(a.paymasterInput))}}:{},...a.factoryDeps?{factoryDeps:a.factoryDeps.map(a=>Array.from((0,zc.hexToBytes)(a)))}:{},...a.customSignature?{customSignature:Array.from((0,zc.hexToBytes)(a.customSignature))}:{}},type:"0x71"}:{}})};var zh=a.i(185228),zi=a.i(407907),zj=zh;class zk extends zj.BaseError{constructor(){super('Transaction is not an EIP712 transaction.\n\nTransaction must:\n  - include `type: "eip712"`\n  - include one of the following: `customSignature`, `paymaster`, `paymasterInput`, `gasPerPubdata`, `factoryDeps`',{name:"InvalidEip712TransactionError"})}}function zl(a){return"eip712"===a.type||"customSignature"in a&&!!a.customSignature||"paymaster"in a&&!!a.paymaster||"paymasterInput"in a&&!!a.paymasterInput||"gasPerPubdata"in a&&"bigint"==typeof a.gasPerPubdata||"factoryDeps"in a&&!!a.factoryDeps||!1}function zm(a){let{chainId:b,to:c,from:d,paymaster:e,paymasterInput:f}=a;if(!zl(a))throw new zk;if(!b||b<=0)throw new zi.InvalidChainIdError({chainId:b});if(c&&!(0,fe.isAddress)(c))throw new yX.InvalidAddressError({address:c});if(d&&!(0,fe.isAddress)(d))throw new yX.InvalidAddressError({address:d});if(e&&!(0,fe.isAddress)(e))throw new yX.InvalidAddressError({address:e});if(e&&!f)throw new zh.BaseError("`paymasterInput` must be provided when `paymaster` is defined");if(!e&&f)throw new zh.BaseError("`paymaster` must be provided when `paymasterInput` is defined")}var zn=a.i(695313),zo=a.i(485516),zp=zh;class zq extends zp.BaseError{constructor({givenLength:a,maxBytecodeSize:b}){super(`Bytecode cannot be longer than ${b} bytes. Given length: ${a}`,{name:"BytecodeLengthExceedsMaxSizeError"})}}class zr extends zp.BaseError{constructor({givenLengthInWords:a}){super(`Bytecode length in 32-byte words must be odd. Given length in words: ${a}`,{name:"BytecodeLengthInWordsMustBeOddError"})}}class zs extends zp.BaseError{constructor({givenLength:a}){super(`The bytecode length in bytes must be divisible by 32. Given length: ${a}`,{name:"BytecodeLengthMustBeDivisibleBy32Error"})}}function zt(a){let b=(0,zc.toBytes)(a);if(b.length%32!=0)throw new zs({givenLength:b.length});if(b.length>zf)throw new zq({givenLength:b.length,maxBytecodeSize:zf});let c=(0,zo.sha256)(b),d=(0,zc.toBytes)(c),e=b.length/32;if(e%2==0)throw new zr({givenLengthInWords:e});let f=(0,zc.toBytes)(e),g=(0,zn.pad)(f,{size:2}),h=new Uint8Array([1,0]);return d.set(h,0),d.set(g,2),d}let zu={blockTime:1e3,formatters:zg,serializers:{transaction:function(a,b){return zl(a)?function(a){let{chainId:b,gas:c,nonce:d,to:e,from:f,value:g,maxFeePerGas:h,maxPriorityFeePerGas:i,customSignature:j,factoryDeps:k,paymaster:l,paymasterInput:m,gasPerPubdata:n,data:o}=a;zm(a);let p=[d?(0,fd.toHex)(d):"0x",i?(0,fd.toHex)(i):"0x",h?(0,fd.toHex)(h):"0x",c?(0,fd.toHex)(c):"0x",e??"0x",g?(0,fd.toHex)(g):"0x",o??"0x",(0,fd.toHex)(b),(0,fd.toHex)(""),(0,fd.toHex)(""),(0,fd.toHex)(b),f??"0x",n?(0,fd.toHex)(n):(0,fd.toHex)(50000n),k??[],j??"0x",l&&m?[l,m]:[]];return(0,yY.concatHex)(["0x71",(0,yZ.toRlp)(p)])}(a):(0,y$.serializeTransaction)(a,b)}},custom:{getEip712Domain:a=>{zm(a);let b=function(a){let{gas:b,nonce:c,to:d,from:e,value:f,maxFeePerGas:g,maxPriorityFeePerGas:h,factoryDeps:i,paymaster:j,paymasterInput:k,gasPerPubdata:l,data:m}=a;return{txType:113n,from:BigInt(e),to:d?BigInt(d):0n,gasLimit:b??0n,gasPerPubdataByteLimit:l??50000n,maxFeePerGas:g??0n,maxPriorityFeePerGas:h??0n,paymaster:j?BigInt(j):0n,nonce:c?BigInt(c):0n,value:f??0n,data:m??"0x",factoryDeps:i?.map(a=>(0,fd.toHex)(zt(a)))??[],paymasterInput:k||"0x"}}(a);return{domain:{name:"zkSync",version:"2",chainId:a.chainId},types:{Transaction:[{name:"txType",type:"uint256"},{name:"from",type:"uint256"},{name:"to",type:"uint256"},{name:"gasLimit",type:"uint256"},{name:"gasPerPubdataByteLimit",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymaster",type:"uint256"},{name:"nonce",type:"uint256"},{name:"value",type:"uint256"},{name:"data",type:"bytes"},{name:"factoryDeps",type:"bytes32[]"},{name:"paymasterInput",type:"bytes"}]},primaryType:"Transaction",message:b}}}},zv=(0,y0.defineChain)({...zu,blockTime:200,id:2741,name:"Abstract",nativeCurrency:{decimals:18,name:"ETH",symbol:"ETH"},rpcUrls:{default:{http:["https://api.mainnet.abs.xyz"],webSocket:["wss://api.mainnet.abs.xyz/ws"]}},blockExplorers:{default:{name:"Etherscan",url:"https://abscan.org"},native:{name:"Abstract Explorer",url:"https://explorer.mainnet.abs.xyz"}},contracts:{multicall3:{address:"0xAa4De41dba0Ca5dCBb288b7cC6b708F3aaC759E7",blockCreated:5288},erc6492Verifier:{address:"0xfB688330379976DA81eB64Fe4BF50d7401763B9C",blockCreated:5263}}}),zw=(0,y0.defineChain)({...zu,blockTime:200,id:11124,name:"Abstract Testnet",nativeCurrency:{decimals:18,name:"ETH",symbol:"ETH"},rpcUrls:{default:{http:["https://api.testnet.abs.xyz"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.abscan.org"},native:{name:"Abstract Explorer",url:"https://explorer.testnet.abs.xyz"}},testnet:!0,contracts:{multicall3:{address:"0xF9cda624FBC7e059355ce98a31693d299FACd963",blockCreated:358349},erc6492Verifier:{address:"0xfB688330379976DA81eB64Fe4BF50d7401763B9C",blockCreated:431682}}}),zx=(0,y0.defineChain)({id:1514,name:"Story",nativeCurrency:{decimals:18,name:"IP Token",symbol:"IP"},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:340998},ensRegistry:{address:"0x5dc881dda4e4a8d312be3544ad13118d1a04cb17",blockCreated:648924},ensUniversalResolver:{address:"0xddfb18888a9466688235887dec2a10c4f5effee9",blockCreated:649114}},rpcUrls:{default:{http:["https://mainnet.storyrpc.io"]}},blockExplorers:{default:{name:"Story explorer",url:"https://storyscan.io",apiUrl:"https://storyscan.io/api/v2"}},ensTlds:[".ip"],testnet:!1}),zy=(0,y0.defineChain)({id:41923,name:"EDU Chain",nativeCurrency:{decimals:18,name:"EDU",symbol:"EDU"},rpcUrls:{default:{http:["https://rpc.edu-chain.raas.gelato.cloud"]}},blockExplorers:{default:{name:"EDU Chain Explorer",url:"https://educhain.blockscout.com/"}},testnet:!1});var zz=a.i(792288),zA=a.i(218135),zB=a.i(316486);async function zC({hash:a,privateKey:b,to:c="object"}){let{r:d,s:e,recovery:f}=zz.secp256k1.sign(a.slice(2),b.slice(2),{lowS:!0,extraEntropy:!!(0,fg.isHex)(!1,{strict:!1})&&(0,zc.hexToBytes)(!1)}),g={r:(0,fd.numberToHex)(d,{size:32}),s:(0,fd.numberToHex)(e,{size:32}),v:f?28n:27n,yParity:f};return"bytes"===c||"hex"===c?(0,zB.serializeSignature)({...g,to:c}):g}async function zD(a){let{chainId:b,nonce:c,privateKey:d,to:e="object"}=a,f=a.contractAddress??a.address,g=await zC({hash:(0,fh.hashAuthorization)({address:f,chainId:b,nonce:c}),privateKey:d,to:e});return"object"===e?{address:f,chainId:b,nonce:c,...g}:g}var zE=a.i(145419);async function zF({message:a,privateKey:b}){return await zC({hash:(0,zE.hashMessage)(a),privateKey:b,to:"hex"})}var zG=a.i(652868);async function zH(a){let{privateKey:b,transaction:c,serializer:d=y$.serializeTransaction}=a,e="eip4844"===c.type?{...c,sidecars:!1}:c,f=await zC({hash:(0,zG.keccak256)(await d(e)),privateKey:b});return await d(c,f)}var zI=a.i(408680);async function zJ(a){let{privateKey:b,...c}=a;return await zC({hash:(0,zI.hashTypedData)(c),privateKey:b,to:"hex"})}var zK=a.i(854723),zL=a.i(369765),zM=a.i(872694),zN=a.i(762029),zO=a.i(59854);let zP=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"accountAddress",type:"address"},{indexed:!1,internalType:"enum IContractDeployer.AccountNonceOrdering",name:"nonceOrdering",type:"uint8"}],name:"AccountNonceOrderingUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"accountAddress",type:"address"},{indexed:!1,internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"aaVersion",type:"uint8"}],name:"AccountVersionUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"deployerAddress",type:"address"},{indexed:!0,internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{indexed:!0,internalType:"address",name:"contractAddress",type:"address"}],name:"ContractDeployed",type:"event"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"create",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"create2",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"},{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_aaVersion",type:"uint8"}],name:"create2Account",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"},{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_aaVersion",type:"uint8"}],name:"createAccount",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"extendedAccountVersion",outputs:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"_keccak256BytecodeHash",type:"bytes32"}],name:"forceDeployKeccak256",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{internalType:"address",name:"newAddress",type:"address"},{internalType:"bool",name:"callConstructor",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"input",type:"bytes"}],internalType:"struct ContractDeployer.ForceDeployment",name:"_deployment",type:"tuple"},{internalType:"address",name:"_sender",type:"address"}],name:"forceDeployOnAddress",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{internalType:"address",name:"newAddress",type:"address"},{internalType:"bool",name:"callConstructor",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"input",type:"bytes"}],internalType:"struct ContractDeployer.ForceDeployment[]",name:"_deployments",type:"tuple[]"}],name:"forceDeployOnAddresses",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"getAccountInfo",outputs:[{components:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"supportedAAVersion",type:"uint8"},{internalType:"enum IContractDeployer.AccountNonceOrdering",name:"nonceOrdering",type:"uint8"}],internalType:"struct IContractDeployer.AccountInfo",name:"info",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_sender",type:"address"},{internalType:"uint256",name:"_senderNonce",type:"uint256"}],name:"getNewAddressCreate",outputs:[{internalType:"address",name:"newAddress",type:"address"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"_sender",type:"address"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"getNewAddressCreate2",outputs:[{internalType:"address",name:"newAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_version",type:"uint8"}],name:"updateAccountVersion",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"enum IContractDeployer.AccountNonceOrdering",name:"_nonceOrdering",type:"uint8"}],name:"updateNonceOrdering",outputs:[],stateMutability:"nonpayable",type:"function"}],zQ="/docs/contract/encodeDeployData";function zR(a,b,c,d){let e=[b,c,d];return({create:{functionName:"create",argsContractDeployer:e},create2:{functionName:"create2",argsContractDeployer:e},createAccount:{functionName:"createAccount",argsContractDeployer:[...e,1]},create2Account:{functionName:"create2Account",argsContractDeployer:[...e,1]}})[a||"create"]}var zS=a.i(134510),zT=a.i(600528),zU=a.i(366451),zV=a.i(158413),zW=a.i(770548),zX=a.i(88963),zY=a.i(197693),zZ=a.i(709987),z$=a.i(745914);function z_(a){if(!zl(a))throw new zk;(0,z$.assertRequest)(a)}var z0=a.i(843104),z1=a.i(622131);async function z2(a,b){let{account:c=a.account,chain:d=a.chain,...e}=b,f=c?(0,zS.parseAccount)(c):a.account;if(!f)throw new zW.AccountNotFoundError({docsPath:"/docs/actions/wallet/signTransaction"});if(z_({account:f,chain:d,...b}),!d?.custom?.getEip712Domain)throw new zh.BaseError("`getEip712Domain` not found on chain.");if(!d?.serializers?.transaction)throw new zh.BaseError("transaction serializer not found on chain.");let g=await (0,zZ.getAction)(a,zT.getChainId,"getChainId")({});null!==d&&(0,zX.assertCurrentChain)({currentChainId:g,chain:d});let h=d?.custom.getEip712Domain({...e,chainId:g,from:f.address,type:"eip712"}),i=await (0,z1.signTypedData)(a,{...h,account:f});return d?.serializers?.transaction({chainId:g,...e,customSignature:i,type:"eip712"},{r:"0x0",s:"0x0",v:0n})}async function z3(a,b){return zl(b)?z2(a,b):await (0,z0.signTransaction)(a,b)}async function z4(a,b){let{account:c=a.account,chain:d=a.chain}=b,e=c?(0,zS.parseAccount)(c):a.account;if(!e)throw new zW.AccountNotFoundError({docsPath:"/docs/actions/wallet/sendTransaction"});try{let c;z_(b);let f=await (0,zU.prepareTransactionRequest)(a,{...b,nonceManager:e.nonceManager,parameters:["gas","nonce","fees"]});null!==d&&(c=await (0,zZ.getAction)(a,zT.getChainId,"getChainId")({}),(0,zX.assertCurrentChain)({currentChainId:c,chain:d}));let g=await z3(a,{...f,chainId:c});return await (0,zZ.getAction)(a,zV.sendRawTransaction,"sendRawTransaction")({serializedTransaction:g})}catch(a){throw(0,zY.getTransactionError)(a,{...b,account:e,chain:d})}}var z5=a.i(567218);async function z6(a,b){return zl(b)?z4(a,b):(0,z5.sendTransaction)(a,b)}var z7=a.i(447213),z8=a.i(626961);function z9(a){return JSON.parse(function(a){let b=[],c=!1;for(let e=0;e<a.length;e++){let f=!1;if("\\"===a[e]&&(b.push(a[e++]),f=!f),'"'===a[e]){b.push(a[e]),f||(c=!c);continue}if(!c){let c=function(a,b){if(!a[b]?.match(/[-\d]/))return null;let c=a.slice(b).match(/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?/);return c?c[0]:null}(a,e);if(c?.length){var d;e+=c.length-1,c.match(/\.|[eE]-/)?b.push(c):b.push((d=c,`{"$n":"${d}"}`));continue}}b.push(a[e])}return b.join("")}(a),(a,b)=>{var c;return(c=b)&&"object"==typeof c&&"$n"in c&&"string"==typeof c.$n?function({$n:a}){if(a.match(/[eE]/)){let[b,c]=a.split(/[eE]/);return BigInt(b)*BigInt(10)**BigInt(c)}return BigInt(a)}(b):b})}var Aa=0n;function Ab(a){let b;return{id:(b=Aa,Aa++,b.toString()),jsonrpc:"2.0",method:a.methodName,params:a.params}}function Ac(a,b){return JSON.stringify(a,(a,b)=>{var c;return"bigint"==typeof b?(c=b,{$n:`${c}`}):b},b).replace(/\{\s*"\$n"\s*:\s*"(-?\d+)"\s*\}/g,"$1")}function Ad(a){return!(null==a||"object"!=typeof a||Array.isArray(a))&&"jsonrpc"in a&&"2.0"===a.jsonrpc&&"method"in a&&"string"==typeof a.method&&"params"in a}var Ae=a.i(29943);function Af(a){return"bigint"==typeof a?Number(a):a}var Ag={};function Ah(a){return function b(c,d){if(Array.isArray(c))return c.map((a,c)=>b(a,{...d,keyPath:[...d.keyPath,c]}));if("object"!=typeof c||null===c)return a.reduce((a,b)=>b(a,d),c);{let a={};for(let e in c){if(!Object.prototype.hasOwnProperty.call(c,e))continue;let f={...d,keyPath:[...d.keyPath,e]};a[e]=b(c[e],f)}return a}}}function Ai(a,b){return c=>{let d=Ah(a);return Object.freeze({...c,params:d(c.params,b)})}}var Aj={accountNotifications:1,blockNotifications:1,getAccountInfo:1,getBalance:1,getBlock:1,getBlockHeight:0,getBlockProduction:0,getBlocks:2,getBlocksWithLimit:2,getEpochInfo:0,getFeeForMessage:1,getInflationGovernor:0,getInflationReward:1,getLargestAccounts:0,getLatestBlockhash:0,getLeaderSchedule:1,getMinimumBalanceForRentExemption:1,getMultipleAccounts:1,getProgramAccounts:1,getSignaturesForAddress:1,getSlot:0,getSlotLeader:0,getStakeMinimumDelegation:0,getSupply:0,getTokenAccountBalance:1,getTokenAccountsByDelegate:2,getTokenAccountsByOwner:2,getTokenLargestAccounts:1,getTokenSupply:1,getTransaction:1,getTransactionCount:0,getVoteAccounts:0,isBlockhashValid:1,logsNotifications:1,programNotifications:1,requestAirdrop:2,sendTransaction:1,signatureNotifications:1,simulateTransaction:1};function Ak(a){let b=a?.onIntegerOverflow;return c=>(0,Ae.pipe)(c,b?a=>{var c;return Ai([(c=(...c)=>b(a,...c),(a,{keyPath:b})=>("bigint"==typeof a&&c&&(a>Number.MAX_SAFE_INTEGER||a<-Number.MAX_SAFE_INTEGER)&&c(b,a),a))],{keyPath:[]})(a)}:a=>a,Ai([Af],{keyPath:[]}),function({defaultCommitment:a,optionsObjectPositionByMethod:b}){return c=>{let{params:d,methodName:e}=c;if(!Array.isArray(d))return c;let f=b[e];return null==f?c:Object.freeze({methodName:e,params:function({commitmentPropertyName:a,params:b,optionsObjectPositionInParams:c,overrideCommitment:d}){let e=b[c];if(void 0===e||e&&"object"==typeof e&&!Array.isArray(e)){if(e&&a in e){if(!e[a]||"finalized"===e[a]){let d=[...b],{[a]:f,...g}=e;return Object.keys(g).length>0?d[c]=g:c===d.length-1?d.length--:d[c]=void 0,d}}else if("finalized"!==d){let f=[...b];return f[c]={...e,[a]:d},f}}return b}({commitmentPropertyName:"sendTransaction"===e?"preflightCommitment":"commitment",optionsObjectPositionInParams:f,overrideCommitment:a,params:d})})}}({defaultCommitment:a?.defaultCommitment,optionsObjectPositionByMethod:Aj}))}function Al(a){var b,c;return b=[function(b,{keyPath:c}){var d;return"number"==typeof b&&Number.isInteger(b)||"bigint"==typeof b?(d=c,a.some(a=>{if(a.length!==d.length)return!1;for(let b=d.length-1;b>=0;b--){let c=d[b],e=a[b];if(e!==c&&(e!==Ag||"number"!=typeof c))return!1}return!0}))?Number(b):BigInt(b):b}],c={keyPath:[]},a=>Ah(b)(a,c)}var Am=[["data","parsed","info","tokenAmount","decimals"],["data","parsed","info","tokenAmount","uiAmount"],["data","parsed","info","rentExemptReserve","decimals"],["data","parsed","info","rentExemptReserve","uiAmount"],["data","parsed","info","delegatedAmount","decimals"],["data","parsed","info","delegatedAmount","uiAmount"],["data","parsed","info","extensions",Ag,"state","olderTransferFee","transferFeeBasisPoints"],["data","parsed","info","extensions",Ag,"state","newerTransferFee","transferFeeBasisPoints"],["data","parsed","info","extensions",Ag,"state","preUpdateAverageRate"],["data","parsed","info","extensions",Ag,"state","currentRate"]],An=[...Am,["data","parsed","info","lastExtendedSlotStartIndex"],["data","parsed","info","slashPenalty"],["data","parsed","info","warmupCooldownRate"],["data","parsed","info","decimals"],["data","parsed","info","numRequiredSigners"],["data","parsed","info","numValidSigners"],["data","parsed","info","stake","delegation","warmupCooldownRate"],["data","parsed","info","exemptionThreshold"],["data","parsed","info","burnPercent"],["data","parsed","info","commission"],["data","parsed","info","votes",Ag,"confirmationCount"]],Ao=[["index"],["instructions",Ag,"accounts",Ag],["instructions",Ag,"programIdIndex"],["instructions",Ag,"stackHeight"]],Ap=[["addressTableLookups",Ag,"writableIndexes",Ag],["addressTableLookups",Ag,"readonlyIndexes",Ag],["header","numReadonlySignedAccounts"],["header","numReadonlyUnsignedAccounts"],["header","numRequiredSignatures"],["instructions",Ag,"accounts",Ag],["instructions",Ag,"programIdIndex"],["instructions",Ag,"stackHeight"]],Aq=["getAccountInfo","getBalance","getBlock","getBlockCommitment","getBlockHeight","getBlockProduction","getBlocks","getBlocksWithLimit","getBlockTime","getClusterNodes","getEpochInfo","getEpochSchedule","getFeeForMessage","getFirstAvailableBlock","getGenesisHash","getHealth","getHighestSnapshotSlot","getIdentity","getInflationGovernor","getInflationRate","getInflationReward","getLargestAccounts","getLatestBlockhash","getLeaderSchedule","getMaxRetransmitSlot","getMaxShredInsertSlot","getMinimumBalanceForRentExemption","getMultipleAccounts","getProgramAccounts","getRecentPerformanceSamples","getRecentPrioritizationFees","getSignaturesForAddress","getSignatureStatuses","getSlot","getSlotLeader","getSlotLeaders","getStakeMinimumDelegation","getSupply","getTokenAccountBalance","getTokenAccountsByDelegate","getTokenAccountsByOwner","getTokenLargestAccounts","getTokenSupply","getTransaction","getTransactionCount","getVersion","getVoteAccounts","index","isBlockhashValid","minimumLedgerSlot","requestAirdrop","sendTransaction","simulateTransaction"];function Ar(a){return Ad(a)&&Aq.includes(a.method)}var As=Object.prototype.toString,At=Object.keys||function(a){let b=[];for(let c in a)b.push(c);return b};function Au(a){let b=function a(b,c){let d,e,f,g,h,i,j;if(!0===b)return"true";if(!1===b)return"false";switch(typeof b){case"object":if(null===b)return null;if("toJSON"in b&&"function"==typeof b.toJSON)return a(b.toJSON(),c);if("[object Array]"===(j=As.call(b))){for(d=0,f="[",e=b.length-1;d<e;d++)f+=a(b[d],!0)+",";return e>-1&&(f+=a(b[d],!0)),f+"]"}if("[object Object]"!==j)return JSON.stringify(b);for(e=(g=At(b).sort()).length,f="",d=0;d<e;)void 0!==(i=a(b[h=g[d]],!1))&&(f&&(f+=","),f+=JSON.stringify(h)+":"+i),d++;return"{"+f+"}";case"function":case"undefined":return c?null:void 0;case"bigint":return`${b.toString()}n`;case"string":return JSON.stringify(b);default:return isFinite(b)?b:null}}(a,!1);if(void 0!==b)return""+b}var Av={defaultCommitment:"confirmed",onIntegerOverflow(a,b,c){throw function a(b,c,d){let e="";if("number"==typeof c[0]){let a=c[0]+1,b=a%10,d=a%100;e=1==b&&11!=d?a+"st":2==b&&12!=d?a+"nd":3==b&&13!=d?a+"rd":a+"th"}else e=`\`${c[0].toString()}\``;let f=c.length>1?c.slice(1).map(a=>"number"==typeof a?`[${a}]`:a).join("."):void 0,g=new z8.SolanaError(z8.SOLANA_ERROR__RPC__INTEGER_OVERFLOW,{argumentLabel:e,keyPath:c,methodName:b,optionalPathLabel:f?` at path \`${f}\``:"",value:d,...void 0!==f?{path:f}:void 0});return(0,z8.safeCaptureStackTrace)(g,a),g}(a.methodName,b,c)}},Aw=class extends globalThis.AbortController{constructor(...a){super(...a),(0,cf.setMaxListeners)(Number.MAX_SAFE_INTEGER,this.signal)}};function Ax(a){return Ad(a)?Au([a.method,a.params]):void 0}function Ay(a,b){var c,d,e,f,g;return d=(c={url:a,...b},(0,Ae.pipe)(function(a){let b,{fromJson:c,headers:d,toJson:e,url:f}=a;"dispatcher_NODE_ONLY"in a&&(b={dispatcher:a.dispatcher_NODE_ONLY});let g=d&&function(a){let b={};for(let c in a)b[c.toLowerCase()]=a[c];return b}(d);return async function({payload:a,signal:d}){let h=e?e(a):JSON.stringify(a),i={...b,body:h,headers:{...g,accept:"application/json","content-length":h.length.toString(),"content-type":"application/json; charset=utf-8"},method:"POST",signal:d},j=await fetch(f,i);if(!j.ok)throw new z8.SolanaError(z8.SOLANA_ERROR__RPC__TRANSPORT_HTTP_ERROR,{headers:j.headers,message:j.statusText,statusCode:j.status});return c?c(await j.text(),a):await j.json()}}({...{...c,headers:{"accept-encoding":"br,gzip,deflate",...c.headers?function(a){let b={};for(let c in a)b[c.toLowerCase()]=a[c];return b}(c.headers):void 0,"solana-client":"js/5.1.0"}},fromJson:(a,b)=>Ar(b)?z9(a):JSON.parse(a),toJson:a=>Ar(a)?Ac(a):JSON.stringify(a)}),a=>{let b;return async function(c){let{payload:d,signal:e}=c,f=Ax(d);if(void 0===f)return await a(c);if(b||(queueMicrotask(()=>{b=void 0}),b={}),null==b[f]){let d=new Aw,e=(async()=>{try{return await a({...c,signal:d.signal})}catch(a){if(a===(Ea||={}))return;throw a}})();b[f]={abortController:d,numConsumers:0,responsePromise:e}}let g=b[f];if(g.numConsumers++,!e)return await g.responsePromise;{let a=g.responsePromise;return await new Promise((b,c)=>{let d=a=>{e.removeEventListener("abort",d),g.numConsumers-=1,queueMicrotask(()=>{0===g.numConsumers&&g.abortController.abort(Ea||={})}),c(a.target.reason)};e.addEventListener("abort",d),a.then(b).catch(c).finally(()=>{e.removeEventListener("abort",d)})})}}})),g={api:(f={requestTransformer:Ak(Av),responseTransformer:(e={allowedNumericKeyPaths:(D9||(D9={getAccountInfo:An.map(a=>["value",...a]),getBlock:[["transactions",Ag,"meta","preTokenBalances",Ag,"accountIndex"],["transactions",Ag,"meta","preTokenBalances",Ag,"uiTokenAmount","decimals"],["transactions",Ag,"meta","postTokenBalances",Ag,"accountIndex"],["transactions",Ag,"meta","postTokenBalances",Ag,"uiTokenAmount","decimals"],["transactions",Ag,"meta","rewards",Ag,"commission"],...Ao.map(a=>["transactions",Ag,"meta","innerInstructions",Ag,...a]),...Ap.map(a=>["transactions",Ag,"transaction","message",...a]),["rewards",Ag,"commission"]],getClusterNodes:[[Ag,"featureSet"],[Ag,"shredVersion"]],getInflationGovernor:[["initial"],["foundation"],["foundationTerm"],["taper"],["terminal"]],getInflationRate:[["foundation"],["total"],["validator"]],getInflationReward:[[Ag,"commission"]],getMultipleAccounts:An.map(a=>["value",Ag,...a]),getProgramAccounts:An.flatMap(a=>[["value",Ag,"account",...a],[Ag,"account",...a]]),getRecentPerformanceSamples:[[Ag,"samplePeriodSecs"]],getTokenAccountBalance:[["value","decimals"],["value","uiAmount"]],getTokenAccountsByDelegate:Am.map(a=>["value",Ag,"account",...a]),getTokenAccountsByOwner:Am.map(a=>["value",Ag,"account",...a]),getTokenLargestAccounts:[["value",Ag,"decimals"],["value",Ag,"uiAmount"]],getTokenSupply:[["value","decimals"],["value","uiAmount"]],getTransaction:[["meta","preTokenBalances",Ag,"accountIndex"],["meta","preTokenBalances",Ag,"uiTokenAmount","decimals"],["meta","postTokenBalances",Ag,"accountIndex"],["meta","postTokenBalances",Ag,"uiTokenAmount","decimals"],["meta","rewards",Ag,"commission"],...Ao.map(a=>["meta","innerInstructions",Ag,...a]),...Ap.map(a=>["transaction","message",...a])],getVersion:[["feature-set"]],getVoteAccounts:[["current",Ag,"commission"],["delinquent",Ag,"commission"]],simulateTransaction:[["value","loadedAccountsDataSize"],...An.map(a=>["value","accounts",Ag,...a]),...Ao.map(a=>["value","innerInstructions",Ag,...a])]}),D9)},(a,b)=>{let c=b.methodName,d=e?.allowedNumericKeyPaths&&c?e.allowedNumericKeyPaths[c]:void 0;return(0,Ae.pipe)(a,a=>(a=>{if("error"in a)throw(0,z8.getSolanaErrorFromJsonRpcError)(a.error);return a})(a,b),a=>a.result,a=>Al(d??[])(a,b))})},new Proxy({},{defineProperty:()=>!1,deleteProperty:()=>!1,get(...a){let[b,c]=a,d=c.toString();return function(...a){let b=Object.freeze({methodName:d,params:a}),c=f?.requestTransformer?f?.requestTransformer(b):b;return Object.freeze({execute:async({signal:a,transport:b})=>{let d=Ab(c),e=await b({payload:d,signal:a});return f?.responseTransformer?f.responseTransformer(e,c):e}})}}})),transport:d},new Proxy(g.api,{defineProperty:()=>!1,deleteProperty:()=>!1,get(a,b,c){if("then"!==b)return function(...d){let e=b.toString(),f=Reflect.get(a,e,c);if(!f)throw new z8.SolanaError(z8.SOLANA_ERROR__RPC__API_PLAN_MISSING_FOR_RPC_METHOD,{method:e,params:d});return function({transport:a},b){return{send:async c=>await b.execute({signal:c?.abortSignal,transport:a})}}(g,f(...d))}}})}var Az=a.i(849470),AA=class extends globalThis.AbortController{constructor(...a){super(...a),(0,cf.setMaxListeners)(Number.MAX_SAFE_INTEGER,this.signal)}},AB=class extends globalThis.EventTarget{constructor(...a){super(...a),(0,cf.setMaxListeners)(Number.MAX_SAFE_INTEGER,this)}};function AC(){return Symbol(void 0)}var AD=Symbol();function AE(a){return{on(b,c,d){function e(a){a instanceof CustomEvent?c(a.detail):c()}return a.addEventListener(b,e,d),()=>{a.removeEventListener(b,e)}}}}var AF=a.i(963001),AG=class extends globalThis.AbortController{constructor(...a){super(...a),(0,cf.setMaxListeners)(Number.MAX_SAFE_INTEGER,this.signal)}},AH=new WeakMap;function AI(a,b,c){let d;if(void 0===c)return;let e=((d=AH.get(b))||AH.set(b,d={}),d);!e[c]&&a>0&&(e[c]=0);let f=a+e[c];return f<=0?delete e[c]:e[c]=f,f}var AJ=new WeakMap;async function AK({channel:a,responseTransformer:b,signal:c,subscribeRequest:d,unsubscribeMethodName:e}){var f;let g,h,i,j,k,l,m;a.on("error",()=>{g=void 0,AH.delete(a)},{signal:c});let n=new Promise((b,d)=>{function f(){if(0===AI(-1,a,g)){let b=Ab({methodName:e,params:[g]});g=void 0,a.send(b).catch(()=>{})}d(this.reason)}c.aborted?f.call(c):c.addEventListener("abort",f)}),o=Ab(d);await a.send(o);let p=new Promise((b,d)=>{let e=new AG;c.addEventListener("abort",e.abort.bind(e));let f={signal:e.signal};a.on("error",a=>{e.abort(),d(a)},f),a.on("message",a=>{a&&"object"==typeof a&&"id"in a&&a.id===o.id&&(e.abort(),"error"in a?d((0,z8.getSolanaErrorFromJsonRpcError)(a.error)):b(a.result))},f)});if(null==(g=await (0,AF.safeRace)([n,p])))throw new z8.SolanaError(z8.SOLANA_ERROR__RPC_SUBSCRIPTIONS__EXPECTED_SERVER_SUBSCRIPTION_ID);AI(1,a,g);let q=((h=AJ.get(a))||AJ.set(a,h=new WeakMap),i=b??a,(j=h.get(i))||h.set(i,(f=a=>{if(!("method"in a))return;let c=b?b(a.params.result,d):a.params.result;return[`notification:${a.params.subscription}`,c]},j={...m=AE(l=new AB),on(b,c,d){k||(k={dispose:a.on("message",a=>{let b=f(a);if(!b)return;let[c,d]=b;l.dispatchEvent(new CustomEvent(c,{detail:d}))}),numSubscribers:0}),k.numSubscribers++;let e=m.on(b,c,d),g=!0;function h(){g&&(g=!1,d?.signal.removeEventListener("abort",h),k.numSubscribers--,0===k.numSubscribers&&(k.dispose(),k=void 0),e())}return d?.signal.addEventListener("abort",h),h}})),j),r=`notification:${g}`;return{on(b,c,d){switch(b){case"notification":return q.on(r,c,d);case"error":return a.on("error",c,d);default:throw new z8.SolanaError(z8.SOLANA_ERROR__INVARIANT_VIOLATION__DATA_PUBLISHER_CHANNEL_UNIMPLEMENTED,{channelName:b,supportedChannelNames:["notification","error"]})}}}}var AL=a.i(206360),AM=class extends globalThis.EventTarget{constructor(...a){super(...a),(0,cf.setMaxListeners)(Number.MAX_SAFE_INTEGER,this)}},AN=globalThis.WebSocket?globalThis.WebSocket:AL.default,AO={defaultCommitment:"confirmed",onIntegerOverflow(a,b,c){throw function a(b,c,d){let e="";if("number"==typeof c[0]){let a=c[0]+1,b=a%10,d=a%100;e=1==b&&11!=d?a+"st":2==b&&12!=d?a+"nd":3==b&&13!=d?a+"rd":a+"th"}else e=`\`${c[0].toString()}\``;let f=c.length>1?c.slice(1).map(a=>"number"==typeof a?`[${a}]`:a).join("."):void 0,g=new z8.SolanaError(z8.SOLANA_ERROR__RPC__INTEGER_OVERFLOW,{argumentLabel:e,keyPath:c,methodName:b,optionalPathLabel:f?` at path \`${f}\``:"",value:d,...void 0!==f?{path:f}:void 0});return(0,z8.safeCaptureStackTrace)(g,a),g}(a.methodName,b,c)}},AP=class extends globalThis.AbortController{constructor(...a){super(...a),(0,cf.setMaxListeners)(Number.MAX_SAFE_INTEGER,this.signal)}},AQ={jsonrpc:"2.0",method:"ping"};function AR(a){return(0,Ae.pipe)(a,a=>Object.freeze({...a,on:(b,c,d)=>"message"!==b?a.on(b,c,d):a.on("message",a=>c(z9(a)),d)}),a=>Object.freeze({...a,send:b=>a.send(Ac(b))}))}function AS(a,b){var c,d,e,f;let g,h;return c=function({createChannel:a}){var b;return(0,Ae.pipe)((b=a,async({execute:a,signal:c})=>{let d=await b({abortSignal:c});return await a({channel:d,signal:c})}),a=>{let b;return b=new Map,function(c){let{request:d,signal:e}=c,f=Au([d.methodName,d.params]),g=b.get(f);if(!g){let d=new AP,e=a({...c,signal:d.signal});e.then(a=>{a.on("error",()=>{b.delete(f),d.abort()},{signal:d.signal})}).catch(()=>{}),b.set(f,g={abortController:d,dataPublisherPromise:e,numSubscribers:0})}return g.numSubscribers++,e.addEventListener("abort",()=>{g.numSubscribers--,0===g.numSubscribers&&queueMicrotask(()=>{0===g.numSubscribers&&(b.delete(f),g.abortController.abort())})},{signal:g.abortController.signal}),g.dataPublisherPromise}})}({createChannel:function(a){if(!1===/^wss?:/i.test(a.url)){let b=a.url.match(/^([^:]+):/);throw new DOMException(b?`Failed to construct 'WebSocket': The URL's scheme must be either 'ws' or 'wss'. '${b[1]}:' is not allowed.`:`Failed to construct 'WebSocket': The URL '${a.url}' is invalid.`)}let{intervalMs:b,...c}=a;return function(a,{maxSubscriptionsPerChannel:b,minChannels:c}){let d={entries:[],freeChannelIndex:-1};function e(){let a;if(d.entries.length<c){d.freeChannelIndex=-1;return}for(let c=0;c<d.entries.length;c++){let e=(d.freeChannelIndex+c+2)%d.entries.length,f=d.entries[e];f.subscriptionCount<b&&(!a||a.subscriptionCount>=f.subscriptionCount)&&(a={poolIndex:e,subscriptionCount:f.subscriptionCount})}d.freeChannelIndex=a?.poolIndex??-1}return function({abortSignal:b}){let c;function f(){let a=d.entries.findIndex(a=>a===c);d.entries.splice(a,1),c.dispose(),e()}if(-1===d.freeChannelIndex){let b=new AP,e=a({abortSignal:b.signal});e.then(a=>{a.on("error",f,{signal:b.signal})}).catch(f),c={channel:e,dispose(){b.abort()},subscriptionCount:0},d.entries.push(c)}else c=d.entries[d.freeChannelIndex];return c.subscriptionCount++,b.addEventListener("abort",function(){c.subscriptionCount--,0===c.subscriptionCount?f():-1!==d.freeChannelIndex&&(d.freeChannelIndex--,e())}),e(),c.channel}}(({abortSignal:d})=>(function({sendBufferHighWatermark:a,signal:b,url:c}){let d,e,f;if(b.aborted)return Promise.reject(b.reason);let g=!1,h=new Set;function i(){h.forEach(a=>{a()}),h.clear()}function j(){i(),g||e(b.reason),p.readyState!==AN.CLOSED&&p.readyState!==AN.CLOSING&&p.close(1e3)}function k(a){if(!b.aborted&&!g){let b=new z8.SolanaError(z8.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_FAILED_TO_CONNECT,{errorEvent:a});e(b),m.dispatchEvent(new CustomEvent("error",{detail:b}))}}function l(a){b.aborted||m.dispatchEvent(new CustomEvent("message",{detail:a.data}))}let m=new AM,n=AE(m);function o(){g=!0,f({...n,async send(b){if(p.readyState!==AN.OPEN)throw new z8.SolanaError(z8.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CONNECTION_CLOSED);if(!d&&p.bufferedAmount>a){let b,c=new Promise((c,e)=>{let f=setInterval(()=>{p.readyState===AN.OPEN&&p.bufferedAmount>a||(clearInterval(f),d=void 0,c())},16);b=()=>{d=void 0,clearInterval(f),e(new z8.SolanaError(z8.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CLOSED_BEFORE_MESSAGE_BUFFERED))}});d={onCancel:b,promise:c}}d&&(!ArrayBuffer.isView(b)||b instanceof DataView||(b=new b.constructor(b)),await d.promise),p.send(b)}})}let p=new AN(c);return b.addEventListener("abort",j),p.addEventListener("close",function a(c){i(),d?.onCancel(),b.removeEventListener("abort",j),p.removeEventListener("close",a),p.removeEventListener("error",k),p.removeEventListener("message",l),p.removeEventListener("open",o),b.aborted||c.wasClean&&1e3===c.code||m.dispatchEvent(new CustomEvent("error",{detail:new z8.SolanaError(z8.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CONNECTION_CLOSED,{cause:c})}))}),p.addEventListener("error",k),p.addEventListener("message",l),p.addEventListener("open",o),new Promise((a,b)=>{e=b,f=a})})({...c,sendBufferHighWatermark:a.sendBufferHighWatermark??131072,signal:d}).then(a.jsonSerializer).then(a=>(function({abortSignal:a,channel:b,intervalMs:c}){let d;function e(){b.send(AQ).catch(a=>{(0,z8.isSolanaError)(a,z8.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CONNECTION_CLOSED)&&g.abort()})}function f(){clearInterval(d),d=setInterval(e,c)}let g=new AP;return g.signal.addEventListener("abort",()=>{clearInterval(d)}),a.addEventListener("abort",()=>{g.abort()}),b.on("error",()=>{g.abort()},{signal:g.signal}),b.on("message",f,{signal:g.signal}),f(),{...b,send:(...a)=>(g.signal.aborted||f(),b.send(...a))}})({abortSignal:d,channel:a,intervalMs:b??5e3})),{maxSubscriptionsPerChannel:a.maxSubscriptionsPerChannel??100,minChannels:a.minChannels??1})}({...b,url:a,jsonSerializer:AR})}),d={api:(g=Ak(AO),e={allowedNumericKeyPaths:(Ec||(Ec={accountNotifications:An.map(a=>["value",...a]),blockNotifications:[["value","block","transactions",Ag,"meta","preTokenBalances",Ag,"accountIndex"],["value","block","transactions",Ag,"meta","preTokenBalances",Ag,"uiTokenAmount","decimals"],["value","block","transactions",Ag,"meta","postTokenBalances",Ag,"accountIndex"],["value","block","transactions",Ag,"meta","postTokenBalances",Ag,"uiTokenAmount","decimals"],["value","block","transactions",Ag,"meta","rewards",Ag,"commission"],["value","block","transactions",Ag,"meta","innerInstructions",Ag,"index"],["value","block","transactions",Ag,"meta","innerInstructions",Ag,"instructions",Ag,"programIdIndex"],["value","block","transactions",Ag,"meta","innerInstructions",Ag,"instructions",Ag,"accounts",Ag],["value","block","transactions",Ag,"transaction","message","addressTableLookups",Ag,"writableIndexes",Ag],["value","block","transactions",Ag,"transaction","message","addressTableLookups",Ag,"readonlyIndexes",Ag],["value","block","transactions",Ag,"transaction","message","instructions",Ag,"programIdIndex"],["value","block","transactions",Ag,"transaction","message","instructions",Ag,"accounts",Ag],["value","block","transactions",Ag,"transaction","message","header","numReadonlySignedAccounts"],["value","block","transactions",Ag,"transaction","message","header","numReadonlyUnsignedAccounts"],["value","block","transactions",Ag,"transaction","message","header","numRequiredSignatures"],["value","block","rewards",Ag,"commission"]],programNotifications:An.flatMap(a=>[["value",Ag,"account",...a],[Ag,"account",...a]])}),Ec)},h=(a,b)=>{let c=b.methodName,d=e?.allowedNumericKeyPaths&&c?e.allowedNumericKeyPaths[c]:void 0;return(0,Ae.pipe)(a,a=>Al(d??[])(a,b))},f={planExecutor:({request:a,...b})=>AK({...b,responseTransformer:h,subscribeRequest:{...a,methodName:a.methodName.replace(/Notifications$/,"Subscribe")},unsubscribeMethodName:a.methodName.replace(/Notifications$/,"Unsubscribe")}),requestTransformer:g},new Proxy({},{defineProperty:()=>!1,deleteProperty:()=>!1,get(...a){let[b,c]=a,d=c.toString();return function(...a){let b={methodName:d,params:a},c=f.requestTransformer?f.requestTransformer(b):b;return{execute:a=>f.planExecutor({...a,request:c}),request:c}}}})),transport:c},new Proxy(d.api,{defineProperty:()=>!1,deleteProperty:()=>!1,get(a,b,c){if("then"!==b)return function(...e){var f,g;let h=b.toString(),i=Reflect.get(a,h,c);if(!i)throw new z8.SolanaError(z8.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CANNOT_CREATE_SUBSCRIPTION_PLAN,{notificationName:h});let j=i(...e);return f=d.transport,g=j,{async subscribe({abortSignal:a}){let b=await f({signal:a,...g});return function({abortSignal:a,dataChannelName:b,dataPublisher:c,errorChannelName:d}){let e=new Map;function f(a){for(let[b,c]of e.entries())c.__hasPolled?(e.delete(b),c.onError(a)):c.publishQueue.push({__type:1,err:a})}let g=new AA;a.addEventListener("abort",()=>{g.abort(),f(Eb||=AC())});let h={signal:g.signal},i=AD;return c.on(d,a=>{i===AD&&(i=a,g.abort(),f(a))},h),c.on(b,a=>{e.forEach((b,c)=>{if(b.__hasPolled){let{onData:d}=b;e.set(c,{__hasPolled:!1,publishQueue:[]}),d(a)}else b.publishQueue.push({__type:0,data:a})})},h),{async *[Symbol.asyncIterator](){if(a.aborted)return;if(i!==AD)throw i;let b=Symbol();e.set(b,{__hasPolled:!1,publishQueue:[]});try{for(;;){let a=e.get(b);if(!a)throw new z8.SolanaError(z8.SOLANA_ERROR__INVARIANT_VIOLATION__SUBSCRIPTION_ITERATOR_STATE_MISSING);if(a.__hasPolled)throw new z8.SolanaError(z8.SOLANA_ERROR__INVARIANT_VIOLATION__SUBSCRIPTION_ITERATOR_MUST_NOT_POLL_BEFORE_RESOLVING_EXISTING_MESSAGE_PROMISE);let c=a.publishQueue;try{if(c.length)for(let b of(a.publishQueue=[],c))if(0===b.__type)yield b.data;else throw b.err;else yield await new Promise((a,c)=>{e.set(b,{__hasPolled:!0,onData:a,onError:c})})}catch(a){if(a===(Eb||=AC()))return;throw a}}}finally{e.delete(b)}}}}({abortSignal:a,dataChannelName:"notification",dataPublisher:b,errorChannelName:"error"})}}}}})}var AT=a.i(168617),AU=a.i(527394),AV=a.i(587437),AW=a.i(895769);a.i(84235),a.i(941342),a.i(683402),a.i(727229),a.i(433289),a.i(847675),a.i(278475),a.i(865177);var AX=((DV=AX||{})[DV.Uninitialized=0]="Uninitialized",DV[DV.Initialized=1]="Initialized",DV[DV.Frozen=2]="Frozen",DV),AY=((DW=AY||{})[DW.MintTokens=0]="MintTokens",DW[DW.FreezeAccount=1]="FreezeAccount",DW[DW.AccountOwner=2]="AccountOwner",DW[DW.CloseAccount=3]="CloseAccount",DW[DW.TransferFeeConfig=4]="TransferFeeConfig",DW[DW.WithheldWithdraw=5]="WithheldWithdraw",DW[DW.CloseMint=6]="CloseMint",DW[DW.InterestRate=7]="InterestRate",DW[DW.PermanentDelegate=8]="PermanentDelegate",DW[DW.ConfidentialTransferMint=9]="ConfidentialTransferMint",DW[DW.TransferHookProgramId=10]="TransferHookProgramId",DW[DW.ConfidentialTransferFeeConfig=11]="ConfidentialTransferFeeConfig",DW[DW.MetadataPointer=12]="MetadataPointer",DW[DW.GroupPointer=13]="GroupPointer",DW[DW.GroupMemberPointer=14]="GroupMemberPointer",DW[DW.ScaledUiAmount=15]="ScaledUiAmount",DW[DW.Pause=16]="Pause",DW),AZ=((DX=AZ||{})[DX.Uninitialized=0]="Uninitialized",DX[DX.TransferFeeConfig=1]="TransferFeeConfig",DX[DX.TransferFeeAmount=2]="TransferFeeAmount",DX[DX.MintCloseAuthority=3]="MintCloseAuthority",DX[DX.ConfidentialTransferMint=4]="ConfidentialTransferMint",DX[DX.ConfidentialTransferAccount=5]="ConfidentialTransferAccount",DX[DX.DefaultAccountState=6]="DefaultAccountState",DX[DX.ImmutableOwner=7]="ImmutableOwner",DX[DX.MemoTransfer=8]="MemoTransfer",DX[DX.NonTransferable=9]="NonTransferable",DX[DX.InterestBearingConfig=10]="InterestBearingConfig",DX[DX.CpiGuard=11]="CpiGuard",DX[DX.PermanentDelegate=12]="PermanentDelegate",DX[DX.NonTransferableAccount=13]="NonTransferableAccount",DX[DX.TransferHook=14]="TransferHook",DX[DX.TransferHookAccount=15]="TransferHookAccount",DX[DX.ConfidentialTransferFee=16]="ConfidentialTransferFee",DX[DX.ConfidentialTransferFeeAmount=17]="ConfidentialTransferFeeAmount",DX[DX.ScaledUiAmountConfig=18]="ScaledUiAmountConfig",DX[DX.PausableConfig=19]="PausableConfig",DX[DX.PausableAccount=20]="PausableAccount",DX[DX.MetadataPointer=21]="MetadataPointer",DX[DX.TokenMetadata=22]="TokenMetadata",DX[DX.GroupPointer=23]="GroupPointer",DX[DX.TokenGroup=24]="TokenGroup",DX[DX.GroupMemberPointer=25]="GroupMemberPointer",DX[DX.TokenGroupMember=26]="TokenGroupMember",DX),A$=((DY=A$||{})[DY.CreateAssociatedToken=0]="CreateAssociatedToken",DY[DY.CreateAssociatedTokenIdempotent=1]="CreateAssociatedTokenIdempotent",DY[DY.RecoverNestedAssociatedToken=2]="RecoverNestedAssociatedToken",DY),A_=((DZ=A_||{})[DZ.Mint=0]="Mint",DZ[DZ.Token=1]="Token",DZ[DZ.Multisig=2]="Multisig",DZ),A0=((D$=A0||{})[D$.InitializeMint=0]="InitializeMint",D$[D$.InitializeAccount=1]="InitializeAccount",D$[D$.InitializeMultisig=2]="InitializeMultisig",D$[D$.Transfer=3]="Transfer",D$[D$.Approve=4]="Approve",D$[D$.Revoke=5]="Revoke",D$[D$.SetAuthority=6]="SetAuthority",D$[D$.MintTo=7]="MintTo",D$[D$.Burn=8]="Burn",D$[D$.CloseAccount=9]="CloseAccount",D$[D$.FreezeAccount=10]="FreezeAccount",D$[D$.ThawAccount=11]="ThawAccount",D$[D$.TransferChecked=12]="TransferChecked",D$[D$.ApproveChecked=13]="ApproveChecked",D$[D$.MintToChecked=14]="MintToChecked",D$[D$.BurnChecked=15]="BurnChecked",D$[D$.InitializeAccount2=16]="InitializeAccount2",D$[D$.SyncNative=17]="SyncNative",D$[D$.InitializeAccount3=18]="InitializeAccount3",D$[D$.InitializeMultisig2=19]="InitializeMultisig2",D$[D$.InitializeMint2=20]="InitializeMint2",D$[D$.GetAccountDataSize=21]="GetAccountDataSize",D$[D$.InitializeImmutableOwner=22]="InitializeImmutableOwner",D$[D$.AmountToUiAmount=23]="AmountToUiAmount",D$[D$.UiAmountToAmount=24]="UiAmountToAmount",D$[D$.InitializeMintCloseAuthority=25]="InitializeMintCloseAuthority",D$[D$.InitializeTransferFeeConfig=26]="InitializeTransferFeeConfig",D$[D$.TransferCheckedWithFee=27]="TransferCheckedWithFee",D$[D$.WithdrawWithheldTokensFromMint=28]="WithdrawWithheldTokensFromMint",D$[D$.WithdrawWithheldTokensFromAccounts=29]="WithdrawWithheldTokensFromAccounts",D$[D$.HarvestWithheldTokensToMint=30]="HarvestWithheldTokensToMint",D$[D$.SetTransferFee=31]="SetTransferFee",D$[D$.InitializeConfidentialTransferMint=32]="InitializeConfidentialTransferMint",D$[D$.UpdateConfidentialTransferMint=33]="UpdateConfidentialTransferMint",D$[D$.ConfigureConfidentialTransferAccount=34]="ConfigureConfidentialTransferAccount",D$[D$.ApproveConfidentialTransferAccount=35]="ApproveConfidentialTransferAccount",D$[D$.EmptyConfidentialTransferAccount=36]="EmptyConfidentialTransferAccount",D$[D$.ConfidentialDeposit=37]="ConfidentialDeposit",D$[D$.ConfidentialWithdraw=38]="ConfidentialWithdraw",D$[D$.ConfidentialTransfer=39]="ConfidentialTransfer",D$[D$.ApplyConfidentialPendingBalance=40]="ApplyConfidentialPendingBalance",D$[D$.EnableConfidentialCredits=41]="EnableConfidentialCredits",D$[D$.DisableConfidentialCredits=42]="DisableConfidentialCredits",D$[D$.EnableNonConfidentialCredits=43]="EnableNonConfidentialCredits",D$[D$.DisableNonConfidentialCredits=44]="DisableNonConfidentialCredits",D$[D$.ConfidentialTransferWithFee=45]="ConfidentialTransferWithFee",D$[D$.InitializeDefaultAccountState=46]="InitializeDefaultAccountState",D$[D$.UpdateDefaultAccountState=47]="UpdateDefaultAccountState",D$[D$.Reallocate=48]="Reallocate",D$[D$.EnableMemoTransfers=49]="EnableMemoTransfers",D$[D$.DisableMemoTransfers=50]="DisableMemoTransfers",D$[D$.CreateNativeMint=51]="CreateNativeMint",D$[D$.InitializeNonTransferableMint=52]="InitializeNonTransferableMint",D$[D$.InitializeInterestBearingMint=53]="InitializeInterestBearingMint",D$[D$.UpdateRateInterestBearingMint=54]="UpdateRateInterestBearingMint",D$[D$.EnableCpiGuard=55]="EnableCpiGuard",D$[D$.DisableCpiGuard=56]="DisableCpiGuard",D$[D$.InitializePermanentDelegate=57]="InitializePermanentDelegate",D$[D$.InitializeTransferHook=58]="InitializeTransferHook",D$[D$.UpdateTransferHook=59]="UpdateTransferHook",D$[D$.InitializeConfidentialTransferFee=60]="InitializeConfidentialTransferFee",D$[D$.WithdrawWithheldTokensFromMintForConfidentialTransferFee=61]="WithdrawWithheldTokensFromMintForConfidentialTransferFee",D$[D$.WithdrawWithheldTokensFromAccountsForConfidentialTransferFee=62]="WithdrawWithheldTokensFromAccountsForConfidentialTransferFee",D$[D$.HarvestWithheldTokensToMintForConfidentialTransferFee=63]="HarvestWithheldTokensToMintForConfidentialTransferFee",D$[D$.EnableHarvestToMint=64]="EnableHarvestToMint",D$[D$.DisableHarvestToMint=65]="DisableHarvestToMint",D$[D$.WithdrawExcessLamports=66]="WithdrawExcessLamports",D$[D$.InitializeMetadataPointer=67]="InitializeMetadataPointer",D$[D$.UpdateMetadataPointer=68]="UpdateMetadataPointer",D$[D$.InitializeGroupPointer=69]="InitializeGroupPointer",D$[D$.UpdateGroupPointer=70]="UpdateGroupPointer",D$[D$.InitializeGroupMemberPointer=71]="InitializeGroupMemberPointer",D$[D$.UpdateGroupMemberPointer=72]="UpdateGroupMemberPointer",D$[D$.InitializeScaledUiAmountMint=73]="InitializeScaledUiAmountMint",D$[D$.UpdateMultiplierScaledUiMint=74]="UpdateMultiplierScaledUiMint",D$[D$.InitializePausableConfig=75]="InitializePausableConfig",D$[D$.Pause=76]="Pause",D$[D$.Resume=77]="Resume",D$[D$.InitializeTokenMetadata=78]="InitializeTokenMetadata",D$[D$.UpdateTokenMetadataField=79]="UpdateTokenMetadataField",D$[D$.RemoveTokenMetadataKey=80]="RemoveTokenMetadataKey",D$[D$.UpdateTokenMetadataUpdateAuthority=81]="UpdateTokenMetadataUpdateAuthority",D$[D$.EmitTokenMetadata=82]="EmitTokenMetadata",D$[D$.InitializeTokenGroup=83]="InitializeTokenGroup",D$[D$.UpdateTokenGroupMaxSize=84]="UpdateTokenGroupMaxSize",D$[D$.UpdateTokenGroupUpdateAuthority=85]="UpdateTokenGroupUpdateAuthority",D$[D$.InitializeTokenGroupMember=86]="InitializeTokenGroupMember",D$);new Uint8Array([250,166,180,250,13,12,184,70]),new Uint8Array([121,113,108,39,54,51,0,4]),new Uint8Array([152,32,222,176,223,237,116,134]),new Uint8Array([210,225,30,162,88,184,77,141]),new Uint8Array([234,18,32,56,89,141,37,181]),new Uint8Array([108,37,171,143,248,30,18,110]),new Uint8Array([161,105,88,1,237,221,216,203]),new Uint8Array([221,233,49,45,181,202,220,200]),new Uint8Array([215,228,166,228,84,100,86,123]),yP.union([yP.string().transform(a=>a.replace(/[^0-9.-]+/g,"")),yP.number()]).pipe(yP.coerce.number().min(1e-4).max(0x3b9ac9ff));var A1=yP.enum(["abstract","abstract-testnet","base-sepolia","base","avalanche-fuji","avalanche","iotex","solana-devnet","solana","sei","sei-testnet","polygon","polygon-amoy","peaq","story","educhain","skale-base-sepolia"]),A2=new Map([["abstract",2741],["abstract-testnet",11124],["base-sepolia",84532],["base",8453],["avalanche-fuji",43113],["avalanche",43114],["iotex",4689],["sei",1329],["sei-testnet",1328],["polygon",137],["polygon-amoy",80002],["peaq",3338],["story",1514],["educhain",41923],["skale-base-sepolia",0x135a9d92]]),A3=["solana-devnet","solana"];Object.fromEntries(["abstract","abstract-testnet","base-sepolia","base","avalanche-fuji","avalanche","iotex","sei","sei-testnet","polygon","polygon-amoy","peaq","story","educhain","skale-base-sepolia",...A3].map(a=>[A2.get(a),a]));var A4={id:0x135a9d92,name:"SKALE Base Sepolia",nativeCurrency:{name:"Credits",symbol:"CREDITS",decimals:18},rpcUrls:{default:{http:["https://base-sepolia-testnet.skalenodes.com/v1/jubilant-horrible-ancha"]}},blockExplorers:{default:{name:"Blockscout",url:"https://base-sepolia-testnet-explorer.skalenodes.com",apiUrl:"https://base-sepolia-testnet-explorer.skalenodes.com/api"}}};function A5(a){let b=Bd(a);return(0,yQ.createPublicClient)({chain:b,transport:(0,wM.http)()}).extend(yR.publicActions)}function A6(){return A5("base-sepolia")}function A7(){return A5("avalanche-fuji")}function A8(a,b){let c=Bd(a),d=(0,wL.createWalletClient)({chain:c,transport:(0,wM.http)(),account:function(a,b={}){let{nonceManager:c}=b,d=(0,fd.toHex)(zz.secp256k1.getPublicKey(a.slice(2),!1));return{...function(a){if("string"==typeof a){if(!(0,fe.isAddress)(a,{strict:!1}))throw new yX.InvalidAddressError({address:a});return{address:a,type:"json-rpc"}}if(!(0,fe.isAddress)(a.address,{strict:!1}))throw new yX.InvalidAddressError({address:a.address});return{address:a.address,nonceManager:a.nonceManager,sign:a.sign,signAuthorization:a.signAuthorization,signMessage:a.signMessage,signTransaction:a.signTransaction,signTypedData:a.signTypedData,source:"custom",type:"local"}}({address:(0,zA.publicKeyToAddress)(d),nonceManager:c,sign:async({hash:b})=>zC({hash:b,privateKey:a,to:"hex"}),signAuthorization:async b=>zD({...b,privateKey:a}),signMessage:async({message:b})=>zF({message:b,privateKey:a}),signTransaction:async(b,{serializer:c}={})=>zH({privateKey:a,transaction:b,serializer:c}),signTypedData:async b=>zJ({...b,privateKey:a})}),publicKey:d,source:"privateKey"}}(b)});return Bf(c)?d.extend(yR.publicActions).extend(a=>({sendTransaction:b=>z6(a,b),signTransaction:b=>z3(a,b),deployContract:b=>(function(a,b){let{abi:c,args:d,bytecode:e,deploymentType:f,salt:g,...h}=b,i=function(a){let{abi:b,args:c,bytecode:d,deploymentType:e,salt:f}=a;if(!c||0===c.length){let{functionName:a,argsContractDeployer:b}=zR(e,f??zL.zeroHash,(0,fd.toHex)(zt(d)),"0x");return(0,zO.encodeFunctionData)({abi:zP,functionName:a,args:b})}let g=b.find(a=>"type"in a&&"constructor"===a.type);if(!g)throw new zM.AbiConstructorNotFoundError({docsPath:zQ});if(!("inputs"in g)||!g.inputs||0===g.inputs.length)throw new zM.AbiConstructorParamsNotFoundError({docsPath:zQ});let h=(0,zN.encodeAbiParameters)(g.inputs,c),{functionName:i,argsContractDeployer:j}=zR(e,f??zL.zeroHash,(0,fd.toHex)(zt(d)),h);return(0,zO.encodeFunctionData)({abi:zP,functionName:i,args:j})}({abi:c,args:d,bytecode:e,deploymentType:f,salt:g});return h.factoryDeps=h.factoryDeps||[],h.factoryDeps.includes(e)||h.factoryDeps.push(e),z4(a,{...h,data:i,to:"create2"===f||"create2Account"===f?"0x0000000000000000000000000000000000010000":"0x0000000000000000000000000000000000008006"})})(a,b),writeContract:b=>(0,zK.writeContract)(Object.assign(a,{sendTransaction:b=>z6(a,b)}),b)})):d.extend(yR.publicActions)}function A9(a){return A8("base-sepolia",a)}function Ba(a){return A8("avalanche-fuji",a)}function Bb(a){return"object"==typeof a&&null!==a&&"chain"in a&&"transport"in a}function Bc(a){return"object"==typeof a&&null!==a&&"string"==typeof a.address&&"string"==typeof a.type&&"function"==typeof a.sign&&"function"==typeof a.signMessage&&"function"==typeof a.signTypedData&&"function"==typeof a.signTransaction}function Bd(a){if(!a)throw Error("NETWORK environment variable is not set");switch(a){case"abstract":return zv;case"abstract-testnet":return zw;case"base":return y3;case"base-sepolia":return y1;case"avalanche":return y9;case"avalanche-fuji":return y2;case"sei":return y4;case"sei-testnet":return y5;case"polygon":return y6;case"polygon-amoy":return y7;case"peaq":return y8;case"story":return zx;case"educhain":return zy;case"iotex":return zb;case"iotex-testnet":return za;case"skale-base-sepolia":return A4;default:throw Error(`Unsupported network: ${a}`)}}var Be=new Set([2741,11124]);function Bf(a){return Be.has(a.id)}function Bg(a){return Ay(a?(0,Az.devnet)(a):(0,Az.devnet)("https://api.devnet.solana.com"))}function Bh(a){return Ay(a?(0,Az.mainnet)(a):(0,Az.mainnet)("https://api.mainnet-beta.solana.com"))}function Bi(a,b){if("solana-devnet"===a)return Bg(b);if("solana"===a)return Bh(b);throw Error("Invalid network")}function Bj(a,b){if("solana-devnet"===a)return AS((0,Az.devnet)(b?Bk(b):"wss://api.devnet.solana.com"));if("solana"===a)return AS((0,Az.mainnet)(b?Bk(b):"wss://api.mainnet-beta.solana.com"));throw Error("Invalid network")}function Bk(a){return a.startsWith("http")?a.replace("http","ws"):a}function Bl(a){if(!A3.find(b=>b===a))throw Error(`Unsupported SVM network: ${a}`);return Bi(a)}async function Bm(a){let b=gf.base58.decode(a);if(64===b.length)return await (0,z7.createKeyPairSignerFromBytes)(b);if(32===b.length)return await (0,z7.createKeyPairSignerFromPrivateKeyBytes)(b);throw Error(`Unexpected key length: ${b.length}. Expected 32 or 64 bytes.`)}function Bn(a){return"object"==typeof a&&null!==a&&(0,z7.isTransactionSigner)(a)}wR({},{authorizationPrimaryType:()=>Bp,authorizationTypes:()=>Bo,config:()=>wS,createClientAvalancheFuji:()=>A7,createClientSepolia:()=>A6,createConnectedClient:()=>A5,createSigner:()=>A8,createSignerAvalancheFuji:()=>Ba,createSignerSepolia:()=>A9,getChainFromNetwork:()=>Bd,isAccount:()=>Bc,isSignerWallet:()=>Bb,isZkStackChain:()=>Bf,usdcABI:()=>wT});var Bo={TransferWithAuthorization:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"},{name:"validAfter",type:"uint256"},{name:"validBefore",type:"uint256"},{name:"nonce",type:"bytes32"}]},Bp="TransferWithAuthorization";wR({},{SvmAddressRegex:()=>Bq});var Bq=/^[1-9A-HJ-NP-Za-km-z]{32,44}$/,Br=/^0x[0-9a-fA-F]{40}$/,Bs=/^0x[a-fA-F0-9]{40}|[A-Za-z0-9][A-Za-z0-9-]{0,34}[A-Za-z0-9]$/,Bt=["exact"],Bu=[1],Bv=["insufficient_funds","invalid_exact_evm_payload_authorization_valid_after","invalid_exact_evm_payload_authorization_valid_before","invalid_exact_evm_payload_authorization_value","invalid_exact_evm_payload_signature","invalid_exact_evm_payload_undeployed_smart_wallet","invalid_exact_evm_payload_recipient_mismatch","invalid_exact_svm_payload_transaction","invalid_exact_svm_payload_transaction_amount_mismatch","invalid_exact_svm_payload_transaction_create_ata_instruction","invalid_exact_svm_payload_transaction_create_ata_instruction_incorrect_payee","invalid_exact_svm_payload_transaction_create_ata_instruction_incorrect_asset","invalid_exact_svm_payload_transaction_instructions","invalid_exact_svm_payload_transaction_instructions_length","invalid_exact_svm_payload_transaction_instructions_compute_limit_instruction","invalid_exact_svm_payload_transaction_instructions_compute_price_instruction","invalid_exact_svm_payload_transaction_instructions_compute_price_instruction_too_high","invalid_exact_svm_payload_transaction_instruction_not_spl_token_transfer_checked","invalid_exact_svm_payload_transaction_instruction_not_token_2022_transfer_checked","invalid_exact_svm_payload_transaction_fee_payer_included_in_instruction_accounts","invalid_exact_svm_payload_transaction_fee_payer_transferring_funds","invalid_exact_svm_payload_transaction_not_a_transfer_instruction","invalid_exact_svm_payload_transaction_receiver_ata_not_found","invalid_exact_svm_payload_transaction_sender_ata_not_found","invalid_exact_svm_payload_transaction_simulation_failed","invalid_exact_svm_payload_transaction_transfer_to_incorrect_ata","invalid_network","invalid_payload","invalid_payment_requirements","invalid_scheme","invalid_payment","payment_expired","unsupported_scheme","invalid_x402_version","invalid_transaction_state","invalid_x402_version","settle_exact_svm_block_height_exceeded","settle_exact_svm_transaction_confirmation_timed_out","unsupported_scheme","unexpected_settle_error","unexpected_verify_error"],Bw=a=>Number.isInteger(Number(a))&&Number(a)>=0,Bx=yP.string().regex(Br).or(yP.string().regex(Bq)),By=yP.string().regex(Bs).or(yP.string().regex(Bq)),Bz=yP.object({scheme:yP.enum(Bt),network:A1,maxAmountRequired:yP.string().refine(Bw),resource:yP.string().url(),description:yP.string(),mimeType:yP.string(),outputSchema:yP.record(yP.any()).optional(),payTo:Bx,maxTimeoutSeconds:yP.number().int(),asset:By,extra:yP.record(yP.any()).optional()}),BA=yP.object({from:yP.string().regex(Br),to:yP.string().regex(Br),value:yP.string().refine(Bw).refine(a=>a.length<=18),validAfter:yP.string().refine(Bw),validBefore:yP.string().refine(Bw),nonce:yP.string().regex(/^0x[0-9a-fA-F]{64}$/)}),BB=yP.object({signature:yP.string().regex(/^0x[0-9a-fA-F]+$/),authorization:BA}),BC=yP.object({transaction:yP.string().regex(/^[A-Za-z0-9+/]*={0,2}$/)}),BD=yP.object({x402Version:yP.number().refine(a=>Bu.includes(a)),scheme:yP.enum(Bt),network:A1,payload:yP.union([BB,BC])});yP.object({x402Version:yP.number().refine(a=>Bu.includes(a)),error:yP.enum(Bv).optional(),accepts:yP.array(Bz).optional(),payer:yP.string().regex(Bs).optional()});var BE=yP.enum(["GET","POST","PUT","DELETE","PATCH","OPTIONS","HEAD"]),BF=yP.object({type:yP.literal("http"),method:BE,queryParams:yP.record(yP.string(),yP.string()).optional(),bodyType:yP.enum(["json","form-data","multipart-form-data","text","binary"]).optional(),bodyFields:yP.record(yP.string(),yP.any()).optional(),headerFields:yP.record(yP.string(),yP.any()).optional()});yP.discriminatedUnion("type",[BF]);var BG=yP.object({resource:yP.string(),type:yP.enum(["http"]),x402Version:yP.number().refine(a=>Bu.includes(a)),accepts:yP.array(Bz),lastUpdated:yP.date(),metadata:yP.record(yP.any()).optional()});yP.object({paymentPayload:BD,paymentRequirements:Bz}),yP.object({paymentPayload:BD,paymentRequirements:Bz}),yP.object({isValid:yP.boolean(),invalidReason:yP.enum(Bv).optional(),payer:Bx.optional()}),yP.object({success:yP.boolean(),errorReason:yP.enum(Bv).optional(),payer:Bx.optional(),transaction:yP.string().regex(Bs),network:A1}),yP.object({type:yP.string().optional(),limit:yP.number().optional(),offset:yP.number().optional()}),yP.object({x402Version:yP.number().refine(a=>Bu.includes(a)),items:yP.array(BG),pagination:yP.object({limit:yP.number(),offset:yP.number(),total:yP.number()})});var BH=yP.object({x402Version:yP.number().refine(a=>Bu.includes(a)),scheme:yP.enum(Bt),network:A1,extra:yP.record(yP.any()).optional()});function BI(a){try{let b=(0,AU.getBase64Encoder)().encode(a.transaction);return(0,AT.getTransactionDecoder)().decode(b)}catch(a){throw console.error("error",a),Error("invalid_exact_svm_payload_transaction")}}function BJ(a){let b=(0,AV.getCompiledTransactionMessageDecoder)().decode(a.messageBytes),c=b.staticAccounts??[];for(let a of b.instructions??[]){let b=c[a.programAddressIndex].toString();if(b===AW.TOKEN_PROGRAM_ADDRESS.toString()||b==="TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb".toString()){let b=a.accountIndices??[];if(b.length>=4){let a=c[b[3]].toString();if(a)return a}}}return""}async function BK(a,b,c){let d=await BL(a,b),e=(0,AT.getBase64EncodedWireTransaction)(d);return await c.simulateTransaction(e,{sigVerify:!0,replaceRecentBlockhash:!1,commitment:"confirmed",encoding:"base64",accounts:void 0,innerInstructions:void 0,minContextSlot:void 0}).send()}async function BL(a,b){if((0,z7.isTransactionModifyingSigner)(a)){let[c]=await a.modifyAndSignTransactions([b]);if(!c)throw Error("transaction_signer_failed_to_return_transaction");return c}if((0,z7.isTransactionPartialSigner)(a)){var c,d;let[e]=await a.signTransactions([b]);if(!e)throw Error("transaction_signer_failed_to_return_signatures");return c=b,d=e,Object.freeze({...c,signatures:Object.freeze({...c.signatures,...d})})}throw Error("transaction_signer_must_support_offline_signing")}yP.object({kinds:yP.array(BH)}),wR({},{createDevnetRpcClient:()=>Bg,createMainnetRpcClient:()=>Bh,createSignerFromBase58:()=>Bm,createSvmConnectedClient:()=>Bl,decodeTransactionFromPayload:()=>BI,getRpcClient:()=>Bi,getRpcSubscriptions:()=>Bj,getTokenPayerFromTransaction:()=>BJ,isSignerWallet:()=>Bn,signAndSimulateTransaction:()=>BK,signTransactionWithSigner:()=>BL}),yP.object({paymentHeader:yP.string(),paymentRequirements:Bz});var BM=((D_=BM||{})[D_.RequestUnits=0]="RequestUnits",D_[D_.RequestHeapFrame=1]="RequestHeapFrame",D_[D_.SetComputeUnitLimit=2]="SetComputeUnitLimit",D_[D_.SetComputeUnitPrice=3]="SetComputeUnitPrice",D_[D_.SetLoadedAccountsDataSizeLimit=4]="SetLoadedAccountsDataSizeLimit",D_);a.s([],781034),a.i(331852),a.i(525660);class BN{static parse(a){try{return new BN(a)}catch(a){return null}}static throwIfNotWellFormedJwt(a){return cm.decodeJwt(a),a}get subject(){return this._decoded.sub}get expiration(){return this._decoded.exp}get issuer(){return this._decoded.iss}get audience(){return this._decoded.aud}isExpired(a=0){return Date.now()>=1e3*(this.expiration-a)}constructor(a){this.value=a,this._decoded=cm.decodeJwt(a)}}class BO extends BN{static parse(a){try{return new BO(a)}catch(a){return null}}get appId(){return this._decoded.aid?this._decoded.aid:this.audience}}let BP=({style:a,...b})=>(0,Q.jsxs)("svg",{viewBox:"0 0 1024 1024",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{height:"28px",width:"28px",...a},...b,children:[(0,Q.jsx)("rect",{width:"1024",height:"1024",fill:"#0052FF",rx:100,ry:100}),(0,Q.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M152 512C152 710.823 313.177 872 512 872C710.823 872 872 710.823 872 512C872 313.177 710.823 152 512 152C313.177 152 152 313.177 152 512ZM420 396C406.745 396 396 406.745 396 420V604C396 617.255 406.745 628 420 628H604C617.255 628 628 617.255 628 604V420C628 406.745 617.255 396 604 396H420Z",fill:"white"})]}),BQ="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PScwIDAgMTAyNCAxMDI0JyBmaWxsPSdub25lJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHN0eWxlPSdoZWlnaHQ6MjhweDt3aWR0aDoyOHB4Jz48cmVjdCB3aWR0aD0nMTAyNCcgaGVpZ2h0PScxMDI0JyBmaWxsPScjMDA1MkZGJyByeD0nMTAwJyByeT0nMTAwJz48L3JlY3Q+PHBhdGggZmlsbC1ydWxlPSdldmVub2RkJyBjbGlwLXJ1bGU9J2V2ZW5vZGQnIGQ9J00xNTIgNTEyQzE1MiA3MTAuODIzIDMxMy4xNzcgODcyIDUxMiA4NzJDNzEwLjgyMyA4NzIgODcyIDcxMC44MjMgODcyIDUxMkM4NzIgMzEzLjE3NyA3MTAuODIzIDE1MiA1MTIgMTUyQzMxMy4xNzcgMTUyIDE1MiAzMTMuMTc3IDE1MiA1MTJaTTQyMCAzOTZDNDA2Ljc0NSAzOTYgMzk2IDQwNi43NDUgMzk2IDQyMFY2MDRDMzk2IDYxNy4yNTUgNDA2Ljc0NSA2MjggNDIwIDYyOEg2MDRDNjE3LjI1NSA2MjggNjI4IDYxNy4yNTUgNjI4IDYwNFY0MjBDNjI4IDQwNi43NDUgNjE3LjI1NSAzOTYgNjA0IDM5Nkg0MjBaJyBmaWxsPSd3aGl0ZSc+PC9wYXRoPjwvc3ZnPg==",BR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAALZJREFUaEPtmjEOhDAMBNc/O14GvOzys3CAKK6eAlmaVGl2Zc+kTOU685vkc9/bnD2prZK5/TZY24z9P+g4F5hNh7/GdoG37WlAA5CATwgCxHENYISwQAMQII5rACOEBRqAAHFcAxghLNAABIjjGsAIYYEGIEAc1wBGCAs0AAHiuAYwQligAQgQxzWAEcICDUCAOK4BjBAWaAACxHENYISwQAMQII6fBjr+VHkW3+u+tfyxMpJaDgYzYxb/ALZVAAAAAElFTkSuQmCC";class BS extends cv.E{async initialize(){await this.importPromise,await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(a){return a.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}disconnect(){this.proxyProvider.walletProvider.disconnect(),this.onDisconnect()}get walletBranding(){return{name:this.displayName,icon:BR,id:"com.coinbase.wallet"}}async promptConnection(){try{await this.importPromise;let a=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!a||0===a.length||!a[0])throw new cx.P("Unable to retrieve accounts");this.connected=!0,await this.syncAccounts([a[0]])}catch(a){throw(0,cy.f)(a)}}constructor(b,c,d,e,f){super("base_account",b,c,d),this.connectorType="base_account",this.walletClientType="base_account",this.displayName="Base",this.setBaseAccountSdk=f,this.proxyProvider=new cv.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.baseAccountConfig={...e,appChainIds:[c.id].concat(b.map(a=>a.id))},g?(this.proxyProvider.setWalletProvider(g.getProvider()),this.setBaseAccountSdk(g)):this.importPromise=a.A(823287).then(({createBaseAccountSDK:a})=>{g=a(this.baseAccountConfig),this.proxyProvider.setWalletProvider(g.getProvider()),this.setBaseAccountSdk(g)}).catch(console.error)}}let BT=[1,0xaa36a7,137,10,8453,84532,42161,7777777,43114,56];class BU extends cv.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(a){return a.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}disconnect(){this.proxyProvider.walletProvider.disconnect(),this.onDisconnect()}get walletBranding(){return{name:this.displayName,icon:BQ,id:"com.coinbase.wallet"}}async promptConnection(){try{let a=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!a||0===a.length||!a[0])throw new cx.P("Unable to retrieve accounts");this.connected=!0,await this.syncAccounts([a[0]])}catch(a){throw(0,cy.f)(a)}}updateConnectionPreference(a){this.coinbaseWalletConfig={...this.coinbaseWalletConfig,preference:{...this.coinbaseWalletConfig.preference,options:a}},this.walletClientType="smartWalletOnly"===a?"coinbase_smart_wallet":"coinbase_wallet",h=e9({...this.coinbaseWalletConfig}),this.proxyProvider.setWalletProvider(h.getProvider())}constructor(a,b,c,d){if(super("coinbase_wallet",a,b,c),this.connectorType="coinbase_wallet",this.displayName="Coinbase Wallet",this.proxyProvider=new cv.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.coinbaseWalletConfig={...d,appChainIds:[b.id].concat(a.map(a=>a.id))},this.walletClientType="smartWalletOnly"===this.coinbaseWalletConfig.preference?.options?"coinbase_smart_wallet":"coinbase_wallet","coinbase_smart_wallet"===this.walletClientType&&(this.displayName="Coinbase Smart Wallet"),!h){let a="eoaOnly"!==this.coinbaseWalletConfig.preference?.options?(this.coinbaseWalletConfig.appChainIds??[]).filter(a=>!BT.includes(a)):[];a.length>0&&!a.every(a=>T.DEFAULT_SUPPORTED_CHAIN_IDS.has(a))&&console.info(`The configured chains are not supported by Coinbase Smart Wallet: ${a.join(", ")}`),h=e9(this.coinbaseWalletConfig)}this.proxyProvider.setWalletProvider(h.getProvider())}}let BV=({...a})=>(0,Q.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,Q.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.37126 11.0323C2.37126 12.696 3.90598 13.4421 5.40654 13.4468C8.91753 13.4468 12.8021 11.2897 12.7819 7.67984C12.7673 5.07728 10.3748 2.86167 7.54357 2.88296C4.8495 2.88296 2.21821 4.6411 2.21803 7.03628C2.21803 7.67951 2.58722 8.30178 3.55231 8.37184C2.74763 9.16826 2.37126 10.1225 2.37126 11.0323ZM7.55283 8.68012C8.11562 8.68012 8.57186 8.13217 8.57186 7.45624C8.57186 6.78032 8.11562 6.23237 7.55283 6.23237C6.99003 6.23237 6.53379 6.78032 6.53379 7.45624C6.53379 8.13217 6.99003 8.68012 7.55283 8.68012ZM10.4747 8.68012C11.0375 8.68012 11.4937 8.13217 11.4937 7.45625C11.4937 6.78032 11.0375 6.23237 10.4747 6.23237C9.91186 6.23237 9.45562 6.78032 9.45562 7.45625C9.45562 8.13217 9.91186 8.68012 10.4747 8.68012Z",fill:a.color||"var(--privy-color-foreground-3)"})});class BW extends cv.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(a){return await this.isConnected()?(await this.proxyProvider.request({method:"wallet_switchEthereumChain",params:[(0,cv.t)(a?.chainId||"0x1")]}),this.getConnectedWallet()):null}get walletBranding(){return{name:"Privy Wallet",icon:BV,id:"io.privy.wallet"}}disconnect(){this.connected=!1}async promptConnection(){}constructor({provider:a,chains:b,defaultChain:c,rpcConfig:d,imported:e,walletIndex:f}){super("privy",b,c,d),this.connectorType="embedded",this.proxyProvider=a,this.walletIndex=f,e&&(this.connectorType="embedded_imported"),this.subscribeListeners()}}async function BX(){let a=El();return a?a.getAccessToken():Promise.resolve(cy.u.get(fb.P)||cy.u.get(fb.C)||null)}let BY=["eth_sign","eth_populateTransactionRequest","eth_signTransaction","personal_sign","eth_signTypedData_v4","csw_signUserOperation","secp256k1_sign"];function BZ(a){return a?{"privy-ui":"t"}:void 0}class B${async authenticate(){if(!this.api)throw new cx.a("Auth flow has no API instance");if(!this.meta.email||!this.meta.emailCode)throw new cx.a("Email and email code must be set prior to calling authenticate.");try{return await this.api.post(fD,{email:this.meta.email,code:this.meta.emailCode,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(a){throw(0,cx.f)(a)}}async link(){if(!this.api)throw new cx.a("Auth flow has no API instance");if(!this.meta.email||!this.meta.emailCode)throw new cx.a("Email and email code must be set prior to calling authenticate.");try{return await this.api.post(fE,{email:this.meta.email,code:this.meta.emailCode})}catch(a){throw(0,cx.f)(a)}}async sendCodeEmail({email:a,captchaToken:b,withPrivyUi:c}){if(!this.api)throw new cx.a("Auth flow has no API instance");if(a&&(this.meta.email=a),b&&(this.meta.captchaToken=b),!this.meta.email)throw new cx.a("Email must be set when initialzing authentication.");let d=BZ(c);try{return await this.api.post(fC,{email:this.meta.email,token:this.meta.captchaToken},{headers:{...d}})}catch(a){throw(0,cx.f)(a)}}constructor({email:a,captchaToken:b,disableSignup:c}){this.meta={email:a,captchaToken:b,disableSignup:c??!1}}}class B_ extends B${async link(){if(!this.api)throw new cx.a("Auth flow has no API instance");if(!this.meta.email||!this.meta.emailCode||!this.meta.oldAddress)throw new cx.a("Email, email code, and an old email address must be set prior to calling update.");try{return await this.api.post(fG,{oldAddress:this.meta.oldAddress,newAddress:this.meta.email,code:this.meta.emailCode})}catch(a){throw(0,cx.f)(a)}}constructor(a,b,c){super({email:b,captchaToken:c}),this.meta={email:b,captchaToken:c,oldAddress:a,disableSignup:!1}}}class B0{execute(a){return null===this.promise&&(this.promise=(async()=>{try{return await this.fn(a)}finally{this.promise=null}})()),this.promise}constructor(a){this.promise=null,this.fn=a}}class B1{get meta(){return this._meta}async authenticate(){if(!this.api)throw new cx.a("Auth flow has no API instance");if(!this.meta.channelToken)throw new cx.a("Auth flow must be initialized first");try{let a=await this.api.post(fx,{channel_token:this.meta.channelToken,message:this.message,signature:this.signature,fid:this.fid,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"});if(!a)throw new cx.a("No response from authentication");return a}catch(a){throw(0,cx.f)(a)}}async link(){if(!this.api)throw new cx.a("Auth flow has no API instance");try{return await this.api.post(fy,{channel_token:this.meta.channelToken,message:this.message,signature:this.signature,fid:this.fid})}catch(a){throw(0,cx.f)(a)}}async _startChannelOnce(){if(!this.api)throw new cx.a("Auth flow has no API instance");let a=await this.api.post(fw,{token:this.captchaToken});fc.isMobile&&!fc.isIOS&&a.connect_uri&&(0,ge.o)(a.connect_uri,"_blank"),this._meta={...this._meta,connectUri:a.connect_uri,channelToken:a.channel_token}}async initializeFarcasterConnect(){if(!this.api)throw new cx.a("Auth flow has no API instance");await this.startChannelOnce.execute()}async _pollForReady(){if(!this.api)throw new cx.a("Auth flow has no API instance");if(!this.meta.channelToken)throw new cx.a("Auth flow must be initialized first");let a=await this.api.get(fz,{headers:{"farcaster-channel-token":this.meta.channelToken}});return"completed"===a.state&&(this.message=a.message,this.signature=a.signature,this.fid=a.fid,!0)}constructor(a,b=!1){this._meta={disableSignup:!1},this.captchaToken=a,this.startChannelOnce=new B0(this._startChannelOnce.bind(this)),this.pollForReady=new B0(this._pollForReady.bind(this)),this._meta.disableSignup=b}}function B2(){}async function B3(a){return new Promise((a,b)=>{b(Error("Chrome identity API not available"))})}function B4(a){return crypto.getRandomValues(new Uint8Array(a))}function B5(){return cs.base64url.encode(B4(36))}function B6(){return B5()}async function B7(a,b="S256"){if("S256"!=b)return a;{let b=await async function(a){let b=(new TextEncoder).encode(a);return new Uint8Array(await crypto.subtle.digest("SHA-256",b))}(a);return cs.base64url.encode(b)}}class B8{addCaptchaToken(a){this.meta.captchaToken=a}isActive(){return!!(this.meta.authorizationCode&&this.meta.stateCode&&this.meta.provider)}async authenticate(){if(!this.api)throw new cx.a("Auth flow has no API instance");if(!this.meta.authorizationCode||!this.meta.stateCode)throw new cx.a("[OAuth AuthFlow] Authorization and state codes code must be set prior to calling authenticate.");if("undefined"===this.meta.authorizationCode)throw new cx.a("User denied confirmation during OAuth flow");let a=function(){let a=cy.u.get(fb.a);if(!a)throw new cx.a("Authentication error.");return a}();try{let b=await this.api.post(fP,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:a,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"});return cy.u.del(fb.a),cy.u.del(fb.H),cy.u.del(fb.O),b}catch(b){let a=(0,cx.f)(b);if(a.privyErrorCode)throw new cx.a(a.message||"Invalid code during OAuth flow.",void 0,a.privyErrorCode);if("User denied confirmation during OAuth flow"===a.message)throw new cx.a("Invalid code during oauth flow.",void 0,cx.b.OAUTH_USER_DENIED);throw new cx.a("Invalid code during OAuth flow.",void 0,cx.b.UNKNOWN_AUTH_ERROR)}}async link(){if(!this.api)throw new cx.a("Auth flow has no API instance");if(!this.meta.authorizationCode||!this.meta.stateCode)throw new cx.a("[OAuth AuthFlow] Authorization and state codes code must be set prior to calling link.");if("undefined"===this.meta.authorizationCode)throw new cx.a("User denied confirmation during OAuth flow");let a=cy.u.get(fb.a);if(!a)throw new cx.a("Authentication error.");try{let b=await this.api.post(fQ,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:a});return cy.u.del(fb.a),b}catch(a){throw(0,cx.f)(a)}}async getAuthorizationUrl(){if(!this.api)throw new cx.a("Auth flow has no API instance");if(!this.meta.provider)throw new cx.a("Provider must be set when initializing OAuth authentication.");let a=B5();cy.u.put(fb.a,a);let b=B6();cy.u.put(fb.S,b);let c=await B7(a);this.meta.withPrivyUi||cy.u.put(fb.H,!0),this.meta.disableSignup?cy.u.put(fb.O,!0):cy.u.del(fb.O);let d=BZ(this.meta.withPrivyUi),e=window.location.href,f=function(){let a=B2();if(a)return`https://${a}.chromiumapp.org`}();f&&(e=f);try{return await this.api.post(fO,{provider:this.meta.provider,redirect_to:this.meta.customOAuthRedirectUrl||e,token:this.meta.captchaToken,code_challenge:c,state_code:b},{headers:{...d}})}catch(a){throw(0,cx.f)(a)}}constructor(a){this.meta=a}}function B9(){let a=new URL(window.location.href);a.searchParams.delete("privy_oauth_code"),a.searchParams.delete("privy_oauth_provider"),a.searchParams.delete("privy_oauth_state"),cy.u.del(fb.S),window.history.replaceState({},"",a)}class Ca{async initRegisterFlow(a){if(!this.api)throw new cx.a("Auth flow has no API instance");this.authenticateForRegistration=!0,this.meta.initRegisterResponse=await this.initRegisterOnce.execute(a)}async initAuthenticationFlow(a){if(!this.api)throw new cx.a("Auth flow has no API instance");this.authenticateForRegistration=!1,this.meta.initAuthenticateResponse=await this.initAuthenticateOnce.execute(a)}async initLinkFlow(){if(!this.api)throw new cx.a("Auth flow has no API instance");this.meta.initLinkResponse=await this.initLinkOnce.execute()}async register(){let b=await a.A(577627);if(!this.api)throw new cx.a("Auth flow has no API instance");if(!b.browserSupportsWebAuthn())throw new cx.a("WebAuthn is not supported in this browser");this.meta.initRegisterResponse||(this.meta.initRegisterResponse=await this.initRegisterOnce.execute());try{let a=this.meta.initRegisterResponse.options,c=await b.startRegistration({optionsJSON:this._transformInitLinkOptionsToCamelCase(a)});return this.meta.setPasskeyAuthState?.({status:"submitting-response"}),await this.api.post(fY,{relying_party:this.meta.initRegisterResponse.relying_party,authenticator_response:this._transformRegistrationResponseToSnakeCase(c)})}catch(a){if("NotAllowedError"===a.name)throw new cx.a("Passkey request timed out or rejected by user.",void 0,cx.b.PASSKEY_NOT_ALLOWED);throw(0,cx.f)(a)}}async authenticate(){if(this.authenticateForRegistration)return this.register();let b=await a.A(577627);if(!this.api)throw new cx.a("Auth flow has no API instance");if(!b.browserSupportsWebAuthn())throw new cx.a("WebAuthn is not supported in this browser");this.meta.initAuthenticateResponse||(this.meta.initAuthenticateResponse=await this.initAuthenticateOnce.execute());let c=this.meta.allowedCredentialsIds?.map(a=>({type:"public-key",id:a}))??this.meta.initAuthenticateResponse.options.allow_credentials;try{let a=await b.startAuthentication({optionsJSON:this._transformInitAuthenticateOptionsToCamelCase({...this.meta.initAuthenticateResponse.options,allow_credentials:c})});return this.meta.setPasskeyAuthState?.({status:"submitting-response"}),await this.api.post(fX,{relying_party:this.meta.initAuthenticateResponse.relying_party,challenge:this.meta.initAuthenticateResponse.options.challenge,authenticator_response:this._transformAuthenticationResponseToSnakeCase(a)})}catch(a){if("NotAllowedError"===a.name)throw new cx.a("Passkey request timed out or rejected by user.",void 0,cx.b.PASSKEY_NOT_ALLOWED);throw(0,cx.f)(a)}}async link(){let b=await a.A(577627);if(!this.api)throw new cx.a("Auth flow has no API instance");if(!b.browserSupportsWebAuthn())throw new cx.a("WebAuthn is not supported in this browser");this.meta.initLinkResponse||(this.meta.initLinkResponse=await this.initLinkOnce.execute());try{let a=this.meta.initLinkResponse.options,c=await b.startRegistration({optionsJSON:this._transformInitLinkOptionsToCamelCase(a)});return this.meta.setPasskeyAuthState?.({status:"submitting-response"}),await this.api.post(fW,{relying_party:this.meta.initLinkResponse.relying_party,authenticator_response:this._transformRegistrationResponseToSnakeCase(c)})}catch(a){if("NotAllowedError"===a.name)throw new cx.a("Passkey request timed out or rejected by user.",void 0,cx.b.PASSKEY_NOT_ALLOWED);throw(0,cx.f)(a)}}async _initRegisterOnce(a){if(!this.api)throw new cx.a("Auth flow has no API instance");let b=BZ(a);return await this.api.post(fV,{token:this.meta.captchaToken},{headers:{...b}})}async _initAuthenticateOnce(a){if(!this.api)throw new cx.a("Auth flow has no API instance");let b=BZ(a);return await this.api.post(fU,{token:this.meta.captchaToken},{headers:{...b}})}async _initLinkOnce(){if(!this.api)throw new cx.a("Auth flow has no API instance");return await this.api.post(fT,{})}_transformInitLinkOptionsToCamelCase(a){return{rp:a.rp,user:{id:a.user.id,name:a.user.name,displayName:a.user.display_name},challenge:a.challenge,pubKeyCredParams:a.pub_key_cred_params.map(a=>({type:a.type,alg:a.alg})),timeout:a.timeout,excludeCredentials:a.exclude_credentials?.map(a=>({id:a.id,type:a.type,transports:a.transports})),authenticatorSelection:{authenticatorAttachment:a.authenticator_selection?.authenticator_attachment,requireResidentKey:a.authenticator_selection?.require_resident_key,residentKey:a.authenticator_selection?.resident_key,userVerification:a.authenticator_selection?.user_verification},attestation:a.attestation,extensions:{appid:a.extensions?.app_id,credProps:a.extensions?.cred_props?.rk,hmacCreateSecret:a.extensions?.hmac_create_secret},hints:this.meta.hints}}_transformRegistrationResponseToSnakeCase(a){return{id:a.id,raw_id:a.rawId,response:{client_data_json:a.response.clientDataJSON,attestation_object:a.response.attestationObject,authenticator_data:a.response.authenticatorData},authenticator_attachment:a.authenticatorAttachment,client_extension_results:{app_id:a.clientExtensionResults.appid,cred_props:a.clientExtensionResults.credProps,hmac_create_secret:a.clientExtensionResults.hmacCreateSecret},type:a.type}}_transformInitAuthenticateOptionsToCamelCase(a){return{rpId:a.rp_id,challenge:a.challenge,allowCredentials:a.allow_credentials?.map(a=>({id:a.id,type:a.type,transports:a.transports}))||[],timeout:a.timeout,extensions:{appid:a.extensions?.app_id,credProps:a.extensions?.cred_props,hmacCreateSecret:a.extensions?.hmac_create_secret},userVerification:a.user_verification}}_transformAuthenticationResponseToSnakeCase(a){return{id:a.id,raw_id:a.rawId,response:{client_data_json:a.response.clientDataJSON,authenticator_data:a.response.authenticatorData,signature:a.response.signature,user_handle:a.response.userHandle},authenticator_attachment:a.authenticatorAttachment,client_extension_results:{app_id:a.clientExtensionResults.appid,cred_props:a.clientExtensionResults.credProps,hmac_create_secret:a.clientExtensionResults.hmacCreateSecret},type:a.type}}constructor({captchaToken:a,setPasskeyAuthState:b,hints:c}){this.authenticateForRegistration=!1,this.initRegisterOnce=new B0(this._initRegisterOnce.bind(this)),this.initAuthenticateOnce=new B0(this._initAuthenticateOnce.bind(this)),this.initLinkOnce=new B0(this._initLinkOnce.bind(this)),this.meta={captchaToken:a,setPasskeyAuthState:b,hints:c}}}let Cb=({address:a,chainId:b,nonce:c})=>`${window.location.host} wants you to sign in with your Ethereum account:
${a}

By signing, you are proving you own this wallet and logging in. This does not initiate a transaction or cost any fees.

URI: ${window.location.origin}
Version: 1
Chain ID: ${b}
Nonce: ${c}
Issued At: ${(new Date).toISOString()}
Resources:
- https://privy.io`;class Cc{get meta(){return{connectorType:this.wallet?.connectorType,walletClientType:this.wallet?.walletClientType,chainId:this.wallet?.chainId,address:this.wallet?.address,disableSignup:this._meta.disableSignup}}async authenticate(){if(!this.client)throw new cx.a("SiweFlow has no client instance");try{if(this.preparedMessage&&this.signature)return await this.client.authenticateWithSiweInternal({message:this.preparedMessage,signature:this.signature,chainId:this.wallet?.chainId,walletClientType:this.walletClientType??this.wallet?.walletClientType,connectorType:this.connectorType??this.wallet?.connectorType,mode:this._meta.disableSignup?"no-signup":"login-or-sign-up"});if(!this.wallet)throw new cx.a("SiweFlow has no wallet instance");let{message:a,signature:b}=await this.sign();return await this.client.authenticateWithSiweInternal({message:a,signature:b,chainId:this.wallet.chainId,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(a){throw(0,cx.f)(a)}}async link(){if(!this.client)throw new cx.a("SiweFlow has no client instance");try{if(!this.wallet)throw new cx.a("SiweFlow has no wallet instance");let{message:a,signature:b}=await this.sign();return await this.client.linkWithSiweInternal({message:a,signature:b,chainId:this.wallet.chainId,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType})}catch(a){throw(0,cx.f)(a)}}async sign(){if(!this.client)throw new cx.a("SiweFlow has no client instance");if(await this.buildMessage(),!this.preparedMessage)throw new cx.a("Could not prepare SIWE message");if(!this.wallet)throw new cx.a("SiweFlow has no wallet instance");let a=await this.wallet.sign(this.preparedMessage);return{message:this.preparedMessage,signature:a}}async _getNonceOnce(){if(!this.client)throw new cx.a("SiweFlow has no client instance");if(!this.wallet)throw new cx.a("UI SiweFlow has no wallet instance");return await this.client.generateSiweNonce({address:this.wallet.address,captchaToken:this.captchaToken})}async buildMessage(){if(!this.client)throw new cx.a("SiweFlow has no client instance");if(!this.wallet)throw new cx.a("SiweFlow has no wallet instance");let a=this.wallet.address,b=this.wallet.chainId.replace("eip155:","");return this.nonce||(this.nonce=await this.getNonceOnce.execute()),this.preparedMessage=Cb({address:a,chainId:b,nonce:this.nonce}),this.preparedMessage}constructor(a,b,c,d=!1,e){this._meta={disableSignup:!1},this.getNonceOnce=new B0(this._getNonceOnce.bind(this)),this.wallet=b,this.captchaToken=c,this.client=a,this._meta.disableSignup=d,this.preparedMessage=e?.message,this.signature=e?.signature,this.walletClientType=e?.walletClientType,this.connectorType=e?.connectorType}}class Cd{get meta(){return{connectorType:this.wallet.connectorType,walletClientType:this.wallet.walletClientType,disableSignup:this._meta.disableSignup,messageType:this._meta.messageType,address:this.wallet?.address}}set messageType(a){this._meta.messageType=a}async authenticate(){if(!this.client)throw new cx.a("SiwsFlow has no client instance");try{let{message:a,signature:b}=await this.sign();return await this.client.authenticateWithSiwsInternal({message:a,signature:b,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up",messageType:this.meta.messageType})}catch(a){throw(0,cx.f)(a)}}async link(){if(!this.client)throw new cx.a("SiwsFlow has no client instance");try{let{message:a,signature:b}=await this.sign();return await this.client.linkWithSiwsInternal({message:a,signature:b,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType,messageType:this.meta.messageType})}catch(a){throw(0,cx.f)(a)}}async sign(){let a,b;if(!this.client)throw new cx.a("SiwsFlow has no client instance");await this.buildMessage();let c="transaction"===this.meta.messageType;if(!this.preparedMessage)throw new cx.a("Could not prepare SIWS message");if(!c&&!this.wallet.provider.signMessage||c&&!this.wallet.provider.signTransaction)throw new cx.a("Wallet does not support the necessary signing methods");if(c&&this._plugin){let c=await this.wallet.provider.signTransaction({transaction:gf.base64.decode(this.preparedMessage)});a=gf.base64.encode(c.signedTransaction),b=this._plugin.getSignatureFromTransaction(c.signedTransaction,this.wallet.address)}else{a=this.preparedMessage;let c=await this.wallet.provider.signMessage({message:(new TextEncoder).encode(this.preparedMessage)});b=gf.base64.encode(c.signature)}return{message:a,signature:b}}async _getNonceOnce(){if(!this.client)throw new cx.a("SiwsFlow has no client instance");return await this.client.generateSiwsNonce({address:this.wallet.address,captchaToken:this.captchaToken})}async buildMessage(){if(!this.client)throw new cx.a("SiwsFlow has no client instance");let a=this.wallet.address;return this.nonce||(this.nonce=await this.getNonceOnce.execute()),"transaction"===this.meta.messageType&&this._plugin?this.preparedMessage=this._plugin.createSiwsMemoTransaction({address:a,nonce:this.nonce}):this.preparedMessage=(0,ge.p)({address:a,nonce:this.nonce}),this.preparedMessage}constructor(a,b,c,d=!1,e="plain",f){this._meta={disableSignup:!1,messageType:"plain"},this.getNonceOnce=new B0(this._getNonceOnce.bind(this)),this.wallet=a,this.captchaToken=c,this.client=b,this._meta.disableSignup=d,this._meta.messageType=e,this._plugin=f}}class Ce{async authenticate(){if(!this.api)throw new cx.a("Auth flow has no API instance");if(!this.meta.phoneNumber||!this.meta.smsCode)throw new cx.a("phone number and sms code must be set prior to calling authenticate.");try{return await this.api.post(fL,{phoneNumber:this.meta.phoneNumber,code:this.meta.smsCode,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(a){throw(0,cx.f)(a)}}async link(){if(!this.api)throw new cx.a("Auth flow has no API instance");if(!this.meta.phoneNumber||!this.meta.smsCode)throw new cx.a("phone number and sms code must be set prior to calling authenticate.");try{return await this.api.post(fJ,{phoneNumber:this.meta.phoneNumber,code:this.meta.smsCode})}catch(a){throw(0,cx.f)(a)}}async sendSmsCode({phoneNumber:a,captchaToken:b,withPrivyUi:c}){if(!this.api)throw new cx.a("Auth flow has no API instance");if(a&&(this.meta.phoneNumber=a),b&&(this.meta.captchaToken=b),!this.meta.phoneNumber)throw new cx.a("phone nNumber must be set when initialzing authentication.");let d=BZ(c);try{return await this.api.post(fI,{phoneNumber:this.meta.phoneNumber,token:this.meta.captchaToken},{headers:{...d}})}catch(a){throw(0,cx.f)(a)}}constructor({phoneNumber:a,captchaToken:b,disableSignup:c}){this.meta={phoneNumber:a,captchaToken:b,disableSignup:c??!1}}}class Cf extends Ce{async link(){if(!this.api)throw new cx.a("Auth flow has no API instance");if(!this.meta.phoneNumber||!this.meta.smsCode||!this.meta.oldPhoneNumber)throw new cx.a("Phone number, sms code, and an old phone number must be set prior to calling update.");try{return await this.api.post(fM,{old_phone_number:this.meta.oldPhoneNumber,new_phone_number:this.meta.phoneNumber,code:this.meta.smsCode})}catch(a){throw(0,cx.f)(a)}}constructor(a,b,c){super({phoneNumber:b,captchaToken:c}),this.meta={phoneNumber:b,captchaToken:c,oldPhoneNumber:a,disableSignup:!1}}}let Cg=(0,R.createContext)({enabled:!1,siteKey:"",provider:void 0,appId:void 0,token:void 0,error:void 0,status:"disabled",setToken:cx.n,setError:cx.n,setExecuting:cx.n,waitForResult:()=>Promise.resolve(""),ref:{current:null},remove:cx.d,reset:cx.n,execute:cx.n});class Ch extends cx.c{constructor(a,b,c){super(a||"Captcha failed"),this.type="Captcha",b instanceof Error&&(this.cause=b),this.privyErrorCode=c}}let Ci=({children:a,appId:b,captchaSiteKey:c,enabledCaptchaProvider:d})=>{let e=(0,R.useRef)(null),f=(0,R.useRef)(null),[g,h]=(0,R.useState)(),[i,j]=(0,R.useState)(),[k,l]=(0,R.useState)(!1),m=(0,R.useMemo)(()=>d?k||g||i?!k||g||i?g&&!i?{status:"success",token:g}:i?{status:"error",error:i}:{status:"ready"}:{status:"loading"}:{status:"ready"}:{status:"disabled"},[d,g,i,k]),n=(0,R.useMemo)(()=>d?"turnstile"===d?{remove:()=>{e.current?.remove(),l(!1),j(void 0),h(void 0)},reset:()=>{e.current?.reset(),l(!1),j(void 0),h(void 0)},execute:()=>{l(!0),e.current?.execute()},waitForResult:async()=>{try{return await (0,cv.p)(()=>e.current?.getResponse(),{interval:200,timeout:2e4})}catch(a){throw new Ch("Captcha failed",null,cx.b.CAPTCHA_TIMEOUT)}}}:{remove:()=>{f.current?.removeCaptcha(),l(!1),j(void 0),h(void 0)},reset:()=>{f.current?.resetCaptcha(),l(!1),j(void 0),h(void 0)},execute:()=>{l(!0),f.current?.execute()},waitForResult:async()=>{try{return await (0,cv.p)(()=>f.current?.getResponse(),{interval:200,timeout:2e4})}catch(a){throw new Ch("Captcha failed",null,cx.b.CAPTCHA_TIMEOUT)}}}:null,[d]),o=(0,R.useMemo)(()=>{if(!d||!n)return{...m,enabled:!1,siteKey:"",appId:b,setToken:cx.n,setError:cx.n,setExecuting:cx.n,waitForResult:()=>Promise.resolve(void 0),remove:cx.d,reset:cx.n,execute:cx.n,provider:void 0,ref:{current:null}};let a={...m,enabled:!0,appId:b,setToken:h,setError:j,setExecuting:l};return"turnstile"===d?{...a,provider:"turnstile",ref:e,siteKey:c.split("t:")[1]??"",...n}:{...a,provider:"hcaptcha",ref:f,siteKey:c.split("h:")[1]??"",...n}},[m,d,n,b,c]);return(0,Q.jsx)(Cg.Provider,{value:o,children:a})},Cj=()=>(0,R.useContext)(Cg);class Ck{async authenticate(){if(!this.api)throw new cx.a("Auth flow has no API instance");try{return await this.api.post(fZ,{captcha_token:this.meta.captchaToken,telegram_auth_result:this.meta.telegramAuthResult,telegram_web_app_data:this.meta.telegramWebAppData,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(a){throw(0,cx.f)(a)}}async link(){if(!this.api)throw new cx.a("Auth flow has no API instance");try{return await this.api.post(f$,{telegram_auth_result:this.meta.telegramAuthResult,telegram_web_app_data:this.meta.telegramWebAppData})}catch(a){throw(0,cx.f)(a)}}constructor(a,b=!1){this.meta={disableSignup:!1},this.meta={captchaToken:a,disableSignup:!1},this.meta.disableSignup=b}}function Cl(a){let b={detail:"",retryable:!1};return a?.privyErrorCode===cx.b.LINKED_TO_ANOTHER_USER&&(b.detail="This account has already been linked to another user."),a?.privyErrorCode===cx.b.DISALLOWED_LOGIN_METHOD&&(b.detail="Login with Telegram not allowed."),a?.privyErrorCode===cx.b.INVALID_DATA&&(b.retryable=!0,b.detail="Something went wrong. Try again."),a?.privyErrorCode===cx.b.CANNOT_LINK_MORE_OF_TYPE&&(b.retryable=!0,b.detail="Something went wrong. Try again."),a?.privyErrorCode===cx.b.INVALID_CREDENTIALS&&(b.retryable=!0,b.detail="Something went wrong. Try again."),a?.privyErrorCode===cx.b.TOO_MANY_REQUESTS&&(b.detail="Too many requests. Please wait before trying again."),a?.privyErrorCode===cx.b.TOO_MANY_REQUESTS&&a.message.includes("rate limit")&&(b.detail="Request limit reached for Telegram. Please wait a moment and try again."),a instanceof Ch&&(b.retryable=!0,b.detail="Something went wrong. Try again."),b}function Cm(a){return Object.fromEntries(decodeURIComponent(a).split("&").map(a=>a.split("=").map(decodeURIComponent)))}function Cn(){let a=new URL(window.location.href);a.searchParams.delete("id"),a.searchParams.delete("hash"),a.searchParams.delete("auth_date"),a.searchParams.delete("first_name"),a.searchParams.delete("last_name"),a.searchParams.delete("username"),a.searchParams.delete("photo_url"),a.hash="",window.history.replaceState({},"",a)}let Co=(0,R.lazy)(()=>a.A(754945)),Cp=(0,R.lazy)(()=>a.A(468956)),Cq=a=>{let b=Cj();return(0,R.useEffect)(()=>b.remove,[b.remove]),b.enabled&&b.provider?(0,Q.jsx)(R.Suspense,{fallback:null,children:(0,Q.jsxs)("div",{className:"hidden h-0 w-0",children:["turnstile"===b.provider&&(0,Q.jsx)(Co,{...a,captchaContext:b}),"hcaptcha"===b.provider&&(0,Q.jsx)(Cp,{...a,captchaContext:b})]})}):null};var Cr=Object.freeze({__proto__:null,AccountNotFoundScreen:()=>a.A(449912),AffirmativeConsentScreen:()=>a.A(364441),AllowlistRejectionScreen:()=>a.A(218629),AuthenticateWithWalletScreen:()=>a.A(508491),AwaitingEvmToSolBridgingScreen:()=>a.A(335327),AwaitingExternalEthereumTransferScreen:()=>a.A(480583),AwaitingPasswordlessCodeScreen:()=>a.A(763254),AwaitingSolToEvmBridgingScreen:()=>a.A(877561),CaptchaScreen:()=>a.A(598221),CoinbaseOnrampStatusScreen:()=>a.A(879784),ConnectLedgerScreen:()=>a.A(217206),ConnectOnlyLandingScreen:()=>a.A(91689),ConnectOnlyStatusScreen:()=>a.A(311156),ConnectOrCreateScreen:()=>a.A(551629),ConnectionStatusScreen:()=>a.A(817464),CrossAppAuthScreen:()=>a.A(536642),DelegatedActionsConsentScreen:()=>a.A(299832),DelegatedActionsRevokeScreen:()=>a.A(109932),EmbeddedWalletConnectingScreen:()=>a.A(397715),EmbeddedWalletCreatedScreen:()=>a.A(4551),EmbeddedWalletKeyExportScreen:()=>a.A(645956),EmbeddedWalletOnAccountCreateScreen:()=>a.A(446195),EmbeddedWalletPasswordCreateScreen:()=>a.A(871057),EmbeddedWalletPasswordUpdateScreen:()=>a.A(195068),EmbeddedWalletPasswordUpdateSplashScreen:()=>a.A(259480),ErrorScreen:()=>a.A(293373),FarcasterConnectStatusScreen:()=>a.A(213872),FarcasterSignerStatusScreen:()=>a.A(175888),FundSolWalletWithExternalSolanaWallet:()=>a.A(591550),FundingAmountEditScreen:()=>a.A(652282),FundingMethodSelectionScreen:()=>a.A(391737),InAppBrowserLoginNotPossible:()=>a.A(93194),InstallWalletScreen:()=>a.A(224341),LandingScreen:()=>a.A(839181),LinkConflictScreen:()=>a.A(603955),LinkEmailScreen:()=>a.A(155145),LinkPasskeyScreen:()=>a.A(873533),LinkPhoneScreen:()=>a.A(479966),LoginFailedScreen:()=>a.A(483249),ManualTransferScreen:()=>a.A(714286),MfaAuthEnrollmentFlowScreen:()=>a.A(720282),MfaAuthVerifyFlowScreen:()=>a.A(29226),MfaEnrollmentFlowScreen:()=>a.A(423974),MoonpayStatusScreen:()=>a.A(331331),OAuthStatusScreen:()=>a.A(693420),PasskeySelectSignupOrLogin:()=>a.A(167940),PasskeyStatusScreen:()=>a.A(201601),PasswordRecoveryScreen:()=>a.A(644244),RecoveryOAuthScreen:()=>a.A(365095),RecoverySelectionScreen:()=>a.A(325719),SendTransactionScreen:()=>a.A(686749),SetAutomaticRecoveryScreen:()=>a.A(208012),SignRequestScreen:()=>a.A(859483),StandardSignAndSendTransactionScreen:()=>a.A(435777),TelegramAuthScreen:()=>a.A(155175),TransferFromWalletScreen:()=>a.A(31085),UpdateEmailScreen:()=>a.A(726423),UpdatePhoneScreen:()=>a.A(671295),UserLimitReachedScreen:()=>a.A(570680),WalletInterstitialScreen:()=>a.A(232095)});let Cs=(0,gi.create)(()=>({inProgressMfaFlow:void 0})),Ct=(0,gg.createGlobalStyle)([":root{","};"],a=>Cu(a.palette)),Cu=a=>(0,gg.css)(["",""],Object.entries({"--privy-color-background":a.background,"--privy-color-background-2":a.background2,"--privy-color-background-3":a.background3,"--privy-color-foreground":a.foreground,"--privy-color-foreground-2":a.foreground2,"--privy-color-foreground-3":a.foreground3,"--privy-color-foreground-4":a.foreground4,"--privy-color-foreground-accent":a.foregroundAccent,"--privy-color-accent":a.accent,"--privy-color-accent-light":a.accentLight,"--privy-color-accent-hover":a.accentHover,"--privy-color-accent-dark":a.accentDark,"--privy-color-accent-darkest":a.accentDarkest,"--privy-color-success":a.success,"--privy-color-success-dark":a.successDark,"--privy-color-success-light":a.successLight,"--privy-color-success-bg":a.successBg,"--privy-color-error":a.error,"--privy-color-error-light":a.errorLight,"--privy-color-error-bg":a.errorBg,"--privy-color-error-bg-hover":a.errorBgHover,"--privy-color-warn":a.warn,"--privy-color-warn-light":a.warnLight,"--privy-color-warn-bg":a.warnBg,"--privy-color-warning-dark":a.warningDark,"--privy-color-error-dark":a.errorDark,"--privy-color-info-bg":a.infoBg,"--privy-color-info-bg-hover":a.infoBgHover,"--privy-color-border-default":a.borderDefault,"--privy-color-border-hover":a.borderHover,"--privy-color-border-focus":a.borderFocus,"--privy-color-border-error":a.borderError,"--privy-color-border-success":a.borderSuccess,"--privy-color-border-warning":a.borderWarning,"--privy-color-border-info":a.borderInfo,"--privy-color-border-interactive":a.borderInteractive,"--privy-color-border-interactive-hover":a.borderInteractiveHover,"--privy-color-background-hover":a.backgroundHover,"--privy-color-background-clicked":a.backgroundClicked,"--privy-color-background-disabled":a.backgroundDisabled,"--privy-color-background-interactive":a.backgroundInteractive,"--privy-color-background-interactive-hover":a.backgroundInteractiveHover,"--privy-color-background-interactive-clicked":a.backgroundInteractiveClicked,"--privy-color-background-interactive-disabled":a.backgroundInteractiveDisabled,"--privy-color-foreground-hover":a.foregroundHover,"--privy-color-foreground-clicked":a.foregroundClicked,"--privy-color-foreground-disabled":a.foregroundDisabled,"--privy-color-foreground-interactive":a.foregroundInteractive,"--privy-color-foreground-interactive-hover":a.foregroundInteractiveHover,"--privy-link-navigation-color":a.linkNavigationColor,"--privy-link-navigation-decoration":a.linkNavigationDecoration,"--privy-accent-has-good-contrast":a.accentHasGoodContrast,"--privy-color-icon-default":a.iconDefault,"--privy-color-icon-muted":a.iconMuted,"--privy-color-icon-subtle":a.iconSubtle,"--privy-color-icon-inverse":a.iconInverse,"--privy-color-icon-success":a.iconSuccess,"--privy-color-icon-warning":a.iconWarning,"--privy-color-icon-error":a.iconError,"--privy-color-icon-interactive":a.iconInteractive,"--privy-color-icon-default-hover":a.iconDefaultHover,"--privy-color-icon-muted-hover":a.iconMutedHover,"--privy-color-icon-subtle-hover":a.iconSubtleHover,"--privy-color-icon-default-clicked":a.iconDefaultClicked,"--privy-color-icon-muted-clicked":a.iconMutedClicked,"--privy-color-icon-subtle-clicked":a.iconSubtleClicked,"--privy-color-icon-default-disabled":a.iconDefaultDisabled,"--privy-color-icon-muted-disabled":a.iconMutedDisabled,"--privy-color-icon-subtle-disabled":a.iconSubtleDisabled,"--privy-color-icon-error-hover":a.iconErrorHover,"--privy-color-icon-interactive-hover":a.iconInteractiveHover,"--privy-color-icon-error-clicked":a.iconErrorClicked,"--privy-color-icon-interactive-clicked":a.iconInteractiveClicked,"--privy-color-icon-muted-disabled-alt":a.iconMutedDisabledAlt,"--privy-color-icon-subtle-disabled-alt":a.iconSubtleDisabledAlt,"--privy-border-radius-xs":"6px","--privy-border-radius-sm":"8px","--privy-border-radius-md":"12px","--privy-border-radius-mdlg":"16px","--privy-border-radius-lg":"24px","--privy-border-radius-full":"9999px","--privy-height-modal-full":"620px","--privy-height-modal-compact":"480px"}).map(([a,b])=>`${a}: ${b};`).join("\n")),Cv=gg.styled.div.withConfig({displayName:"StylesWrapper",componentId:"sc-188229e4-0"})([""," color:var(--privy-color-foreground-2);h3{font-size:16px;line-height:24px;font-weight:500;color:var(--privy-color-foreground-2);}h4{font-size:14px;line-height:20px;font-weight:500;color:var(--privy-color-foreground);}p{font-size:13px;line-height:20px;color:var(--privy-color-foreground-2);}button:focus,input:focus,optgroup:focus,select:focus,textarea:focus{outline:none;border-color:var(--privy-color-accent-light);box-shadow:0 0 0 3px var(--privy-color-border-focus);}.mobile-only{@media (min-width:441px){display:none;}}@keyframes fadein{0%{opacity:0;}100%{opacity:1;}}"],"\n  *,\n  ::before,\n  ::after {\n    box-sizing: border-box;\n    border-width: 0;\n    border-style: solid;\n  }\n\n  line-height: 1.15;\n  -webkit-text-size-adjust: 100%;\n  -moz-tab-size: 4;\n  tab-size: 4;\n  font-feature-settings: normal;\n\n  margin: 0;\n  font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif,\n    'Apple Color Emoji', 'Segoe UI Emoji';\n\n  hr {\n    height: 0;\n    color: inherit;\n    border-top-width: 1px;\n  }\n\n  abbr:where([title]) {\n    text-decoration: underline dotted;\n  }\n\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6 {\n    font-size: inherit;\n    font-weight: inherit;\n    font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif,\n    'Apple Color Emoji', 'Segoe UI Emoji';\n    display: inline;\n  }\n\n  a {\n    color: inherit;\n    text-decoration: inherit;\n  }\n\n  b,\n  strong {\n    font-weight: bolder;\n  }\n\n  code,\n  kbd,\n  samp,\n  pre {\n    font-family: ui-monospace, SFMono-Regular, Consolas, 'Liberation Mono', Menlo, monospace;\n    font-size: 1em;\n  }\n\n  small {\n    font-size: 80%;\n  }\n\n  sub,\n  sup {\n    font-size: 75%;\n    line-height: 0;\n    position: relative;\n    vertical-align: baseline;\n  }\n\n  sub {\n    bottom: -0.25em;\n  }\n\n  sup {\n    top: -0.5em;\n  }\n\n  table {\n    text-indent: 0;\n    border-color: inherit;\n    border-collapse: collapse;\n  }\n\n  button,\n  input,\n  optgroup,\n  select,\n  textarea {\n    font-family: inherit;\n    font-size: 100%;\n    font-weight: inherit;\n    line-height: inherit;\n    color: inherit;\n    margin: 0;\n    padding: 0;\n  }\n\n  button,\n  select {\n    text-transform: none;\n  }\n\n  button,\n  [type='button'],\n  [type='reset'],\n  [type='submit'] {\n    -webkit-appearance: button;\n    background-color: transparent;\n    background-image: none;\n  }\n\n  ::-moz-focus-inner {\n    border-style: none;\n    padding: 0;\n  }\n\n  :-moz-focusring {\n    outline: 1px dotted ButtonText;\n  }\n\n  :-moz-ui-invalid {\n    box-shadow: none;\n  }\n\n  legend {\n    padding: 0;\n  }\n\n  progress {\n    vertical-align: baseline;\n  }\n\n  ::-webkit-inner-spin-button,\n  ::-webkit-outer-spin-button {\n    height: auto;\n  }\n\n  [type='search'] {\n    -webkit-appearance: textfield;\n    outline-offset: -2px;\n  }\n\n  ::-webkit-search-decoration {\n    -webkit-appearance: none;\n  }\n\n  ::-webkit-file-upload-button {\n    -webkit-appearance: button;\n    font: inherit;\n  }\n\n  summary {\n    display: list-item;\n  }\n\n  blockquote,\n  dl,\n  dd,\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6,\n  hr,\n  figure,\n  p,\n  pre {\n    margin: 0;\n  }\n\n  fieldset {\n    margin: 0;\n    padding: 0;\n  }\n\n  legend {\n    padding: 0;\n  }\n\n  ol,\n  ul,\n  menu {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n\n  textarea {\n    resize: vertical;\n  }\n\n  input::placeholder,\n  textarea::placeholder {\n    opacity: 1;\n    color: #9ca3af;\n  }\n\n  button,\n  [role='button'] {\n    cursor: pointer;\n  }\n\n  :disabled {\n    cursor: default;\n  }\n\n  img,\n  svg,\n  video,\n  canvas,\n  audio,\n  iframe,\n  embed,\n  object {\n    display: block;\n  }\n\n  img,\n  video {\n    max-width: 100%;\n    height: auto;\n  }\n\n  [hidden] {\n    display: none;\n  }\n"),Cw=({children:a,open:b,onClick:c,...d})=>(0,Q.jsx)(g1,{show:b,as:R.default.Fragment,children:(0,Q.jsxs)(iO,{onClose:c,...d,as:Cy,children:[(0,Q.jsx)(g0,{as:R.default.Fragment,enterFrom:"entering",leaveTo:"leaving",children:(0,Q.jsx)(Cx,{id:"privy-dialog-backdrop","aria-hidden":"true"})}),(0,Q.jsx)(Cz,{children:(0,Q.jsx)(g0,{as:R.default.Fragment,enterFrom:"entering",leaveTo:"leaving",children:(0,Q.jsx)(iN,{as:CA,children:a})})})]})}),Cx=gg.styled.div.withConfig({displayName:"Backdrop",componentId:"sc-3cfde0b5-0"})(["position:fixed;inset:0;transition:backdrop-filter 100ms ease;backdrop-filter:blur(3px);-webkit-backdrop-filter:blur(3px);&.entering,&.leaving{backdrop-filter:unset;-webkit-backdrop-filter:unset;}"]),Cy=gg.styled.div.withConfig({displayName:"DialogWrapper",componentId:"sc-3cfde0b5-1"})(["position:relative;z-index:999999;"]),Cz=gg.styled.div.withConfig({displayName:"DialogContainer",componentId:"sc-3cfde0b5-2"})(["position:fixed;inset:0;display:flex;align-items:center;justify-content:center;width:100vw;min-height:100vh;"]),CA=gg.styled.div.withConfig({displayName:"Panel",componentId:"sc-3cfde0b5-3"})(["padding:0;background:transparent;border:none;width:100%;pointer-events:auto;outline:none;display:block;@media (max-width:440px){opacity:1;transform:translate3d(0,0,0);transition:transform 200ms ease-in;position:fixed;bottom:0;&.entering,&.leaving{opacity:0;transform:translate3d(0,100%,0);transition:transform 150ms ease-in 0ms,opacity 0ms ease 150ms;}}@media (min-width:441px){opacity:1;transition:opacity 100ms ease-in;&.entering,&.leaving{opacity:0;transition-delay:5ms;}margin:auto;width:360px;box-shadow:0px 8px 36px rgba(55,65,81,0.15);border-radius:var(--privy-border-radius-lg);}"]),CB=(0,R.lazy)(()=>a.A(466164)),CC=(0,R.lazy)(()=>Cr.MfaAuthVerifyFlowScreen().then(a=>({default:a.default.component}))),CD=()=>(0,Q.jsx)(CJ,{children:(0,Q.jsx)(cv.L,{})}),CE=()=>{let{currentScreen:a}=(0,ct.a)(),b=Cs(a=>a.inProgressMfaFlow),c=()=>Cs.setState({inProgressMfaFlow:void 0}),{component:d,isLoading:e}=(()=>{let{ready:a}=(0,ct.u)(),{currentScreen:b}=(0,ct.a)(),[c,d]=(0,R.useState)(null),[e,f]=(0,R.useState)(!1),g=function(a){let[b,c]=(0,R.useState)(!1),d=(0,R.useRef)(null),e=(0,R.useRef)(null),f=(0,R.useRef)(null);return(0,R.useEffect)(()=>{if(d.current&&(clearTimeout(d.current),d.current=null),e.current&&(clearTimeout(e.current),e.current=null),a)f.current=Date.now(),d.current=setTimeout(()=>{c(!0)},150);else if(null!==f.current){let a=Date.now()-f.current;a>=150?e.current=setTimeout(()=>{c(!1),f.current=null},Math.max(0,400-(a-150))):(d.current&&(clearTimeout(d.current),d.current=null),c(!1),f.current=null)}return()=>{d.current&&clearTimeout(d.current),e.current&&clearTimeout(e.current)}},[a]),b}(e);return(0,R.useEffect)(()=>{b?(f(!0),Cr[b]().then(c=>{(!b||a||c.default.isShownBeforeReady)&&(d(()=>c.default.component),f(!1))}).catch(()=>{d(null),f(!1)})):(d(null),f(!1))},[b,a]),{component:c,isLoading:g}})();return function(){let{isModalOpen:a}=(0,ct.u)(),{headless:b}=(0,fb.u)(),{currentScreen:c}=(0,ct.a)(),{status:d,execute:e,reset:f,enabled:g}=Cj(),[h,i]=(0,R.useState)(!1);(0,R.useEffect)(()=>{!a&&g&&f()},[a,g,f]),(0,R.useEffect)(()=>{c?Cr[c]().then(a=>{i(!!a.default.isCaptchaRequired)}).catch(()=>{i(!1)}):i(!1)},[c]),(0,R.useEffect)(()=>{a&&h&&!b&&"ready"===d&&g&&e()},[a,h,b,d,g,e])}(),a||"txn"!==b?e?(0,Q.jsx)(CD,{}):d?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(cv.H,{$if:!!b,children:(0,Q.jsx)(R.Suspense,{children:(0,Q.jsx)(d,{})})}),(0,Q.jsxs)(R.Suspense,{children:["txn"===b&&(0,Q.jsx)(CB,{onClose:c}),"auth"===b&&(0,Q.jsx)(CC,{})]})]}):null:(0,Q.jsxs)(R.Suspense,{children:[(0,Q.jsx)(CB,{onClose:c}),";"]})},CF=()=>{let a=(0,R.useRef)(null);return(0,Q.jsx)(CI,{style:{height:(0,cv.u)(a)},id:"privy-modal-content",children:(0,Q.jsx)("div",{ref:a,children:(0,Q.jsx)(CE,{})})})},CG=({open:a})=>{var b;let c=(0,fb.u)(),{gracefulClosePrivyModal:d}=(()=>{let{closePrivyModal:a}=(0,cx.u)(),{onUserCloseViaDialogOrKeybindRef:b}=(0,ct.a)();return{gracefulClosePrivyModal:(0,R.useCallback)(()=>{if(!b?.current)return a({shouldCallAuthOnSuccess:!1});b.current()},[a])}})(),e=Cs(a=>a.inProgressMfaFlow);return b={onMfaRequired:()=>{c.mfa.noPromptOnMfaRequired||Cs.setState({inProgressMfaFlow:"txn"})}},(0,gh.u)("configureMfa",b),c.render.standalone?(0,Q.jsx)(Cv,{children:(0,Q.jsx)(CH,{id:"privy-modal-content",children:(0,Q.jsx)(CE,{})})}):(0,Q.jsx)(Cw,{open:!(!a&&!e),id:"privy-dialog","aria-label":"log in or sign up","aria-labelledby":"privy-dialog-title",onClick:()=>d(),children:(0,Q.jsx)(Cv,{children:(0,Q.jsx)(CF,{})})})},CH=gg.styled.div.withConfig({displayName:"ContentWrapper",componentId:"sc-9b080f09-0"})(["display:flex;flex-direction:column;text-align:center;font-size:14px;line-height:20px;width:100%;background:var(--privy-color-background);padding:0 16px;"]),CI=(0,gg.styled)(CH).withConfig({displayName:"BaseModal",componentId:"sc-9b080f09-1"})(["transition:height 150ms ease-out;overflow-x:hidden;overflow-y:auto;scrollbar-width:none;max-height:calc(100svh - 32px);border-radius:var(--privy-border-radius-lg) var(--privy-border-radius-lg) 0 0;box-shadow:0px 0px 36px rgba(55,65,81,0.15);@media (min-width:441px){box-shadow:0px 8px 36px rgba(55,65,81,0.15);border-radius:var(--privy-border-radius-lg);}"]),CJ=gg.styled.div.withConfig({displayName:"LoadingScreenContainer",componentId:"sc-9b080f09-2"})(["display:flex;align-items:center;justify-content:center;min-height:300px;padding:2rem;"]);function CK(a){let b=(0,R.useRef)(null),c=(0,R.useRef)();return(0,R.useEffect)(()=>{c.current?.remove(),c.current=function({botUsername:a,scriptHost:b}){let c=document.createElement("script"),{origin:d}=new URL(b);return c.async=!0,c.src=`${d}/js/telegram-login.js`,c.setAttribute("data-telegram-login",a),c.setAttribute("data-request-access","write"),c.setAttribute("data-lang","en"),c}(a),b.current?.after(c.current)},[a]),(0,Q.jsx)("div",{ref:b,hidden:!0})}let CL=()=>{let{ready:a}=(0,cw.u)(),{client:b}=(0,cx.u)();return(0,R.useEffect)(()=>{let c=()=>{if(!b.connectors||!a)return;let c=b.connectors.wallets.map(a=>({address:a.address,connectorType:a.connectorType,walletClientType:a.walletClientType,connectedAt:a.connectedAt,id:a.meta.id}));cy.u.put(fb.b,c)};return b.connectors?.on("walletsUpdated",c),()=>{b.connectors?.off("walletsUpdated",c)}},[a,b.connectors]),null};class CM extends cv.E{async initialize(){let a=await this.createProvider();this.provider=a,this.proxyProvider.setWalletProvider(a),this.subscribeListeners(),a.session&&(this.walletProvider?.session?.peer.metadata.url&&(this.walletEntry=(0,cv.g)(this.walletProvider?.session?.peer.metadata.url),this.walletClientType=this.walletEntry?.slug||"unknown"),this.connected=!0,await this.syncAccounts()),this.initialized=!0,this.emit("initialized")}async connect(a){return a.showPrompt&&await this.promptConnection(),this.getConnectedWallet()}async isConnected(){return!!this.walletProvider?.connected}get walletBranding(){let a=this.walletProvider?.session?.peer.metadata.icons?.[0];return{name:(0,cv.s)(this.walletProvider?.session?.peer.metadata.name||"")||"WalletConnect",icon:"string"==typeof a?a:cy.W,id:this.walletProvider?.session?.peer.metadata.name.toLowerCase()||"wallet_connect_v2"}}async resetConnection(a){this.walletProvider&&this.walletProvider.connected&&(await this.walletProvider.disconnect(),this.walletProvider.signer.session=void 0,this.walletClientType=a,this.redirectUri=void 0,this.fallbackUniversalRedirectUri=void 0,(0,ge.d)(),this.onDisconnect())}async promptConnection(){if(this.provider)return new Promise((a,b)=>{(async()=>{let b="",c=await Promise.race([this.walletProvider?.enable(),this.proxyProvider.walletTimeout()]);if(c?.length&&(b=c[0]),!b||""===b)throw new cx.P("Unable to retrieve address");this.walletProvider?.session?.peer.metadata.url&&(this.walletEntry=(0,cv.g)(this.walletProvider?.session?.peer.metadata.url),this.walletClientType=this.walletEntry?.slug||"unknown",this.proxyProvider.rpcTimeoutDuration=(0,cv.c)(this.rpcConfig,this.walletClientType)),this.connected=!0,await this.syncAccounts(c),a()})().catch(a=>{b(a?(0,cy.f)(a):new cx.P("Unknown error during connection"))})})}disconnect(){this.walletProvider?.disconnect().then(()=>this.onDisconnect()).catch(()=>console.warn("Unable to disconnect WalletConnect provider"))}get walletProvider(){return this.proxyProvider.walletProvider}setWalletProvider(a){this.proxyProvider.setWalletProvider(a)}async createProvider(){let a={};for(let b of this.chains){let c=(0,cv.a)(b.id,this.chains,this.rpcConfig,this.privyAppId);c&&(a[b.id]=c)}let b=this.shouldEnforceDefaultChainOnConnect?[this.defaultChain.id]:[],c=this.chains.map(a=>a.id),d=await wy.init({projectId:this.walletConnectCloudProjectId,chains:b,optionalChains:c,optionalEvents:wl,optionalMethods:wj,rpcMap:a,showQrModal:!1,metadata:{description:this.privyAppName,name:this.privyAppName,url:window.location.origin,icons:[]}});return d.on("display_uri",a=>{if(d.signer.abortPairingAttempt(),(0,ge.r)(),!this.showPrivyQrModal)throw new cx.P("WalletConnect modal not available - Privy handles wallet connections through its own UI");if(fc.isMobile&&this.walletEntry){let{redirect:b,href:c}=(0,ge.b)(a,this.walletEntry);(0,ge.o)(b,"_self"),(0,ge.s)({href:c,name:this.walletEntry.metadata?.shortName||this.walletEntry.name});let d=(0,ge.a)(a,this.walletEntry);return this.redirectUri=b,this.fallbackUniversalRedirectUri=d?.redirect,this.showPrivyQrModal({native:b,universal:b})}if(this.redirectUri=void 0,this.walletEntry){let b=(0,ge.a)(a,this.walletEntry);this.fallbackUniversalRedirectUri=b?.redirect}this.showPrivyQrModal({native:a,universal:void 0})}),d.on("connect",()=>{d.session?.peer.metadata.url&&(this.walletEntry=(0,cv.g)(d.session?.peer.metadata.url),this.walletClientType=this.walletEntry?.slug||"unknown")}),d}async enableProvider(){return this.walletProvider?.connected?Promise.resolve(this.walletProvider.accounts):await this.walletProvider?.enable()}setWalletEntry(a,b){this.walletEntry=a,this.showPrivyQrModal=b}constructor({walletConnectCloudProjectId:a,rpcConfig:b,chains:c,defaultChain:d,shouldEnforceDefaultChainOnConnect:e,privyAppId:f,privyAppName:g,walletClientType:h}){super(h||"unknown",c,d,b),this.connectorType="wallet_connect_v2",this.privyAppId=f,this.privyAppName=g,this.walletConnectCloudProjectId=a,this.rpcConfig=b,this.shouldEnforceDefaultChainOnConnect=e,this.proxyProvider=new cv.P(void 0,this.rpcTimeoutDuration),h&&(this.walletEntry=(0,cv.b)(h),this.walletClientType=h)}}let CN=["error","invalid_request_arguments","wallet_not_on_device","invalid_recovery_pin","insufficient_funds","missing_or_invalid_mfa","mfa_verification_max_attempts_reached","mfa_timeout","twilio_verification_failed"];class CO extends Error{constructor(a,b){super(b),this.type=a}}function CP(a){let b=a.type;return"string"==typeof b&&CN.includes(b)}function CQ(a){return CP(a)&&"wallet_not_on_device"===a.type}function CR(a){return CP(a)&&("invalid_recovery_pin"===a.type||"invalid_request_arguments"===a.type)}function CS(a){return!!CP(a)&&"mfa_timeout"===a.type}function CT(a){return!!CP(a)&&"missing_or_invalid_mfa"===a.type}function CU(a){return!!CP(a)&&"mfa_verification_max_attempts_reached"===a.type}function CV(a){return!(!CP(a)||!a.message.includes("code 429"))}function CW(a){let b;return"string"==typeof(b=a.type)&&"client_error"===b&&"MFA canceled"===a.message}async function CX(a,b,c,d,e,f=!1){let g=f,h=async h=>{if(g&&b&&b.length>0){h===+!f?e("configureMfa","onMfaRequired",{mfaMethods:b}):d.current?.reject(new CO("missing_or_invalid_mfa","MFA verification failed, retry."));let g=await new Promise((a,b)=>{c.current={resolve:a,reject:b},setTimeout(()=>{let a=new CO("mfa_timeout","Timed out waiting for MFA code");d.current?.reject(a),b(a)},3e5)});return await a(g)}return await a()},i=null;for(let a=0;a<4;a++)try{i=await h(a),d.current?.resolve(void 0);break}catch(a){if("missing_or_invalid_mfa"!==a.type)throw d.current?.resolve(void 0),a;g=!0}if(null===i){let a=new CO("mfa_verification_max_attempts_reached","Max MFA verification attempts reached");throw d.current?.reject(a),a}return i}let CY=(Ed=0,()=>"id-"+Ed++);function CZ(a){return void 0!==a.error}let C$=new class{enqueue(a,b){this.callbacks[a]=b}dequeue(a,b){let c=this.callbacks[b];if(!c)throw Error(`cannot dequeue ${a} event: no event found for id ${b}`);switch(delete this.callbacks[b],a){case"privy:iframe:ready":case"privy:user-signer:sign":case"privy:wallets:add":case"privy:wallets:import":case"privy:wallets:set-recovery":case"privy:wallets:connect":case"privy:wallets:recover":case"privy:wallets:rpc":case"privy:wallet:create":case"privy:mfa:verify":case"privy:mfa:init-enrollment":case"privy:mfa:submit-enrollment":case"privy:mfa:unenroll":case"privy:mfa:clear":case"privy:auth:unlink-passkey":case"privy:farcaster:init-signer":case"privy:farcaster:sign":case"privy:solana-wallet:create":case"privy:delegated-actions:consent":return c;default:throw Error(`invalid wallet event type ${a}`)}}constructor(){this.callbacks={}}},C_=new Map,C0=(a,b)=>"bigint"==typeof b?b.toString():b;function C1(a,b,c,d){let e=c.contentWindow;if(!e)throw Error("iframe not initialized");let f=`${a}${JSON.stringify(b,C0)}`;if("privy:wallet:create"===a){let a=C_.get(f);if(a)return a}let g=new Promise((c,f)=>{let g=CY();C$.enqueue(g,{resolve:c,reject:f}),e.postMessage({id:g,event:a,data:b},d)}).finally(()=>{C_.delete(f)});return C_.set(f,g),g}function C2(a){let b=(0,fb.c)(),c=(0,R.useRef)(null),d=(0,R.useRef)(a.mfaMethods),e=(0,gh.a)(),[f,g]=(0,R.useState)(!1);return(0,R.useEffect)(()=>{d.current=a.mfaMethods},[a.mfaMethods]),(0,R.useEffect)(()=>{if(!f)return;let b=c.current;if(!b)return;function g(b){var c;b&&b.origin===a.origin&&"string"==typeof(c=b.data).event&&/^privy:.+/.test(c.event)&&function(a){switch(a.event){case"privy:iframe:ready":let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data);case"privy:user-signer:sign":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallets:add":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallets:set-recovery":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallets:connect":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallets:recover":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallets:rpc":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallet:create":let c=C$.dequeue(a.event,a.id);return CZ(a)?c.reject(new CO(a.error.type,a.error.message)):c.resolve(a.data);case"privy:wallets:import":let d=C$.dequeue(a.event,a.id);return CZ(a)?d.reject(new CO(a.error.type,a.error.message)):d.resolve(a.data);case"privy:mfa:verify":let e=C$.dequeue(a.event,a.id);return CZ(a)?e.reject(new CO(a.error.type,a.error.message)):e.resolve(a.data);case"privy:mfa:init-enrollment":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:mfa:submit-enrollment":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:mfa:unenroll":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:mfa:clear":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:auth:unlink-passkey":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:solana-wallet:create":let f=C$.dequeue(a.event,a.id);return CZ(a)?f.reject(new CO(a.error.type,a.error.message)):f.resolve(a.data);case"privy:farcaster:init-signer":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:farcaster:sign":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:delegated-actions:consent":{let b=C$.dequeue(a.event,a.id);return CZ(a)?b.reject(new CO(a.error.type,a.error.message)):b.resolve(a.data)}default:console.warn("Unsupported wallet proxy method:",a)}}(b.data)}let h={signWithUserSigner:c=>CX(d=>C1("privy:user-signer:sign",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),addWallet:c=>CX(d=>C1("privy:wallets:add",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),setRecovery:c=>CX(d=>C1("privy:wallets:set-recovery",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),connect:c=>CX(d=>C1("privy:wallets:connect",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),recover:c=>CX(d=>C1("privy:wallets:recover",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e,!c.recoveryAccessToken&&!c.recoveryPassword&&!c.recoverySecretOverride),rpc:c=>CX(d=>C1("privy:wallets:rpc",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),create:c=>C1("privy:wallet:create",c,b,a.origin),importWallet:c=>C1("privy:wallets:import",c,b,a.origin),createSolana:c=>CX(d=>C1("privy:solana-wallet:create",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),createDelegatedAction:c=>C1("privy:delegated-actions:consent",c,b,a.origin),verifyMfa:c=>CX(d=>C1("privy:mfa:verify",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e,!0),initEnrollMfa:c=>CX(d=>C1("privy:mfa:init-enrollment",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),submitEnrollMfa:c=>CX(d=>C1("privy:mfa:submit-enrollment",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),unenrollMfa:c=>CX(d=>C1("privy:mfa:unenroll",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),clearMfa:c=>C1("privy:mfa:clear",c,b,a.origin),unlinkPasskeyAccount:c=>CX(d=>C1("privy:auth:unlink-passkey",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),initFarcasterSigner:c=>C1("privy:farcaster:init-signer",c,b,a.origin),signFarcasterMessage:c=>C1("privy:farcaster:sign",c,b,a.origin)};window.addEventListener("message",g);let i=new AbortController;return(0,cv.i)(()=>C1("privy:iframe:ready",{},b,a.origin),{abortSignal:i.signal}).then(()=>a.onLoad(h),(...b)=>{console.warn("Privy iframe failed to load: ",...b),a.onLoadFailed()}),()=>{window.removeEventListener("message",g),i.abort()}},[f]),b?(0,Q.jsx)("iframe",{ref:c,width:"0",height:"0",style:{display:"none",height:"0px",width:"0px"},onLoad:()=>g(!0),src:(0,wK.constructURL)({origin:a.origin,path:`/apps/${a.appId}/embedded-wallets`,query:{caid:a.clientAnalyticsId,client_id:a.appClientId}})}):null}let C3=a=>a.linkedAccounts.filter(a=>"wallet"===a.type&&"privy"===a.walletClientType&&a.delegated),C4="popup-privy-oauth",C5="PRIVY_OAUTH_USE_BROADCAST_CHANNEL";class C6{async authenticate(){if(!this.api)throw new cx.a("Auth flow has no API instance");try{return await this.api.post(fP,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:this.meta.codeVerifier,provider:this.meta.provider})}catch(a){throw(0,cx.f)(a)}}async link(){if(!this.api)throw new cx.a("Auth flow has no API instance");try{return await this.api.post(fQ,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:this.meta.codeVerifier,provider:this.meta.provider})}catch(a){throw(0,cx.f)(a)}}constructor({authorizationCode:a,stateCode:b,codeVerifier:c,provider:d}){this.meta={authorizationCode:a,stateCode:b,codeVerifier:c,provider:d}}}async function C7({api:a,requesterAppId:b,providerAppId:c}){let d=(await a.get(`/api/v1/apps/${b}/cross-app/connections`)).connections.find(a=>a.provider_app_id===c);if(!d)throw new cx.a("Invalid connected app");return{name:d.provider_app_name,logoUrl:d.provider_app_icon_url||void 0,apiUrl:d.provider_app_custom_api_url,readOnly:d.read_only,customAuthAuthorizeUrl:d.provider_app_custom_auth_authorize_url,customAuthTransactUrl:d.provider_app_custom_auth_transact_url}}let C8=async({user:a,address:b,client:c,request:d,requesterAppId:e,reconnect:f})=>{c.createAnalyticsEvent({eventName:"cross_app_request_started",payload:{address:b,method:d.method}});let g=a?.linkedAccounts.find(a=>"cross_app"===a.type&&(a.embeddedWallets.some(a=>a.address===b)||a.smartWallets.some(a=>a.address===b)));if(!a||!g)throw c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Cannot request a signature with this wallet address",address:b}}),new cx.a("Cannot request a signature with this wallet address");let h=c.getProviderAccessToken(g.providerApp.id),i=await C7({api:c.api,requesterAppId:e,providerAppId:g.providerApp.id});if(!h){if(i.readOnly)throw console.error("cannot transact against a read-only provider app"),new cx.a("Cannot transact against a read-only provider app");await f({appId:g.providerApp.id,action:"link"})&&(h=c.getProviderAccessToken(g.providerApp.id))}if(!h)throw c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Transactions require a valid token",address:b}}),new cx.a("Transactions require a valid token");let j=new URL(i.customAuthTransactUrl||`${i.apiUrl}/oauth/transact`);j.searchParams.set("token",h||""),j.searchParams.set("request",C9(d));let k=(0,fi.trigger)({location:j.href});if(!k)throw c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Missing token",address:b}}),new cx.a("Failed to initialize signature request");return new Promise((a,e)=>{let f=setTimeout(()=>{j(),e(new cx.a("Request timeout")),c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Request timeout",address:b}})},12e4),h=setInterval(()=>{k.closed&&(j(),e(new cx.a("User rejected request")),c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"User rejected request",address:b}}))},300),i=f=>{f.data&&("set"===f.data.token?.action&&void 0!==f.data.token?.value?c.storeProviderAccessToken(g.providerApp.id,f.data.token.value):"clear"===f.data.token?.action&&c.storeProviderAccessToken(g.providerApp.id,null),"PRIVY_CROSS_APP_ACTION_RESPONSE"===f.data.type&&f.data.result&&(j(),a(f.data.result),c.createAnalyticsEvent({eventName:"cross_app_request_success",payload:{address:b,method:d.method}})),"PRIVY_CROSS_APP_ACTION_ERROR"===f.data.type&&f.data.error&&(j(),e(f.data.error),c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:f.data.error,address:b}})))};window.addEventListener("message",i);let j=()=>{k.close(),clearInterval(h),clearTimeout(f),window.removeEventListener("message",i)}})},C9=a=>JSON.stringify({content:{request:{request:Da(a,fd.toHex)}},timestamp:Date.now(),callbackUrl:window.origin}),Da=(a,b)=>"bigint"==typeof a?b(a):Array.isArray(a)?a.map(a=>Da(a,b)):a&&"object"==typeof a?Object.fromEntries(Object.entries(a).map(([a,c])=>[a,Da(c,b)])):a;function Db({isCreatingWallet:a,skipSplashScreen:b}){return a?"EmbeddedWalletPasswordCreateScreen":b?"EmbeddedWalletPasswordUpdateScreen":"EmbeddedWalletPasswordUpdateSplashScreen"}function Dc({walletAction:a,availableRecoveryMethods:b,legacySetWalletPasswordFlow:c,isResettingPassword:d,showAutomaticRecovery:e}){return e?"SetAutomaticRecoveryScreen":c||1===b.length?Db({isCreatingWallet:"create"===a,skipSplashScreen:d}):"RecoverySelectionScreen"}function Dd(a){switch(a){case"user-passcode":return"PasswordRecoveryScreen";case"google-drive":case"icloud":return"RecoveryOAuthScreen";default:throw Error("Recovery method not supported")}}function De(a,b,c,d,e,f,g){return{...a,funding:a?.funding?{...a.funding,fundingResult:{status:b,address:a.funding.address,fundingMethod:void 0,transactionHash:c,amount:a.funding.amount,assetType:e?f?.symbol||"ETH":g.nativeCurrency.symbol||"ETH",metadata:{walletClientType:d}}}:void 0,solanaFundingData:a?.solanaFundingData,sendTransaction:a?.sendTransaction}}let Df=new Map([["FundingMethodSelectionScreen",null],["TransferFromWalletScreen","external"],["FundingAmountEditScreen","external"],["ConnectOnlyLandingScreen","external"],["ConnectOnlyStatusScreen","external"],["AwaitingExternalEthereumTransferScreen","external"],["AwaitingEvmToSolBridgingScreen","external"],["AwaitingSolToEvmBridgingScreen","external"],["ManualTransferScreen","manual"],["MoonpayStatusScreen","moonpay"]]);function Dg(a){let b=a.toLowerCase();return!!window?.webkit?.messageHandlers?.ReactNativeWebView||!!window?.ReactNativeWebView||["fbav","fban","instagram","snapchat","linkedinapp"].some(a=>b.includes(a))}async function Dh({rpc:a,address:b}){return(await a.getBalance(b,{commitment:"confirmed"}).send()).value??0n}let Di={apple_oauth:"apple",custom_auth:"custom",discord_oauth:"discord",email:"email",farcaster:"farcaster",github_oauth:"github",google_oauth:"google",instagram_oauth:"instagram",linkedin_oauth:"linkedin",passkey:"passkey",phone:"sms",spotify_oauth:"spotify",telegram:"telegram",tiktok_oauth:"tiktok",line_oauth:"line",twitch_oauth:"twitch",twitter_oauth:"twitter",wallet:"siwe",smart_wallet:"siwe",cross_app:"privy:"},Dj=a=>{if((0,ct.i)(a))return{displayName:a.replace("custom:",""),loginMethod:"custom"};let b=Di[a];return"wallet"===a||"phone"===a?{displayName:a,loginMethod:b}:{displayName:b,loginMethod:b}},Dk=(a,b)=>!(0,ct.b)(a)&&("all-users"===b||"users-without-wallets"===b&&!Dl(a).length),Dl=a=>a.linkedAccounts.filter(a=>"wallet"===a.type&&"ethereum"===a.chainType),Dm=(a,b)=>!(0,ct.c)(a)&&("all-users"===b||"users-without-wallets"===b&&!Dn(a).length),Dn=a=>a.linkedAccounts.filter(a=>"wallet"===a.type&&"solana"===a.chainType);async function Do(a,b,c,d){let e=(0,fa.toViemTransactionSerializable)(a),{chain:f,...g}=await (async()=>d?await d():await b.prepareTransactionRequest({...e,account:{address:c,type:"json-rpc"}}))();return{...g,type:fa.STRING_TO_NUMBER_TXN_TYPE[g.type]}}let Dp=({disabled:a})=>{let{migrate:b}=(()=>{let a=(0,fb.u)(),{user:b}=(0,ct.u)(),{client:c,refreshSessionAndUser:d,walletProxy:e}=(0,cx.u)();return{migrate:(0,R.useCallback)(async()=>{if("legacy-embedded-wallets-only"===a.embeddedWallets.mode)return{success:!0};if(!b)throw new cx.a("User must be authenticated before migrating wallets",cx.b.MUST_BE_AUTHENTICATED);if(!e)throw new cx.a("Cannot connect to wallet proxy");let f=await c.getAccessToken();if(!f)throw new cx.a("User must be authenticated before migrating wallets",cx.b.MUST_BE_AUTHENTICATED);let g=b.linkedAccounts.filter(a=>"wallet"===a.type&&"privy"===a.walletClientType&&(0,cy.i)(a)&&!(0,ct.d)(a));if(0===g.length)return{success:!0};let h=g.filter(a=>a.imported),i=g.filter(a=>!a.imported);if(i.length>0){let a=i.find(a=>"ethereum"===a.chainType&&0===a.walletIndex)??i.find(a=>"solana"===a.chainType&&0===a.walletIndex)??null;if(!a)throw new cx.a("Primary wallet not found");let{entropyId:b,entropyIdVerifier:c}=(0,cw.t)(a);try{await e.connect({accessToken:f,entropyId:b,entropyIdVerifier:c})}catch(d){if(!CQ(d)||"privy"!==a.recoveryMethod)throw d;await e.recover({accessToken:f,entropyId:b,entropyIdVerifier:c})}await e.createDelegatedAction({accessToken:f,rootWallet:{address:a.address,chainType:a.chainType,imported:!1},delegatedWallets:i.map(a=>({address:a.address,chainType:a.chainType,walletIndex:a.walletIndex??0}))})}for(let a of h){let{entropyId:b,entropyIdVerifier:c}=(0,cw.t)(a);try{await e.connect({accessToken:f,entropyId:b,entropyIdVerifier:c})}catch(d){if(!CQ(d)||"privy"!==a.recoveryMethod)throw d;await e.recover({accessToken:f,entropyId:b,entropyIdVerifier:c})}await e.createDelegatedAction({accessToken:f,rootWallet:{address:a.address,chainType:a.chainType,imported:!0},delegatedWallets:[{address:a.address,chainType:a.chainType,walletIndex:a.walletIndex??0}]})}return await d(),{success:!0}},[a.embeddedWallets.mode,b,e,c,d])}})(),{user:c}=(0,ct.u)(),{walletProxy:d}=(0,cx.u)(),e=(0,R.useRef)(!1);return(0,R.useEffect)(()=>{!a&&!e.current&&c&&d&&(e.current=!0,b().catch(a=>{console.debug("Unable to migrate wallets: ",a)}).finally(()=>{e.current=!1}))},[c,d,a,b]),null},Dq=(0,gi.create)(()=>({ethereum:[]}));class Dr{async authenticate(){if(!this.api)throw new cx.a("Auth flow has no API instance");try{return await this.api.post(f5,{token:this.meta.token})}catch(a){throw(0,cx.f)(a)}}async link(){if(!this.api)throw new cx.a("Auth flow has no API instance");try{return await this.api.post(f6,{token:this.meta.token})}catch(a){throw(0,cx.f)(a)}}constructor(a){this.meta={token:a}}}let Ds=(0,gi.create)(()=>({jwtAuthFlowState:{status:"not-enabled"}}));function Dt({customAuth:a}){let{jwtAuthFlowState:b}=function({customAuth:a}){let b=(0,gh.a)(),c=(0,R.useRef)(),d=(0,R.useCallback)(a=>(c.current=a,()=>{c.current=void 0}),[]),e=a?.getCustomAccessToken??(()=>Promise.resolve(void 0)),{state:f}=function({subscribe:a,getExternalJwt:b,enabled:c=!0,onAuthenticated:d,onUnauthenticated:e,onError:f}){let{client:g,onCustomAuthAuthenticated:h}=(0,cx.u)(),{logout:i,authenticated:j,ready:k}=(0,ge.u)();if(!g)throw new cx.a("`useSyncJwtBasedAuthState` must be used within a `PrivyProvider`");let[l,m]=(0,R.useState)({status:"initial"}),n=(0,R.useRef)(),o=(0,R.useRef)(!1),p=(0,R.useRef)(b);(0,R.useEffect)(()=>{p.current=b},[b]);let q=(0,R.useRef)(d);(0,R.useEffect)(()=>{q.current=d},[d]);let r=(0,R.useRef)(e);(0,R.useEffect)(()=>{r.current=e},[e]);let s=(0,R.useRef)(f);return(0,R.useEffect)(()=>{s.current=f},[f]),(0,R.useEffect)(()=>{if(!c||!k)return;let b=async()=>{if(!o.current){o.current=!0;try{m({status:"loading"});let a=await p.current();if(void 0!==n.current&&n.current===a)return void m({status:"done"});if(!a)return j&&(await i(),r.current?.()),n.current=a,void m({status:"done"});g.startAuthFlow(new Dr(a));let{user:b,isNewUser:c=!1}=await g.authenticate();if(!b)throw new cx.a("Failed to sync with custom auth provider");q.current?.({user:b,isNewUser:c}),h(b,c),n.current=a,m({status:"done"})}catch(a){if(console.warn(a),await i().catch(()=>{}),r.current?.(),a instanceof cx.e&&a.privyErrorCode===cx.b.LINKED_TO_ANOTHER_USER)return m({status:"initial"}),void setTimeout(()=>{b()},0);s.current?.(a),m({status:"error",error:a})}finally{o.current=!1}}};return b(),a(b)},[a,g,h,j,i,c,k]),c?{state:l}:{state:{status:"not-enabled"}}}({enabled:!0===a?.enabled,subscribe:d,getExternalJwt:e,onAuthenticated:({user:a,isNewUser:c})=>{b("login","onComplete",{user:a,isNewUser:c,wasAlreadyAuthenticated:!1,loginMethod:"custom",loginAccount:null}),b("customAuth","onAuthenticated",{user:a})},onUnauthenticated:()=>{b("customAuth","onUnauthenticated")},onError:a=>{b("login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR)}});return(0,R.useEffect)(()=>{(async()=>{a&&!a.isLoading&&c.current?.()})()},[a?.enabled,a?.getCustomAccessToken,a?.isLoading]),{jwtAuthFlowState:f}}({customAuth:a});return(0,R.useEffect)(()=>{Ds.setState({jwtAuthFlowState:b})},[b]),null}let Du=(0,R.createContext)(!1),Dv=b=>{let c=b.client,d=b.privy,e=(0,ge.c)(),f=(0,fb.u)();(0,cv.d)((0,cv.e)(f?.appearance.walletList??[]));let[g,h]=(0,R.useState)(!1),n=Cs(a=>a.inProgressMfaFlow),[o,p]=(0,R.useState)(!1),[q,r]=(0,R.useState)(null),s=Dq(a=>a.ethereum),[t,u]=(0,R.useState)(void 0),[v,w]=(0,R.useState)(!1),[x,y]=(0,R.useState)(null),[z,A]=(0,R.useState)(!1),[B,C]=(0,R.useState)({status:"disconnected",connectedWallet:null,connectError:null,connector:null,connectRetry:cx.n}),[D,E]=(0,R.useState)({status:"initial"}),[F,G]=(0,R.useState)({status:"initial"}),[H,I]=(0,R.useState)({status:"initial"}),[J,K]=(0,R.useState)({status:"initial"}),[L,M]=(0,R.useState)({status:"initial"}),[N,O]=(0,R.useState)({status:"initial"}),[P,S]=(0,R.useState)(null),T=(0,fb.c)(),[V,W]=(0,R.useState)({}),[X,Y]=(0,R.useState)(null),Z=(0,R.useRef)(null),[$,_]=(0,R.useState)(!1),[aa,ab]=(0,R.useState)(!1),ac=(0,R.useRef)(null),ad=(0,R.useRef)(null),ae=(0,R.useRef)(gh.p),[af,ag]=(0,R.useState)(!1),[ah,ai]=(0,R.useState)(!1),aj=(0,R.useCallback)(a=>{ai(a),!a&&x&&Cr[x]().then(a=>{a.default.isUnauthenticatedScreem&&y(null)})},[x]);c.onStoreCustomerAccessToken=a=>{a&&(0,gh.e)(ae,"accessToken","onAccessTokenGranted",{accessToken:a})},c.onDeleteCustomerAccessToken=()=>{r(null),aj(!1),(0,gh.e)(ae,"accessToken","onAccessTokenRemoved")};let ak=(0,R.useRef)(null),al=(0,R.useRef)(null),am=(0,R.useRef)(!1),an=({showWalletUIs:a})=>am.current?am.current:void 0!==a?!a:!f.embeddedWallets.showWalletUIs,ao=a=>{y(a),setTimeout(()=>{h(!0)},15)};(0,R.useEffect)(()=>{if(!q)return void c.connectors?.removeEmbeddedWalletConnectors();let a=(0,ct.b)(q),e=(0,ct.e)(q),g=(0,ct.f)(q);a&&e.length||c.connectors?.removeEmbeddedWalletConnectors(),g.length||c.connectors?.removeImportedWalletConnectors(),c.connectors?P?(a&&c.connectors.addEmbeddedWalletConnectors({walletProxy:P,user:q,embeddedWallets:e,defaultChain:f.defaultChain,appId:b.appId,privyClient:d}),g.forEach(a=>c.connectors?.addImportedWalletConnector(P,a.address,f.defaultChain,b.appId))):console.debug("Failed to add embedded wallet connector: Wallet proxy not initialized"):console.debug("Failed to add embedded wallet connector: Client connectors not initialized")},[P,q]),(0,R.useEffect)(()=>{P&&Z.current?.(P)},[P]);let ap=(0,R.useCallback)((a,b)=>{r(a),w(b),aj(!0),ab(!0)},[]);(0,R.useEffect)(()=>{aa&&P&&q&&(async()=>{let a=Dk(q,f.embeddedWallets.ethereum.createOnLogin),b=Dm(q,f.embeddedWallets.solana.createOnLogin),c=await BX();if(c){if(a&&b){let a=await P.create({accessToken:c});return await P.createSolana({accessToken:c,ethereumAddress:a?.address}),void ab(!1)}if(b)return await P.createSolana({accessToken:c,ethereumAddress:(0,ct.b)(q)?.address}),await aG.refreshSessionAndUser(),void ab(!1);if(a)return await P.create({accessToken:c}),void ab(!1)}})().catch(console.error)},[aa&&P&&q]),(0,R.useEffect)(()=>{if(f.externalWallets.solana.connectors)return f.externalWallets.solana.connectors.onMount(),()=>f.externalWallets.solana.connectors?.onUnmount()},[f.externalWallets.solana.connectors]),(0,R.useEffect)(()=>{!o&&T&&async function(){let a,b,d,e,g,h=aq(),i=ar(),j=(a=new Set,b=[],e=(d=()=>{})(),{_listeners:()=>a,clear(){a.forEach(a=>a([],{removed:[...b]})),b=[]},destroy(){this.clear(),a.clear(),e?.()},findProvider:({rdns:a})=>b.find(b=>b.info.rdns===a),getProviders:()=>b,reset(){this.clear(),e?.(),e=d()},subscribe:(c,{emitImmediately:d}={})=>(a.add(c),d&&c(b,{added:b}),()=>a.delete(c))});c.initializeConnectorManager({walletConnectCloudProjectId:f.walletConnectCloudProjectId,rpcConfig:f.rpcConfig,chains:f.chains,defaultChain:f.defaultChain,store:j,walletList:f.appearance.walletList,shouldEnforceDefaultChainOnConnect:f.shouldEnforceDefaultChainOnConnect,externalWalletConfig:f.externalWallets,appName:f.name??"Privy",walletChainType:f.appearance.walletChainType,setBaseAccountSdk:u}),c.connectors?.on("connectorInitialized",()=>{g&&clearTimeout(g);let a=c.connectors.walletConnectors.length,b=c.connectors.walletConnectors.reduce((a,b)=>a+ +!!b.initialized,0);b===a?ag(!0):g=setTimeout(()=>{console.debug({message:"Unable to initialize all expected connectors before timeout",initialized:b,expected:a}),ag(!0)},1500)}),c.connectors?.initialize().then(()=>{aw()});let k=await c.getAuthenticatedUser(),l=!!k;f.legal.requireUsersAcceptTerms&&k&&!k.hasAcceptedTerms?(await c.logout(),aG.setReadyToTrue(!0),(0,gh.e)(ae,"logout","onSuccess")):(f.customAuth?.enabled||(aj(!!k),k&&(0,gh.e)(ae,"login","onComplete",{user:k,isNewUser:!1,wasAlreadyAuthenticated:!0,loginMethod:null,loginAccount:null}),r(k)),h?al.current=l?"link":"login":i&&!l?(al.current="login",W({telegramAuthModalData:{seamlessAuth:!0}}),ao("TelegramAuthScreen")):aG.setReadyToTrue(!!k))}()},[c,X,o,T]),(0,R.useEffect)(()=>{if(o){if(!q||!q.linkedAccounts.find(a=>"wallet"===a.type&&"privy"===a.walletClientType))return void _(!!P);if([...s].some(a=>"privy"===a.walletClientType))return void _(!0);_(!!P)}},[o,q,s,P]),(0,R.useEffect)(()=>{c.connectors?.setWalletList(f.appearance.walletList)},[f.appearance.walletList.join()]);let aq=()=>{let a=function(){let a=new URLSearchParams(window.location.search),b=a.get("privy_oauth_code"),c=a.get("privy_oauth_state"),d=a.get("privy_oauth_provider");if(!b||!c||!d)return{inProgress:!1};let e=!1;try{e=!!window.opener.location.origin}catch{}return{inProgress:!0,authorizationCode:b,stateCode:c,provider:d,withPrivyUi:!cy.u.get(fb.H),popupFlow:null!==window.opener&&e,disableSignup:!!cy.u.get(fb.O)}}();return a.inProgress&&a.popupFlow?window.opener.location.origin!==window.location.origin?void window.opener.postMessage({type:"PRIVY_OAUTH_ERROR",error:"Origins between parent and child windows do not match."}):"error"===a.authorizationCode?void window.opener.postMessage({type:"PRIVY_OAUTH_ERROR",error:"Something went wrong. Try again."}):void window.opener.postMessage({type:"PRIVY_OAUTH_RESPONSE",stateCode:a.stateCode,authorizationCode:a.authorizationCode}):(a.inProgress&&a.provider.startsWith("privy:")&&!a.popupFlow&&(new BroadcastChannel(C4).postMessage({type:"PRIVY_OAUTH_RESPONSE",stateCode:a.stateCode,authorizationCode:a.authorizationCode}),window.close()),!!a.inProgress&&!!a.withPrivyUi&&(c.startAuthFlow(new B8({...a,customOAuthRedirectUrl:f.customOAuthRedirectUrl})),ao("OAuthStatusScreen"),!0))},ar=()=>{let a,b=(a=function(){let a=new URLSearchParams(window.location.search),b=Number(a.get("id")||""),c=a.get("hash"),d=Number(a.get("auth_date")||""),e=a.get("first_name");if(b&&e&&d&&c)return Object.fromEntries(a.entries())}())?(Cn(),{flowType:"login-url",authData:a}):(a=function(){let a=window.location.hash;if(!a||!a.startsWith("#tgWebAppData"))return;let b=Cm(a.replace("#tgWebAppData=","")),{user:c,auth_date:d,hash:e}=b;return c&&d&&e?b:void 0}())?(Cn(),{flowType:"web-app",authData:a}):void 0;if(!b||!f.loginMethods.telegram||!f.loginConfig.telegramAuthConfiguration?.seamlessAuthEnabled)return;let d=new Ck;return c.startAuthFlow(d),"login-url"===b.flowType&&(d.meta.telegramWebAppData=void 0,d.meta.telegramAuthResult=b.authData),"web-app"===b.flowType&&(d.meta.telegramAuthResult=void 0,d.meta.telegramWebAppData=b.authData),!0},as=async(a,b,d,e)=>{if("solana_adapter"!==a)at(await c.connectors?.createEthereumWalletConnector({connectorType:a,walletClientType:b})||null,b,d,e);else{let a=c.connectors?.findSolanaWalletConnector(b);if(!a)return;at(a,b,d,e)}};async function at(a,b,c,d){if(!a)return C({status:"disconnected",connectedWallet:null,connectError:new cx.P("Unable to connect to wallet."),connector:null,connectRetry:cx.n}),d?.(null,c);C({status:"disconnected",connectedWallet:null,connectError:null,connector:a,connectRetry:cx.n}),a instanceof CM&&b&&await a.resetConnection(b),C({connector:a,status:"connecting",connectedWallet:null,connectError:null,connectRetry:()=>at(a,b,c,d)});try{let b=await a.connect({showPrompt:!0});if((!b||(0,cv.f)(b))&&f.shouldEnforceDefaultChainOnConnect&&!f.chains.find(a=>a.id===Number(b?.chainId.replace("eip155:","")))&&("wallet_connect_v2"!==b?.connectorType||"metamask"!==b?.walletClientType)){C(b=>({...b,connector:a,status:"switching_to_supported_chain",connectedWallet:null,connectError:null,connectRetry:cx.n}));try{await b?.switchChain(f.defaultChain.id),b&&(b.chainId=(0,cv.h)((0,fd.toHex)(f.defaultChain.id)))}catch{console.warn(`Unable to switch to default chain: ${f.defaultChain.id}`)}}return C(a=>({...a,status:"connected",connectedWallet:b,connectError:null,connectRetry:cx.n})),b&&(0,gh.e)(ae,"connectWallet","onSuccess",{wallet:b}),d?.(b,c)}catch(a){return a instanceof cx.c?(console.warn(a.cause?a.cause:a.message),(0,gh.e)(ae,"connectWallet","onError",a.privyErrorCode||cx.b.GENERIC_CONNECT_WALLET_ERROR)):(console.warn(a),(0,gh.e)(ae,"connectWallet","onError",cx.b.UNKNOWN_CONNECT_WALLET_ERROR)),C(b=>({...b,status:"disconnected",connectedWallet:null,connectError:a})),d?.(null,c)}}let au=async(a,b,d)=>{if(null===a||!(0,cv.f)(a))return;let e=new Cc(c,a,b,d);c.startAuthFlow(e)},av=async(a,b,d,f="plain")=>{let g=e(ge.e);if("transaction"===f&&!g)throw new cx.a("useSolanaLedger plugin hook must be mounted");if(null===a||!(0,cv.l)(a))return;let h=new Cd(a,c,b,d,f,g);c.startAuthFlow(h)},aw=async()=>{let a=new URLSearchParams(window.location.search),b=a.get("privy_connector"),d=a.get("privy_wallet_client"),e="true"===a.get("privy_connect_only");if(!b||!d)return;let f=(0,cv.n)({connectorType:b,walletClientType:d});if(!f||!f.isInstalled)return ao("LoginFailedScreen");if(!c.connectors)throw new cx.a("Connector not initialized");await ao(e?"ConnectOnlyStatusScreen":"ConnectionStatusScreen");let g=new URL(window.location.href);g.searchParams.delete("privy_connector"),g.searchParams.delete("privy_wallet_client"),g.searchParams.delete("privy_connect_only"),window.history.pushState({},"",g),as(b,d,void 0,e?void 0:"solana_adapter"===b?av:au)};(0,R.useEffect)(()=>{o&&ah&&null===q&&c.getAuthenticatedUser().then(r)},[o,ah,q,c]);let ax=a=>{if(!ah)throw(0,gh.e)(ae,"linkAccount","onError",cx.b.MUST_BE_AUTHENTICATED,{linkMethod:a}),new cx.a("User must be authenticated before linking an account.")},ay=()=>{Dq.setState(a=>{let b=c.connectors?.wallets.filter(cv.f).map(a=>({...a,linked:(a=>{if(!ah||!q)return!1;if("privy"===a.walletClientType)return!0;for(let b of q.linkedAccounts)if("wallet"===b.type&&b.address===a.address&&"privy"!==b.walletClientType)return!0;return!1})(a),loginOrLink:async()=>{if(!await a.isConnected())throw new cx.a("Wallet is not connected");if("embedded"===a.connectorType&&"privy"===a.walletClientType)throw new cx.a("Cannot link or login with embedded wallet");(async a=>{let b;if(!c.connectors)throw new cx.a("Connector not initialized");b="ethereum"===a.type?c.connectors.findWalletConnector(a.connectorType,a.walletClientType)||null:c.connectors.findSolanaWalletConnector(a.walletClientType)||null,C(c=>({...c,connector:b,status:"connected",connectedWallet:a,connectError:null,connectRetry:cx.n})),f.captcha.enabledProvider&&!ah?(W({captchaModalData:{callback:b=>(0,cv.f)(a)?au(a,b):av(a,b),userIntentRequired:!1,onSuccessNavigateTo:"ConnectionStatusScreen",onErrorNavigateTo:"ErrorScreen"}}),await ao("CaptchaScreen")):((0,cv.f)(a)?await au(a):await av(a),await ao("ConnectionStatusScreen"))})(a)},fund:async b=>{await aG.fundWallet(a.address,b)},unlink:async()=>{if(!ah)throw new cx.a("User is not authenticated.");if("embedded"===a.connectorType&&"privy"===a.walletClientType)throw new cx.a("Cannot unlink an embedded wallet");r(await c.unlinkEthereumWallet(a.address))}}))||[];return(0,cv.j)(a.ethereum,b)?{}:{ethereum:b}})};(0,R.useEffect)(()=>{ay()},[q?.linkedAccounts,ah,o]),(0,R.useEffect)(()=>{if(o){if(!c.connectors)throw new cx.a("Connector not initialized");ay(),c.connectors.on("walletsUpdated",ay)}},[o]),(0,R.useEffect)(()=>{[...f.loginMethodsAndOrder?.primary??[],...f.loginMethodsAndOrder?.overflow??[]].filter(a=>a.startsWith("privy:")).forEach(a=>c.getCrossAppProviderDetails(a.replace("privy:","")))},[!!c]);let az=({transaction:a,sponsor:e,uiOptions:g,fundWalletConfig:h,address:i,signOnly:j})=>new Promise(async(k,l)=>{let{requesterAppId:m}=g||{},n=j?"signTransaction":"sendTransaction",o=i?(0,ct.h)(q,i):(0,ct.b)(q);if(!o&&i){let b=(0,ct.k)(Dq.getState().ethereum,i);if(b){if(e)throw new cx.a("Cannot sponsor transactions for externally connected wallet.");try{let c=await b.getEthereumProvider(),d={...a,from:i,chainId:a.chainId||Number(b.chainId.replace("eip155:","")),value:void 0!==a.value?(0,fd.toHex)(a.value):void 0},e=await c.request({method:"sendTransaction"===n?"eth_sendTransaction":"eth_signTransaction",params:[d]});return(0,gh.e)(ae,n,"onSuccess",{hash:e}),void k({hash:e})}catch(a){return(0,gh.e)(ae,n,"onError",cx.b.TRANSACTION_FAILURE),void l(a??new cy.P("Unable to "+n+a))}}}if(!o)return(0,gh.e)(ae,n,"onError",cx.b.EMBEDDED_WALLET_NOT_FOUND),void l(new cx.a("No embedded or connected wallet found for address."));if(!ah||!q)return(0,gh.e)(ae,n,"onError",cx.b.MUST_BE_AUTHENTICATED),void l(Error("User must be authenticated before signing with a Privy wallet"));let p=o.address,r=o.walletIndex??0,{entropyId:s,entropyIdVerifier:t}=(0,cw.g)(q,o),u=aH.wallets.find(a=>"privy"===a.walletClientType&&(0,ff.getAddress)(a.address)===(0,ff.getAddress)(p));if(!u)return(0,gh.e)(ae,n,"onError",cx.b.EMBEDDED_WALLET_NOT_FOUND),void l(Error("Must have a Privy wallet before signing"));let v=await u.getEthereumProvider(),w=await v.request({method:"eth_chainId"}),x=a.chainId?Number(a.chainId):(0,cy.b)(w);if(!f.chains.map(a=>a.id).includes(x))throw new cx.P(`Chain ID ${x} is not supported. It must be added to the config.supportedChains property of the PrivyProvider.`,cx.b.UNSUPPORTED_CHAIN_ID);let y={...a,from:a.from??p,chainId:x},z=await BX();if(!z||!P)return(0,gh.e)(ae,n,"onError",cx.b.EMBEDDED_WALLET_NOT_FOUND),void l(Error("Must have valid access token and Privy wallet to send transaction"));let A=(0,wN.g)(y.chainId,f.chains,f.rpcConfig,{appId:b.appId}),B=(0,ct.d)(o),C=async({transactionRequest:a})=>{try{let b;if(!await aG.recoverEmbeddedWallet({address:p}))throw(0,gh.e)(ae,n,"onError",cx.b.UNKNOWN_CONNECT_WALLET_ERROR),l(Error("Unable to connect to wallet")),Error("Unable to connect to wallet");if(e){let b=await (async({transactionRequest:a})=>{if(!B)throw new cx.a("Sponsoring is only supported for wallets on the TEE stack");if(j)throw new cx.a("Cannot sponsor a sign transaction request");let b=a=>null==a?void 0:(0,fd.toHex)(a),c=await (0,U.rpc)(d,async({message:a})=>await P.signWithUserSigner({accessToken:z,requesterAppId:m,message:a}),{chain_type:"ethereum",method:"eth_sendTransaction",caip2:(0,cv.h)((0,fd.toHex)(a.chainId)),sponsor:!0,params:{transaction:{from:a.from,to:a.to,chain_id:b(a.chainId),data:(0,fg.isHex)(a.data)?a.data?a.data:(0,fd.toHex)(Uint8Array.from(a.data)):void 0,value:b(a.value)}},wallet_id:o.id});if(c.data&&"hash"in c.data)return c.data.hash;throw new cy.P("Unable to sign transaction")})({transactionRequest:a});return(0,gh.e)(ae,"sendTransaction","onSuccess",{hash:b}),b}if(B){let c=a=>null==a?void 0:(0,fd.toHex)(a),e=await (0,U.rpc)(d,async({message:a})=>await P.signWithUserSigner({accessToken:z,requesterAppId:m,message:a}),{chain_type:"ethereum",method:"eth_signTransaction",params:{transaction:{from:a.from,to:a.to,nonce:c(a.nonce),chain_id:c(a.chainId),data:(0,fg.isHex)(a.data)?a.data?a.data:(0,fd.toHex)(Uint8Array.from(a.data)):void 0,value:c(a.value),type:a.type,gas_limit:c(a.gasLimit??a.gas),gas_price:c(a.gasPrice??a.gas),max_fee_per_gas:c(a.maxFeePerGas),max_priority_fee_per_gas:c(a.maxPriorityFeePerGas)}},wallet_id:o.id});if(!e.data||!("signed_transaction"in e.data))throw new cy.P("Unable to sign transaction");b=e.data.signed_transaction}else b=await async function({accessToken:a,entropyId:b,entropyIdVerifier:c,transactingWalletIndex:d,walletProxy:e,transactionRequest:f,requesterAppId:g}){return(await e.rpc({entropyId:b,entropyIdVerifier:c,hdWalletIndex:d??0,chainType:"ethereum",accessToken:a,requesterAppId:g,request:{method:"eth_signTransaction",params:[f]}})).response.data}({accessToken:z,entropyId:s,entropyIdVerifier:t,transactingWalletIndex:r,walletProxy:P,transactionRequest:a,requesterAppId:m});if(j)return(0,gh.e)(ae,"signTransaction","onSuccess",{signature:b}),b;{let a=await A.sendRawTransaction({serializedTransaction:b});return(0,gh.e)(ae,"sendTransaction","onSuccess",{hash:a}),a}}catch(a){throw(0,gh.e)(ae,n,"onError",cx.b.TRANSACTION_FAILURE),a}};if(an({showWalletUIs:g?.showWalletUIs})){let a=j||e?y:await Do(y,A,y.from);try{let b=await C({transactionRequest:a});j?(0,gh.e)(ae,"signTransaction","onSuccess",{signature:b}):(0,gh.e)(ae,"sendTransaction","onSuccess",{hash:b}),k({hash:b})}catch(a){(0,gh.e)(ae,n,"onError",cx.b.TRANSACTION_FAILURE),l(a)}}else{let a={connectingWalletAddress:p,recoveryMethod:o.recoveryMethod,entropyId:s,entropyIdVerifier:t,onCompleteNavigateTo:"SendTransactionScreen",isUnifiedWallet:B,onFailure:a=>{(0,gh.e)(ae,n,"onError",cx.b.UNKNOWN_CONNECT_WALLET_ERROR),l(a)}},b=f.fundingConfig&&(0,cy.a)(f.fundingConfig.options).length>=1?(0,cy.p)({address:p,appConfig:f,fundWalletConfig:h,methodScreen:"FundingMethodSelectionScreen",chainIdOverride:y.chainId,comingFromSendTransactionScreen:!0}):void 0;W({connectWallet:a,sendTransaction:{transactionRequest:y,transactingWalletIndex:r,transactingWalletAddress:p,entropyId:s,entropyIdVerifier:t,signOnly:j,scanTransaction:async()=>{let a=await Do(y,A,y.from);return await c.scanTransaction({metadata:{domain:f.embeddedWallets.transactionScanning.domain},chain_id:a.chainId.toString(),request:{method:"eth_sendTransaction",params:[{from:a.from,to:a.to,value:a.value?.toString(),gas:a.gas?.toString(),gasPrice:a.gasPrice?.toString(),nonce:a.nonce?.toString(),data:a.data}]}})},getIsSponsored:async()=>!!e,onConfirm:({transactionRequest:a})=>C({transactionRequest:a}),onSuccess:a=>{j?(0,gh.e)(ae,"signTransaction","onSuccess",{signature:a.hash}):(0,gh.e)(ae,"sendTransaction","onSuccess",{hash:a.hash}),k(a)},onFailure:a=>{(0,gh.e)(ae,n,"onError",cx.b.TRANSACTION_FAILURE),l(a)},uiOptions:g||{},fundWalletConfig:h,requesterAppId:m},funding:b}),ao("EmbeddedWalletConnectingScreen")}});function aA(){return new Promise(async(a,b)=>{let c=await BX();if(!c||!P)throw Error("Must have valid access token to enroll in MFA");try{await P.verifyMfa({accessToken:c}),a()}catch(a){b(a)}})}let aB=a=>a?.linkedAccounts.filter(a=>null!==a.latestVerifiedAt&&("wallet"!==a.type||"privy"!==a.walletClientType)).sort((a,b)=>b.latestVerifiedAt.getTime()-a.latestVerifiedAt.getTime())[0],aC=a=>{let b=q?.linkedAccounts.filter(b=>b.type===a).length??0,{displayName:c,loginMethod:d}=Dj(a);if("passkey"===a&&b>=5||"passkey"!==a&&b>=1)throw(0,gh.e)(ae,"linkAccount","onError",cx.b.CANNOT_LINK_MORE_OF_TYPE,{linkMethod:d}),new cx.a(`User already has an account of type ${c} linked.`)};async function aD({showAutomaticRecovery:a=!1,legacySetWalletPasswordFlow:b=!1}){y(null);let c=b?"setWalletPassword":"setWalletRecovery";if(!ah||!q)throw(0,gh.e)(ae,c,"onError",cx.b.MUST_BE_AUTHENTICATED),Error("User must be authenticated before adding recovery method to Privy wallet");let d=(0,ct.g)(q);if(!d||!P)throw(0,gh.e)(ae,c,"onError",cx.b.EMBEDDED_WALLET_NOT_FOUND),Error("Must have a Privy wallet to add a recovery method");let e=(0,ct.d)(d);if(e)throw(0,gh.e)(ae,c,"onError",cx.b.UNSUPPORTED_WALLET_TYPE),new cx.a("User owned wallet recovery is only supported for on-device execution and this app uses TEE execution. Learn more https://docs.privy.io/recipes/tee-wallet-migration-guide");try{await aA()}catch(a){throw(0,gh.e)(ae,c,"onError",cx.b.MISSING_MFA_CREDENTIALS),a}return new Promise((g,h)=>{let i="user-passcode"===d.recoveryMethod,j=Dc({walletAction:"update",availableRecoveryMethods:f.embeddedWallets.userOwnedRecoveryOptions,legacySetWalletPasswordFlow:b,isResettingPassword:i,showAutomaticRecovery:a}),{entropyId:k,entropyIdVerifier:l}=(0,cw.g)(q),m={recoveryMethod:d.recoveryMethod,connectingWalletAddress:d.address,onCompleteNavigateTo:j,shouldForceMFA:!1,entropyId:k,isUnifiedWallet:e,entropyIdVerifier:l,onFailure:a=>{(0,gh.e)(ae,c,"onError",cx.b.UNKNOWN_CONNECT_WALLET_ERROR),h(a)}};W({setWalletPassword:{onSuccess:a=>{(0,gh.e)(ae,c,"onSuccess",{method:"user-passcode",wallet:a}),g(a)},onFailure:a=>{(0,gh.e)(ae,c,"onError",cx.b.USER_EXITED_SET_PASSWORD_FLOW),h(a)},callAuthOnSuccessOnClose:!1},recoverWallet:{entropyId:k,entropyIdVerifier:l,onFailure:h},connectWallet:m,recoverySelection:{isInAccountCreateFlow:!1,isResettingPassword:i,shouldCreateEth:!1,shouldCreateSol:!1}}),ao("EmbeddedWalletConnectingScreen")})}async function aE({appId:a,action:b}){let d=await BX();if("link"===b&&!d)throw(0,gh.e)(ae,"linkAccount","onError",cx.b.MUST_BE_AUTHENTICATED,{linkMethod:`privy:${a}`}),new cx.a("User must be authenticated before linking an account.");if("login"===b&&d)throw(0,gh.e)(ae,"login","onError",cx.b.UNKNOWN_AUTH_ERROR),new cx.a("Attempted to log in, but user is already logged in. Use a `link` helper instead.");ak.current=`privy:${a}`,al.current=b;let e=(0,fi.trigger)();return c.createAnalyticsEvent({eventName:"cross_app_auth_started",payload:{providerAppId:a}}),new Promise(async(d,g)=>{let{name:h,logoUrl:i}=await C7({api:c.api,providerAppId:a,requesterAppId:f.id});W({crossAppAuth:{appId:a,name:h,logoUrl:i,action:b,popup:e,onSuccess:d,onError:g}}),ao("CrossAppAuthScreen")})}let aF={ready:o,authenticated:ah,user:q,walletConnectors:c.connectors||null,connectWallet:a=>{a&&"target"in a&&a&&(a=void 0),W({externalConnectWallet:{walletList:a?.walletList&&a?.walletList.length>0?a.walletList:void 0,walletChainType:a?.walletChainType,description:a?.description,hideHeader:a?.hideHeader}}),ao("ConnectOnlyLandingScreen")},linkWallet:a=>(a&&"target"in a&&a&&(a=void 0),ax("siwe"),ak.current="siwe",al.current="link",W({...V,externalConnectWallet:{...V.externalConnectWallet,walletList:a?.walletList,walletChainType:a?.walletChainType,description:a?.description||`Link a wallet to your ${f?.name} account`}}),ao("AuthenticateWithWalletScreen")),startCrossAppAuthFlow:aE,linkEmail:()=>{ax("email"),aC("email"),ak.current="email",al.current="link",ao("LinkEmailScreen")},linkPhone:()=>{ax("sms"),aC("phone"),ak.current="sms",al.current="link",ao("LinkPhoneScreen")},linkGoogle:async()=>{ax("google"),aC("google_oauth"),al.current="link",await aG.initLoginWithOAuth("google")},linkTwitter:async()=>{ax("twitter"),aC("twitter_oauth"),al.current="link",await aG.initLoginWithOAuth("twitter")},linkTwitch:async()=>{ax("twitch"),aC("twitch_oauth"),al.current="link",await aG.initLoginWithOAuth("twitch")},linkDiscord:async()=>{ax("discord"),aC("discord_oauth"),al.current="link",await aG.initLoginWithOAuth("discord")},linkGithub:async()=>{ax("github"),aC("github_oauth"),al.current="link",await aG.initLoginWithOAuth("github")},linkSpotify:async()=>{ax("spotify"),aC("spotify_oauth"),al.current="link",await aG.initLoginWithOAuth("spotify")},linkInstagram:async()=>{ax("instagram"),aC("instagram_oauth"),al.current="link",await aG.initLoginWithOAuth("instagram")},linkTiktok:async()=>{ax("tiktok"),aC("tiktok_oauth"),al.current="link",await aG.initLoginWithOAuth("tiktok")},linkLine:async()=>{ax("line"),aC("line_oauth"),al.current="link",await aG.initLoginWithOAuth("line")},linkLinkedIn:async()=>{ax("linkedin"),aC("linkedin_oauth"),al.current="link",await aG.initLoginWithOAuth("linkedin")},linkApple:async()=>{ax("apple"),aC("apple_oauth"),al.current="link",await aG.initLoginWithOAuth("apple")},linkPasskey:async()=>{ax("passkey"),aC("passkey"),await aG.initLinkWithPasskey(),ao("LinkPasskeyScreen")},linkTelegram:async a=>{if(ax("telegram"),aC("telegram"),al.current="link",ak.current="telegram",a?.launchParams)if(a.launchParams.initDataRaw){let b=new Ck;c.startAuthFlow(b),b.meta.telegramAuthResult=void 0,b.meta.telegramWebAppData=Cm(a.launchParams.initDataRaw),W({telegramAuthModalData:{seamlessAuth:!0}}),ao("TelegramAuthScreen")}else(0,gh.e)(ae,"linkAccount","onError",cx.b.INVALID_DATA,{linkMethod:"telegram"});else await aG.initLoginWithTelegram();ao("TelegramAuthScreen")},linkFarcaster:async()=>{ax("farcaster"),aC("farcaster"),await aG.initLoginWithFarcaster(),al.current="link",ak.current="farcaster",ao("FarcasterConnectStatusScreen")},updateEmail:()=>{if(ax("email"),!q?.email)throw new cx.a("User does not have an email linked to their account.");al.current="update",ak.current="email",ao("UpdateEmailScreen")},updatePhone:()=>{if(ax("sms"),!q?.phone)throw new cx.a("User does not have a phone number linked to their account.");al.current="update",ak.current="sms",ao("UpdatePhoneScreen")},login:async a=>{a&&"target"in a&&a&&(a=void 0);let b="Attempted to log in, but user is already logged in. Use a `link` helper instead.";if(!o){let a=await new Promise(a=>{Y(b=>a.bind(b))});if(Y(null),a)return void console.warn(b)}!q||q.isGuest?(al.current="login",W({login:a}),ao("LandingScreen")):console.warn(b)},connectOrCreateWallet:async()=>{o||(await new Promise(a=>{Y(()=>a)}),Y(null)),ah?console.warn("User must be unauthenticated to `connectOrCreateWallet`"):(al.current="connect-or-create",ao("ConnectOrCreateScreen"))},logout:async()=>{if(al.current=null,ak.current=null,q&&c.clearProviderAcccessTokens(q),y(null),await c.logout(),q&&P)try{await P.clearMfa({userId:q.id})}catch(a){}r(null),aj(!1),G({status:"initial"}),I({status:"initial"}),E({status:"initial"}),K({status:"initial"}),M({status:"initial"}),O({status:"initial"}),(0,gh.e)(ae,"logout","onSuccess"),h(!1),cy.u.del(fb.d),cy.u.del((0,fb.g)(f.id))},getAccessToken:(0,R.useCallback)(async()=>{let a=await c.getCustomerAccessToken();return a&&!ah&&aj(!0),a},[c,ah]),unlinkWallet:async a=>{let b;return r(b=a.startsWith("0x")?await c.unlinkEthereumWallet(a):await c.unlinkSolanaWallet(a)),b},unlinkEmail:async a=>{let b=await c.unlinkEmail(a);return r(b),b},unlinkPhone:async a=>{let b=await c.unlinkPhone(a);return r(b),b},unlinkGoogle:async a=>{let b=await c.unlinkOAuth("google",a);return r(b),b},unlinkTwitter:async a=>{let b=await c.unlinkOAuth("twitter",a);return r(b),b},unlinkTwitch:async a=>{let b=await c.unlinkOAuth("twitch",a);return r(b),b},unlinkDiscord:async a=>{let b=await c.unlinkOAuth("discord",a);return r(b),b},unlinkGithub:async a=>{let b=await c.unlinkOAuth("github",a);return r(b),b},unlinkSpotify:async a=>{let b=await c.unlinkOAuth("spotify",a);return r(b),b},unlinkInstagram:async a=>{let b=await c.unlinkOAuth("instagram",a);return r(b),b},unlinkTiktok:async a=>{let b=await c.unlinkOAuth("tiktok",a);return r(b),b},unlinkLine:async a=>{let b=await c.unlinkOAuth("line",a);return r(b),b},unlinkLinkedIn:async a=>{let b=await c.unlinkOAuth("linkedin",a);return r(b),b},unlinkApple:async a=>{let b=await c.unlinkOAuth("apple",a);return r(b),b},unlinkFarcaster:async a=>{let b=await c.unlinkFarcaster(a);return r(b),b},unlinkTelegram:async a=>{let b=await c.unlinkTelegram(a);return r(b),b},unlinkPasskey:async a=>{let b=await BX();if(!b)throw Error("Must have valid access token to enroll in MFA");if(!P)throw Error("Wallet proxy not initialized.");let d=f.passkeys.shouldUnenrollMfaOnUnlink;await P.unlinkPasskeyAccount({credentialId:a,accessToken:b,removeAsMfa:d});let e=await c.getAuthenticatedUser();return r(e),e},unlinkCrossAppAccount:async({subject:a})=>{let b=q?.linkedAccounts.find(b=>"cross_app"===b.type&&b.subject===a)?.providerApp;if(!b)throw new cx.a("Invalid subject");c.storeProviderAccessToken(b.id,null);let d=await c.unlinkOAuth(`privy:${b.id}`,a);return r(d),d},setWalletRecovery:async a=>aD({legacySetWalletPasswordFlow:!1,showAutomaticRecovery:a?.showAutomaticRecovery??!1}),setWalletPassword:async()=>aD({legacySetWalletPasswordFlow:!0,showAutomaticRecovery:!1}),signMessage:(a,b)=>new Promise(async(e,f)=>{let{requesterAppId:g}=b?.uiOptions||{},h=a.message,i=b?.address?(0,ct.h)(q,b.address):(0,ct.b)(q);if(!i&&void 0!==b?.address){let a=(0,ct.k)(Dq.getState().ethereum,b.address);if(a)try{let b=await a.getEthereumProvider(),c=await b.request({method:"personal_sign",params:[h,a.address]});return(0,gh.e)(ae,"signMessage","onSuccess",{signature:c}),void e({signature:c})}catch(a){return(0,gh.e)(ae,"signMessage","onError",cx.b.UNABLE_TO_SIGN),void f(a??new cy.P("Unable to sign message"))}}if(!i)throw new cx.a("No embedded or connected wallet found for address.");if(!ah||!q)return(0,gh.e)(ae,"signMessage","onError",cx.b.MUST_BE_AUTHENTICATED),void f(Error("User must be authenticated before signing with a Privy wallet"));let j=i.address,k=i.walletIndex??0,{entropyId:l,entropyIdVerifier:m}=(0,cw.g)(q,i),n=(0,ct.d)(i);if("string"!=typeof h||h.length<1)return(0,gh.e)(ae,"signMessage","onError",cx.b.INVALID_MESSAGE),void f(Error("Message must be a non-empty string"));let o=async()=>{let b;if(!ah)throw Error("User must be authenticated before signing with a Privy wallet");let e=await BX();if(!P||!e||!await aG.recoverEmbeddedWallet({address:j}))throw Error("Unable to connect to wallet");if(c.createAnalyticsEvent({eventName:"embedded_wallet_sign_message_started",payload:{walletAddress:j,requesterAppId:g}}),n){let c=(0,fg.isHex)(a.message,{strict:!0}),f=await (0,U.rpc)(d,async({message:a})=>await P.signWithUserSigner({accessToken:e,requesterAppId:g,message:a}),{chain_type:"ethereum",method:"personal_sign",params:c?{message:h.slice(2),encoding:"hex"}:{message:h,encoding:"utf-8"},wallet_id:i.id});if(!f.data||!("signature"in f.data))throw new cy.P("Unable to sign message");b=f.data.signature}else{let{response:a}=await P.rpc({accessToken:e,entropyId:l,entropyIdVerifier:m,chainType:"ethereum",hdWalletIndex:k,requesterAppId:g,request:{method:"personal_sign",params:[h,j]}});b=a.data}return c.createAnalyticsEvent({eventName:"embedded_wallet_sign_message_completed",payload:{walletAddress:j,requesterAppId:g}}),b};if(an({showWalletUIs:b?.uiOptions?.showWalletUIs}))try{let a=await o();(0,gh.e)(ae,"signMessage","onSuccess",{signature:a}),e({signature:a})}catch(a){(0,gh.e)(ae,"signMessage","onError",cx.b.UNABLE_TO_SIGN),f(a??new cy.P("Unable to sign message"))}else W({signMessage:{method:"personal_sign",data:h,confirmAndSign:o,onSuccess:a=>{(0,gh.e)(ae,"signMessage","onSuccess",{signature:a}),e({signature:a})},onFailure:a=>{(0,gh.e)(ae,"signMessage","onError",cx.b.UNABLE_TO_SIGN),f(a)},uiOptions:b?.uiOptions||{}},connectWallet:{recoveryMethod:i.recoveryMethod,connectingWalletAddress:j,entropyId:l,entropyIdVerifier:m,onCompleteNavigateTo:"SignRequestScreen",isUnifiedWallet:n,onFailure:a=>{(0,gh.e)(ae,"signMessage","onError",cx.b.UNKNOWN_CONNECT_WALLET_ERROR),f(a)}}}),ao("EmbeddedWalletConnectingScreen")}),signTypedData:(a,b)=>new Promise(async(e,f)=>{let{requesterAppId:g}=b?.uiOptions||{},h=b?.address?(0,ct.h)(q,b.address):(0,ct.b)(q);if(!h&&b?.address){let c=(0,ct.k)(Dq.getState().ethereum,b.address);if(c)try{let b=await c.getEthereumProvider(),d=(0,cv.m)(a),f=await b.request({method:"eth_signTypedData_v4",params:[c.address,d]});return(0,gh.e)(ae,"signTypedData","onSuccess",{signature:f}),void e({signature:f})}catch(a){return(0,gh.e)(ae,"signTypedData","onError",cx.b.UNABLE_TO_SIGN),void f(a??new cy.P("Unable to sign typed data "+a))}}if(!h)throw new cx.a("No embedded or connected wallet found for address.");if(!ah||!q)return(0,gh.e)(ae,"signTypedData","onError",cx.b.MUST_BE_AUTHENTICATED),void f(Error("User must be authenticated before signing with a Privy wallet"));let i=h.address,j=h.walletIndex??0,{entropyId:k,entropyIdVerifier:l}=(0,cw.g)(q,h),m=(0,ct.d)(h),n=(0,cv.m)(a),o=async()=>{let a;if(!ah)throw Error("User must be authenticated before signing with a Privy wallet");let b=await BX();if(!P||!b||!await aG.recoverEmbeddedWallet({address:i}))throw Error("Unable to connect to wallet");if(c.createAnalyticsEvent({eventName:"embedded_wallet_sign_typed_data_started",payload:{walletAddress:i,requesterAppId:g}}),m){let{domain:c,types:e,primaryType:f,message:i}=n,j=await (0,U.rpc)(d,async({message:a})=>await P.signWithUserSigner({accessToken:b,requesterAppId:g,message:a}),{chain_type:"ethereum",method:"eth_signTypedData_v4",params:{typed_data:{domain:c,types:e,primary_type:f,message:i}},wallet_id:h.id});if(!j.data||!("signature"in j.data))throw new cy.P("Unable to sign message");a=j.data.signature}else{let{response:c}=await P.rpc({accessToken:b,entropyId:k,entropyIdVerifier:l,chainType:"ethereum",hdWalletIndex:j,requesterAppId:g,request:{method:"eth_signTypedData_v4",params:[i,n]}});a=c.data}return c.createAnalyticsEvent({eventName:"embedded_wallet_sign_typed_data_completed",payload:{walletAddress:i,requesterAppId:g}}),a};if(an({showWalletUIs:b?.uiOptions?.showWalletUIs}))try{let a=await o();(0,gh.e)(ae,"signTypedData","onSuccess",{signature:a}),e({signature:a})}catch(a){(0,gh.e)(ae,"signTypedData","onError",cx.b.UNABLE_TO_SIGN),f(a??new cy.P("Unable to sign message"))}else W({signMessage:{method:"eth_signTypedData_v4",data:n,confirmAndSign:o,onSuccess:a=>{(0,gh.e)(ae,"signTypedData","onSuccess",{signature:a}),e({signature:a})},onFailure:a=>{(0,gh.e)(ae,"signTypedData","onError",cx.b.UNABLE_TO_SIGN),f(a)},uiOptions:b?.uiOptions||{}},connectWallet:{recoveryMethod:h.recoveryMethod,connectingWalletAddress:h.address,entropyId:k,isUnifiedWallet:m,entropyIdVerifier:l,onCompleteNavigateTo:"SignRequestScreen",onFailure:a=>{(0,gh.e)(ae,"signMessage","onError",cx.b.UNKNOWN_CONNECT_WALLET_ERROR),f(a)}}}),ao("EmbeddedWalletConnectingScreen")}),sendTransaction:async(a,b)=>await az({transaction:a,sponsor:b?.sponsor,uiOptions:b?.uiOptions,fundWalletConfig:b?.fundWalletConfig,address:b?.address,signOnly:!1}),signTransaction:async(a,b)=>({signature:(await az({transaction:a,uiOptions:b?.uiOptions,address:b?.address,signOnly:!0})).hash}),exportWallet:a=>new Promise(async(d,e)=>{if(!ah||!q)return void e(Error("User must be authenticated before exporting their Privy wallet"));a&&"target"in a&&a&&(a=void 0);let f=a?.address?(0,ct.h)(q,a.address):(0,ct.b)(q);if(!f)return void e(new cx.a("User must have an embedded wallet."));let g=f.address,{entropyId:h,entropyIdVerifier:i}=(0,cw.g)(q,f),j=(0,ct.d)(f);if(!g)return void e(Error("User does not have an HD Ethereum wallet. To export an imported wallet, pass the `address` of the wallet to `exportWallet`."));if(!(0,fe.isAddress)(g))return void e(Error("Must provide a valid Ethereum address."));let k={recoveryMethod:f.recoveryMethod,connectingWalletAddress:f.address,isUnifiedWallet:j,entropyId:h,entropyIdVerifier:i,onCompleteNavigateTo:"EmbeddedWalletKeyExportScreen",onFailure:e,shouldForceMFA:!0};W(V),await BX()&&P?P?(0,cy.i)(f)?(W({keyExport:{appId:b.appId,appClientId:b.clientId,origin:c.apiUrl,address:f.address,entropyId:h,entropyIdVerifier:i,hdWalletIndex:f.walletIndex,chainType:f.chainType,walletId:f.id,isUnifiedWallet:j,imported:f.imported,onSuccess:d,onFailure:e},connectWallet:k}),ao("EmbeddedWalletConnectingScreen")):e(Error(`Export is not supported for ${f.chainType} wallets`)):e(Error("Must have a Privy wallet before exporting")):e(Error("Must have valid access token to enroll in MFA"))}),promptMfa:aA,async init(a){switch(a){case"sms":return void await c.initMfaSmsVerification();case"passkey":return await c.initMfaPasskeyVerification();case"totp":return;default:throw Error(`Unsupported MFA method: ${a}`)}},async submit(b,c){switch(b){case"totp":case"sms":if("string"!=typeof c)throw new cx.a("Invalid MFA code");ac.current?.resolve({mfaMethod:b,mfaCode:c,relyingParty:window.origin}),await new Promise((a,b)=>{ad.current={resolve:a,reject:b}});break;case"passkey":let d;if("string"==typeof c)throw new cx.a("Invalid authenticator response");let e=await a.A(577627),f={id:(d=await e.startAuthentication({optionsJSON:c})).id,raw_id:d.rawId,response:{client_data_json:d.response.clientDataJSON,authenticator_data:d.response.authenticatorData,signature:d.response.signature,user_handle:d.response.userHandle},authenticator_attachment:d.authenticatorAttachment,client_extension_results:{app_id:d.clientExtensionResults.appid,cred_props:d.clientExtensionResults.credProps,hmac_create_secret:d.clientExtensionResults.hmacCreateSecret},type:d.type};ac.current?.resolve({mfaMethod:b,mfaCode:f,relyingParty:window.origin}),await new Promise((a,b)=>{ad.current={resolve:a,reject:b}});break;default:throw ac.current?.reject(new cx.a("Unsupported MFA method")),new cx.a(`Unsupported MFA method: ${b}`)}},cancel(){ac.current?.reject(new cx.a("MFA canceled"))},async initEnrollmentWithSms(a){let b=await BX();if(!b||!P)throw Error("Must have valid access token to enroll in MFA");await P.initEnrollMfa({method:"sms",accessToken:b,phoneNumber:a.phoneNumber})},enrollInMfa:a=>new Promise((b,c)=>{a?(f.mfa.noPromptOnMfaRequired&&console.warn("[Privy Warning] Triggering the 'showMfaEnrollmentModal' function when 'noPromptOnMfaRequired' is set to true is unexpected. If this is intentional, ensure that you are building custom UIs for MFA verification."),W({mfaEnrollmentFlow:{mfaMethods:f.mfa.methods,shouldUnlinkOnUnenrollMfa:f.passkeys.shouldUnlinkOnUnenrollMfa,onSuccess:b,onFailure:c}}),ao("MfaEnrollmentFlowScreen")):(aG.closePrivyModal(),b())}),async initEnrollmentWithTotp(){let a=await BX();if(!a||!P)throw Error("Must have valid access token to enroll in MFA");let b=await P.initEnrollMfa({method:"totp",accessToken:a});return{secret:b.secret,authUrl:b.authUrl}},async submitEnrollmentWithSms(a){let b=await BX();if(!b||!P)throw Error("Must have valid access token to enroll in MFA");await P.submitEnrollMfa({method:"sms",accessToken:b,phoneNumber:a.phoneNumber,code:a.mfaCode}),r(await c.getAuthenticatedUser())},async submitEnrollmentWithTotp(a){let b=await BX();if(!b||!P)throw Error("Must have valid access token to enroll in MFA");await P.submitEnrollMfa({method:"totp",accessToken:b,code:a.mfaCode}),r(await c.getAuthenticatedUser())},async initEnrollmentWithPasskey(){},async submitEnrollmentWithPasskey({credentialIds:a},b={}){let d=await BX();if(!d||!P)throw Error("Must have valid access token to enroll in MFA");await P.submitEnrollMfa({method:"passkey",accessToken:d,credentialIds:a,removeForLogin:b.removeForLogin}),r(await c.getAuthenticatedUser())},async unenroll(a,b={}){let d=await BX();if(!d||!P)throw Error("Must have valid access token to remove MFA");"passkey"===a?await P.submitEnrollMfa({method:"passkey",accessToken:d,credentialIds:[],removeForLogin:b.removeForLogin}):await P.unenrollMfa({method:a,accessToken:d}),r(await c.getAuthenticatedUser())},requestFarcasterSignerFromWarpcast:async()=>{let a=await BX(),b=q?.linkedAccounts.find(a=>"wallet"===a.type&&"privy"===a.walletClientType);if(!a)throw Error("Must have valid access token to connect with Farcaster");if(!P||!b)throw Error("Must have an embedded wallet to use Farcaster signers");if((0,ct.d)(b))throw new cx.a("Farcaster signers are only supported for on-device execution and this app uses TEE execution. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");if(!q?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");if(!await aG.recoverEmbeddedWallet({address:b.address}))throw Error("Unable to connect to wallet");let d=await P.initFarcasterSigner({address:b.address,hdWalletIndex:null,accessToken:a,mfaCode:null,mfaMethod:null,relyingParty:window.origin});"approved"===d.status&&r(await c.getAuthenticatedUser()||q||null),W({farcasterSigner:d}),ao("FarcasterSignerStatusScreen")},getFarcasterSignerPublicKey:async()=>{let a,b=await BX(),c=q?.linkedAccounts.find(a=>"wallet"===a.type&&"privy"===a.walletClientType);if(!b)throw Error("Must have valid access token to connect with Farcaster");if(!P||!c)throw Error("Must have an embedded wallet to use Farcaster signers");if((0,ct.d)(c))throw new cx.a("Farcaster signers are only supported for on-device execution and this app uses TEE execution. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");if(!q?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");if(!await aG.recoverEmbeddedWallet({address:c.address}))throw Error("Unable to connect to wallet");if(!q.farcaster?.signerPublicKey)throw Error("Must have a Farcaster signer public key to sign");return a=q.farcaster.signerPublicKey.slice(2),Uint8Array.from(a.match(/.{1,2}/g).map(a=>parseInt(a,16)))},signFarcasterMessage:async b=>{let c=await BX(),d=q?.linkedAccounts.find(a=>"wallet"===a.type&&"privy"===a.walletClientType);if(!c)throw Error("Must have valid access token to connect with Farcaster");if(!P||!d)throw Error("Must have an embedded wallet to use Farcaster signers");if((0,ct.d)(d))throw new cx.a("Farcaster signers are only supported for on-device execution and this app uses TEE execution. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");if(!q?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");if(!await aG.recoverEmbeddedWallet({address:d.address}))throw Error("Unable to connect to wallet");if(!q.farcaster?.signerPublicKey)throw Error("Must have a Farcaster signer public key to sign");let e=await a.A(577627),f=await P.signFarcasterMessage({address:d.address,hdWalletIndex:null,accessToken:c,mfaCode:null,mfaMethod:null,payload:{hash:e.bufferToBase64URLString(b)},fid:BigInt(q.farcaster.fid),relyingParty:window.origin});return new Uint8Array(e.base64URLStringToBuffer(f.signature))},signMessageWithCrossAppWallet(a,{address:b,chainId:d}){let e=q?.linkedAccounts.some(a=>"cross_app"===a.type&&a.smartWallets.some(a=>a.address===b));return C8({user:q,client:c,address:b,requesterAppId:f.id,request:{method:e?"privy_signSmartWalletMessage":"personal_sign",params:[a,b],chainId:d},reconnect:aE})},signTypedDataWithCrossAppWallet(a,{address:b,chainId:d}){let e=q?.linkedAccounts.some(a=>"cross_app"===a.type&&a.smartWallets.some(a=>a.address===b)),g=(0,cv.m)(a);return C8({user:q,client:c,address:b,requesterAppId:f.id,request:{method:e?"privy_signSmartWalletTypedData":"eth_signTypedData_v4",params:[b,g],chainId:d},reconnect:aE})},sendTransactionWithCrossAppWallet(a,{address:b}){let d=q?.linkedAccounts.some(a=>"cross_app"===a.type&&a.smartWallets.some(a=>a.address===b));return C8({user:q,client:c,address:b,requesterAppId:f.id,request:{method:d?"privy_sendSmartWalletTx":"eth_sendTransaction",params:[a],chainId:a.chainId},reconnect:aE})},signTransactionWithCrossAppWallet(a,{address:b}){let d=q?.linkedAccounts.some(a=>"cross_app"===a.type&&a.smartWallets.some(a=>a.address===b));return C8({user:q,client:c,address:b,requesterAppId:f.id,request:{method:d?"privy_signSmartWalletTx":"eth_signTransaction",params:[a],chainId:a.chainId},reconnect:aE})},isModalOpen:g||!!n,mfaMethods:f.mfa.methods};i=aF.signMessage,j=aF.signTypedData,l=async(a,b)=>await az({transaction:a,...b,signOnly:!1}),k=async(a,b)=>({signature:(await az({transaction:a,...b,signOnly:!0})).hash});let aG={privy:d,setAuthenticated:aj,setUser:r,setIsNewUser:w,isNewUserThisSession:v,pendingTransaction:null,walletConnectionStatus:B,setWalletConnectionStatus:C,connectors:c.connectors?.walletConnectors??[],rpcConfig:f.rpcConfig,chains:f.chains,appId:b.appId,showFiatPrices:"native-token"!==f.embeddedWallets.priceDisplay.primary,clientAnalyticsId:c.clientAnalyticsId,onCustomAuthAuthenticated:ap,hideWalletUIs:am,isHeadlessSigning:(0,R.useCallback)(an,[f.embeddedWallets.showWalletUIs]),emailOtpState:F,setEmailOtpState:G,smsOtpState:H,setSmsOtpState:I,oAuthState:L,setOAuthState:M,telegramAuthState:N,setTelegramAuthState:O,siweState:J,setSiweState:K,isHeadlessOAuthLoading:z,baseAccountSdk:t,setBaseAccountSdk:u,nativeTokenSymbolForChainId:a=>f.chains.find(b=>b.id===Number(a))?.nativeCurrency.symbol,initializeWalletProxy:async a=>{if(P)return P;let b=new Promise(a=>{Z.current=a}),c=new Promise(b=>setTimeout(()=>b(null),a)),d=await Promise.race([b,c]);return Z.current=null,d},getAuthFlow:()=>c.authFlow,getAuthMeta:()=>c.authFlow?.meta,client:c,closePrivyModal:async(a={shouldCallAuthOnSuccess:!0,isSuccess:!1})=>{let d,g=o&&ah&&q;if(g&&ak.current&&(d=aB(q)),"login"===al.current)a.shouldCallAuthOnSuccess&&g&&ak.current?(0,gh.e)(ae,"login","onComplete",{user:q,isNewUser:v,wasAlreadyAuthenticated:!1,loginMethod:ak.current,loginAccount:d??null}):(0,gh.e)(ae,"login","onError",cx.b.USER_EXITED_AUTH_FLOW);else if("link"===al.current&&d)a.isSuccess&&g&&ak.current?(0,gh.e)(ae,"linkAccount","onSuccess",{user:q,linkMethod:ak.current,linkedAccount:d}):ak.current&&(0,gh.e)(ae,"linkAccount","onError",cx.b.USER_EXITED_LINK_FLOW,{linkMethod:ak.current});else if("update"===al.current&&d)a.isSuccess&&g&&ak.current?(0,gh.e)(ae,"update","onSuccess",{user:q,updateMethod:ak.current,updatedAccount:d}):ak.current&&(0,gh.e)(ae,"update","onError",cx.b.USER_EXITED_UPDATE_FLOW,{linkMethod:ak.current});else if("connect-or-create"===al.current){let a=Dq.getState().ethereum;a[0]?(0,gh.e)(ae,"connectOrCreateWallet","onSuccess",{wallet:a[0]}):(0,gh.e)(ae,"connectOrCreateWallet","onError",cx.b.USER_EXITED_AUTH_FLOW)}let i=x&&Df.has(x),j="ErrorScreen"===x&&V.errorModalData&&Df.has(V.errorModalData.previousScreen);if((i||j)&&V.funding){let a,c=Df.get(x)??null;if(j&&V.funding?.onError){let a=V.errorModalData?.error,b=a?.privyErrorCode||cx.b.UNKNOWN_FUNDING_ERROR,c=new cx.a(a?.message||"Funding failed",a,b);V.funding?.onError?.(c)}if("solana"===V.funding.chainType){let b=f.solanaRpcs[V.funding.chain];if(!b)return void console.warn("Unable to load solana rpc, skipping balance");if(e(ge.S))try{a=await Dh({rpc:b.rpc,address:V.funding.address})}catch{console.error("Unable to pull wallet balance")}else console.warn("Unable to load solana plugin, skipping balance");(0,gh.e)(ae,"fundSolanaWallet","onUserExited",{address:V.funding.address,fundingMethod:c,chain:V.funding.chain,balance:a})}else{let d=(0,wN.g)(V.funding.chain.id,f.chains,f.rpcConfig,{appId:b.appId});try{a=await d.getBalance({address:V.funding.address})}catch{console.error("Unable to pull wallet balance")}(0,gh.e)(ae,"fundWallet","onUserExited",{address:V.funding.address,chain:V.funding.chain,fundingMethod:c,balance:a}),function(a,b){if(a.onComplete)switch(b){case"external":a.fundingResult?a.onComplete({...a.fundingResult,fundingMethod:b}):a.onComplete({status:"cancelled",address:a.address,fundingMethod:b,amount:a.amount});break;case null:a.onComplete({status:"cancelled",address:a.address,fundingMethod:void 0,amount:a.amount});break;default:a.onComplete({status:"completed",address:a.address,fundingMethod:b,amount:a.amount})}}(V.funding,c)}}W(a=>({...a,externalConnectWallet:{}})),al.current=null,ak.current=null,w(!1),h(!1),C({status:"disconnected",connectedWallet:null,connector:null,connectError:null,connectRetry:()=>{}}),setTimeout(()=>{c.authFlow=void 0},200)},openPrivyModal:ao,connectWallet:at,initLoginWithWallet:async(a,b,c,d)=>{(0,cv.f)(a)?(ak.current="siwe",au(a,b,c)):(ak.current="siws",av(a,b,c,d))},loginWithWallet:async()=>{let a,b,d;if(!o)throw new cx.g;if(c.authFlow instanceof Cc?a="siwe":c.authFlow instanceof Cd&&(a="siws"),!a)throw new cx.a("Must initialize SIWE/SIWS flow first.");if(null!==await c.getAccessToken())try{({user:b}=await c.link()),ak.current=a}catch(b){throw(0,gh.e)(ae,"linkAccount","onError",b.privyErrorCode||cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:a}),b}else try{({user:b,isNewUser:d}=await c.authenticate()),ak.current=a}catch(a){throw(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.GENERIC_CONNECT_WALLET_ERROR),a}r(b||q||null),w(d||!1),aj(!0)},delegateWallet:async({address:a,chainType:b,showDelegationUIs:c})=>new Promise(async(d,e)=>{let f=await BX();if(!ah||!q||!f)throw new cx.a("User must be authenticated and have an embedded wallet to delegate actions.");if("solana"!==b&&"ethereum"!==b)throw new cx.a("Only Solana and Ethereum embedded wallets are supported for delegation and revocation.");let g=aG.walletProxy??await aG.initializeWalletProxy(15e3);if(!g)throw new cx.a("Wallet proxy not initialized.");if((({address:a,user:b})=>!!C3(b).find(b=>b.address===a))({address:a,user:q}))return d();let h=(0,ct.h)(q,a);if(!h)throw new cx.a("Address to delegate is not associated with current user.");if((0,ct.d)(h))throw new cx.a("useDelegatedActions is only supported for on-device execution and this app uses TEE execution. Use the useSessionSigners hook to provision server side access on behalf of your users. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");let i=(({address:a,user:b})=>{let c=b.linkedAccounts.find(b=>"wallet"===b.type&&"privy"===b.walletClientType&&b.address===a);if(!c)throw new cx.a("Address to delegate is not associated with current user.");if(!(0,cy.i)(c))throw new cx.a(`useDelegatedActions is not supported for ${c.chainType} wallets. Use the useSessionSigners hook to provision server side access on behalf of your users.`);return{address:c.address,chainType:c.chainType,walletIndex:c.walletIndex??0}})({address:a,user:q}),j=(({address:a,user:b})=>{let c=b.linkedAccounts.find(b=>"wallet"===b.type&&"privy"===b.walletClientType&&b.address===a);if(!c)throw new cx.a("Address to delegate is not associated with current user.");let d=c.imported?c:(0,ct.g)(b);if(!d)throw new cx.a("Unable to determine root address for delegated address.");if(!(0,cy.i)(d))throw new cx.a(`useDelegatedActions is not supported for ${d.chainType} wallets. Use the useSessionSigners hook to provision server side access on behalf of your users.`);return{address:d.address,chainType:d.chainType,imported:d.imported}})({address:a,user:q}),k=async()=>{await g.createDelegatedAction({accessToken:f,rootWallet:j,delegatedWallets:[i]}),await aG.refreshSessionAndUser()};if(await aG.recoverEmbeddedWallet({address:a}),c)W({delegatedActions:{consent:{address:a,onDelegate:k,onSuccess:async()=>{d()},onError:async a=>{e(a)}}}}),ao("DelegatedActionsConsentScreen");else try{await k(),d()}catch(a){e(a)}}),revokeDelegatedWallets:async({showDelegationUIs:a})=>new Promise(async(b,d)=>{if(!ah||!q)throw new cx.a("User must be authenticated and have an embedded wallet to revoke a delegated wallet.");let e=C3(q);if(0===e.length)throw new cx.a("User has no delegated wallets to revoke.");if(e.some(ct.d))throw new cx.a("useDelegatedActions is only supported for on-device execution and this app uses TEE execution. Use the useSessionSigners hook to provision server side access on behalf of your users. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");let f=async()=>{await c.revokeDelegatedWallet(),await aG.refreshSessionAndUser()};if(a)W({delegatedActions:{revoke:{onRevoke:f,onSuccess:async()=>{b()},onError:async a=>{d(a)}}}}),ao("DelegatedActionsRevokeScreen");else try{await f(),b()}catch(a){d(a)}}),initLoginWithFarcaster:async(a,b)=>{let d=new B1(a,b);c.startAuthFlow(d);try{ak.current="farcaster",await d.initializeFarcasterConnect()}catch(a){throw"login"===al.current?(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR):"link"===al.current&&(0,gh.e)(ae,"linkAccount","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR,{linkMethod:"farcaster"}),a}},loginWithFarcaster:async()=>{let a,b;if(!o)throw new cx.g;if(!(c.authFlow instanceof B1))throw new cx.a("Must initialize Farcaster flow first.");if(null!==await c.getAccessToken())try{({user:a}=await c.link()),ak.current="farcaster"}catch(a){throw(0,gh.e)(ae,"linkAccount","onError",a.privyErrorCode||cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"farcaster"}),a}else try{({user:a,isNewUser:b}=await c.authenticate()),ak.current="farcaster"}catch(a){throw(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR),a}r(a||null),w(b||!1),aj(!0)},async crossAppAuthFlow({appId:a,popup:b,action:d}){let e=`privy:${a}`;ak.current=e;let{url:f,stateCode:g,codeVerifier:h}=await async function({api:a,appId:b}){let c=B5(),d=B6(),e=await B7(c);try{let{url:f}=await a.post(fO,{provider:`privy:${b}`,redirect_to:window.location.href,code_challenge:e,state_code:d});return{url:f,stateCode:d,codeVerifier:c}}catch(a){throw(0,cx.f)(a)}}({api:c.api,appId:a});if(!f)throw c.createAnalyticsEvent({eventName:"cross_app_auth_error",payload:{error:"Unable to open cross-app auth popup",appId:a}}),new cx.a("No authorization URL returned for cross-app auth.");try{let i=await async function({url:a,popup:b}){return b.location=a,new Promise((a,c)=>{let d,e=setTimeout(()=>{c(new cx.a("Authorization request timed out after 2 minutes.")),f()},12e4);function f(){b?.close(),window.removeEventListener("message",h)}let g=setInterval(()=>{b?.closed&&!d&&(f(),clearInterval(g),clearTimeout(e),c(new cx.a("User rejected request")))},300);function h(b){b.data&&("PRIVY_OAUTH_RESPONSE"===b.data.type&&b.data.stateCode&&b.data.authorizationCode&&(clearTimeout(e),a(b.data),f()),"PRIVY_OAUTH_ERROR"===b.data.type&&(clearTimeout(e),c(new cx.a(b.data.error)),f()),b.data.type===C5&&((d=new BroadcastChannel(C4)).onmessage=h))}window.addEventListener("message",h)})}({url:f,popup:b,provider:e}),j=i.stateCode,k=i.authorizationCode;if(j!==g)throw c.createAnalyticsEvent({eventName:"possible_phishing_attempt",payload:{provider:e,storedStateCode:g??"",returnedStateCode:j??""}}),new cx.a("Unexpected auth flow. This may be a phishing attempt.",void 0,cx.b.OAUTH_UNEXPECTED);let l=await async function({appId:a,stateCode:b,codeVerifier:c,authorizationCode:d,action:e,client:f}){if(!d||!b)throw new cx.a("[Cross-App AuthFlow] Authorization and state codes code must be set prior to calling authenicate.");if("undefined"===d)throw new cx.a("User denied confirmation during cross-app auth flow");try{let g=new C6({authorizationCode:d,stateCode:b,codeVerifier:c,provider:`privy:${a}`});f.startAuthFlow(g);let h="link"===e?await f.link():await f.authenticate(),i=h.oAuthTokens?.accessToken;return console.debug(),i}catch(b){let a=(0,cx.f)(b);if(a.privyErrorCode===cx.b.ACCOUNT_TRANSFER_REQUIRED)throw a;if(a.privyErrorCode)throw new cx.a(a.message||"Invalid code during cross-app auth flow.",void 0,a.privyErrorCode);if("User denied confirmation during cross-app auth flow"===a.message)throw new cx.a("Invalid code during cross-app auth flow.",void 0,cx.b.OAUTH_USER_DENIED);throw new cx.a("Invalid code during cross-app auth flow.",void 0,cx.b.UNKNOWN_AUTH_ERROR)}}({appId:a,codeVerifier:h,stateCode:j,authorizationCode:k,action:d,client:c});l&&c.storeProviderAccessToken(a,l);let m=await aG.refreshSessionAndUser();if(!m)throw new cx.a("Unable to update user");return c.createAnalyticsEvent({eventName:"cross_app_auth_completed",payload:{providerAppId:a}}),m}catch(a){throw c.createAnalyticsEvent({eventName:"cross_app_auth_error",payload:{error:a.toString(),provider:e}}),a}},async initLoginWithOAuth(a,b,d){if(ak.current=a,!(0,cy.e)()||"google"===a&&!f.allowOAuthInEmbeddedBrowsers&&Dg(window.navigator.userAgent))return void ao("InAppBrowserLoginNotPossible");"twitter"===a&&window.opener&&window.opener.postMessage({type:C5},"*"),cy.u.del(fb.H),cy.u.del(fb.O);let e=new B8({provider:a,disableSignup:!!d,withPrivyUi:!0,customOAuthRedirectUrl:f.customOAuthRedirectUrl});b&&e.addCaptchaToken(b),c.startAuthFlow(e);let g=await c.authFlow.getAuthorizationUrl();if(g&&g.url)if("twitter"===a&&fc.isAndroid&&(g.url=g.url.replace("x.com","twitter.com")),"chrome-extension:"!==window.location.protocol||1)window.location.assign(g.url);else try{let{privyOAuthCode:a,privyOAuthState:b}=await B3(g.url);ao("OAuthStatusScreen"),e.meta.stateCode=b,e.meta.authorizationCode=a}catch(a){throw console.error("OAuth in chrome extension flow failed:",a),a}},async initLoginWithTelegram(a,b){if(!o)throw new cx.g;ak.current="telegram";let d=new Ck(a,b);c.startAuthFlow(d),O({status:"loading"}),d.meta.telegramWebAppData=void 0,d.meta.telegramAuthResult=await new Promise((a,b)=>f.loginConfig.telegramAuthConfiguration?window.Telegram?void window.Telegram.Login.auth({bot_id:f.loginConfig.telegramAuthConfiguration.botId,request_access:!0},c=>c?a(c):("link"===al.current?(0,gh.e)(ae,"linkAccount","onError",cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"telegram"}):"login"===al.current?(0,gh.e)(ae,"login","onError",cx.b.INVALID_CREDENTIALS):"update"===al.current&&(0,gh.e)(ae,"login","onError",cx.b.FAILED_TO_UPDATE_ACCOUNT),b(new cx.a("Telegram auth failed or was canceled by the client")))):b(new cx.a("Telegram was not initialized")):b(new cx.a("Telegram Auth configuration is not loaded")))},async loginWithTelegram(a){let b,d;if(!(c.authFlow instanceof Ck))throw new cx.a("Must initialize Telegram flow before calling loginWithTelegram");c.authFlow.meta.captchaToken||=a?.captchaToken;let e=await BX(),f=a?.intent||al.current;if("login"===f)try{let a=await c.authenticate();b=a.user,d=a.isNewUser,ak.current="telegram"}catch(a){throw(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR),a}else{if("link"!==f)throw new cx.a("Unknown auth intent");try{b=(await c.link()).user,ak.current="telegram"}catch(a){throw(0,gh.e)(ae,"linkAccount","onError",a.privyErrorCode||cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"telegram"}),a}}r(b),w(d||!1),aj(!0),O({status:"done"});let g=b?.linkedAccounts.find(({type:a})=>"telegram"===a)||null;return{user:b,isNewUser:d||!1,wasAlreadyAuthenticated:!!e,loginAccount:g}},async loginWithOAuth(a){let b,d,e;if(!(c.authFlow instanceof B8))throw new cx.a("Must initialize OAuth flow before calling loginWithOAuth");let f=cy.u.get(fb.S),g=c.authFlow.meta.stateCode;if(f!==g)throw c.createAnalyticsEvent({eventName:"possible_phishing_attempt",payload:{provider:a,storedStateCode:f??"",returnedStateCode:g??""}}),new cx.a("Unexpected auth flow. This may be a phishing attempt.",void 0,cx.b.OAUTH_UNEXPECTED);if(null!==await c.getAccessToken())try{let d=await c.link();b=d.user,e=d.oAuthTokens,ak.current=a}catch(b){throw(0,gh.e)(ae,"linkAccount","onError",b.privyErrorCode||cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:a}),b}else try{let f=await c.authenticate();b=f.user,d=f.isNewUser,e=f.oAuthTokens,ak.current=a}catch(b){throw"login"===al.current?(0,gh.e)(ae,"login","onError",b.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR):"link"===al.current&&(0,gh.e)(ae,"linkAccount","onError",b.privyErrorCode||cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:a}),b}return r(b),w(d||!1),aj(!0),e&&b&&(0,gh.e)(ae,"oAuthAuthorization","onOAuthTokenGrant",{oAuthTokens:e,user:b}),e},passkeyAuthState:D,setPasskeyAuthState:E,async initSignupWithPasskey({captchaToken:a,withPrivyUi:b}){let d=new Ca({captchaToken:a,setPasskeyAuthState:E,hints:f.passkeys.registration?.hints});c.startAuthFlow(d),al.current="login";try{ak.current="passkey",E({status:"generating-challenge"}),await d.initRegisterFlow(b),E({status:"awaiting-passkey"})}catch(a){throw E({status:"error",error:a}),(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR),a}},async signupWithPasskey(){let a,b;if(!o)throw new cx.g;if(!(c.authFlow instanceof Ca))throw new cx.a("Must initialize Passkey flow first.");if("passkey"!==ak.current){let a=new cx.a("Must init login with Passkey flow first.");throw E({status:"error",error:a}),a}let d=await BX();try{ak.current="passkey",E({status:"awaiting-passkey"}),{user:a,isNewUser:b}=await c.authenticate()}catch(a){throw E({status:"error",error:a}),(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR),a}r(a),w(b||!1),aj(!0),E({status:"done"});let e=a?.linkedAccounts.find(({type:a})=>"passkey"===a)||null;return{user:a,isNewUser:b||!1,wasAlreadyAuthenticated:!!d,loginAccount:e}},async initLoginWithPasskey({captchaToken:a,withPrivyUi:b}){let d=new Ca({captchaToken:a,setPasskeyAuthState:E,hints:void 0});c.startAuthFlow(d),al.current="login";try{ak.current="passkey",E({status:"generating-challenge"}),await d.initAuthenticationFlow(b),E({status:"awaiting-passkey"})}catch(a){throw E({status:"error",error:a}),(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR),a}},async loginWithPasskey(a){let b,d;if(!o)throw new cx.g;if(!(c.authFlow instanceof Ca))throw new cx.a("Must initialize Passkey flow first.");if(a?.credentialIds&&(c.authFlow.meta.allowedCredentialsIds=a.credentialIds),"passkey"!==ak.current){let a=new cx.a("Must init login with Passkey flow first.");throw E({status:"error",error:a}),a}let e=await BX();try{ak.current="passkey",E({status:"awaiting-passkey"}),{user:b,isNewUser:d}=await c.authenticate()}catch(a){throw E({status:"error",error:a}),(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR),a}r(b),w(d||!1),aj(!0),E({status:"done"});let f=b?.linkedAccounts.find(({type:a})=>"passkey"===a)||null;return{user:b,isNewUser:d||!1,wasAlreadyAuthenticated:!!e,loginAccount:f}},async initLinkWithPasskey(a){let b=new Ca({captchaToken:a,hints:f.passkeys.registration?.hints});c.startAuthFlow(b),al.current="link",ak.current="passkey",E({status:"generating-challenge"});try{await b.initLinkFlow(),E({status:"awaiting-passkey"})}catch(a){throw(0,gh.e)(ae,"linkAccount","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR,{linkMethod:"passkey"}),E({status:"error",error:a}),a}},async linkWithPasskey(){let a;if(!o)throw new cx.g;if(!(c.authFlow instanceof Ca))throw new cx.a("Must initialize Passkey flow first.");if("passkey"!==ak.current)throw new cx.a("Must init login with Passkey flow first.");try{ak.current="passkey",{user:a}=await c.link()}catch(a){throw(0,gh.e)(ae,"linkAccount","onError",a.privyErrorCode||cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"passkey"}),a}return r(a||q||null),E({status:"done"}),a},async initLoginWithHeadlessOAuth(a,b,d){if(!(0,cy.e)()||"google"===a&&!f.allowOAuthInEmbeddedBrowsers&&Dg(window.navigator.userAgent))throw Error("It looks like you're using an in-app browser.  To log in, please try again using an external browser.");let e=new B8({provider:a,withPrivyUi:!1,disableSignup:d??!1,customOAuthRedirectUrl:f.customOAuthRedirectUrl});b&&e.addCaptchaToken(b),M({status:"loading"});let g=await c.startAuthFlow(e).getAuthorizationUrl();if(g?.url)if("chrome-extension:"!==window.location.protocol||1)window.location.assign(g.url);else try{let{privyOAuthCode:a,privyOAuthState:b}=await B3(g.url);e.meta.stateCode=b,e.meta.authorizationCode=a,await this.loginWithHeadlessOAuth(e.meta)}catch(a){throw M({status:"error",error:a}),a}},async loginWithHeadlessOAuth(a){let b,d,e;A(!0),M({status:"loading"}),c.startAuthFlow(new B8({...a,customOAuthRedirectUrl:f.customOAuthRedirectUrl}));let g=cy.u.get(fb.S),h=a.stateCode;if(g!==h)throw c.createAnalyticsEvent({eventName:"possible_phishing_attempt",payload:{provider:a.provider,storedStateCode:g??"",returnedStateCode:h??""}}),A(!1),new cx.a("Unexpected auth flow. This may be a phishing attempt.",void 0,cx.b.OAUTH_UNEXPECTED);if(null!==await c.getAccessToken())try{({user:b,oAuthTokens:e}=await c.link()),ak.current=a.provider;let d=aB(b);b&&d&&(0,gh.e)(ae,"linkAccount","onSuccess",{user:b,linkMethod:ak.current,linkedAccount:d})}catch(b){throw A(!1),(0,gh.e)(ae,"linkAccount","onError",b.privyErrorCode||cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:a.provider}),b}else try{({user:b,isNewUser:d,oAuthTokens:e}=await c.authenticate()),ak.current=a.provider;let f=aB(b);b&&f&&void 0!==d&&(0,gh.e)(ae,"login","onComplete",{user:b,isNewUser:d,wasAlreadyAuthenticated:!1,loginMethod:ak.current,loginAccount:f})}catch(a){throw A(!1),M({status:"error",error:a}),(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR),a}return r(b),w(d||!1),aj(!0),A(!1),M({status:"done"}),e&&b&&(0,gh.e)(ae,"oAuthAuthorization","onOAuthTokenGrant",{oAuthTokens:e,user:b}),b??void 0},initLoginWithEmail:async({email:a,captchaToken:b,disableSignup:d,withPrivyUi:e})=>{let f=new B$({email:a,captchaToken:b,disableSignup:d});c.startAuthFlow(f);try{ak.current="email",G({status:"sending-code"});let a=await f.sendCodeEmail({withPrivyUi:e});if(a?.ssoRedirectUrl)return window.location.href=a.ssoRedirectUrl,void await (0,cv.k)(1e4);G({status:"awaiting-code-input"})}catch(a){throw G({status:"error",error:a}),"login"===al.current?(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR):"link"===al.current&&(0,gh.e)(ae,"linkAccount","onError",a.privyErrorCode||cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"email"}),a}},initUpdateEmail:async({oldAddress:a,newAddress:b,captchaToken:d})=>{let e=new B_(a,b,d);c.startAuthFlow(e);try{await e.sendCodeEmail({withPrivyUi:!0})}catch(a){throw(0,gh.e)(ae,"update","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR,{linkMethod:ak.current}),a}},initUpdatePhone:async(a,b,d)=>{let e=new Cf(a,b,d);c.startAuthFlow(e);try{await e.sendSmsCode({withPrivyUi:!0})}catch(a){(0,gh.e)(ae,"update","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR,{linkMethod:ak.current})}},initLoginWithSms:async({phoneNumber:a,captchaToken:b,disableSignup:d,withPrivyUi:e})=>{I({status:"sending-code"});let f=new Ce({phoneNumber:a,captchaToken:b,disableSignup:d});c.startAuthFlow(f);try{ak.current="sms",await f.sendSmsCode({withPrivyUi:e}),I({status:"awaiting-code-input"})}catch(a){throw I({status:"error",error:a}),"login"===al.current?(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR):"link"===al.current&&(0,gh.e)(ae,"linkAccount","onError",a.privyErrorCode||cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"sms"}),a}},resendEmailCode:async()=>{await c.authFlow?.sendCodeEmail({withPrivyUi:!0})},resendSmsCode:async()=>{await c.authFlow?.sendSmsCode({withPrivyUi:!0})},loginWithCode:async a=>{let b,d;function e(a){c.authFlow instanceof B$?G(a):c.authFlow instanceof Ce&&I(a)}if(e({status:"submitting-code"}),!o){let a=new cx.g;throw e({status:"error",error:a}),a}if(c.authFlow instanceof B$)c.authFlow.meta.emailCode=a.trim();else{if(!(c.authFlow instanceof Ce)){let a=new cx.a("Must initialize a passwordless code flow first");throw e({status:"error",error:a}),a}c.authFlow.meta.smsCode=a.trim()}let f=await BX();if("link"===al.current)try{({user:b}=await c.link())}catch(a){throw e({status:"error",error:a}),(0,gh.e)(ae,"linkAccount","onError",a.privyErrorCode||cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:ak.current}),a}else if("update"===al.current)try{({user:b}=await c.link())}catch(a){throw e({status:"error",error:a}),(0,gh.e)(ae,"update","onError",a.privyErrorCode||cx.b.FAILED_TO_UPDATE_ACCOUNT,{linkMethod:ak.current}),a}else try{({user:b,isNewUser:d}=await c.authenticate())}catch(a){throw e({status:"error",error:a}),(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR),a}let g=b||q;r(g||null),w(d||!1),aj(!0),e({status:"done"});let h=null;return c.authFlow instanceof B$?h=g?.linkedAccounts.find(({type:a})=>"email"===a)||null:c.authFlow instanceof Ce&&(h=g?.linkedAccounts.find(({type:a})=>"phone"===a)||null),{user:g,isNewUser:d||!1,wasAlreadyAuthenticated:!!f,linkedAccount:h}},generateSiweMessage:async({address:a,chainId:b,captchaToken:d})=>{al.current=ah?"link":"login",ak.current="siwe",K({status:"generating-message"});let e=await c.generateSiweNonce({address:a,captchaToken:d});return K({status:"awaiting-signature"}),Cb({address:a,chainId:b.replace("eip155:",""),nonce:e})},generateSiweMessageForSmartWallet:async({address:a,chainId:b})=>{let d=await c.generateSiweNonce({address:a});return Cb({address:a,chainId:b.replace("eip155:",""),nonce:d})},linkSmartWallet:async({message:a,signature:b,smartWalletType:d,smartWalletVersion:e})=>{let f;f=await c.linkSmartWallet({message:a,signature:b,smartWalletType:d,smartWalletVersion:e}),r((f=await aG.refreshSessionAndUser()??f)||q||null)},loginWithSiwe:async({message:a,signature:b,captchaToken:d,disableSignup:e,walletClientType:f,connectorType:g})=>{let h,i=null;try{if(q)throw Error("User already authenticated");let j=new Cc(c,void 0,d,e,{message:a,signature:b,walletClientType:f,connectorType:g});c.startAuthFlow(j),ak.current="siwe",al.current="login",K({status:"submitting-signature"});let k=await c.authenticate();if({user:i,isNewUser:h}=k,!i)throw Error("Authentication failed - no user returned")}catch(a){throw(0,gh.e)(ae,"login","onError",a.privyErrorCode||cx.b.UNKNOWN_AUTH_ERROR),K({status:"error",error:a}),a}return r(i),w(h||!1),aj(!0),K({status:"done"}),al.current=null,ak.current=null,{user:i,isNewUser:h||!1}},linkWithSiwe:async({message:a,signature:b,chainId:d,walletClientType:e,connectorType:f})=>{let g;ax("siwe");let h=null;try{K({status:"submitting-signature"}),g=await c.linkWithSiwe({message:a,signature:b,chainId:d,walletClientType:e,connectorType:f}),g=await aG.refreshSessionAndUser()??g,K({status:"done"}),(h=aB(g)||null)&&(0,gh.e)(ae,"linkAccount","onSuccess",{user:g,linkMethod:"siwe",linkedAccount:h})}catch(a){throw(0,gh.e)(ae,"linkAccount","onError",a.privyErrorCode||cx.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"siwe"}),al.current=null,ak.current=null,K({status:"error",error:a}),a}let i=g||q;return r(i||null),al.current=null,ak.current=null,{user:i,linkedAccount:h}},refreshSessionAndUser:async()=>{let a=await c.getAuthenticatedUser();return aj(!!a),r(a),a},walletProxy:P,createAnalyticsEvent:({eventName:a,payload:b,timestamp:d})=>c.createAnalyticsEvent({eventName:a,payload:b,timestamp:d}),acceptTerms:async()=>{let a=await c.acceptTerms();return r(a),a},getUsdTokenPrice:a=>c.getUsdTokenPrice(a),getUsdPriceForSol:()=>c.getUsdPriceForSol(),getSplTokenMetadata:a=>c.getSplTokenMetadata(a),recoverEmbeddedWallet:async a=>new Promise(async(b,d)=>{if(!q)return void b(!0);let e=a?.address?(0,ct.h)(q,a.address):(0,ct.g)(q)||(0,ct.f)(q).at(0)||(0,ct.j)(q).at(0);if(!e||(0,ct.d)(e))return void b(!0);let f=await BX();if(!f||!P||!e)return void d(Error("Must have valid access token and Privy wallet to recover wallet"));let{entropyId:g,entropyIdVerifier:h}=(0,cw.g)(q,e);try{await P.connect({accessToken:f,entropyId:g,entropyIdVerifier:h}),b(!0)}catch(a){if(CQ(a)&&"privy"===e.recoveryMethod){let a;c.createAnalyticsEvent({eventName:"embedded_wallet_pinless_recovery_started",payload:{walletAddress:e.address}});try{a=await P.recover({entropyId:g,entropyIdVerifier:h,accessToken:f})}catch(a){return void d(a)}a.entropyId||d(Error("Unable to recover wallet")),c.createAnalyticsEvent({eventName:"embedded_wallet_recovery_completed",payload:{walletAddress:e.address}}),b(!0)}else CQ(a)&&"privy"!==e.recoveryMethod&&"privy-v2"!==e.recoveryMethod?(W({recoverWallet:{entropyId:g,entropyIdVerifier:h,onFailure:d,onSuccess:()=>b(!0)},recoveryOAuthStatus:{provider:e.recoveryMethod,action:"recover",shouldCreateEth:!1,shouldCreateSol:!1}}),ao(Dd(e.recoveryMethod))):d(a)}}),setReadyToTrue:a=>{p(!0),X?.(a)},updateWallets:()=>ay(),fundWallet:async(a,b)=>{let c="FundingMethodSelectionScreen";return new Promise((d,e)=>{W({funding:{...(0,cy.p)({address:a,appConfig:f,fundWalletConfig:b,methodScreen:c,onComplete:d,onError:e})}}),ao(c)})},openModal:ao,requestFarcasterSignerStatus:async a=>{let b=await BX(),d=q?.linkedAccounts.find(a=>"wallet"===a.type&&"privy"===a.walletClientType);if(!b)throw Error("Must have valid access token to connect with Farcaster");if(!P||!d)throw Error("Must have an embedded wallet to use Farcaster signers");if(!q?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");let e=await c.requestFarcasterSignerStatus(a);return"approved"===e.status&&r(await c.getAuthenticatedUser()||q||null),e},connectCoinbaseSmartWallet:async()=>{f.externalWallets.coinbaseWallet.config.preference={...f.externalWallets.coinbaseWallet.config.preference,options:"smartWalletOnly"};let a=c.connectors?.findWalletConnector("coinbase_wallet","coinbase_smart_wallet")||c.connectors?.findWalletConnector("coinbase_wallet","coinbase_wallet");if(a)return a.updateConnectionPreference("smartWalletOnly"),at(a);await as("coinbase_wallet","coinbase_smart_wallet")},connectBaseAccount:async()=>{let a=c.connectors?.findWalletConnector("base_account","base_account");if(a)return at(a);await as("base_account","base_account")},initiateAccountTransfer:async({nonce:a,account:b,accountType:d,externalWalletMetadata:e,telegramAuthResult:f,telegramWebAppData:g,farcasterEmbeddedAddress:h,oAuthUserInfo:i})=>{let j=await c.sendAccountTransferRequest({nonce:a,account:b,accountType:d,externalWalletMetadata:e,telegramAuthResult:f,telegramWebAppData:g,farcasterEmbeddedAddress:h,oAuthUserInfo:i});return r(j),j},inProgressAuthFlowRef:al,inProgressLoginOrLinkMethodRef:ak};m=aG.recoverEmbeddedWallet,aG.recoverEmbeddedWallet;let aH=(0,R.useMemo)(()=>({wallets:s,ready:$&&af}),[s,$,af]),aI=c.authFlow instanceof Ck,{siteKey:aJ,enabledProvider:aK}=f.captcha,aL=!f.headless&&aK&&!ah&&(o||aI);return(0,Q.jsx)(Du.Provider,{value:!0,children:(0,Q.jsx)(ct.P.Provider,{value:aF,children:(0,Q.jsx)(gh.P.Provider,{value:ae,children:(0,Q.jsx)(cw.U.Provider,{value:aH,children:(0,Q.jsx)(Ci,{appId:f.id,captchaSiteKey:aJ,enabledCaptchaProvider:aK,children:(0,Q.jsxs)(cx.I.Provider,{value:aG,children:[(0,Q.jsx)(cv.R,{children:(0,Q.jsxs)(ct.M,{data:V,setModalData:W,setInitialScreen:y,initialScreen:x,authenticated:ah,open:g,children:[b.children,(0,Q.jsx)(Dt,{customAuth:f.customAuth}),aL&&(0,Q.jsx)(Cq,{delayedExecution:!1}),(0,Q.jsx)(CL,{}),(0,Q.jsx)(Dp,{disabled:f.embeddedWallets.disableAutomaticMigration}),(0,Q.jsx)(Ct,{palette:f.appearance.palette||{}}),!f.render.standalone&&(0,Q.jsx)(CG,{open:g})]})}),(0,Q.jsx)(C2,{appId:b.appId,appClientId:b.clientId,clientAnalyticsId:c.clientAnalyticsId,origin:c.apiUrl,mfaMethods:q?.mfaMethods,mfaPromise:ac,mfaSubmitPromise:ad,onLoad:S,onLoadFailed:()=>null}),f.loginConfig.telegramAuthConfiguration&&(0,Q.jsx)(cv.H,{$if:!0,children:(0,Q.jsx)(CK,{scriptHost:b.apiUrl||fb.D,botUsername:f.loginConfig.telegramAuthConfiguration.botName})})]})})})})})})};class Dw extends Error{constructor(a,b,c){super(a),this.code=b,this.data=c}}class Dx extends cu.default{async handleSendTransaction(a){let b;if(!a.params||!Array.isArray(a.params))throw new Dw(`Invalid params for ${a.method}`,4200);let c=a.params[0];if(!await BX()||!this.address)throw new Dw("Disconnected",4900);let{hash:d}=await (b={address:this.address},l(c,b));return d}async handleSignTransaction(a){let b;if(!a.params||!Array.isArray(a.params))throw new Dw(`Invalid params for ${a.method}`,4200);let c=a.params[0];if(!await BX()||!this.address)throw new Dw("Disconnected",4900);let{signature:d}=await (b={address:this.address},k(c,b));return d}handleSwitchEthereumChain(a){let b;if(!a.params||!Array.isArray(a.params))throw new Dw(`Invalid params for ${a.method}`,4200);if("string"==typeof a.params[0])b=a.params[0];else{if(!("chainId"in a.params[0])||"string"!=typeof a.params[0].chainId)throw new Dw(`Invalid params for ${a.method}`,4200);b=a.params[0].chainId}this.chainId=Number(b),this.publicClient=(0,wN.g)(this.chainId,this.chains,this.rpcConfig,{appId:this.appId}),this.emit("chainChanged",b)}async handlePersonalSign(a){if(!a.params||!Array.isArray(a.params))throw Error("Invalid params for personal_sign");let b=a.params[0],c=a.params[1],{signature:d}=await i({message:b},{address:c});return d}async handleSignedTypedData(a){let b;if(!a.params||!Array.isArray(a.params))throw Error("Invalid params for eth_signTypedData_v4");let c=a.params[0],d="string"==typeof a.params[1]?JSON.parse(a.params[1]):a.params[1],{signature:e}=await (b=(0,cv.m)(d),j(b,{address:c}));return e}async handleEstimateGas(a){if(!a.params||!Array.isArray(a.params))throw Error("Invalid params for eth_estimateGas");delete a.params[0].gasPrice,delete a.params[0].maxFeePerGas,delete a.params[0].maxPriorityFeePerGas;let b={...a.params[0],chainId:(0,cv.t)(this.chainId)};return await this.publicClient.estimateGas({account:b.from??this.address,...(0,fa.toViemTransactionSerializable)(b)})}async request(a){let b;switch(console.debug("Embedded1193Provider.request() called with args",a),a.method){case"eth_accounts":case"eth_requestAccounts":return this.address?[this.address]:[];case"eth_chainId":return(0,cv.t)(this.chainId);case"eth_estimateGas":return this.handleEstimateGas(a);case"eth_sendTransaction":return this.handleSendTransaction(a);case"eth_signTransaction":return this.handleSignTransaction(a);case"wallet_switchEthereumChain":return this.handleSwitchEthereumChain(a);case"personal_sign":return this.handlePersonalSign(a);case"eth_signTypedData_v4":return this.handleSignedTypedData(a)}if(b=a.method,!BY.includes(b))return this.publicClient.request({method:a.method,params:a.params});{let b,c=await BX();if(await (b={address:this.address},m(b)),!c||!this.address)throw new Dw("Disconnected",4900);try{let b={method:a.method,params:a.params},d=this.walletAccount;return d&&(0,ct.d)(d)?this.handleWalletApiRequest(b,d,c):(await this.walletProxy.rpc({accessToken:c,entropyId:this.entropyId,entropyIdVerifier:this.entropyIdVerifier,chainType:"ethereum",hdWalletIndex:this.walletIndex,request:b})).response.data}catch(a){throw console.error(a),new Dw("Disconnected",4900)}}}async handleWalletApiRequest(a,b,c){let d=this.privyClient;if(!d)throw new Dw("Disconnected",4900);if("secp256k1_sign"===a.method){let e=await (0,U.rpc)(d,async({message:a})=>this.walletProxy.signWithUserSigner({accessToken:c,message:a}),{chain_type:"ethereum",method:"secp256k1_sign",wallet_id:b.id,params:{hash:a.params[0]}});if("secp256k1_sign"!==e.method)throw new Dw(`Invalid params for ${a.method}`,4200);return e.data.signature}throw new Dw(`Method not supported: ${a.method}`,4200)}constructor({walletProxy:a,address:b,entropyId:c,entropyIdVerifier:d,rpcConfig:e,chains:f,appId:g,chainId:h=1,walletIndex:i,privyClient:j,walletAccount:k}){super(),this.walletProxy=a,this.address=b,this.entropyId=c,this.entropyIdVerifier=d,this.chainId=h,this.rpcConfig=e,this.chains=f,this.publicClient=(0,wN.g)(h,this.chains,e,{appId:g}),this.rpcTimeoutDuration=(0,cv.c)(e,"privy"),this.appId=g,this.walletIndex=i,this.privyClient=j,this.walletAccount=k}}let Dy=({style:a,...b})=>(0,Q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",style:{...a},...b,children:(0,Q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"})}),Dz=({style:a,...b})=>(0,Q.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"108",height:"108",viewBox:"0 0 108 108",fill:"none",style:{height:"28px",width:"28px",...a},...b,children:[(0,Q.jsx)("rect",{width:"108",height:"108",rx:"23",fill:"#AB9FF2"}),(0,Q.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M46.5267 69.9229C42.0054 76.8509 34.4292 85.6182 24.348 85.6182C19.5824 85.6182 15 83.6563 15 75.1342C15 53.4305 44.6326 19.8327 72.1268 19.8327C87.768 19.8327 94 30.6846 94 43.0079C94 58.8258 83.7355 76.9122 73.5321 76.9122C70.2939 76.9122 68.7053 75.1342 68.7053 72.314C68.7053 71.5783 68.8275 70.7812 69.0719 69.9229C65.5893 75.8699 58.8685 81.3878 52.5754 81.3878C47.993 81.3878 45.6713 78.5063 45.6713 74.4598C45.6713 72.9884 45.9768 71.4556 46.5267 69.9229ZM83.6761 42.5794C83.6761 46.1704 81.5575 47.9658 79.1875 47.9658C76.7816 47.9658 74.6989 46.1704 74.6989 42.5794C74.6989 38.9885 76.7816 37.1931 79.1875 37.1931C81.5575 37.1931 83.6761 38.9885 83.6761 42.5794ZM70.2103 42.5795C70.2103 46.1704 68.0916 47.9658 65.7216 47.9658C63.3157 47.9658 61.233 46.1704 61.233 42.5795C61.233 38.9885 63.3157 37.1931 65.7216 37.1931C68.0916 37.1931 70.2103 38.9885 70.2103 42.5795Z",fill:"#FFFDF8"})]});function DA(a,b){if(!Object.prototype.hasOwnProperty.call(a,b))throw TypeError("attempted to use private field on non-instance");return a}var DB=0;class DC extends cv.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(a){return a.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}get walletBranding(){return{name:this.providerDetail.info.name,icon:this.providerDetail.info.icon,id:this.providerDetail.info.rdns}}disconnect(){console.warn(`Programmatic disconnect with ${this.providerDetail.info.name} is not yet supported.`)}async promptConnection(){try{let a=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!a||0===a.length||!a[0])throw new cx.P("Unable to retrieve accounts");await this.syncAccounts([a[0]])}catch(a){throw(0,cy.f)(a)}}constructor(a,b,c,d,e){super(e||"unknown",a,b,c),this.connectorType="injected",this.proxyProvider=new cv.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.providerDetail=d;let f=d.provider;this.proxyProvider.setWalletProvider(f)}}var DD="__private_"+DB+++"__walletBranding";class DE extends cv.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(a){return a.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}get walletBranding(){return DA(this,DD)[DD]??{name:"Browser Extension",icon:Dy,id:"extension"}}disconnect(){console.warn("Programmatic disconnect with browser wallets is not yet supported.")}async promptConnection(){try{let a=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!a||0===a.length||!a[0])throw new cx.P("Unable to retrieve accounts");await this.syncAccounts([a[0]])}catch(a){throw(0,cy.f)(a)}}constructor(a,b,c,d,e){super(e??"unknown",a,b,c),Object.defineProperty(this,DD,{writable:!0,value:void 0}),this.connectorType="injected",this.proxyProvider=new cv.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.proxyProvider.setWalletProvider(d),"metamask"===e?DA(this,DD)[DD]={name:"MetaMask",icon:cv.M,id:"io.metamask"}:"phantom"===e&&(DA(this,DD)[DD]={name:"Phantom",icon:Dz,id:"phantom"})}}class DF extends DC{disconnect(){console.warn("MetaMask does not support programmatic disconnect.")}async promptConnection(){try{fc.isMobile||await this.proxyProvider.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]});let a=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!a||0===a.length||!a[0])throw new cx.P("Unable to retrieve accounts");await this.syncAccounts([a[0]])}catch(a){throw(0,cy.f)(a)}}}class DG extends cu.default{get wallets(){let a=new Set;return this.walletConnectors.flatMap(a=>a.wallets).sort((a,b)=>a.connectedAt&&b.connectedAt?b.connectedAt-a.connectedAt:0).filter(b=>{let c=`${b.address}${b.walletClientType}${b.connectorType}${b.meta.id}`;return!a.has(c)&&(a.add(c),!0)})}async initialize(a){if(this.initialized&&!a||(a&&this.removeAllConnectors(),this.externalWalletConfig.disableAllExternalWallets))return;let b=(0,cv.o)({store:this.store,walletList:this.walletList,externalWalletConfig:this.externalWalletConfig,walletChainType:this.walletChainType}).then(a=>{a.forEach(({type:a,eip6963InjectedProvider:b,legacyInjectedProvider:c})=>{this.createEthereumWalletConnector({connectorType:"injected",walletClientType:a,providers:{eip6963InjectedProvider:b,legacyInjectedProvider:c}})})});for(let a of(this.walletList.includes("coinbase_wallet")&&this.createEthereumWalletConnector({connectorType:"coinbase_wallet",walletClientType:"coinbase_wallet"}),this.walletList.includes("base_account")&&this.createEthereumWalletConnector({connectorType:"base_account",walletClientType:"base_account"}),Object.values(cv.q)))!a.isInstalled&&this.walletList.includes(a.client)&&(["ethereum-only","ethereum-and-solana"].includes(this.walletChainType)&&a.chainTypes.includes("ethereum")&&this.createEthereumWalletConnector({connectorType:"null",walletClientType:a.client,walletConfig:a}),["ethereum-and-solana","solana-only"].includes(this.walletChainType)&&a.chainTypes.includes("solana")&&this.addSolanaWalletConnector(new cv.S({id:a.client,name:a.name})));this.externalWalletConfig.walletConnect.enabled&&(this.walletList.includes("wallet_connect_qr")||(0,cv.e)(this.walletList))&&"solana-only"!==this.walletChainType&&this.createEthereumWalletConnector({connectorType:"wallet_connect_v2",walletClientType:"unknown"});let c=this.walletList.includes("wallet_connect_qr_solana")||(0,cv.e)(this.walletList)&&"ethereum-only"!==this.walletChainType,d=this.externalWalletConfig.solana.connectors?.get()||[],e=async a=>{if(!c)return;let b=a.find(a=>"walletconnect_solana"===a.walletBranding?.id);b&&b.wallet&&await b.wallet.initialize({walletConnectCloudProjectId:this.walletConnectCloudProjectId,privyAppName:this.privyAppName})};e(d),d.filter(a=>c||"walletconnect_solana"!==a.walletBranding?.id).forEach(this.addSolanaWalletConnector),this.externalWalletConfig.solana.connectors?._setOnConnectorsUpdated?.(a=>{e(a),a?.filter(a=>c||"walletconnect_solana"!==a.walletBranding?.id).forEach(this.addSolanaWalletConnector)}),await b,this.initialized=!0}findWalletConnector(a,b,c){return"wallet_connect_v2"===a?this.walletConnectors.filter(cv.r).find(b=>b.connectorType===a&&(!c||b.wallets.some(a=>a.address===c)))??null:this.walletConnectors.filter(cv.r).find(d=>d.connectorType===a&&d.walletClientType===b&&(!c||d.wallets.some(a=>a.address===c)))??null}findSolanaWalletConnector(a){return this.walletConnectors.filter(cv.v).find(b=>"unknown"===b.walletClientType?b.walletBranding.id===a:b.walletClientType===a)??null}findEmbeddedWalletConnectors(){return this.walletConnectors.filter(a=>"embedded"===a.connectorType)}findImportedWalletConnectors(){return this.walletConnectors.filter(a=>"embedded_imported"===a.connectorType)}onInitialized(a){a.wallets.forEach(a=>{let b=this.storedConnections.find(b=>b.address===a.address&&b.connectorType===a.connectorType&&("solana"===a.type&&"unknown"===b.walletClientType&&"unknown"===a.walletClientType?a.meta.id===b.id:b.walletClientType===a.walletClientType));b&&(a.connectedAt=b.connectedAt)}),this.emit("walletsUpdated"),this.emit("connectorInitialized")}onWalletsUpdated(a){a.initialized&&this.emit("walletsUpdated")}addEmbeddedWalletConnectors({walletProxy:a,user:b,embeddedWallets:c,defaultChain:d,appId:e,privyClient:f}){let{entropyId:g,entropyIdVerifier:h}=(0,cw.g)(b);for(let b of c){let c=this.findEmbeddedWalletConnectors().find(a=>a.walletIndex===b.walletIndex);if(c&&(0,cv.r)(c))c.proxyProvider.walletProxy=a;else{let c=new BW({provider:new Dx({walletProxy:a,address:b.address,entropyId:g,entropyIdVerifier:h,rpcConfig:this.rpcConfig,chains:this.chains,appId:e,chainId:d.id,walletIndex:b.walletIndex,privyClient:f,walletAccount:b}),chains:this.chains,defaultChain:d,rpcConfig:this.rpcConfig,imported:!1,walletIndex:b.walletIndex});this.addWalletConnector(c)}}}addImportedWalletConnector(a,b,c,d){let e=this.findWalletConnector("embedded_imported","privy",b);if(e&&(0,cv.r)(e))e.proxyProvider.walletProxy=a;else{let e=new BW({provider:new Dx({walletProxy:a,address:b,entropyId:b,entropyIdVerifier:"ethereum-address-verifier",walletIndex:0,rpcConfig:this.rpcConfig,chains:this.chains,appId:d,chainId:c.id}),chains:this.chains,walletIndex:0,defaultChain:c,rpcConfig:this.rpcConfig,imported:!0});this.addWalletConnector(e)}}removeEmbeddedWalletConnectors(){this.walletConnectors=this.walletConnectors.filter(a=>"embedded"!==a.connectorType),this.storedConnections=(0,cy.l)(),this.emit("walletsUpdated")}removeImportedWalletConnectors(){let a=this.findImportedWalletConnectors();a.length&&(a.forEach(a=>{let b=this.walletConnectors.indexOf(a);this.walletConnectors.splice(b,1)}),this.storedConnections=(0,cy.l)(),this.emit("walletsUpdated"))}async createEthereumWalletConnector({connectorType:a,walletClientType:b,providers:c,walletConfig:d}){let e=this.findWalletConnector(a,b);if(e&&(0,cv.r)(e))return e instanceof CM&&e.resetConnection(b),e;let f="injected"!==a?"coinbase_wallet"===a?new BU(this.chains,this.defaultChain,this.rpcConfig,this.externalWalletConfig.coinbaseWallet.config):"base_account"===a?new BS(this.chains,this.defaultChain,this.rpcConfig,this.externalWalletConfig.baseAccount.config,this.setBaseAccountSdk):"null"!==a?new CM({walletConnectCloudProjectId:this.walletConnectCloudProjectId,rpcConfig:this.rpcConfig,chains:this.chains,defaultChain:this.defaultChain,shouldEnforceDefaultChainOnConnect:this.shouldEnforceDefaultChainOnConnect,privyAppId:this.privyAppId,privyAppName:this.privyAppName,walletClientType:b}):d?new cv.w({id:d.client,name:d.name,defaultChain:this.defaultChain,walletClientType:d.client}):null:"metamask"===b&&c?.eip6963InjectedProvider?new DF(this.chains,this.defaultChain,this.rpcConfig,c?.eip6963InjectedProvider,"metamask"):"metamask"===b&&c?.legacyInjectedProvider?new DE(this.chains,this.defaultChain,this.rpcConfig,c?.legacyInjectedProvider,"metamask"):"phantom"===b&&c?.legacyInjectedProvider?new DE(this.chains,this.defaultChain,this.rpcConfig,c?.legacyInjectedProvider,"phantom"):c?.legacyInjectedProvider&&"unknown_browser_extension"===b?new DE(this.chains,this.defaultChain,this.rpcConfig,c?.legacyInjectedProvider):c?.eip6963InjectedProvider?new DC(this.chains,this.defaultChain,this.rpcConfig,c?.eip6963InjectedProvider,b):void 0;return f&&this.addWalletConnector(f),f||null}addWalletConnector(a){this.walletConnectors.push(a),a.on("initialized",()=>this.onInitialized(a)),a.on("walletsUpdated",()=>this.onWalletsUpdated(a)),a.initialize().catch(a=>{console.debug("Failed to initialize connector",a)})}setWalletList(a){this.walletList=a,this.initialized&&this.initialize(!0).catch(console.error)}removeAllConnectors(){for(let a of this.walletConnectors)a.removeAllListeners();this.walletConnectors=[]}constructor(a,b,c,d,e,f,g,h,i,j,k,l){super(),this.addSolanaWalletConnector=async a=>{let b=this.findSolanaWalletConnector(a.walletClientType);if(!b||"null"===b.connectorType){if("null"===b?.connectorType){let a=this.walletConnectors.indexOf(b);this.walletConnectors.splice(a,1)}this.addWalletConnector(a)}},this.privyAppId=a,this.walletConnectCloudProjectId=b,this.rpcConfig=c,this.chains=d,this.defaultChain=e,this.walletConnectors=[],this.initialized=!1,this.store=f,this.walletList=g,this.shouldEnforceDefaultChainOnConnect=h,this.externalWalletConfig=i,this.privyAppName=j,this.walletChainType=l||"ethereum-only",this.setBaseAccountSdk=k,this.storedConnections=(0,cy.l)()}}let DH=(0,gi.create)(()=>({identityToken:null})),DI=[fj,fk,f4];class DJ{async get(a,b){try{return await this.baseFetch(a,b)}catch(a){throw(0,cx.f)(a)}}async post(a,b,c){try{return await this.baseFetch(a,{method:"POST",...b?{body:b}:{},...c})}catch(a){throw(0,cx.f)(a)}}async delete(a,b){try{return await this.baseFetch(a,{method:"DELETE",...b})}catch(a){throw(0,cx.f)(a)}}constructor({appId:a,appClientId:b,client:c,defaults:d}){this.appId=a,this.appClientId=b,this.clientAnalyticsId=c.clientAnalyticsId,this.sdkVersion=fb.V,this.client=c,this.defaults=d,this.fallbackApiUrl=c.fallbackApiUrl,this.baseFetch=wO.ofetch.create({baseURL:this.defaults.baseURL,timeout:this.defaults.timeout,retry:3,retryDelay:500,retryStatusCodes:[408,409,425,500,502,503,504],credentials:"include",onRequest:async({request:a,options:b})=>{let c=new Headers(b.headers);c.set("privy-app-id",this.appId),this.appClientId&&c.set("privy-client-id",this.appClientId),c.set("privy-ca-id",this.clientAnalyticsId||""),c.set("privy-client",`react-auth:${this.sdkVersion}`);let d=DI.includes(a.toString());if(!c.has("authorization")){let a=await this.client.getAccessToken({disableAutoRefresh:d});null!==a&&c.set("authorization",`Bearer ${a}`)}b.headers=c,b.retryDelay&&"number"==typeof b.retryDelay&&(b.retryDelay=3*b.retryDelay)},onRequestError:({error:a})=>{if(a instanceof DOMException&&"AbortError"===a.name)throw new cx.h}})}}class DK{getOrCreateGuestCredential(a){let b=(0,fb.g)(a);if((0,cy.e)()){if(cy.u.get(b))return cy.u.get(b);{let a=cs.base64url.encode(B4(32));return cy.u.put(b,a),a}}return cs.base64url.encode(B4(32))}async authenticate(){if(!this.api)throw new cx.a("Auth flow has no API instance");try{return await this.api.post(f7,{guest_credential:this.meta.guestCredential})}catch(a){throw(0,cx.f)(a)}}async link(){throw Error("Linking is not supported for the guest flow")}constructor(a){this.meta={guestCredential:this.getOrCreateGuestCredential(a)}}}function DL(){return!(fc.isSafari&&window.location.origin.startsWith("http://localhost"))}var DM,DN,DO,DP,DQ,DR,DS,DT,DU,DV,DW,DX,DY,DZ,D$,D_,D0,D1,D2,D3,D4,D5,D6,D7,D8,D9,Ea,Eb,Ec,Ed,Ee,Ef=((Ee={}).PRIVY="privy_access_token",Ee.CUSTOMER="customer_access_token",Ee);class Eg{get token(){return this.privyAccessToken||this.customerAccessToken}getToken(a){return"privy_access_token"===a?this.privyAccessToken:this.customerAccessToken}get customerAccessToken(){return this._getToken(fb.C)}get privyAccessToken(){return this._getToken(fb.P)}_getToken(a){try{let b=cy.u.get(a);return"string"==typeof b?BN.throwIfNotWellFormedJwt(b):null}catch(a){return console.error(a),this.destroyLocalState(),null}}get refreshToken(){try{let a=cy.u.get(fb.R);return"string"==typeof a?a:null}catch(a){return console.error(a),this.destroyLocalState(),null}}getProviderAccessToken(a){try{let b=cy.u.get((0,fb.e)(a));if("string"!=typeof b)return null;{let c=new BN(b);return c.isExpired()?(cy.u.del((0,fb.e)(a)),null):c.value}}catch(a){return console.error(a),null}}get mightHaveServerCookies(){try{let a=wP.default.get(fb.f);return void 0!==a&&a.length>0}catch(a){console.error(a)}return!1}hasRefreshCredentials(a="privy_access_token"){let b="string"==typeof this.getToken(a),c="string"==typeof this.refreshToken&&this.refreshToken!==fb.h;return this.mightHaveServerCookies||b&&c}hasActiveAccessToken(a){let b=BN.parse(this.getToken(a));return null!==b&&!b.isExpired(30)}authenticate(a){return this.authenticateOnce.execute(a)}link(a){return this.linkOnce.execute(a)}refresh(){return this.refreshOnce.execute()}destroy(){return this.destroyOnce.execute()}storeProviderAccessToken(a,b){"string"==typeof b?cy.u.put((0,fb.e)(a),b):cy.u.del((0,fb.e)(a))}updateIdentityToken(a){"string"==typeof a?this.storeIdentityToken(a):this.clearIdentityToken()}async _authenticate(a){try{let b=await a.authenticate(),{user:c,is_new_user:d,oauth_tokens:e}=b;this.handleTokenResponse(b);let f=e?{provider:e.provider,accessToken:e.access_token,accessTokenExpiresInSeconds:e.access_token_expires_in_seconds,refreshToken:e.refresh_token,refreshTokenExpiresInSeconds:e.refresh_token_expires_in_seconds,scopes:e.scopes}:void 0;return this._trackAuthenticateEvents(a,d),{user:(0,ct.l)(c),isNewUser:d,oAuthTokens:f}}catch(a){throw console.warn("Error authenticating session"),(0,cx.i)(a)}}_trackAuthenticateEvents(a,b){let c=a instanceof B$?"email":a instanceof Ce?"sms":a instanceof Cc?"siwe":a instanceof DK?"guest":a instanceof Dr?"custom_auth":a instanceof B8?a.meta.provider:null;c&&this.client&&this.client.createAnalyticsEvent({eventName:"sdk_authenticate",payload:{method:c,isNewUser:b}}),"siwe"===c&&this.client&&this.client.createAnalyticsEvent({eventName:"sdk_authenticate_siwe",payload:{connectorType:a.meta.connectorType,walletClientType:a.meta.walletClientType}})}async _link(a){try{let b=await a.link(),c=b.oauth_tokens,d=c?{provider:c.provider,accessToken:c.access_token,accessTokenExpiresInSeconds:c.access_token_expires_in_seconds,refreshToken:c.refresh_token,refreshTokenExpiresInSeconds:c.refresh_token_expires_in_seconds,scopes:c.scopes}:void 0;return{user:(0,ct.l)(b),oAuthTokens:d}}catch(a){throw console.warn("Error linking account"),(0,cx.i)(a)}}async _refresh(){if(!this.api)throw new cx.a("Session has no API instance");if(!this.client)throw new cx.a("Session has no PrivyClient instance");await this.client.getAccessToken({disableAutoRefresh:!0});let a=this.token,b=this.refreshToken;if(this.client.useServerCookies&&!this.mightHaveServerCookies&&this.token&&window.location.origin===this.client.apiUrl)return this.destroyLocalState(),null;try{let c;if(!(a&&b||this.mightHaveServerCookies))return null;{let d={};a&&(d.authorization=`Bearer ${a}`),c=await this.api.post(fj,b?{refresh_token:b}:{},{headers:d})}return this.handleTokenResponse(c),(0,ct.l)(c.user)}catch(a){if(a instanceof cx.e&&a.privyErrorCode===cx.b.MISSING_OR_INVALID_TOKEN)return console.warn("Unable to refresh tokens - token is missing or no longer valid"),this.destroyLocalState(),null;throw(0,cx.i)(a)}}handleTokenResponse(a){a.session_update_action&&"set"!==a.session_update_action?"clear"===a.session_update_action?this.destroyLocalState():"ignore"===a.session_update_action&&(a.token&&(this.storeCustomerAccessToken(a.token),this.storePrivyAccessToken(a.privy_access_token)),a.identity_token&&this.storeIdentityToken(a.identity_token)):this._storeAllTokens(a)}_storeAllTokens(a){this.storeRefreshToken(a.refresh_token),this.storeCustomerAccessToken(a.token),this.storePrivyAccessToken(a.privy_access_token),a.identity_token&&this.storeIdentityToken(a.identity_token)}async _destroy(){try{await this.api?.post(fk,{refresh_token:this.refreshToken})}catch(a){console.warn("Error destroying session")}this.destroyLocalState()}destroyLocalState(){this.storeRefreshToken(null),this.storeCustomerAccessToken(null),this.storePrivyAccessToken(null),this.clearIdentityToken()}storeCustomerAccessToken(a){if("string"==typeof a){let b=cy.u.get(fb.C);if(cy.u.put(fb.C,a),!this.client?.useServerCookies){let b=BN.parse(a)?.expiration;wP.default.set(fb.i,a,{sameSite:"Strict",secure:DL(),expires:b?new Date(1e3*b):void 0})}b!==a&&this.client?.onStoreCustomerAccessToken?.(a)}else cy.u.del(fb.C),wP.default.remove(fb.i),this.client?.onDeleteCustomerAccessToken?.()}storeRefreshToken(a){"string"==typeof a?(cy.u.put(fb.R,a),this.client?.useServerCookies||wP.default.set(fb.f,"t",{sameSite:"Strict",secure:DL(),expires:30})):(cy.u.del(fb.R),wP.default.remove(fb.j),wP.default.remove(fb.f))}storePrivyAccessToken(a){"string"==typeof a?cy.u.put(fb.P,a):cy.u.del(fb.P)}storeIdentityToken(a){if(DH.setState({identityToken:a}),this.client?.useServerCookies)return;cy.u.put(fb.I,a);let b=BN.parse(a)?.expiration;wP.default.set(fb.k,a,{sameSite:"Strict",secure:DL(),expires:b?new Date(1e3*b):void 0})}clearIdentityToken(){cy.u.del(fb.I),DH.setState({identityToken:null}),wP.default.remove(fb.k)}constructor(){this.authenticateOnce=new B0(async a=>this._authenticate(a)),this.linkOnce=new B0(async a=>this._link(a)),this.refreshOnce=new B0(this._refresh.bind(this)),this.destroyOnce=new B0(this._destroy.bind(this))}}var Eh=0,Ei="__private_"+Eh+++"__getOrGenerateClientAnalyticsId";class Ej{getAppId(){return this.appId}initializeConnectorManager({walletConnectCloudProjectId:a,rpcConfig:b,chains:c,defaultChain:d,store:e,walletList:f,shouldEnforceDefaultChainOnConnect:g,externalWalletConfig:h,appName:i,walletChainType:j,setBaseAccountSdk:k}){this.connectors||(this.connectors=new DG(this.appId,a,b,c,d,e,f,g,h,i,k,j))}generateApi(){let a=new DJ({appId:this.appId,appClientId:this.appClientId,client:this,defaults:{baseURL:this.apiUrl,timeout:this.timeout}});return this.session.api=a,a}updateApiUrl(a){this.apiUrl=a||this.fallbackApiUrl,this.api=this.generateApi(),a&&(this.useServerCookies=!0)}authenticate(){if(!this.authFlow)throw new cx.a("No auth flow in progress.");return this.session.authenticate(this.authFlow)}async link(){if(!this.authFlow)throw new cx.a("No auth flow in progress.");let{oAuthTokens:a}=await this.session.link(this.authFlow);return{user:await this.getAuthenticatedUser(),oAuthTokens:a}}storeProviderAccessToken(a,b){this.session.storeProviderAccessToken(a,b)}getProviderAccessToken(a){return this.session.getProviderAccessToken(a)}async logout(){await this.session.destroy(),this.authFlow=void 0}clearProviderAcccessTokens(a){a.linkedAccounts.filter(a=>"cross_app"===a.type).forEach(a=>{this.storeProviderAccessToken(a.providerApp.id,null)})}startAuthFlow(a){return a.api=this.api,this.authFlow=a,this.authFlow}async initMfaSmsVerification(){try{await this.api.post(f1,{action:"verify"})}catch(a){throw(0,cx.f)(a)}}async initMfaPasskeyVerification(){try{let a,b=await this.api.post(f2,{});return{rpId:(a=b.options).rp_id,challenge:a.challenge,allowCredentials:a.allow_credentials?.map(a=>({id:a.id,type:a.type,transports:a.transports}))||[],timeout:a.timeout,extensions:{appid:a.extensions?.app_id,credProps:a.extensions?.cred_props,hmacCreateSecret:a.extensions?.hmac_create_secret},userVerification:a.user_verification}}catch(a){throw(0,cx.f)(a)}}async getCrossAppProviderDetails(a){try{return this._cachedProviderAppDetails[a]||(this._cachedProviderAppDetails[a]=await this.api.get(`/api/v1/apps/${a}/cross-app/details`)),this._cachedProviderAppDetails[a]}catch(a){console.error("Error fetching cross app provider details",a)}}async acceptTerms(){try{let a=await this.api.post(f3,{});return(0,ct.l)(a)}catch(a){throw(0,cx.i)(a)}}async unlinkEmail(a){try{let b=await this.api.post(fF,{address:a});return await this.getAuthenticatedUser()??(0,ct.l)(b)}catch(a){throw(0,cx.i)(a)}}async unlinkPhone(a){try{let b=await this.api.post(fK,{phoneNumber:a});return await this.getAuthenticatedUser()??(0,ct.l)(b)}catch(a){throw(0,cx.i)(a)}}async unlinkEthereumWallet(a){try{let b=await this.api.post(fp,{address:a});return await this.getAuthenticatedUser()??(0,ct.l)(b)}catch(a){throw(0,cx.i)(a)}}async unlinkSolanaWallet(a){try{let b=await this.api.post(fu,{address:a});return await this.getAuthenticatedUser()??(0,ct.l)(b)}catch(a){throw(0,cx.i)(a)}}async unlinkOAuth(a,b){try{let c=await this.api.post(fR,{provider:a,subject:b});return await this.getAuthenticatedUser()??(0,ct.l)(c)}catch(a){throw(0,cx.i)(a)}}async unlinkFarcaster(a){try{let b=await this.api.post(fA,{fid:a});return await this.getAuthenticatedUser()??(0,ct.l)(b)}catch(a){throw(0,cx.i)(a)}}async unlinkTelegram(a){try{let b=await this.api.post(f_,{telegram_user_id:a});return await this.getAuthenticatedUser()??(0,ct.l)(b)}catch(a){throw(0,cx.i)(a)}}async revokeDelegatedWallet(){try{await this.api.post(gb,{})}catch(a){throw(0,cx.i)(a)}}async createAnalyticsEvent({eventName:a,payload:b,timestamp:c,options:d}){}async signMoonpayOnRampUrl(a){try{return this.api.post(f8,a)}catch(a){throw(0,cx.i)(a)}}async initCoinbaseOnRamp(a){try{return this.api.post(f9,a)}catch(a){throw(0,cx.i)(a)}}async getCoinbaseOnRampStatus({partnerUserId:a}){try{return this.api.get(`${ga}?partnerUserId=${a}`)}catch(a){throw(0,cx.i)(a)}}async getAuthenticatedUser(){return this.session.hasRefreshCredentials()?this.session.refresh():null}async getAccessToken(a){return await this.getPrivyAccessToken(a)||await this.getCustomerAccessToken(a)}async getCustomerAccessToken(a){return await this._getToken(Ef.CUSTOMER,a)}async getPrivyAccessToken(a){return await this._getToken(Ef.PRIVY,a)}async _getToken(a,b){return this.session.getToken(a)?this.session.hasActiveAccessToken(a)?this.session.hasRefreshCredentials(a)?BO.parse(this.session.getToken(a))?.appId!==this.appId?(await this.logout(),null):this.session.getToken(a):(this.session.destroyLocalState(),null):!b?.disableAutoRefresh&&this.session.hasRefreshCredentials(a)?(await this.session.refresh(),this.session.getToken(a)):null:null}async getUsdTokenPrice(a){try{return(await this.api.get(`/api/v1/token_price?chainId=${a.id}&tokenSymbol=${a.nativeCurrency.symbol}`)).usd}catch(b){return void console.error(`Unable to fetch token price for chain with id ${a.id}`)}}async getUsdPriceForSol(){try{return(await this.api.get("/api/v1/token_price?chainId=0&tokenSymbol=SOL")).usd}catch(a){return void console.error("Unable to fetch token price for SOL")}}async getSplTokenMetadata({mintAddress:a,cluster:b}){try{return await this.api.get(`/api/v1/spl_token_info?mint_address=${a}&cluster=${b}`)}catch(c){return void console.error(`Unable to fetch token metadata for ${b}:${a}`)}}async requestFarcasterSignerStatus(a){try{return await this.api.post("/api/v1/farcaster/signer/status",{ed25519_public_key:a})}catch(a){throw console.error("Unable to fetch Farcaster signer status"),a}}async generateSiweNonce({address:a,captchaToken:b}){try{return(await this.api.post(fl,{address:a,token:b})).nonce}catch(a){throw(0,cx.i)(a)}}async authenticateWithSiweInternal({message:a,signature:b,chainId:c,walletClientType:d,connectorType:e,mode:f}){return await this.api.post(fm,{message:a,signature:b,chainId:c,walletClientType:d,connectorType:e,mode:f})}async linkWithSiweInternal({message:a,signature:b,chainId:c,walletClientType:d,connectorType:e}){return await this.api.post(fn,{message:a,signature:b,chainId:c,walletClientType:d,connectorType:e})}async linkSmartWallet({message:a,signature:b,smartWalletType:c,smartWalletVersion:d}){try{let e=await this.api.post(fo,{message:a,signature:b,smart_wallet_type:c,smart_wallet_version:d});return(0,ct.l)(e)}catch(a){throw(0,cx.i)(a)}}async linkWithSiwe({message:a,signature:b,chainId:c,walletClientType:d,connectorType:e}){try{let f=await this.linkWithSiweInternal({message:a,signature:b,chainId:c,walletClientType:d,connectorType:e});return(0,ct.l)(f)}catch(a){throw(0,cx.i)(a)}}async generateSiwsNonce({address:a,captchaToken:b}){try{return(await this.api.post(fr,{address:a,token:b})).nonce}catch(a){throw(0,cx.i)(a)}}async authenticateWithSiwsInternal({message:a,signature:b,walletClientType:c,connectorType:d,mode:e,messageType:f="plain"}){return await this.api.post(fs,{message:a,signature:b,walletClientType:c,connectorType:d,mode:e,message_type:f})}async authenticateWithSiws({message:a,signature:b,walletClientType:c,connectorType:d,mode:e,messageType:f="plain"}){let g=await this.authenticateWithSiwsInternal({message:a,signature:b,walletClientType:c,connectorType:d,mode:e,messageType:f});this.session.handleTokenResponse(g);let h=(0,ct.l)(g.user);if(!h)throw Error("Authentication failed - no user returned");return{user:h,isNewUser:g.is_new_user||!1}}async sendAccountTransferRequest({nonce:a,account:b,accountType:c,externalWalletMetadata:d,telegramAuthResult:e,telegramWebAppData:f,farcasterEmbeddedAddress:g,oAuthUserInfo:h}){try{let i,j;switch(c){case"email":i=fH,j={nonce:a,email:b};break;case"sms":i=fN,j={nonce:a,phoneNumber:b};break;case"siwe":if(i=fq,!d)throw Error("Wallet parameters must be defined");j={nonce:a,address:b,...d};break;case"farcaster":i=fB,j={nonce:a,farcaster_id:b,farcaster_embedded_address:g};break;case"telegram":i=f0,j={nonce:a,telegram_auth_result:e,telegram_web_app_data:f};break;case"siws":i=fv,j={nonce:a,address:b,...d};break;case"custom":case"guest":case"passkey":throw Error("Invalid transfer account type");default:i=fS,j={nonce:a,userInfo:h}}let k=await this.api.post(i,j);return await this.getAuthenticatedUser()??(0,ct.l)(k)}catch(a){throw(0,cx.i)(a)}}async linkWithSiwsInternal({message:a,signature:b,walletClientType:c,connectorType:d,messageType:e="plain"}){return await this.api.post(ft,{message:a,signature:b,walletClientType:c,connectorType:d,message_type:e})}async linkWithSiws({message:a,signature:b,walletClientType:c,connectorType:d,messageType:e="plain"}){try{let f=await this.linkWithSiwsInternal({message:a,signature:b,walletClientType:c,connectorType:d,messageType:e});return(0,ct.l)(f)}catch(a){throw(0,cx.i)(a)}}async updateUserAndIdToken(){try{let a=await this.api.get(gc);return this.session.updateIdentityToken(a.identity_token),(0,ct.l)(a.user)}catch(a){throw(0,cx.i)(a)}}async scanTransaction(a){try{return await this.api.post(gd,a)}catch(a){throw(0,cx.i)(a)}}constructor({apiUrl:a=fb.D,appId:b,appClientId:c,timeout:d=fb.l}){Object.defineProperty(this,Ei,{value:Ek}),this._cachedProviderAppDetails={},this.apiUrl=a,this.fallbackApiUrl=this.apiUrl,this.useServerCookies=a!==fb.D&&a.startsWith("https://privy."),this.timeout=d,this.appId=b,this.appClientId=c,this.clientAnalyticsId=(function(a,b){if(!Object.prototype.hasOwnProperty.call(a,b))throw TypeError("attempted to use private field on non-instance");return a})(this,Ei)[Ei](),n||(n=new Eg),this.session=n,this.api=this.generateApi(),this.session.client=this}}function Ek(){return null}function El(){if(!o)throw new cx.a("No global PrivyClient instance found. Please ensure you have initialized the PrivyProvider.");return o}let Em=({config:a,...b})=>{(()=>{if((0,R.useContext)(Du))throw new cx.a("Multiple PrivyProvider instances found","Found multiple instances of PrivyProvider, ensure there is only one mounted in your application tree.")})(),function(a){if("string"!=typeof a||25!==a.length)throw new cx.a("Cannot initialize the Privy provider with an invalid Privy app ID")}(b.appId),o||(o=new Ej({appId:b.appId,appClientId:b.clientId,apiUrl:b.apiUrl}));let c=(0,R.useMemo)(()=>new S.default({appId:b.appId,clientId:b.clientId,storage:cy.u,baseUrl:b.apiUrl,sdkVersion:"react-auth:3.10.0"}),[]),d=El(),e=Object.assign({},a);return(0,Q.jsx)(fb.m,{client:c,legacyClient:d,appClientId:b.clientId,clientConfig:e,children:(0,Q.jsx)(ge.P,{children:(0,Q.jsx)(Dv,{...b,client:d,privy:c})})})};function En(){let{promptMfa:a,init:b,submit:c,cancel:d,mfaMethods:e}=(0,R.useContext)(ct.P);return{promptMfa:a,init:b,submit:c,cancel:d,mfaMethods:e}}function Eo(){let{initEnrollmentWithSms:a,initEnrollmentWithTotp:b,initEnrollmentWithPasskey:c,submitEnrollmentWithSms:d,submitEnrollmentWithTotp:e,submitEnrollmentWithPasskey:f,unenroll:g,enrollInMfa:h}=(0,R.useContext)(ct.P);return{initEnrollmentWithSms:a,initEnrollmentWithTotp:b,initEnrollmentWithPasskey:c,submitEnrollmentWithSms:d,submitEnrollmentWithTotp:e,submitEnrollmentWithPasskey:f,unenrollWithSms:()=>g("sms"),unenrollWithTotp:()=>g("totp"),unenrollWithPasskey:a=>g("passkey",a),showMfaEnrollmentModal:()=>h(!0),closeMfaEnrollmentModal:()=>h(!1)}}a.s(["A",()=>BQ,"B",()=>Dy,"C",()=>Ch,"D",()=>BR,"E",()=>Dc,"F",()=>Dz,"G",()=>BP,"H",()=>Em,"P",()=>CO,"R",()=>B0,"S",()=>Cd,"W",()=>CM,"a",()=>Cj,"b",()=>Cc,"c",()=>Dd,"d",()=>Eo,"e",()=>CQ,"f",()=>CV,"g",()=>CT,"h",()=>CS,"i",()=>CW,"j",()=>CU,"k",()=>Dm,"l",()=>B9,"m",()=>Cl,"n",()=>CR,"o",()=>B5,"p",()=>Do,"q",()=>B6,"r",()=>B7,"s",()=>Dk,"t",()=>Dj,"u",()=>En,"v",()=>Db,"w",()=>Dh,"x",()=>De,"y",()=>BV,"z",()=>Dg],226945)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__2a5f7c57._.js.map